import{r as D,b as Ls,j as U,R as ro,y as ku,p as Ye,q as Oe,F as Os,x as On,D as wu,C as vr,I as pf,A as as,t as ht,V as Uo,w as Su,X as mf,Y as _f,Z as gf,a0 as vf,a1 as yf,a2 as xf,a3 as Tf,a4 as kf,a5 as wf,Q as Ir,a6 as Sf,a7 as bf,a8 as Cf,a9 as Ef,O as Of}from"./index-72d3d74c.js";import{u as Pe,a as Lo,e as oc,b as Bt,L as Af,c as Mf,d as Pf,m as Df,f as Rf,A as ll,H as If,E as Nf,g as Ff,h as bu,i as yr,t as Cu,T as Uf,j as Lf,I as Bf,k as zf,D as Vf,C as jf,P as Hf,l as qf}from"./index-9093718b.js";import{D as Nr,F as Gf,V as le,L as Wf,a as Yf,M as Rn,b as ae,S as Zf,B as $f,c as Eu,P as oa,d as Ou,e as Jr,f as nn,T as Bo,g as hn,h as Xf,C as ys,W as Qf,i as Kf,E as ac,j as At,N as Jn,k as Jf,l as fi,U as ks,m as ep,n as tp,o as sp,p as np,q as ip,r as Fr,s as cs,t as rp,u as he,R as op,v as As,w as Da,x as Au,y as cc,z as ul,A as ap,G as oo,H as cp,I as Mu,J as Pu,K as Du,O as Ru,Q as hl,X as lp,Y as Ur,Z as up,_ as hp,$ as dp,a0 as fp,a1 as xr,a2 as dl,a3 as fl}from"./three.module-ebe9f2a4.js";import{B as Iu,_ as We,a as $t,u as lc,T as pl,A as pp,b as mp,P as _p,O as gp,c as vp}from"./index-5e9ff699.js";import{T as yp}from"./TextareaAutosize-12e774de.js";import{D as xp,M as Tp,A as kp,E as wp}from"./ThreeDotsIcons-cb69dbc2.js";import{M as Sp,a as bp}from"./index.esm-e8cb4216.js";import{u as Cp}from"./index-b8d372d1.js";import{P as Ep}from"./SearchIcon-77a6c082.js";import{C as Op}from"./ClipLoader-e2f445a1.js";import"./SourcesTableIcon-59b30c3f.js";import"./VolumeIcon-09292b7d.js";import"./NodeCircleIcon-4ea650ed.js";import"./CheckIcon-ef222a12.js";import"./DeleteNodeIcon-579db2d1.js";import"./EditNodeIcon-bab0850d.js";import"./SucessFeedBackIcon-b6547a2e.js";function Ap(n){let e;const t=new Set,s=(l,u)=>{const h=typeof l=="function"?l(e):l;if(h!==e){const d=e;e=u?h:Object.assign({},e,h),t.forEach(f=>f(e,d))}},i=()=>e,r=(l,u=i,h=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let d=u(e);function f(){const m=u(e);if(!h(d,m)){const p=d;l(d=m,p)}}return t.add(f),()=>t.delete(f)},c={setState:s,getState:i,subscribe:(l,u,h)=>u||h?r(l,u,h):(t.add(l),()=>t.delete(l)),destroy:()=>t.clear()};return e=n(s,i,c),c}const Mp=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),ml=Mp?D.useEffect:D.useLayoutEffect;function Pp(n){const e=typeof n=="function"?Ap(n):n,t=(s=e.getState,i=Object.is)=>{const[,r]=D.useReducer(_=>_+1,0),o=e.getState(),a=D.useRef(o),c=D.useRef(s),l=D.useRef(i),u=D.useRef(!1),h=D.useRef();h.current===void 0&&(h.current=s(o));let d,f=!1;(a.current!==o||c.current!==s||l.current!==i||u.current)&&(d=s(o),f=!i(h.current,d)),ml(()=>{f&&(h.current=d),a.current=o,c.current=s,l.current=i,u.current=!1});const m=D.useRef(o);ml(()=>{const _=()=>{try{const k=e.getState(),w=c.current(k);l.current(h.current,w)||(a.current=k,h.current=w,r())}catch{u.current=!0,r()}},y=e.subscribe(_);return e.getState()!==m.current&&_(),y},[]);const p=f?d:h.current;return D.useDebugValue(p),p};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const s=[t,e];return{next(){const i=s.length<=0;return{value:s.shift(),done:i}}}},t}let xi=0;const Dp=Pp(n=>(Nr.onStart=(e,t,s)=>{n({active:!0,item:e,loaded:t,total:s,progress:(t-xi)/(s-xi)*100})},Nr.onLoad=()=>{n({active:!1})},Nr.onError=e=>n(t=>({errors:[...t.errors,e]})),Nr.onProgress=(e,t,s)=>{t===s&&(xi=s),n({active:!0,item:e,loaded:t,total:s,progress:(t-xi)/(s-xi)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0})),Rp=n=>`Loading ${n.toFixed(2)}%`;function Ip({containerStyles:n,innerStyles:e,barStyles:t,dataStyles:s,dataInterpolation:i=Rp,initialState:r=o=>o}){const{active:o,progress:a}=Dp(),c=D.useRef(0),l=D.useRef(0),u=D.useRef(null),[h,d]=D.useState(r(o));D.useEffect(()=>{let m;return o!==h&&(m=setTimeout(()=>d(o),300)),()=>clearTimeout(m)},[h,o]);const f=D.useCallback(()=>{u.current&&(c.current+=(a-c.current)/2,(c.current>.95*a||a===100)&&(c.current=a),u.current.innerText=i(c.current),c.current<a&&(l.current=requestAnimationFrame(f)))},[i,a]);return D.useEffect(()=>(f(),()=>cancelAnimationFrame(l.current)),[f]),h?D.createElement("div",{style:{...Lr.container,opacity:o?1:0,...n}},D.createElement("div",null,D.createElement("div",{style:{...Lr.inner,...e}},D.createElement("div",{style:{...Lr.bar,transform:`scaleX(${a/100})`,...t}}),D.createElement("span",{ref:u,style:{...Lr.data,...s}})))):null}const Lr={container:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"#171717",display:"flex",alignItems:"center",justifyContent:"center",transition:"opacity 300ms ease",zIndex:1e3},inner:{width:100,height:3,background:"#272727",textAlign:"center"},bar:{height:3,width:"100%",background:"white",transition:"transform 200ms",transformOrigin:"left center"},data:{display:"inline-block",position:"relative",fontVariantNumeric:"tabular-nums",marginTop:"0.8em",color:"#f0f0f0",fontSize:"0.6em",fontFamily:'-apple-system, BlinkMacSystemFont, "Inter", "Segoe UI", "Helvetica Neue", Helvetica, Arial, Roboto, Ubuntu, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',whiteSpace:"nowrap"}};let Ti;function Np(){var n;if(Ti!==void 0)return Ti;try{let e;const t=document.createElement("canvas");return Ti=!!(window.WebGL2RenderingContext&&(e=t.getContext("webgl2"))),e&&((n=e.getExtension("WEBGL_lose_context"))==null||n.loseContext()),Ti}catch{return Ti=!1}}const aa=new Gf,ca=new le,In=new le,Vt=new le,ds=new le,Kt=new le,fs=new le,ps=new le,ki=new le,wi=new le,Si=new le,Br=new le,bi=new le,Ci=new le,Ei=new le;class Fp{constructor(e,t,s){this.camera=e,this.scene=t,this.startPoint=new le,this.endPoint=new le,this.collection=[],this.deep=s||Number.MAX_VALUE}select(e,t){return this.startPoint=e||this.startPoint,this.endPoint=t||this.endPoint,this.collection=[],this.updateFrustum(this.startPoint,this.endPoint),this.searchChildInFrustum(aa,this.scene),this.collection}updateFrustum(e,t){if(e=e||this.startPoint,t=t||this.endPoint,e.x===t.x&&(t.x+=Number.EPSILON),e.y===t.y&&(t.y+=Number.EPSILON),this.camera.updateProjectionMatrix(),this.camera.updateMatrixWorld(),this.camera.isPerspectiveCamera){In.copy(e),In.x=Math.min(e.x,t.x),In.y=Math.max(e.y,t.y),t.x=Math.max(e.x,t.x),t.y=Math.min(e.y,t.y),Vt.setFromMatrixPosition(this.camera.matrixWorld),ds.copy(In),Kt.set(t.x,In.y,0),fs.copy(t),ps.set(In.x,t.y,0),ds.unproject(this.camera),Kt.unproject(this.camera),fs.unproject(this.camera),ps.unproject(this.camera),bi.copy(ds).sub(Vt),Ci.copy(Kt).sub(Vt),Ei.copy(fs).sub(Vt),bi.normalize(),Ci.normalize(),Ei.normalize(),bi.multiplyScalar(this.deep),Ci.multiplyScalar(this.deep),Ei.multiplyScalar(this.deep),bi.add(Vt),Ci.add(Vt),Ei.add(Vt);var s=aa.planes;s[0].setFromCoplanarPoints(Vt,ds,Kt),s[1].setFromCoplanarPoints(Vt,Kt,fs),s[2].setFromCoplanarPoints(fs,ps,Vt),s[3].setFromCoplanarPoints(ps,ds,Vt),s[4].setFromCoplanarPoints(Kt,fs,ps),s[5].setFromCoplanarPoints(Ei,Ci,bi),s[5].normal.multiplyScalar(-1)}else if(this.camera.isOrthographicCamera){const i=Math.min(e.x,t.x),r=Math.max(e.y,t.y),o=Math.max(e.x,t.x),a=Math.min(e.y,t.y);ds.set(i,r,-1),Kt.set(o,r,-1),fs.set(o,a,-1),ps.set(i,a,-1),ki.set(i,r,1),wi.set(o,r,1),Si.set(o,a,1),Br.set(i,a,1),ds.unproject(this.camera),Kt.unproject(this.camera),fs.unproject(this.camera),ps.unproject(this.camera),ki.unproject(this.camera),wi.unproject(this.camera),Si.unproject(this.camera),Br.unproject(this.camera);var s=aa.planes;s[0].setFromCoplanarPoints(ds,ki,wi),s[1].setFromCoplanarPoints(Kt,wi,Si),s[2].setFromCoplanarPoints(Si,Br,ps),s[3].setFromCoplanarPoints(Br,ki,ds),s[4].setFromCoplanarPoints(Kt,fs,ps),s[5].setFromCoplanarPoints(Si,wi,ki),s[5].normal.multiplyScalar(-1)}else console.error("THREE.SelectionBox: Unsupported camera type.")}searchChildInFrustum(e,t){if((t.isMesh||t.isLine||t.isPoints)&&t.material!==void 0&&(t.geometry.boundingSphere===null&&t.geometry.computeBoundingSphere(),ca.copy(t.geometry.boundingSphere.center),ca.applyMatrix4(t.matrixWorld),e.containsPoint(ca)&&this.collection.push(t)),t.children.length>0)for(let s=0;s<t.children.length;s++)this.searchChildInFrustum(e,t.children[s])}}class Bi extends Wf{constructor(e){super(e),this.defaultDPI=90,this.defaultUnit="px"}load(e,t,s,i){const r=this,o=new Yf(r.manager);o.setPath(r.path),o.setRequestHeader(r.requestHeader),o.setWithCredentials(r.withCredentials),o.load(e,function(a){try{t(r.parse(a))}catch(c){i?i(c):console.error(c),r.manager.itemError(e)}},s,i)}parse(e){const t=this;function s(N,F){if(N.nodeType!==1)return;const C=v(N);let P=!0,G=null;switch(N.nodeName){case"svg":break;case"style":r(N);break;case"g":F=m(N,F);break;case"path":F=m(N,F),N.hasAttribute("d")&&(G=i(N));break;case"rect":F=m(N,F),G=c(N);break;case"polygon":F=m(N,F),G=l(N);break;case"polyline":F=m(N,F),G=u(N);break;case"circle":F=m(N,F),G=h(N);break;case"ellipse":F=m(N,F),G=d(N);break;case"line":F=m(N,F),G=f(N);break;case"defs":P=!1;break;case"mask":P=!1;break;case"use":F=m(N,F);const I=N.href.baseVal.substring(1),B=N.viewportElement.getElementById(I);B?s(B,F):console.warn("SVGLoader: 'use node' references non-existent node id: "+I);break}if(G&&(F.fill!==void 0&&F.fill!=="none"&&G.color.setStyle(F.fill),S(G,$),A.push(G),G.userData={node:N,style:F}),P){const I=N.childNodes;for(let B=0;B<I.length;B++)s(I[B],F)}C&&(M.pop(),M.length>0?$.copy(M[M.length-1]):$.identity())}function i(N){const F=new nn,C=new ae,P=new ae,G=new ae;let I=!0,B=!1;const se=N.getAttribute("d").match(/[a-df-z][^a-df-z]*/gi);for(let ne=0,J=se.length;ne<J;ne++){const ge=se[ne],K=ge.charAt(0),j=ge.substr(1).trim();I===!0&&(B=!0,I=!1);let O;switch(K){case"M":O=_(j);for(let E=0,X=O.length;E<X;E+=2)C.x=O[E+0],C.y=O[E+1],P.x=C.x,P.y=C.y,E===0?F.moveTo(C.x,C.y):F.lineTo(C.x,C.y),E===0&&G.copy(C);break;case"H":O=_(j);for(let E=0,X=O.length;E<X;E++)C.x=O[E],P.x=C.x,P.y=C.y,F.lineTo(C.x,C.y),E===0&&B===!0&&G.copy(C);break;case"V":O=_(j);for(let E=0,X=O.length;E<X;E++)C.y=O[E],P.x=C.x,P.y=C.y,F.lineTo(C.x,C.y),E===0&&B===!0&&G.copy(C);break;case"L":O=_(j);for(let E=0,X=O.length;E<X;E+=2)C.x=O[E+0],C.y=O[E+1],P.x=C.x,P.y=C.y,F.lineTo(C.x,C.y),E===0&&B===!0&&G.copy(C);break;case"C":O=_(j);for(let E=0,X=O.length;E<X;E+=6)F.bezierCurveTo(O[E+0],O[E+1],O[E+2],O[E+3],O[E+4],O[E+5]),P.x=O[E+2],P.y=O[E+3],C.x=O[E+4],C.y=O[E+5],E===0&&B===!0&&G.copy(C);break;case"S":O=_(j);for(let E=0,X=O.length;E<X;E+=4)F.bezierCurveTo(p(C.x,P.x),p(C.y,P.y),O[E+0],O[E+1],O[E+2],O[E+3]),P.x=O[E+0],P.y=O[E+1],C.x=O[E+2],C.y=O[E+3],E===0&&B===!0&&G.copy(C);break;case"Q":O=_(j);for(let E=0,X=O.length;E<X;E+=4)F.quadraticCurveTo(O[E+0],O[E+1],O[E+2],O[E+3]),P.x=O[E+0],P.y=O[E+1],C.x=O[E+2],C.y=O[E+3],E===0&&B===!0&&G.copy(C);break;case"T":O=_(j);for(let E=0,X=O.length;E<X;E+=2){const ee=p(C.x,P.x),ue=p(C.y,P.y);F.quadraticCurveTo(ee,ue,O[E+0],O[E+1]),P.x=ee,P.y=ue,C.x=O[E+0],C.y=O[E+1],E===0&&B===!0&&G.copy(C)}break;case"A":O=_(j,[3,4],7);for(let E=0,X=O.length;E<X;E+=7){if(O[E+5]==C.x&&O[E+6]==C.y)continue;const ee=C.clone();C.x=O[E+5],C.y=O[E+6],P.x=C.x,P.y=C.y,o(F,O[E],O[E+1],O[E+2],O[E+3],O[E+4],ee,C),E===0&&B===!0&&G.copy(C)}break;case"m":O=_(j);for(let E=0,X=O.length;E<X;E+=2)C.x+=O[E+0],C.y+=O[E+1],P.x=C.x,P.y=C.y,E===0?F.moveTo(C.x,C.y):F.lineTo(C.x,C.y),E===0&&G.copy(C);break;case"h":O=_(j);for(let E=0,X=O.length;E<X;E++)C.x+=O[E],P.x=C.x,P.y=C.y,F.lineTo(C.x,C.y),E===0&&B===!0&&G.copy(C);break;case"v":O=_(j);for(let E=0,X=O.length;E<X;E++)C.y+=O[E],P.x=C.x,P.y=C.y,F.lineTo(C.x,C.y),E===0&&B===!0&&G.copy(C);break;case"l":O=_(j);for(let E=0,X=O.length;E<X;E+=2)C.x+=O[E+0],C.y+=O[E+1],P.x=C.x,P.y=C.y,F.lineTo(C.x,C.y),E===0&&B===!0&&G.copy(C);break;case"c":O=_(j);for(let E=0,X=O.length;E<X;E+=6)F.bezierCurveTo(C.x+O[E+0],C.y+O[E+1],C.x+O[E+2],C.y+O[E+3],C.x+O[E+4],C.y+O[E+5]),P.x=C.x+O[E+2],P.y=C.y+O[E+3],C.x+=O[E+4],C.y+=O[E+5],E===0&&B===!0&&G.copy(C);break;case"s":O=_(j);for(let E=0,X=O.length;E<X;E+=4)F.bezierCurveTo(p(C.x,P.x),p(C.y,P.y),C.x+O[E+0],C.y+O[E+1],C.x+O[E+2],C.y+O[E+3]),P.x=C.x+O[E+0],P.y=C.y+O[E+1],C.x+=O[E+2],C.y+=O[E+3],E===0&&B===!0&&G.copy(C);break;case"q":O=_(j);for(let E=0,X=O.length;E<X;E+=4)F.quadraticCurveTo(C.x+O[E+0],C.y+O[E+1],C.x+O[E+2],C.y+O[E+3]),P.x=C.x+O[E+0],P.y=C.y+O[E+1],C.x+=O[E+2],C.y+=O[E+3],E===0&&B===!0&&G.copy(C);break;case"t":O=_(j);for(let E=0,X=O.length;E<X;E+=2){const ee=p(C.x,P.x),ue=p(C.y,P.y);F.quadraticCurveTo(ee,ue,C.x+O[E+0],C.y+O[E+1]),P.x=ee,P.y=ue,C.x=C.x+O[E+0],C.y=C.y+O[E+1],E===0&&B===!0&&G.copy(C)}break;case"a":O=_(j,[3,4],7);for(let E=0,X=O.length;E<X;E+=7){if(O[E+5]==0&&O[E+6]==0)continue;const ee=C.clone();C.x+=O[E+5],C.y+=O[E+6],P.x=C.x,P.y=C.y,o(F,O[E],O[E+1],O[E+2],O[E+3],O[E+4],ee,C),E===0&&B===!0&&G.copy(C)}break;case"Z":case"z":F.currentPath.autoClose=!0,F.currentPath.curves.length>0&&(C.copy(G),F.currentPath.currentPoint.copy(C),I=!0);break;default:console.warn(ge)}B=!1}return F}function r(N){if(!(!N.sheet||!N.sheet.cssRules||!N.sheet.cssRules.length))for(let F=0;F<N.sheet.cssRules.length;F++){const C=N.sheet.cssRules[F];if(C.type!==1)continue;const P=C.selectorText.split(/,/gm).filter(Boolean).map(G=>G.trim());for(let G=0;G<P.length;G++)R[P[G]]=Object.assign(R[P[G]]||{},C.style)}}function o(N,F,C,P,G,I,B,ie){if(F==0||C==0){N.lineTo(ie.x,ie.y);return}P=P*Math.PI/180,F=Math.abs(F),C=Math.abs(C);const se=(B.x-ie.x)/2,ne=(B.y-ie.y)/2,J=Math.cos(P)*se+Math.sin(P)*ne,ge=-Math.sin(P)*se+Math.cos(P)*ne;let K=F*F,j=C*C;const O=J*J,E=ge*ge,X=O/K+E/j;if(X>1){const cl=Math.sqrt(X);F=cl*F,C=cl*C,K=F*F,j=C*C}const ee=K*E+j*O,ue=(K*j-ee)/ee;let ke=Math.sqrt(Math.max(0,ue));G===I&&(ke=-ke);const Xe=ke*F*ge/C,zt=-ke*C*J/F,yi=Math.cos(P)*Xe-Math.sin(P)*zt+(B.x+ie.x)/2,ra=Math.sin(P)*Xe+Math.cos(P)*zt+(B.y+ie.y)/2,Rr=a(1,0,(J-Xe)/F,(ge-zt)/C),ff=a((J-Xe)/F,(ge-zt)/C,(-J-Xe)/F,(-ge-zt)/C)%(Math.PI*2);N.currentPath.absellipse(yi,ra,F,C,Rr,Rr+ff,I===0,P)}function a(N,F,C,P){const G=N*C+F*P,I=Math.sqrt(N*N+F*F)*Math.sqrt(C*C+P*P);let B=Math.acos(Math.max(-1,Math.min(1,G/I)));return N*P-F*C<0&&(B=-B),B}function c(N){const F=w(N.getAttribute("x")||0),C=w(N.getAttribute("y")||0),P=w(N.getAttribute("rx")||N.getAttribute("ry")||0),G=w(N.getAttribute("ry")||N.getAttribute("rx")||0),I=w(N.getAttribute("width")),B=w(N.getAttribute("height")),ie=1-.551915024494,se=new nn;return se.moveTo(F+P,C),se.lineTo(F+I-P,C),(P!==0||G!==0)&&se.bezierCurveTo(F+I-P*ie,C,F+I,C+G*ie,F+I,C+G),se.lineTo(F+I,C+B-G),(P!==0||G!==0)&&se.bezierCurveTo(F+I,C+B-G*ie,F+I-P*ie,C+B,F+I-P,C+B),se.lineTo(F+P,C+B),(P!==0||G!==0)&&se.bezierCurveTo(F+P*ie,C+B,F,C+B-G*ie,F,C+B-G),se.lineTo(F,C+G),(P!==0||G!==0)&&se.bezierCurveTo(F,C+G*ie,F+P*ie,C,F+P,C),se}function l(N){function F(I,B,ie){const se=w(B),ne=w(ie);G===0?P.moveTo(se,ne):P.lineTo(se,ne),G++}const C=/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,P=new nn;let G=0;return N.getAttribute("points").replace(C,F),P.currentPath.autoClose=!0,P}function u(N){function F(I,B,ie){const se=w(B),ne=w(ie);G===0?P.moveTo(se,ne):P.lineTo(se,ne),G++}const C=/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,P=new nn;let G=0;return N.getAttribute("points").replace(C,F),P.currentPath.autoClose=!1,P}function h(N){const F=w(N.getAttribute("cx")||0),C=w(N.getAttribute("cy")||0),P=w(N.getAttribute("r")||0),G=new oa;G.absarc(F,C,P,0,Math.PI*2);const I=new nn;return I.subPaths.push(G),I}function d(N){const F=w(N.getAttribute("cx")||0),C=w(N.getAttribute("cy")||0),P=w(N.getAttribute("rx")||0),G=w(N.getAttribute("ry")||0),I=new oa;I.absellipse(F,C,P,G,0,Math.PI*2);const B=new nn;return B.subPaths.push(I),B}function f(N){const F=w(N.getAttribute("x1")||0),C=w(N.getAttribute("y1")||0),P=w(N.getAttribute("x2")||0),G=w(N.getAttribute("y2")||0),I=new nn;return I.moveTo(F,C),I.lineTo(P,G),I.currentPath.autoClose=!1,I}function m(N,F){F=Object.assign({},F);let C={};if(N.hasAttribute("class")){const B=N.getAttribute("class").split(/\s/).filter(Boolean).map(ie=>ie.trim());for(let ie=0;ie<B.length;ie++)C=Object.assign(C,R["."+B[ie]])}N.hasAttribute("id")&&(C=Object.assign(C,R["#"+N.getAttribute("id")]));function P(B,ie,se){se===void 0&&(se=function(J){return J.startsWith("url")&&console.warn("SVGLoader: url access in attributes is not implemented."),J}),N.hasAttribute(B)&&(F[ie]=se(N.getAttribute(B))),C[B]&&(F[ie]=se(C[B])),N.style&&N.style[B]!==""&&(F[ie]=se(N.style[B]))}function G(B){return Math.max(0,Math.min(1,w(B)))}function I(B){return Math.max(0,w(B))}return P("fill","fill"),P("fill-opacity","fillOpacity",G),P("fill-rule","fillRule"),P("opacity","opacity",G),P("stroke","stroke"),P("stroke-opacity","strokeOpacity",G),P("stroke-width","strokeWidth",I),P("stroke-linejoin","strokeLineJoin"),P("stroke-linecap","strokeLineCap"),P("stroke-miterlimit","strokeMiterLimit",I),P("visibility","visibility"),F}function p(N,F){return N-(F-N)}function _(N,F,C){if(typeof N!="string")throw new TypeError("Invalid input: "+typeof N);const P={SEPARATOR:/[ \t\r\n\,.\-+]/,WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i,FLAGS:/[01]/},G=0,I=1,B=2,ie=3;let se=G,ne=!0,J="",ge="";const K=[];function j(ee,ue,ke){const Xe=new SyntaxError('Unexpected character "'+ee+'" at index '+ue+".");throw Xe.partial=ke,Xe}function O(){J!==""&&(ge===""?K.push(Number(J)):K.push(Number(J)*Math.pow(10,Number(ge)))),J="",ge=""}let E;const X=N.length;for(let ee=0;ee<X;ee++){if(E=N[ee],Array.isArray(F)&&F.includes(K.length%C)&&P.FLAGS.test(E)){se=I,J=E,O();continue}if(se===G){if(P.WHITESPACE.test(E))continue;if(P.DIGIT.test(E)||P.SIGN.test(E)){se=I,J=E;continue}if(P.POINT.test(E)){se=B,J=E;continue}P.COMMA.test(E)&&(ne&&j(E,ee,K),ne=!0)}if(se===I){if(P.DIGIT.test(E)){J+=E;continue}if(P.POINT.test(E)){J+=E,se=B;continue}if(P.EXP.test(E)){se=ie;continue}P.SIGN.test(E)&&J.length===1&&P.SIGN.test(J[0])&&j(E,ee,K)}if(se===B){if(P.DIGIT.test(E)){J+=E;continue}if(P.EXP.test(E)){se=ie;continue}P.POINT.test(E)&&J[J.length-1]==="."&&j(E,ee,K)}if(se===ie){if(P.DIGIT.test(E)){ge+=E;continue}if(P.SIGN.test(E)){if(ge===""){ge+=E;continue}ge.length===1&&P.SIGN.test(ge)&&j(E,ee,K)}}P.WHITESPACE.test(E)?(O(),se=G,ne=!1):P.COMMA.test(E)?(O(),se=G,ne=!0):P.SIGN.test(E)?(O(),se=I,J=E):P.POINT.test(E)?(O(),se=B,J=E):j(E,ee,K)}return O(),K}const y=["mm","cm","in","pt","pc","px"],k={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:72/6,pc:1,px:-1},px:{px:1}};function w(N){let F="px";if(typeof N=="string"||N instanceof String)for(let P=0,G=y.length;P<G;P++){const I=y[P];if(N.endsWith(I)){F=I,N=N.substring(0,N.length-I.length);break}}let C;return F==="px"&&t.defaultUnit!=="px"?C=k.in[t.defaultUnit]/t.defaultDPI:(C=k[F][t.defaultUnit],C<0&&(C=k[F].in*t.defaultDPI)),C*parseFloat(N)}function v(N){if(!(N.hasAttribute("transform")||N.nodeName==="use"&&(N.hasAttribute("x")||N.hasAttribute("y"))))return null;const F=g(N);return M.length>0&&F.premultiply(M[M.length-1]),$.copy(F),M.push(F),F}function g(N){const F=new Rn,C=L;if(N.nodeName==="use"&&(N.hasAttribute("x")||N.hasAttribute("y"))){const P=w(N.getAttribute("x")),G=w(N.getAttribute("y"));F.translate(P,G)}if(N.hasAttribute("transform")){const P=N.getAttribute("transform").split(")");for(let G=P.length-1;G>=0;G--){const I=P[G].trim();if(I==="")continue;const B=I.indexOf("("),ie=I.length;if(B>0&&B<ie){const se=I.substr(0,B),ne=_(I.substr(B+1,ie-B-1));switch(C.identity(),se){case"translate":if(ne.length>=1){const J=ne[0];let ge=J;ne.length>=2&&(ge=ne[1]),C.translate(J,ge)}break;case"rotate":if(ne.length>=1){let J=0,ge=0,K=0;J=-ne[0]*Math.PI/180,ne.length>=3&&(ge=ne[1],K=ne[2]),q.identity().translate(-ge,-K),Y.identity().rotate(J),W.multiplyMatrices(Y,q),q.identity().translate(ge,K),C.multiplyMatrices(q,W)}break;case"scale":if(ne.length>=1){const J=ne[0];let ge=J;ne.length>=2&&(ge=ne[1]),C.scale(J,ge)}break;case"skewX":ne.length===1&&C.set(1,Math.tan(ne[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":ne.length===1&&C.set(1,0,0,Math.tan(ne[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":ne.length===6&&C.set(ne[0],ne[2],ne[4],ne[1],ne[3],ne[5],0,0,1);break}}F.premultiply(C)}}return F}function S(N,F){function C(I){z.set(I.x,I.y,1).applyMatrix3(F),I.set(z.x,z.y)}const P=T(F),G=N.subPaths;for(let I=0,B=G.length;I<B;I++){const se=G[I].curves;for(let ne=0;ne<se.length;ne++){const J=se[ne];J.isLineCurve?(C(J.v1),C(J.v2)):J.isCubicBezierCurve?(C(J.v0),C(J.v1),C(J.v2),C(J.v3)):J.isQuadraticBezierCurve?(C(J.v0),C(J.v1),C(J.v2)):J.isEllipseCurve&&(P&&console.warn("SVGLoader: Elliptic arc or ellipse rotation or skewing is not implemented."),V.set(J.aX,J.aY),C(V),J.aX=V.x,J.aY=V.y,J.xRadius*=x(F),J.yRadius*=b(F))}}}function T(N){return N.elements[1]!==0||N.elements[3]!==0}function x(N){const F=N.elements;return Math.sqrt(F[0]*F[0]+F[1]*F[1])}function b(N){const F=N.elements;return Math.sqrt(F[3]*F[3]+F[4]*F[4])}const A=[],R={},M=[],L=new Rn,q=new Rn,Y=new Rn,W=new Rn,V=new ae,z=new le,$=new Rn,Q=new DOMParser().parseFromString(e,"image/svg+xml");return s(Q.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4}),{paths:A,xml:Q.documentElement}}static createShapes(e){const s={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},i={loc:s.ORIGIN,t:0};function r(_,y,k,w){const v=_.x,g=y.x,S=k.x,T=w.x,x=_.y,b=y.y,A=k.y,R=w.y,M=(T-S)*(x-A)-(R-A)*(v-S),L=(g-v)*(x-A)-(b-x)*(v-S),q=(R-A)*(g-v)-(T-S)*(b-x),Y=M/q,W=L/q;if(q===0&&M!==0||Y<=0||Y>=1||W<0||W>1)return null;if(M===0&&q===0){for(let V=0;V<2;V++)if(o(V===0?k:w,_,y),i.loc==s.ORIGIN){const z=V===0?k:w;return{x:z.x,y:z.y,t:i.t}}else if(i.loc==s.BETWEEN){const z=+(v+i.t*(g-v)).toPrecision(10),$=+(x+i.t*(b-x)).toPrecision(10);return{x:z,y:$,t:i.t}}return null}else{for(let $=0;$<2;$++)if(o($===0?k:w,_,y),i.loc==s.ORIGIN){const Q=$===0?k:w;return{x:Q.x,y:Q.y,t:i.t}}const V=+(v+Y*(g-v)).toPrecision(10),z=+(x+Y*(b-x)).toPrecision(10);return{x:V,y:z,t:Y}}}function o(_,y,k){const w=k.x-y.x,v=k.y-y.y,g=_.x-y.x,S=_.y-y.y,T=w*S-g*v;if(_.x===y.x&&_.y===y.y){i.loc=s.ORIGIN,i.t=0;return}if(_.x===k.x&&_.y===k.y){i.loc=s.DESTINATION,i.t=1;return}if(T<-Number.EPSILON){i.loc=s.LEFT;return}if(T>Number.EPSILON){i.loc=s.RIGHT;return}if(w*g<0||v*S<0){i.loc=s.BEHIND;return}if(Math.sqrt(w*w+v*v)<Math.sqrt(g*g+S*S)){i.loc=s.BEYOND;return}let x;w!==0?x=g/w:x=S/v,i.loc=s.BETWEEN,i.t=x}function a(_,y){const k=[],w=[];for(let v=1;v<_.length;v++){const g=_[v-1],S=_[v];for(let T=1;T<y.length;T++){const x=y[T-1],b=y[T],A=r(g,S,x,b);A!==null&&k.find(R=>R.t<=A.t+Number.EPSILON&&R.t>=A.t-Number.EPSILON)===void 0&&(k.push(A),w.push(new ae(A.x,A.y)))}}return w}function c(_,y,k){const w=new ae;y.getCenter(w);const v=[];return k.forEach(g=>{g.boundingBox.containsPoint(w)&&a(_,g.points).forEach(T=>{v.push({identifier:g.identifier,isCW:g.isCW,point:T})})}),v.sort((g,S)=>g.point.x-S.point.x),v}function l(_,y,k,w,v){(v==null||v==="")&&(v="nonzero");const g=new ae;_.boundingBox.getCenter(g);const S=[new ae(k,g.y),new ae(w,g.y)],T=c(S,_.boundingBox,y);T.sort((L,q)=>L.point.x-q.point.x);const x=[],b=[];T.forEach(L=>{L.identifier===_.identifier?x.push(L):b.push(L)});const A=x[0].point.x,R=[];let M=0;for(;M<b.length&&b[M].point.x<A;)R.length>0&&R[R.length-1]===b[M].identifier?R.pop():R.push(b[M].identifier),M++;if(R.push(_.identifier),v==="evenodd"){const L=R.length%2===0,q=R[R.length-2];return{identifier:_.identifier,isHole:L,for:q}}else if(v==="nonzero"){let L=!0,q=null,Y=null;for(let W=0;W<R.length;W++){const V=R[W];L?(Y=y[V].isCW,L=!1,q=V):Y!==y[V].isCW&&(Y=y[V].isCW,L=!0)}return{identifier:_.identifier,isHole:L,for:q}}else console.warn('fill-rule: "'+v+'" is currently not implemented.')}let u=0,h=999999999,d=-999999999,f=e.subPaths.map(_=>{const y=_.getPoints();let k=-999999999,w=999999999,v=-999999999,g=999999999;for(let S=0;S<y.length;S++){const T=y[S];T.y>k&&(k=T.y),T.y<w&&(w=T.y),T.x>v&&(v=T.x),T.x<g&&(g=T.x)}return d<=v&&(d=v+1),h>=g&&(h=g-1),{curves:_.curves,points:y,isCW:Zf.isClockWise(y),identifier:u++,boundingBox:new $f(new ae(g,w),new ae(v,k))}});f=f.filter(_=>_.points.length>1);const m=f.map(_=>l(_,f,h,d,e.userData.style.fillRule)),p=[];return f.forEach(_=>{if(!m[_.identifier].isHole){const k=new Eu;k.curves=_.curves,m.filter(v=>v.isHole&&v.for===_.identifier).forEach(v=>{const g=f[v.identifier],S=new oa;S.curves=g.curves,k.holes.push(S)}),p.push(k)}}),p}static getStrokeStyle(e,t,s,i,r){return e=e!==void 0?e:1,t=t!==void 0?t:"#000",s=s!==void 0?s:"miter",i=i!==void 0?i:"butt",r=r!==void 0?r:4,{strokeColor:t,strokeWidth:e,strokeLineJoin:s,strokeLineCap:i,strokeMiterLimit:r}}static pointsToStroke(e,t,s,i){const r=[],o=[],a=[];if(Bi.pointsToStrokeWithBuffers(e,t,s,i,r,o,a)===0)return null;const c=new Ou;return c.setAttribute("position",new Jr(r,3)),c.setAttribute("normal",new Jr(o,3)),c.setAttribute("uv",new Jr(a,2)),c}static pointsToStrokeWithBuffers(e,t,s,i,r,o,a,c){const l=new ae,u=new ae,h=new ae,d=new ae,f=new ae,m=new ae,p=new ae,_=new ae,y=new ae,k=new ae,w=new ae,v=new ae,g=new ae,S=new ae,T=new ae,x=new ae,b=new ae;s=s!==void 0?s:12,i=i!==void 0?i:.001,c=c!==void 0?c:0,e=ge(e);const A=e.length;if(A<2)return 0;const R=e[0].equals(e[A-1]);let M,L=e[0],q;const Y=t.strokeWidth/2,W=1/(A-1);let V=0,z,$,Q,te,N=!1,F=0,C=c*3,P=c*2;G(e[0],e[1],l).multiplyScalar(Y),_.copy(e[0]).sub(l),y.copy(e[0]).add(l),k.copy(_),w.copy(y);for(let K=1;K<A;K++){M=e[K],K===A-1?R?q=e[1]:q=void 0:q=e[K+1];const j=l;if(G(L,M,j),h.copy(j).multiplyScalar(Y),v.copy(M).sub(h),g.copy(M).add(h),z=V+W,$=!1,q!==void 0){G(M,q,u),h.copy(u).multiplyScalar(Y),S.copy(M).sub(h),T.copy(M).add(h),Q=!0,h.subVectors(q,L),j.dot(h)<0&&(Q=!1),K===1&&(N=Q),h.subVectors(q,M),h.normalize();const O=Math.abs(j.dot(h));if(O!==0){const E=Y/O;h.multiplyScalar(-E),d.subVectors(M,L),f.copy(d).setLength(E).add(h),x.copy(f).negate();const X=f.length(),ee=d.length();d.divideScalar(ee),m.subVectors(q,M);const ue=m.length();switch(m.divideScalar(ue),d.dot(x)<ee&&m.dot(x)<ue&&($=!0),b.copy(f).add(M),x.add(M),te=!1,$?Q?(T.copy(x),g.copy(x)):(S.copy(x),v.copy(x)):ie(),t.strokeLineJoin){case"bevel":se(Q,$,z);break;case"round":ne(Q,$),Q?B(M,v,S,z,0):B(M,T,g,z,1);break;case"miter":case"miter-clip":default:const ke=Y*t.strokeMiterLimit/X;if(ke<1)if(t.strokeLineJoin!=="miter-clip"){se(Q,$,z);break}else ne(Q,$),Q?(m.subVectors(b,v).multiplyScalar(ke).add(v),p.subVectors(b,S).multiplyScalar(ke).add(S),I(v,z,0),I(m,z,0),I(M,z,.5),I(M,z,.5),I(m,z,0),I(p,z,0),I(M,z,.5),I(p,z,0),I(S,z,0)):(m.subVectors(b,g).multiplyScalar(ke).add(g),p.subVectors(b,T).multiplyScalar(ke).add(T),I(g,z,1),I(m,z,1),I(M,z,.5),I(M,z,.5),I(m,z,1),I(p,z,1),I(M,z,.5),I(p,z,1),I(T,z,1));else $?(Q?(I(y,V,1),I(_,V,0),I(b,z,0),I(y,V,1),I(b,z,0),I(x,z,1)):(I(y,V,1),I(_,V,0),I(b,z,1),I(_,V,0),I(x,z,0),I(b,z,1)),Q?S.copy(b):T.copy(b)):Q?(I(v,z,0),I(b,z,0),I(M,z,.5),I(M,z,.5),I(b,z,0),I(S,z,0)):(I(g,z,1),I(b,z,1),I(M,z,.5),I(M,z,.5),I(b,z,1),I(T,z,1)),te=!0;break}}else ie()}else ie();!R&&K===A-1&&J(e[0],k,w,Q,!0,V),V=z,L=M,_.copy(S),y.copy(T)}if(!R)J(M,v,g,Q,!1,z);else if($&&r){let K=b,j=x;N!==Q&&(K=x,j=b),Q?(te||N)&&(j.toArray(r,0*3),j.toArray(r,3*3),te&&K.toArray(r,1*3)):(te||!N)&&(j.toArray(r,1*3),j.toArray(r,3*3),te&&K.toArray(r,0*3))}return F;function G(K,j,O){return O.subVectors(j,K),O.set(-O.y,O.x).normalize()}function I(K,j,O){r&&(r[C]=K.x,r[C+1]=K.y,r[C+2]=0,o&&(o[C]=0,o[C+1]=0,o[C+2]=1),C+=3,a&&(a[P]=j,a[P+1]=O,P+=2)),F+=3}function B(K,j,O,E,X){l.copy(j).sub(K).normalize(),u.copy(O).sub(K).normalize();let ee=Math.PI;const ue=l.dot(u);Math.abs(ue)<1&&(ee=Math.abs(Math.acos(ue))),ee/=s,h.copy(j);for(let ke=0,Xe=s-1;ke<Xe;ke++)d.copy(h).rotateAround(K,ee),I(h,E,X),I(d,E,X),I(K,E,.5),h.copy(d);I(d,E,X),I(O,E,X),I(K,E,.5)}function ie(){I(y,V,1),I(_,V,0),I(v,z,0),I(y,V,1),I(v,z,1),I(g,z,0)}function se(K,j,O){j?K?(I(y,V,1),I(_,V,0),I(v,z,0),I(y,V,1),I(v,z,0),I(x,z,1),I(v,O,0),I(S,O,0),I(x,O,.5)):(I(y,V,1),I(_,V,0),I(g,z,1),I(_,V,0),I(x,z,0),I(g,z,1),I(g,O,1),I(T,O,0),I(x,O,.5)):K?(I(v,O,0),I(S,O,0),I(M,O,.5)):(I(g,O,1),I(T,O,0),I(M,O,.5))}function ne(K,j){j&&(K?(I(y,V,1),I(_,V,0),I(v,z,0),I(y,V,1),I(v,z,0),I(x,z,1),I(v,V,0),I(M,z,.5),I(x,z,1),I(M,z,.5),I(S,V,0),I(x,z,1)):(I(y,V,1),I(_,V,0),I(g,z,1),I(_,V,0),I(x,z,0),I(g,z,1),I(g,V,1),I(x,z,0),I(M,z,.5),I(M,z,.5),I(x,z,0),I(T,V,1)))}function J(K,j,O,E,X,ee){switch(t.strokeLineCap){case"round":X?B(K,O,j,ee,.5):B(K,j,O,ee,.5);break;case"square":if(X)l.subVectors(j,K),u.set(l.y,-l.x),h.addVectors(l,u).add(K),d.subVectors(u,l).add(K),E?(h.toArray(r,1*3),d.toArray(r,0*3),d.toArray(r,3*3)):(h.toArray(r,1*3),h.toArray(r,3*3),d.toArray(r,0*3));else{l.subVectors(O,K),u.set(l.y,-l.x),h.addVectors(l,u).add(K),d.subVectors(u,l).add(K);const ue=r.length;E?(h.toArray(r,ue-1*3),d.toArray(r,ue-2*3),d.toArray(r,ue-4*3)):(h.toArray(r,ue-2*3),d.toArray(r,ue-1*3),d.toArray(r,ue-4*3))}break}}function ge(K){let j=!1;for(let E=1,X=K.length-1;E<X;E++)if(K[E].distanceTo(K[E+1])<i){j=!0;break}if(!j)return K;const O=[];O.push(K[0]);for(let E=1,X=K.length-1;E<X;E++)K[E].distanceTo(K[E+1])>=i&&O.push(K[E]);return O.push(K[K.length-1]),O}}}function Up(n,e){if(Object.is(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;const t=Object.keys(n);if(t.length!==Object.keys(e).length)return!1;for(let s=0;s<t.length;s++)if(!Object.prototype.hasOwnProperty.call(e,t[s])||!Object.is(n[t[s]],e[t[s]]))return!1;return!0}const Lp=D.createContext([]);function Bp({box:n,multiple:e,children:t,onChange:s,border:i="1px solid #55aaff",backgroundColor:r="rgba(75, 160, 255, 0.1)",filter:o=c=>c,...a}){const{setEvents:c,camera:l,raycaster:u,gl:h,controls:d,size:f,get:m}=Pe(),[p,_]=D.useState(!1),[y,k]=D.useReducer((S,{object:T,shift:x})=>T===void 0?[]:Array.isArray(T)?T:x?S.includes(T)?S.filter(b=>b!==T):[T,...S]:S[0]===T?[]:[T],[]);D.useEffect(()=>void(s==null?void 0:s(y)),[y]);const w=D.useCallback(S=>{S.stopPropagation(),k({object:o([S.object])[0],shift:e&&S.shiftKey})},[]),v=D.useCallback(S=>!p&&k({}),[p]),g=D.useRef(null);return D.useEffect(()=>{if(!n||!e)return;const S=new Fp(l,g.current),T=document.createElement("div");T.style.pointerEvents="none",T.style.border=i,T.style.backgroundColor=r,T.style.position="fixed";const x=new ae,b=new ae,A=new ae,R=m().events.enabled,M=d==null?void 0:d.enabled;let L=!1;function q(N,F){const{offsetX:C,offsetY:P}=N,{width:G,height:I}=f;F.set(C/G*2-1,-(P/I)*2+1)}function Y(N){var F;d&&(d.enabled=!1),c({enabled:!1}),L=!0,(F=h.domElement.parentElement)==null||F.appendChild(T),T.style.left=`${N.clientX}px`,T.style.top=`${N.clientY}px`,T.style.width="0px",T.style.height="0px",x.x=N.clientX,x.y=N.clientY}function W(N){A.x=Math.max(x.x,N.clientX),A.y=Math.max(x.y,N.clientY),b.x=Math.min(x.x,N.clientX),b.y=Math.min(x.y,N.clientY),T.style.left=`${b.x}px`,T.style.top=`${b.y}px`,T.style.width=`${A.x-b.x}px`,T.style.height=`${A.y-b.y}px`}function V(){if(L){var N;d&&(d.enabled=M),c({enabled:R}),L=!1,(N=T.parentElement)==null||N.removeChild(T)}}function z(N){N.shiftKey&&(Y(N),q(N,S.startPoint))}let $=[];function Q(N){if(L){W(N),q(N,S.endPoint);const F=S.select().sort(C=>C.uuid).filter(C=>C.isMesh);Up(F,$)||($=F,k({object:o(F)}))}}function te(N){L&&V()}return document.addEventListener("pointerdown",z,{passive:!0}),document.addEventListener("pointermove",Q,{passive:!0,capture:!0}),document.addEventListener("pointerup",te,{passive:!0}),()=>{document.removeEventListener("pointerdown",z),document.removeEventListener("pointermove",Q),document.removeEventListener("pointerup",te)}},[f.width,f.height,u,l,d,h]),D.createElement("group",Ls({ref:g,onClick:w,onPointerOver:()=>_(!0),onPointerOut:()=>_(!1),onPointerMissed:v},a),D.createElement(Lp.Provider,{value:y},t))}const _l=n=>n===Object(n)&&!Array.isArray(n)&&typeof n!="function";function pn(n,e){const t=Pe(i=>i.gl),s=Lo(Bo,_l(n)?Object.values(n):n);if(D.useLayoutEffect(()=>{e==null||e(s)},[e]),D.useEffect(()=>{(Array.isArray(s)?s:[s]).forEach(t.initTexture)},[t,s]),_l(n)){const i=Object.keys(n),r={};return i.forEach(o=>Object.assign(r,{[o]:s[i.indexOf(o)]})),r}else return s}pn.preload=n=>Lo.preload(Bo,n);pn.clear=n=>Lo.clear(Bo,n);const zp=D.forwardRef(function({src:e,skipFill:t,skipStrokes:s,fillMaterial:i,strokeMaterial:r,fillMeshProps:o,strokeMeshProps:a,...c},l){const u=Lo(Bi,e.startsWith("<svg")?`data:image/svg+xml;utf8,${e}`:e),h=D.useMemo(()=>s?[]:u.paths.map(d=>{var f;return((f=d.userData)==null?void 0:f.style.stroke)===void 0||d.userData.style.stroke==="none"?null:d.subPaths.map(m=>Bi.pointsToStroke(m.getPoints(),d.userData.style))}),[u,s]);return D.useEffect(()=>()=>h.forEach(d=>d&&d.map(f=>f.dispose())),[h]),D.createElement("object3D",Ls({ref:l},c),D.createElement("object3D",{scale:[1,-1,1]},u.paths.map((d,f)=>{var m,p;return D.createElement(D.Fragment,{key:f},!t&&((m=d.userData)==null?void 0:m.style.fill)!==void 0&&d.userData.style.fill!=="none"&&Bi.createShapes(d).map((_,y)=>D.createElement("mesh",Ls({key:y},o),D.createElement("shapeGeometry",{args:[_]}),D.createElement("meshBasicMaterial",Ls({color:d.userData.style.fill,opacity:d.userData.style.fillOpacity,transparent:!0,side:hn,depthWrite:!1},i)))),!s&&((p=d.userData)==null?void 0:p.style.stroke)!==void 0&&d.userData.style.stroke!=="none"&&d.subPaths.map((_,y)=>D.createElement("mesh",Ls({key:y,geometry:h[f][y]},a),D.createElement("meshBasicMaterial",Ls({color:d.userData.style.stroke,opacity:d.userData.style.strokeOpacity,transparent:!0,side:hn,depthWrite:!1},r)))))})))});/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */const ce={LEFT:1,RIGHT:2,MIDDLE:4},H=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768}),Nn={NONE:0,IN:1,OUT:-1};function rn(n){return n.isPerspectiveCamera}function Fs(n){return n.isOrthographicCamera}const Fn=Math.PI*2,gl=Math.PI/2,Nu=1e-5,Oi=Math.PI/180;function jt(n,e,t){return Math.max(e,Math.min(t,n))}function Me(n,e=Nu){return Math.abs(n)<e}function xe(n,e,t=Nu){return Me(n-e,t)}function vl(n,e){return Math.round(n/e)*e}function Ai(n){return isFinite(n)?n:n<0?-Number.MAX_VALUE:Number.MAX_VALUE}function Mi(n){return Math.abs(n)<Number.MAX_VALUE?n:n*(1/0)}function zr(n,e,t,s,i=1/0,r){s=Math.max(1e-4,s);const o=2/s,a=o*r,c=1/(1+a+.48*a*a+.235*a*a*a);let l=n-e;const u=e,h=i*s;l=jt(l,-h,h),e=n-l;const d=(t.value+o*l)*r;t.value=(t.value-o*d)*c;let f=e+(l+d)*c;return u-n>0==f>u&&(f=u,t.value=(f-u)/r),f}function yl(n,e,t,s,i=1/0,r,o){s=Math.max(1e-4,s);const a=2/s,c=a*r,l=1/(1+c+.48*c*c+.235*c*c*c);let u=e.x,h=e.y,d=e.z,f=n.x-u,m=n.y-h,p=n.z-d;const _=u,y=h,k=d,w=i*s,v=w*w,g=f*f+m*m+p*p;if(g>v){const Y=Math.sqrt(g);f=f/Y*w,m=m/Y*w,p=p/Y*w}u=n.x-f,h=n.y-m,d=n.z-p;const S=(t.x+a*f)*r,T=(t.y+a*m)*r,x=(t.z+a*p)*r;t.x=(t.x-a*S)*l,t.y=(t.y-a*T)*l,t.z=(t.z-a*x)*l,o.x=u+(f+S)*l,o.y=h+(m+T)*l,o.z=d+(p+x)*l;const b=_-n.x,A=y-n.y,R=k-n.z,M=o.x-_,L=o.y-y,q=o.z-k;return b*M+A*L+R*q>0&&(o.x=_,o.y=y,o.z=k,t.x=(o.x-_)/r,t.y=(o.y-y)/r,t.z=(o.z-k)/r),o}function la(n,e){e.set(0,0),n.forEach(t=>{e.x+=t.clientX,e.y+=t.clientY}),e.x/=n.length,e.y/=n.length}function ua(n,e){return Fs(n)?(console.warn(`${e} is not supported in OrthographicCamera`),!0):!1}class Vp{constructor(){this._listeners={}}addEventListener(e,t){const s=this._listeners;s[e]===void 0&&(s[e]=[]),s[e].indexOf(t)===-1&&s[e].push(t)}hasEventListener(e,t){const s=this._listeners;return s[e]!==void 0&&s[e].indexOf(t)!==-1}removeEventListener(e,t){const i=this._listeners[e];if(i!==void 0){const r=i.indexOf(t);r!==-1&&i.splice(r,1)}}removeAllEventListeners(e){if(!e){this._listeners={};return}Array.isArray(this._listeners[e])&&(this._listeners[e].length=0)}dispatchEvent(e){const s=this._listeners[e.type];if(s!==void 0){e.target=this;const i=s.slice(0);for(let r=0,o=i.length;r<o;r++)i[r].call(this,e)}}}const jp="2.7.3",Vr=1/8,Fu=typeof window<"u",Hp=Fu&&/Mac/.test(navigator.platform),qp=!(Fu&&"PointerEvent"in window);let oe,xl,jr,ha,pt,fe,ve,Un,Pi,Jt,es,on,Tl,kl,Pt,Di,Ln,wl,da,Sl,fa,pa,Hr,ma=class Ra extends Vp{static install(e){oe=e.THREE,xl=Object.freeze(new oe.Vector3(0,0,0)),jr=Object.freeze(new oe.Vector3(0,1,0)),ha=Object.freeze(new oe.Vector3(0,0,1)),pt=new oe.Vector2,fe=new oe.Vector3,ve=new oe.Vector3,Un=new oe.Vector3,Pi=new oe.Vector3,Jt=new oe.Vector3,es=new oe.Vector3,on=new oe.Vector3,Tl=new oe.Vector3,kl=new oe.Vector3,Pt=new oe.Spherical,Di=new oe.Spherical,Ln=new oe.Box3,wl=new oe.Box3,da=new oe.Sphere,Sl=new oe.Quaternion,fa=new oe.Quaternion,pa=new oe.Matrix4,Hr=new oe.Raycaster}static get ACTION(){return H}constructor(e,t){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=H.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=Nn.NONE,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new oe.Vector3,this._focalOffsetVelocity=new oe.Vector3,this._zoomVelocity={value:0},this._truckInternal=(v,g,S)=>{let T,x;if(rn(this._camera)){const b=fe.copy(this._camera.position).sub(this._target),A=this._camera.getEffectiveFOV()*Oi,R=b.length()*Math.tan(A*.5);T=this.truckSpeed*v*R/this._elementRect.height,x=this.truckSpeed*g*R/this._elementRect.height}else if(Fs(this._camera)){const b=this._camera;T=v*(b.right-b.left)/b.zoom/this._elementRect.width,x=g*(b.top-b.bottom)/b.zoom/this._elementRect.height}else return;this.verticalDragToForward?(S?this.setFocalOffset(this._focalOffsetEnd.x+T,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(T,0,!0),this.forward(-x,!0)):S?this.setFocalOffset(this._focalOffsetEnd.x+T,this._focalOffsetEnd.y+x,this._focalOffsetEnd.z,!0):this.truck(T,x,!0)},this._rotateInternal=(v,g)=>{const S=Fn*this.azimuthRotateSpeed*v/this._elementRect.height,T=Fn*this.polarRotateSpeed*g/this._elementRect.height;this.rotate(S,T,!0)},this._dollyInternal=(v,g,S)=>{const T=Math.pow(.95,-v*this.dollySpeed),x=this._sphericalEnd.radius,b=this._sphericalEnd.radius*T,A=jt(b,this.minDistance,this.maxDistance),R=A-b;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(b,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(R,!0),this._dollyToNoClamp(A,!0)):this._dollyToNoClamp(A,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?b:A)-x,this._dollyControlCoord.set(g,S)),this._lastDollyDirection=Math.sign(-v)},this._zoomInternal=(v,g,S)=>{const T=Math.pow(.95,v*this.dollySpeed),x=this._zoom,b=this._zoom*T;this.zoomTo(b,!0),this.dollyToCursor&&(this._changedZoom+=b-x,this._dollyControlCoord.set(g,S))},typeof oe>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=new oe.Quaternion().setFromUnitVectors(this._camera.up,jr),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=H.NONE,this._target=new oe.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new oe.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new oe.Spherical().setFromVector3(fe.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new oe.Vector3,new oe.Vector3,new oe.Vector3,new oe.Vector3],this._updateNearPlaneCorners(),this._boundary=new oe.Box3(new oe.Vector3(-1/0,-1/0,-1/0),new oe.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new oe.Vector2,this.mouseButtons={left:H.ROTATE,middle:H.DOLLY,right:H.TRUCK,wheel:rn(this._camera)?H.DOLLY:Fs(this._camera)?H.ZOOM:H.NONE},this.touches={one:H.TOUCH_ROTATE,two:rn(this._camera)?H.TOUCH_DOLLY_TRUCK:Fs(this._camera)?H.TOUCH_ZOOM_TRUCK:H.NONE,three:H.TOUCH_TRUCK};const s=new oe.Vector2,i=new oe.Vector2,r=new oe.Vector2,o=v=>{if(!this._enabled||!this._domElement)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const T=this._domElement.getBoundingClientRect(),x=v.clientX/T.width,b=v.clientY/T.height;if(x<this._interactiveArea.left||x>this._interactiveArea.right||b<this._interactiveArea.top||b>this._interactiveArea.bottom)return}const g=v.pointerType!=="mouse"?null:(v.buttons&ce.LEFT)===ce.LEFT?ce.LEFT:(v.buttons&ce.MIDDLE)===ce.MIDDLE?ce.MIDDLE:(v.buttons&ce.RIGHT)===ce.RIGHT?ce.RIGHT:null;if(g!==null){const T=this._findPointerByMouseButton(g);T&&this._disposePointer(T)}if((v.buttons&ce.LEFT)===ce.LEFT&&this._lockedPointer)return;const S={pointerId:v.pointerId,clientX:v.clientX,clientY:v.clientY,deltaX:0,deltaY:0,mouseButton:g};this._activePointers.push(S),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",u),this._domElement.ownerDocument.addEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",u),this._isDragging=!0,p(v)},a=v=>{if(!this._enabled||!this._domElement||this._lockedPointer)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const T=this._domElement.getBoundingClientRect(),x=v.clientX/T.width,b=v.clientY/T.height;if(x<this._interactiveArea.left||x>this._interactiveArea.right||b<this._interactiveArea.top||b>this._interactiveArea.bottom)return}const g=(v.buttons&ce.LEFT)===ce.LEFT?ce.LEFT:(v.buttons&ce.MIDDLE)===ce.MIDDLE?ce.MIDDLE:(v.buttons&ce.RIGHT)===ce.RIGHT?ce.RIGHT:null;if(g!==null){const T=this._findPointerByMouseButton(g);T&&this._disposePointer(T)}const S={pointerId:1,clientX:v.clientX,clientY:v.clientY,deltaX:0,deltaY:0,mouseButton:(v.buttons&ce.LEFT)===ce.LEFT?ce.LEFT:(v.buttons&ce.MIDDLE)===ce.LEFT?ce.MIDDLE:(v.buttons&ce.RIGHT)===ce.LEFT?ce.RIGHT:null};this._activePointers.push(S),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("mouseup",h),this._domElement.ownerDocument.addEventListener("mousemove",l),this._domElement.ownerDocument.addEventListener("mouseup",h),this._isDragging=!0,p(v)},c=v=>{v.cancelable&&v.preventDefault();const g=v.pointerId,S=this._lockedPointer||this._findPointerById(g);if(S){if(S.clientX=v.clientX,S.clientY=v.clientY,S.deltaX=v.movementX,S.deltaY=v.movementY,this._state=0,v.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(v.buttons&ce.LEFT)===ce.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(v.buttons&ce.MIDDLE)===ce.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(v.buttons&ce.RIGHT)===ce.RIGHT&&(this._state=this._state|this.mouseButtons.right);_()}},l=v=>{const g=this._lockedPointer||this._findPointerById(1);g&&(g.clientX=v.clientX,g.clientY=v.clientY,g.deltaX=v.movementX,g.deltaY=v.movementY,this._state=0,(this._lockedPointer||(v.buttons&ce.LEFT)===ce.LEFT)&&(this._state=this._state|this.mouseButtons.left),(v.buttons&ce.MIDDLE)===ce.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(v.buttons&ce.RIGHT)===ce.RIGHT&&(this._state=this._state|this.mouseButtons.right),_())},u=v=>{const g=this._findPointerById(v.pointerId);if(!(g&&g===this._lockedPointer)){if(g&&this._disposePointer(g),v.pointerType==="touch")switch(this._activePointers.length){case 0:this._state=H.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=H.NONE;y()}},h=()=>{const v=this._findPointerById(1);v&&v===this._lockedPointer||(v&&this._disposePointer(v),this._state=H.NONE,y())};let d=-1;const f=v=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===H.NONE)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const b=this._domElement.getBoundingClientRect(),A=v.clientX/b.width,R=v.clientY/b.height;if(A<this._interactiveArea.left||A>this._interactiveArea.right||R<this._interactiveArea.top||R>this._interactiveArea.bottom)return}if(v.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===H.ROTATE||this.mouseButtons.wheel===H.TRUCK){const b=performance.now();d-b<1e3&&this._getClientRect(this._elementRect),d=b}const g=Hp?-1:-3,S=v.deltaMode===1?v.deltaY/g:v.deltaY/(g*10),T=this.dollyToCursor?(v.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,x=this.dollyToCursor?(v.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case H.ROTATE:{this._rotateInternal(v.deltaX,v.deltaY),this._isUserControllingRotate=!0;break}case H.TRUCK:{this._truckInternal(v.deltaX,v.deltaY,!1),this._isUserControllingTruck=!0;break}case H.OFFSET:{this._truckInternal(v.deltaX,v.deltaY,!0),this._isUserControllingOffset=!0;break}case H.DOLLY:{this._dollyInternal(-S,T,x),this._isUserControllingDolly=!0;break}case H.ZOOM:{this._zoomInternal(-S,T,x),this._isUserControllingZoom=!0;break}}this.dispatchEvent({type:"control"})},m=v=>{if(!(!this._domElement||!this._enabled)){if(this.mouseButtons.right===Ra.ACTION.NONE){const g=v instanceof PointerEvent?v.pointerId:(v instanceof MouseEvent,0),S=this._findPointerById(g);S&&this._disposePointer(S),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",u),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("mouseup",h);return}v.preventDefault()}},p=v=>{if(!this._enabled)return;if(la(this._activePointers,pt),this._getClientRect(this._elementRect),s.copy(pt),i.copy(pt),this._activePointers.length>=2){const S=pt.x-this._activePointers[1].clientX,T=pt.y-this._activePointers[1].clientY,x=Math.sqrt(S*S+T*T);r.set(0,x);const b=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,A=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;i.set(b,A)}if(this._state=0,!v)this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);else if("pointerType"in v&&v.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else!this._lockedPointer&&(v.buttons&ce.LEFT)===ce.LEFT&&(this._state=this._state|this.mouseButtons.left),(v.buttons&ce.MIDDLE)===ce.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(v.buttons&ce.RIGHT)===ce.RIGHT&&(this._state=this._state|this.mouseButtons.right);((this._state&H.ROTATE)===H.ROTATE||(this._state&H.TOUCH_ROTATE)===H.TOUCH_ROTATE||(this._state&H.TOUCH_DOLLY_ROTATE)===H.TOUCH_DOLLY_ROTATE||(this._state&H.TOUCH_ZOOM_ROTATE)===H.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&H.TRUCK)===H.TRUCK||(this._state&H.TOUCH_TRUCK)===H.TOUCH_TRUCK||(this._state&H.TOUCH_DOLLY_TRUCK)===H.TOUCH_DOLLY_TRUCK||(this._state&H.TOUCH_ZOOM_TRUCK)===H.TOUCH_ZOOM_TRUCK)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&H.DOLLY)===H.DOLLY||(this._state&H.TOUCH_DOLLY)===H.TOUCH_DOLLY||(this._state&H.TOUCH_DOLLY_TRUCK)===H.TOUCH_DOLLY_TRUCK||(this._state&H.TOUCH_DOLLY_OFFSET)===H.TOUCH_DOLLY_OFFSET||(this._state&H.TOUCH_DOLLY_ROTATE)===H.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&H.ZOOM)===H.ZOOM||(this._state&H.TOUCH_ZOOM)===H.TOUCH_ZOOM||(this._state&H.TOUCH_ZOOM_TRUCK)===H.TOUCH_ZOOM_TRUCK||(this._state&H.TOUCH_ZOOM_OFFSET)===H.TOUCH_ZOOM_OFFSET||(this._state&H.TOUCH_ZOOM_ROTATE)===H.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&H.OFFSET)===H.OFFSET||(this._state&H.TOUCH_OFFSET)===H.TOUCH_OFFSET||(this._state&H.TOUCH_DOLLY_OFFSET)===H.TOUCH_DOLLY_OFFSET||(this._state&H.TOUCH_ZOOM_OFFSET)===H.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})},_=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,la(this._activePointers,pt);const g=this._domElement&&document.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,S=g?-g.deltaX:i.x-pt.x,T=g?-g.deltaY:i.y-pt.y;if(i.copy(pt),((this._state&H.ROTATE)===H.ROTATE||(this._state&H.TOUCH_ROTATE)===H.TOUCH_ROTATE||(this._state&H.TOUCH_DOLLY_ROTATE)===H.TOUCH_DOLLY_ROTATE||(this._state&H.TOUCH_ZOOM_ROTATE)===H.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(S,T),this._isUserControllingRotate=!0),(this._state&H.DOLLY)===H.DOLLY||(this._state&H.ZOOM)===H.ZOOM){const x=this.dollyToCursor?(s.x-this._elementRect.x)/this._elementRect.width*2-1:0,b=this.dollyToCursor?(s.y-this._elementRect.y)/this._elementRect.height*-2+1:0,A=this.dollyDragInverted?-1:1;(this._state&H.DOLLY)===H.DOLLY?(this._dollyInternal(A*T*Vr,x,b),this._isUserControllingDolly=!0):(this._zoomInternal(A*T*Vr,x,b),this._isUserControllingZoom=!0)}if((this._state&H.TOUCH_DOLLY)===H.TOUCH_DOLLY||(this._state&H.TOUCH_ZOOM)===H.TOUCH_ZOOM||(this._state&H.TOUCH_DOLLY_TRUCK)===H.TOUCH_DOLLY_TRUCK||(this._state&H.TOUCH_ZOOM_TRUCK)===H.TOUCH_ZOOM_TRUCK||(this._state&H.TOUCH_DOLLY_OFFSET)===H.TOUCH_DOLLY_OFFSET||(this._state&H.TOUCH_ZOOM_OFFSET)===H.TOUCH_ZOOM_OFFSET||(this._state&H.TOUCH_DOLLY_ROTATE)===H.TOUCH_DOLLY_ROTATE||(this._state&H.TOUCH_ZOOM_ROTATE)===H.TOUCH_ZOOM_ROTATE){const x=pt.x-this._activePointers[1].clientX,b=pt.y-this._activePointers[1].clientY,A=Math.sqrt(x*x+b*b),R=r.y-A;r.set(0,A);const M=this.dollyToCursor?(i.x-this._elementRect.x)/this._elementRect.width*2-1:0,L=this.dollyToCursor?(i.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&H.TOUCH_DOLLY)===H.TOUCH_DOLLY||(this._state&H.TOUCH_DOLLY_ROTATE)===H.TOUCH_DOLLY_ROTATE||(this._state&H.TOUCH_DOLLY_TRUCK)===H.TOUCH_DOLLY_TRUCK||(this._state&H.TOUCH_DOLLY_OFFSET)===H.TOUCH_DOLLY_OFFSET?(this._dollyInternal(R*Vr,M,L),this._isUserControllingDolly=!0):(this._zoomInternal(R*Vr,M,L),this._isUserControllingZoom=!0)}((this._state&H.TRUCK)===H.TRUCK||(this._state&H.TOUCH_TRUCK)===H.TOUCH_TRUCK||(this._state&H.TOUCH_DOLLY_TRUCK)===H.TOUCH_DOLLY_TRUCK||(this._state&H.TOUCH_ZOOM_TRUCK)===H.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(S,T,!1),this._isUserControllingTruck=!0),((this._state&H.OFFSET)===H.OFFSET||(this._state&H.TOUCH_OFFSET)===H.TOUCH_OFFSET||(this._state&H.TOUCH_DOLLY_OFFSET)===H.TOUCH_DOLLY_OFFSET||(this._state&H.TOUCH_ZOOM_OFFSET)===H.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(S,T,!0),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},y=()=>{la(this._activePointers,pt),i.copy(pt),this._dragNeedsUpdate=!1,(this._activePointers.length===0||this._activePointers.length===1&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),this._activePointers.length===0&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("pointerup",u),this._domElement.ownerDocument.removeEventListener("mouseup",h),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{!this._enabled||!this._domElement||(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",u),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",k),this._domElement.ownerDocument.addEventListener("pointerlockerror",w),this._domElement.ownerDocument.addEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",u),p())},this.unlockPointer=()=>{this._lockedPointer!==null&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),document.exitPointerLock(),this.cancel(),this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointerlockchange",k),this._domElement.ownerDocument.removeEventListener("pointerlockerror",w))};const k=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},w=()=>{this.unlockPointer()};this._addAllEventListeners=v=>{this._domElement=v,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",o),qp&&this._domElement.addEventListener("mousedown",a),this._domElement.addEventListener("pointercancel",u),this._domElement.addEventListener("wheel",f,{passive:!1}),this._domElement.addEventListener("contextmenu",m)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",o),this._domElement.removeEventListener("mousedown",a),this._domElement.removeEventListener("pointercancel",u),this._domElement.removeEventListener("wheel",f,{passive:!1}),this._domElement.removeEventListener("contextmenu",m),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("pointerup",u),this._domElement.ownerDocument.removeEventListener("mouseup",h),this._domElement.ownerDocument.removeEventListener("pointerlockchange",k),this._domElement.ownerDocument.removeEventListener("pointerlockerror",w))},this.cancel=()=>{this._state!==H.NONE&&(this._state=H.NONE,this._activePointers.length=0,y())},t&&this.connect(t),this.update(0)}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){this._spherical.radius===e&&this._sphericalEnd.radius===e||(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){this._spherical.theta===e&&this._sphericalEnd.theta===e||(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){this._spherical.phi===e&&this._sphericalEnd.phi===e||(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=jt(e.width,0,1),this._interactiveArea.height=jt(e.height,0,1),this._interactiveArea.x=jt(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=jt(e.y,0,1-this._interactiveArea.height)}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t,s=!1){return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,s)}rotateAzimuthTo(e,t=!1){return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e,t=!1){return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t,s=!1){this._isUserControllingRotate=!1;const i=jt(e,this.minAzimuthAngle,this.maxAzimuthAngle),r=jt(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=i,this._sphericalEnd.phi=r,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,s||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const o=!s||xe(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&xe(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(o)}dolly(e,t=!1){return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e,t=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=Nn.NONE,this._changedDolly=0,this._dollyToNoClamp(jt(e,this.minDistance,this.maxDistance),t)}_dollyToNoClamp(e,t=!1){const s=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const o=this._collisionTest(),a=xe(o,this._spherical.radius);if(!(s>e)&&a)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,o)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);const r=!t||xe(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(r)}dollyInFixed(e,t=!1){this._targetEnd.add(this._getCameraDirection(Pi).multiplyScalar(e)),t||this._target.copy(this._targetEnd);const s=!t||xe(this._target.x,this._targetEnd.x,this.restThreshold)&&xe(this._target.y,this._targetEnd.y,this.restThreshold)&&xe(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(s)}zoom(e,t=!1){return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e,t=!1){this._isUserControllingZoom=!1,this._zoomEnd=jt(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);const s=!t||xe(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(s)}pan(e,t,s=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,s)}truck(e,t,s=!1){this._camera.updateMatrix(),Jt.setFromMatrixColumn(this._camera.matrix,0),es.setFromMatrixColumn(this._camera.matrix,1),Jt.multiplyScalar(e),es.multiplyScalar(-t);const i=fe.copy(Jt).add(es),r=ve.copy(this._targetEnd).add(i);return this.moveTo(r.x,r.y,r.z,s)}forward(e,t=!1){fe.setFromMatrixColumn(this._camera.matrix,0),fe.crossVectors(this._camera.up,fe),fe.multiplyScalar(e);const s=ve.copy(this._targetEnd).add(fe);return this.moveTo(s.x,s.y,s.z,t)}elevate(e,t=!1){return fe.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+fe.x,this._targetEnd.y+fe.y,this._targetEnd.z+fe.z,t)}moveTo(e,t,s,i=!1){this._isUserControllingTruck=!1;const r=fe.set(e,t,s).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,r,this.boundaryFriction),this._needsUpdate=!0,i||this._target.copy(this._targetEnd);const o=!i||xe(this._target.x,this._targetEnd.x,this.restThreshold)&&xe(this._target.y,this._targetEnd.y,this.restThreshold)&&xe(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(o)}lookInDirectionOf(e,t,s,i=!1){const a=fe.set(e,t,s).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius);return this.setPosition(a.x,a.y,a.z,i)}fitToBox(e,t,{cover:s=!1,paddingLeft:i=0,paddingRight:r=0,paddingBottom:o=0,paddingTop:a=0}={}){const c=[],l=e.isBox3?Ln.copy(e):Ln.setFromObject(e);l.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const u=vl(this._sphericalEnd.theta,gl),h=vl(this._sphericalEnd.phi,gl);c.push(this.rotateTo(u,h,t));const d=fe.setFromSpherical(this._sphericalEnd).normalize(),f=Sl.setFromUnitVectors(d,ha),m=xe(Math.abs(d.y),1);m&&f.multiply(fa.setFromAxisAngle(jr,u)),f.multiply(this._yAxisUpSpaceInverse);const p=wl.makeEmpty();ve.copy(l.min).applyQuaternion(f),p.expandByPoint(ve),ve.copy(l.min).setX(l.max.x).applyQuaternion(f),p.expandByPoint(ve),ve.copy(l.min).setY(l.max.y).applyQuaternion(f),p.expandByPoint(ve),ve.copy(l.max).setZ(l.min.z).applyQuaternion(f),p.expandByPoint(ve),ve.copy(l.min).setZ(l.max.z).applyQuaternion(f),p.expandByPoint(ve),ve.copy(l.max).setY(l.min.y).applyQuaternion(f),p.expandByPoint(ve),ve.copy(l.max).setX(l.min.x).applyQuaternion(f),p.expandByPoint(ve),ve.copy(l.max).applyQuaternion(f),p.expandByPoint(ve),p.min.x-=i,p.min.y-=o,p.max.x+=r,p.max.y+=a,f.setFromUnitVectors(ha,d),m&&f.premultiply(fa.invert()),f.premultiply(this._yAxisUpSpace);const _=p.getSize(fe),y=p.getCenter(ve).applyQuaternion(f);if(rn(this._camera)){const k=this.getDistanceToFitBox(_.x,_.y,_.z,s);c.push(this.moveTo(y.x,y.y,y.z,t)),c.push(this.dollyTo(k,t)),c.push(this.setFocalOffset(0,0,0,t))}else if(Fs(this._camera)){const k=this._camera,w=k.right-k.left,v=k.top-k.bottom,g=s?Math.max(w/_.x,v/_.y):Math.min(w/_.x,v/_.y);c.push(this.moveTo(y.x,y.y,y.z,t)),c.push(this.zoomTo(g,t)),c.push(this.setFocalOffset(0,0,0,t))}return Promise.all(c)}fitToSphere(e,t){const s=[],r=e instanceof oe.Sphere?da.copy(e):Ra.createBoundingSphere(e,da);if(s.push(this.moveTo(r.center.x,r.center.y,r.center.z,t)),rn(this._camera)){const o=this.getDistanceToFitSphere(r.radius);s.push(this.dollyTo(o,t))}else if(Fs(this._camera)){const o=this._camera.right-this._camera.left,a=this._camera.top-this._camera.bottom,c=2*r.radius,l=Math.min(o/c,a/c);s.push(this.zoomTo(l,t))}return s.push(this.setFocalOffset(0,0,0,t)),Promise.all(s)}setLookAt(e,t,s,i,r,o,a=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=Nn.NONE,this._changedDolly=0;const c=ve.set(i,r,o),l=fe.set(e,t,s);this._targetEnd.copy(c),this._sphericalEnd.setFromVector3(l.sub(c).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,a||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const u=!a||xe(this._target.x,this._targetEnd.x,this.restThreshold)&&xe(this._target.y,this._targetEnd.y,this.restThreshold)&&xe(this._target.z,this._targetEnd.z,this.restThreshold)&&xe(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&xe(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&xe(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(u)}lerpLookAt(e,t,s,i,r,o,a,c,l,u,h,d,f,m=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=Nn.NONE,this._changedDolly=0;const p=fe.set(i,r,o),_=ve.set(e,t,s);Pt.setFromVector3(_.sub(p).applyQuaternion(this._yAxisUpSpace));const y=Un.set(u,h,d),k=ve.set(a,c,l);Di.setFromVector3(k.sub(y).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(p.lerp(y,f));const w=Di.theta-Pt.theta,v=Di.phi-Pt.phi,g=Di.radius-Pt.radius;this._sphericalEnd.set(Pt.radius+g*f,Pt.phi+v*f,Pt.theta+w*f),this.normalizeRotations(),this._needsUpdate=!0,m||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const S=!m||xe(this._target.x,this._targetEnd.x,this.restThreshold)&&xe(this._target.y,this._targetEnd.y,this.restThreshold)&&xe(this._target.z,this._targetEnd.z,this.restThreshold)&&xe(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&xe(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&xe(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(S)}setPosition(e,t,s,i=!1){return this.setLookAt(e,t,s,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,i)}setTarget(e,t,s,i=!1){const r=this.getPosition(fe),o=this.setLookAt(r.x,r.y,r.z,e,t,s,i);return this._sphericalEnd.phi=jt(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),o}setFocalOffset(e,t,s,i=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,t,s),this._needsUpdate=!0,i||this._focalOffset.copy(this._focalOffsetEnd);const r=!i||xe(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&xe(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&xe(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(r)}setOrbitPoint(e,t,s){this._camera.updateMatrixWorld(),Jt.setFromMatrixColumn(this._camera.matrixWorldInverse,0),es.setFromMatrixColumn(this._camera.matrixWorldInverse,1),on.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const i=fe.set(e,t,s),r=i.distanceTo(this._camera.position),o=i.sub(this._camera.position);Jt.multiplyScalar(o.x),es.multiplyScalar(o.y),on.multiplyScalar(o.z),fe.copy(Jt).add(es).add(on),fe.z=fe.z+r,this.dollyTo(r,!1),this.setFocalOffset(-fe.x,fe.y,-fe.z,!1),this.moveTo(e,t,s,!1)}setBoundary(e){if(!e){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,s,i){if(e===null){this._viewport=null;return}this._viewport=this._viewport||new oe.Vector4,typeof e=="number"?this._viewport.set(e,t,s,i):this._viewport.copy(e)}getDistanceToFitBox(e,t,s,i=!1){if(ua(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const r=e/t,o=this._camera.getEffectiveFOV()*Oi,a=this._camera.aspect;return((i?r>a:r<a)?t:e/a)*.5/Math.tan(o*.5)+s*.5}getDistanceToFitSphere(e){if(ua(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const t=this._camera.getEffectiveFOV()*Oi,s=Math.atan(Math.tan(t*.5)*this._camera.aspect)*2,i=1<this._camera.aspect?t:s;return e/Math.sin(i*.5)}getTarget(e,t=!0){return(e&&e.isVector3?e:new oe.Vector3).copy(t?this._targetEnd:this._target)}getPosition(e,t=!0){return(e&&e.isVector3?e:new oe.Vector3).setFromSpherical(t?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(t?this._targetEnd:this._target)}getSpherical(e,t=!0){return(e&&e instanceof oe.Spherical?e:new oe.Spherical).copy(t?this._sphericalEnd:this._spherical)}getFocalOffset(e,t=!0){return(e&&e.isVector3?e:new oe.Vector3).copy(t?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%Fn,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=Fn),this._spherical.theta+=Fn*Math.round((this._sphericalEnd.theta-this._spherical.theta)/Fn)}reset(e=!1){if(!xe(this._camera.up.x,this._cameraUp0.x)||!xe(this._camera.up.y,this._cameraUp0.y)||!xe(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const s=this.getPosition(fe);this.updateCameraUp(),this.setPosition(s.x,s.y,s.z)}const t=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)];return Promise.all(t)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,jr),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const e=fe.subVectors(this._target,this._camera.position).normalize(),t=ve.crossVectors(e,this._camera.up);this._camera.up.crossVectors(t,e).normalize(),this._camera.updateMatrixWorld();const s=this.getPosition(fe);this.updateCameraUp(),this.setPosition(s.x,s.y,s.z)}update(e){const t=this._sphericalEnd.theta-this._spherical.theta,s=this._sphericalEnd.phi-this._spherical.phi,i=this._sphericalEnd.radius-this._spherical.radius,r=Tl.subVectors(this._targetEnd,this._target),o=kl.subVectors(this._focalOffsetEnd,this._focalOffset),a=this._zoomEnd-this._zoom;if(Me(t))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const h=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=zr(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,h,1/0,e),this._needsUpdate=!0}if(Me(s))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const h=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=zr(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,h,1/0,e),this._needsUpdate=!0}if(Me(i))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const h=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=zr(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,h,this.maxSpeed,e),this._needsUpdate=!0}if(Me(r.x)&&Me(r.y)&&Me(r.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const h=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;yl(this._target,this._targetEnd,this._targetVelocity,h,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(Me(o.x)&&Me(o.y)&&Me(o.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const h=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;yl(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,h,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(Me(a))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const h=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=zr(this._zoom,this._zoomEnd,this._zoomVelocity,h,1/0,e)}if(this.dollyToCursor){if(rn(this._camera)&&this._changedDolly!==0){const h=this._spherical.radius-this._lastDistance,d=this._camera,f=this._getCameraDirection(Pi),m=fe.copy(f).cross(d.up).normalize();m.lengthSq()===0&&(m.x=1);const p=ve.crossVectors(m,f),_=this._sphericalEnd.radius*Math.tan(d.getEffectiveFOV()*Oi*.5),k=(this._sphericalEnd.radius-h-this._sphericalEnd.radius)/this._sphericalEnd.radius,w=Un.copy(this._targetEnd).add(m.multiplyScalar(this._dollyControlCoord.x*_*d.aspect)).add(p.multiplyScalar(this._dollyControlCoord.y*_)),v=fe.copy(this._targetEnd).lerp(w,k),g=this._lastDollyDirection===Nn.IN&&this._spherical.radius<=this.minDistance,S=this._lastDollyDirection===Nn.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(g||S)){this._sphericalEnd.radius-=h,this._spherical.radius-=h;const x=ve.copy(f).multiplyScalar(-h);v.add(x)}this._boundary.clampPoint(v,v);const T=ve.subVectors(v,this._targetEnd);this._targetEnd.copy(v),this._target.add(T),this._changedDolly-=h,Me(this._changedDolly)&&(this._changedDolly=0)}else if(Fs(this._camera)&&this._changedZoom!==0){const h=this._zoom-this._lastZoom,d=this._camera,f=fe.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(d.near+d.far)/(d.near-d.far)).unproject(d),m=ve.set(0,0,-1).applyQuaternion(d.quaternion),p=Un.copy(f).add(m.multiplyScalar(-f.dot(d.up))),y=-(this._zoom-h-this._zoom)/this._zoom,k=this._getCameraDirection(Pi),w=this._targetEnd.dot(k),v=fe.copy(this._targetEnd).lerp(p,y),g=v.dot(k),S=k.multiplyScalar(g-w);v.sub(S),this._boundary.clampPoint(v,v);const T=ve.subVectors(v,this._targetEnd);this._targetEnd.copy(v),this._target.add(T),this._changedZoom-=h,Me(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const c=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,c),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!Me(this._focalOffset.x)||!Me(this._focalOffset.y)||!Me(this._focalOffset.z))&&(this._camera.updateMatrixWorld(),Jt.setFromMatrixColumn(this._camera.matrix,0),es.setFromMatrixColumn(this._camera.matrix,1),on.setFromMatrixColumn(this._camera.matrix,2),Jt.multiplyScalar(this._focalOffset.x),es.multiplyScalar(-this._focalOffset.y),on.multiplyScalar(this._focalOffset.z),fe.copy(Jt).add(es).add(on),this._camera.position.add(fe)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),fe.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const u=this._needsUpdate;return u&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):u?(this.dispatchEvent({type:"update"}),Me(t,this.restThreshold)&&Me(s,this.restThreshold)&&Me(i,this.restThreshold)&&Me(r.x,this.restThreshold)&&Me(r.y,this.restThreshold)&&Me(r.z,this.restThreshold)&&Me(o.x,this.restThreshold)&&Me(o.y,this.restThreshold)&&Me(o.z,this.restThreshold)&&Me(a,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!u&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=u,this._needsUpdate=!1,u}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:Ai(this.maxDistance),minZoom:this.minZoom,maxZoom:Ai(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:Ai(this.maxPolarAngle),minAzimuthAngle:Ai(this.minAzimuthAngle),maxAzimuthAngle:Ai(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:fe.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e,t=!1){const s=JSON.parse(e);this.enabled=s.enabled,this.minDistance=s.minDistance,this.maxDistance=Mi(s.maxDistance),this.minZoom=s.minZoom,this.maxZoom=Mi(s.maxZoom),this.minPolarAngle=s.minPolarAngle,this.maxPolarAngle=Mi(s.maxPolarAngle),this.minAzimuthAngle=Mi(s.minAzimuthAngle),this.maxAzimuthAngle=Mi(s.maxAzimuthAngle),this.smoothTime=s.smoothTime,this.draggingSmoothTime=s.draggingSmoothTime,this.dollySpeed=s.dollySpeed,this.truckSpeed=s.truckSpeed,this.dollyToCursor=s.dollyToCursor,this.verticalDragToForward=s.verticalDragToForward,this._target0.fromArray(s.target0),this._position0.fromArray(s.position0),this._zoom0=s.zoom0,this._focalOffset0.fromArray(s.focalOffset0),this.moveTo(s.target[0],s.target[1],s.target[2],t),Pt.setFromVector3(fe.fromArray(s.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(Pt.theta,Pt.phi,t),this.dollyTo(Pt.radius,t),this.zoomTo(s.zoom,t),this.setFocalOffset(s.focalOffset[0],s.focalOffset[1],s.focalOffset[2],t),this._needsUpdate=!0}connect(e){if(this._domElement){console.warn("camera-controls is already connected.");return}e.setAttribute("data-camera-controls-version",jp),this._addAllEventListeners(e),this._getClientRect(this._elementRect)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find(t=>t.pointerId===e)}_findPointerByMouseButton(e){return this._activePointers.find(t=>t.mouseButton===e)}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,t,s){const i=t.lengthSq();if(i===0)return e;const r=ve.copy(t).add(e),a=this._boundary.clampPoint(r,Un).sub(r),c=a.lengthSq();if(c===0)return e.add(t);if(c===i)return e;if(s===0)return e.add(t).add(a);{const l=1+s*c/t.dot(a);return e.add(ve.copy(t).multiplyScalar(l)).add(a.multiplyScalar(1-s))}}_updateNearPlaneCorners(){if(rn(this._camera)){const e=this._camera,t=e.near,s=e.getEffectiveFOV()*Oi,i=Math.tan(s*.5)*t,r=i*e.aspect;this._nearPlaneCorners[0].set(-r,-i,0),this._nearPlaneCorners[1].set(r,-i,0),this._nearPlaneCorners[2].set(r,i,0),this._nearPlaneCorners[3].set(-r,i,0)}else if(Fs(this._camera)){const e=this._camera,t=1/e.zoom,s=e.left*t,i=e.right*t,r=e.top*t,o=e.bottom*t;this._nearPlaneCorners[0].set(s,r,0),this._nearPlaneCorners[1].set(i,r,0),this._nearPlaneCorners[2].set(i,o,0),this._nearPlaneCorners[3].set(s,o,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||ua(this._camera,"_collisionTest"))return e;const s=this._getTargetDirection(Pi);pa.lookAt(xl,s,this._camera.up);for(let i=0;i<4;i++){const r=ve.copy(this._nearPlaneCorners[i]);r.applyMatrix4(pa);const o=Un.addVectors(this._target,r);Hr.set(o,s),Hr.far=this._spherical.radius+1;const a=Hr.intersectObjects(this.colliderMeshes);a.length!==0&&a[0].distance<e&&(e=a[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;const t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(t=>{const s=()=>{this.removeEventListener("rest",s),t()};this.addEventListener("rest",s)}))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e,t=new oe.Sphere){const s=t,i=s.center;Ln.makeEmpty(),e.traverseVisible(o=>{o.isMesh&&Ln.expandByObject(o)}),Ln.getCenter(i);let r=0;return e.traverseVisible(o=>{if(!o.isMesh)return;const a=o,c=a.geometry.clone();c.applyMatrix4(a.matrixWorld);const u=c.attributes.position;for(let h=0,d=u.count;h<d;h++)fe.fromBufferAttribute(u,h),r=Math.max(r,i.distanceToSquared(fe))}),s.radius=Math.sqrt(r),s}};const Gp=D.forwardRef((n,e)=>{D.useMemo(()=>{ma.install({THREE:Xf}),oc({CameraControlsImpl:ma})},[]);const{camera:t,domElement:s,makeDefault:i,onStart:r,onEnd:o,onChange:a,regress:c,...l}=n,u=Pe(g=>g.camera),h=Pe(g=>g.gl),d=Pe(g=>g.invalidate),f=Pe(g=>g.events),m=Pe(g=>g.setEvents),p=Pe(g=>g.set),_=Pe(g=>g.get),y=Pe(g=>g.performance),k=t||u,w=s||f.connected||h.domElement,v=D.useMemo(()=>new ma(k),[k]);return Bt((g,S)=>{v.enabled&&v.update(S)},-1),D.useEffect(()=>(v.connect(w),()=>void v.disconnect()),[w,v]),D.useEffect(()=>{const g=x=>{d(),c&&y.regress(),a&&a(x)},S=x=>{r&&r(x)},T=x=>{o&&o(x)};return v.addEventListener("update",g),v.addEventListener("controlstart",S),v.addEventListener("controlend",T),()=>{v.removeEventListener("update",g),v.removeEventListener("controlstart",S),v.removeEventListener("controlend",T)}},[v,r,o,d,m,c,a]),D.useEffect(()=>{if(i){const g=_().controls;return p({controls:v}),()=>p({controls:g})}},[i,v]),D.createElement("primitive",Ls({ref:e,object:v},l))}),Uu=D.createContext(null),Wp=D.forwardRef((n,e)=>{D.useMemo(()=>oc({SegmentObject:Yp}),[]);const{limit:t=1e3,lineWidth:s=1,children:i,...r}=n,[o,a]=D.useState([]),[c]=D.useState(()=>new Af),[l]=D.useState(()=>new Mf),[u]=D.useState(()=>new Pf),[h]=D.useState(()=>new ae(512,512)),[d]=D.useState(()=>Array(t*6).fill(0)),[f]=D.useState(()=>Array(t*6).fill(0)),m=D.useMemo(()=>({subscribe:p=>(a(_=>[..._,p]),()=>a(_=>_.filter(y=>y.current!==p.current)))}),[]);return Bt(()=>{for(let _=0;_<t;_++){var p;const y=(p=o[_])==null?void 0:p.current;y&&(d[_*6+0]=y.start.x,d[_*6+1]=y.start.y,d[_*6+2]=y.start.z,d[_*6+3]=y.end.x,d[_*6+4]=y.end.y,d[_*6+5]=y.end.z,f[_*6+0]=y.color.r,f[_*6+1]=y.color.g,f[_*6+2]=y.color.b,f[_*6+3]=y.color.r,f[_*6+4]=y.color.g,f[_*6+5]=y.color.b)}u.setColors(f),u.setPositions(d),c.computeLineDistances()}),D.createElement("primitive",{object:c,ref:e},D.createElement("primitive",{object:u,attach:"geometry"}),D.createElement("primitive",Ls({object:l,attach:"material",vertexColors:!0,resolution:h,linewidth:s},r)),D.createElement(Uu.Provider,{value:m},i))});class Yp{constructor(){this.color=new ys("white"),this.start=new le(0,0,0),this.end=new le(0,0,0)}}const bl=n=>n instanceof le?n:new le(...typeof n=="number"?[n,n,n]:n),Zp=D.forwardRef(({color:n,start:e,end:t},s)=>{const i=D.useContext(Uu);if(!i)throw"Segment must used inside Segments component.";const r=D.useRef(null);return D.useLayoutEffect(()=>i.subscribe(r),[]),D.createElement("segmentObject",{ref:Df([r,s]),color:n,start:bl(e),end:bl(t)})});function $p({all:n,scene:e,camera:t}){const s=Pe(({gl:o})=>o),i=Pe(({camera:o})=>o),r=Pe(({scene:o})=>o);return D.useLayoutEffect(()=>{const o=[];n&&(e||r).traverse(l=>{l.visible===!1&&(o.push(l),l.visible=!0)}),s.compile(e||r,t||i);const a=new Qf(128);new Kf(.01,1e5,a).update(s,e||r),a.dispose(),o.forEach(l=>l.visible=!1)},[]),null}function Xp({pixelated:n}){const e=Pe(o=>o.gl),t=Pe(o=>o.internal.active),s=Pe(o=>o.performance.current),i=Pe(o=>o.viewport.initialDpr),r=Pe(o=>o.setDpr);return D.useEffect(()=>{const o=e.domElement;return()=>{t&&r(i),n&&o&&(o.style.imageRendering="auto")}},[]),D.useEffect(()=>{r(s*i),n&&e.domElement&&(e.domElement.style.imageRendering=s===1?"auto":"pixelated")},[s]),null}function Qp(){const n=Pe(s=>s.get),e=Pe(s=>s.setEvents),t=Pe(s=>s.performance.current);return D.useEffect(()=>{const s=n().events.enabled;return()=>e({enabled:s})},[]),D.useEffect(()=>e({enabled:t===1}),[t]),null}const uc=D.createContext(null);function Kp({children:n,enabled:e=!0}){const[t,s]=D.useState([]),i=D.useMemo(()=>({selected:t,select:s,enabled:e}),[t,s,e]);return U.jsx(uc.Provider,{value:i,children:n})}function Lu({enabled:n=!1,children:e,...t}){const s=D.useRef(null),i=D.useContext(uc);return D.useEffect(()=>{if(i&&n){let r=!1;const o=[];if(s.current.traverse(a=>{a.type==="Mesh"&&o.push(a),i.selected.indexOf(a)===-1&&(r=!0)}),r)return i.select(a=>[...a,...o]),()=>{i.select(a=>a.filter(c=>!o.includes(c)))}}},[n,e,i]),U.jsx("group",{ref:s,...t,children:e})}/**
 * postprocessing v6.33.4 build Sat Dec 02 2023
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2023 Raoul van Rschen
 * @license Zlib
 */var Bu="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",pe={SKIP:9,SET:30,ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},zu="",Je="srgb",zo="srgb-linear",xs={NONE:0,DEPTH:1,CONVOLUTION:2},ye={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},Vo={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},qr={DEFAULT:0,ESKIL:1},Vu=Number(cc.replace(/\D+/g,"")),ju=Vu>=152,Jp=new Map([[Du,zo],[Ru,Je]]),e0=new Map([[zo,Du],[Je,Ru]]);function ei(n){return n===null?null:ju?n.outputColorSpace:Jp.get(n.outputEncoding)}function js(n,e){n!==null&&(ju?n.colorSpace=e:n.encoding=e0.get(e))}function Tr(n){return Vu<154?n.replace("colorspace_fragment","encodings_fragment"):n}var t0=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,s0="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",n0=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],i0=class extends cs{constructor(n=new hl){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new he(null),texelSize:new he(new hl),scale:new he(1),kernel:new he(0)},blending:As,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:t0,vertexShader:s0}),this.fragmentShader=Tr(this.fragmentShader),this.setTexelSize(n.x,n.y),this.kernelSize=Vo.MEDIUM}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.inputBuffer=n}get kernelSequence(){return n0[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(n){this.uniforms.scale.value=n}getScale(){return this.uniforms.scale.value}setScale(n){this.uniforms.scale.value=n}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(n){this.uniforms.kernel.value=n}setKernel(n){this.kernel=n}setTexelSize(n,e){this.uniforms.texelSize.value.set(n,e,n*.5,e*.5)}setSize(n,e){const t=1/n,s=1/e;this.uniforms.texelSize.value.set(t,s,t*.5,s*.5)}},r0=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <colorspace_fragment>
#include <dithering_fragment>
}`,Hu=class extends cs{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new he(null),opacity:new he(1)},blending:As,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:r0,vertexShader:Bu}),this.fragmentShader=Tr(this.fragmentShader)}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.uniforms.inputBuffer.value=n}getOpacity(n){return this.uniforms.opacity.value}setOpacity(n){this.uniforms.opacity.value=n}},o0=`#include <packing>
#include <clipping_planes_pars_fragment>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float cameraNear;uniform float cameraFar;centroid varying float vViewZ;centroid varying vec4 vProjTexCoord;void main(){
#include <clipping_planes_fragment>
vec2 projTexCoord=(vProjTexCoord.xy/vProjTexCoord.w)*0.5+0.5;projTexCoord=clamp(projTexCoord,0.002,0.998);
#if DEPTH_PACKING == 3201
float fragCoordZ=unpackRGBAToDepth(texture2D(depthBuffer,projTexCoord));
#else
float fragCoordZ=texture2D(depthBuffer,projTexCoord).r;
#endif
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(fragCoordZ,cameraNear,cameraFar);
#else
float viewZ=orthographicDepthToViewZ(fragCoordZ,cameraNear,cameraFar);
#endif
float depthTest=(-vViewZ>-viewZ)?1.0:0.0;gl_FragColor.rg=vec2(0.0,depthTest);}`,a0=`#include <common>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
varying float vViewZ;varying vec4 vProjTexCoord;void main(){
#include <skinbase_vertex>
#include <begin_vertex>
#include <morphtarget_vertex>
#include <skinning_vertex>
#include <project_vertex>
vViewZ=mvPosition.z;vProjTexCoord=gl_Position;
#include <clipping_planes_vertex>
}`,c0=class extends cs{constructor(n=null,e){super({name:"DepthComparisonMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new he(null),cameraNear:new he(.3),cameraFar:new he(1e3)},blending:As,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:o0,vertexShader:a0}),this.depthBuffer=n,this.depthPacking=Da,this.copyCameraSettings(e)}set depthBuffer(n){this.uniforms.depthBuffer.value=n}set depthPacking(n){this.defines.DEPTH_PACKING=n.toFixed(0),this.needsUpdate=!0}setDepthBuffer(n,e=Da){this.depthBuffer=n,this.depthPacking=e}adoptCameraSettings(n){this.copyCameraSettings(n)}copyCameraSettings(n){n&&(this.uniforms.cameraNear.value=n.near,this.uniforms.cameraFar.value=n.far,n instanceof Au?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},l0=`#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
#ifdef DOWNSAMPLE_NORMALS
uniform lowp sampler2D normalBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])*0.25;float distances[4];distances[0]=abs(c-samples[0]);distances[1]=abs(c-samples[1]);distances[2]=abs(c-samples[2]);distances[3]=abs(c-samples[3]);float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[4];d[0]=readDepth(vUv0);d[1]=readDepth(vUv1);d[2]=readDepth(vUv2);d[3]=readDepth(vUv3);int index=findBestDepth(d);
#ifdef DOWNSAMPLE_NORMALS
vec3 n[4];n[0]=texture2D(normalBuffer,vUv0).rgb;n[1]=texture2D(normalBuffer,vUv1).rgb;n[2]=texture2D(normalBuffer,vUv2).rgb;n[3]=texture2D(normalBuffer,vUv3).rgb;
#else
vec3 n[4];n[0]=vec3(0.0);n[1]=vec3(0.0);n[2]=vec3(0.0);n[3]=vec3(0.0);
#endif
gl_FragColor=vec4(n[index],d[index]);}`,u0="uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}",h0=class extends cs{constructor(){super({name:"DepthDownsamplingMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new he(null),normalBuffer:new he(null),texelSize:new he(new ae)},blending:As,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:l0,vertexShader:u0})}set depthBuffer(n){this.uniforms.depthBuffer.value=n}set depthPacking(n){this.defines.DEPTH_PACKING=n.toFixed(0),this.needsUpdate=!0}setDepthBuffer(n,e=fi){this.depthBuffer=n,this.depthPacking=e}set normalBuffer(n){this.uniforms.normalBuffer.value=n,n!==null?this.defines.DOWNSAMPLE_NORMALS="1":delete this.defines.DOWNSAMPLE_NORMALS,this.needsUpdate=!0}setNormalBuffer(n){this.normalBuffer=n}setTexelSize(n,e){this.uniforms.texelSize.value.set(n,e)}setSize(n,e){this.uniforms.texelSize.value.set(1/n,1/e)}},d0=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#define WEIGHT_INNER 0.125
#define WEIGHT_OUTER 0.0555555
varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;
#include <colorspace_fragment>
}`,f0="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",p0=class extends cs{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new he(null),texelSize:new he(new ae)},blending:As,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:d0,vertexShader:f0}),this.fragmentShader=Tr(this.fragmentShader)}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setSize(n,e){this.uniforms.texelSize.value.set(1/n,1/e)}},m0=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,_0="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",g0=class extends cs{constructor(n,e,t,s,i=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:cc.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new he(null),depthBuffer:new he(null),resolution:new he(new ae),texelSize:new he(new ae),cameraNear:new he(.3),cameraFar:new he(1e3),aspect:new he(1),time:new he(0)},blending:As,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:i}),n&&this.setShaderParts(n),e&&this.setDefines(e),t&&this.setUniforms(t),this.copyCameraSettings(s)}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.uniforms.inputBuffer.value=n}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(n){this.uniforms.depthBuffer.value=n}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(n){this.defines.DEPTH_PACKING=n.toFixed(0),this.needsUpdate=!0}setDepthBuffer(n,e=fi){this.depthBuffer=n,this.depthPacking=e}setShaderData(n){this.setShaderParts(n.shaderParts),this.setDefines(n.defines),this.setUniforms(n.uniforms),this.setExtensions(n.extensions)}setShaderParts(n){return this.fragmentShader=m0.replace(ye.FRAGMENT_HEAD,n.get(ye.FRAGMENT_HEAD)||"").replace(ye.FRAGMENT_MAIN_UV,n.get(ye.FRAGMENT_MAIN_UV)||"").replace(ye.FRAGMENT_MAIN_IMAGE,n.get(ye.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=_0.replace(ye.VERTEX_HEAD,n.get(ye.VERTEX_HEAD)||"").replace(ye.VERTEX_MAIN_SUPPORT,n.get(ye.VERTEX_MAIN_SUPPORT)||""),this.fragmentShader=Tr(this.fragmentShader),this.needsUpdate=!0,this}setDefines(n){for(const e of n.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(n){for(const e of n.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(n){this.extensions={};for(const e of n)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(n){this.encodeOutput!==n&&(n?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(n){return this.encodeOutput}setOutputEncodingEnabled(n){this.encodeOutput=n}get time(){return this.uniforms.time.value}set time(n){this.uniforms.time.value=n}setDeltaTime(n){this.uniforms.time.value+=n}adoptCameraSettings(n){this.copyCameraSettings(n)}copyCameraSettings(n){n&&(this.uniforms.cameraNear.value=n.near,this.uniforms.cameraFar.value=n.far,n instanceof Au?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(n,e){const t=this.uniforms;t.resolution.value.set(n,e),t.texelSize.value.set(1/n,1/e),t.aspect.value=n/e}static get Section(){return ye}},v0=`#include <common>
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,y0=class extends cs{constructor(n=!1,e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:cc.replace(/\D+/g,"")},uniforms:{inputBuffer:new he(null),threshold:new he(0),smoothing:new he(1),range:new he(null)},blending:As,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:v0,vertexShader:Bu}),this.colorOutput=n,this.luminanceRange=e}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.uniforms.inputBuffer.value=n}get threshold(){return this.uniforms.threshold.value}set threshold(n){this.smoothing>0||n>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=n}getThreshold(){return this.threshold}setThreshold(n){this.threshold=n}get smoothing(){return this.uniforms.smoothing.value}set smoothing(n){this.threshold>0||n>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=n}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(n){this.smoothing=n}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(n){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(n){n?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(n){return this.colorOutput}setColorOutputEnabled(n){this.colorOutput=n}get useRange(){return this.luminanceRange!==null}set useRange(n){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(n){n!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=n,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(n){this.luminanceRange=n}},x0="uniform lowp sampler2D inputBuffer;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 c0=texture2D(inputBuffer,vUv0).rg;vec2 c1=texture2D(inputBuffer,vUv1).rg;vec2 c2=texture2D(inputBuffer,vUv2).rg;vec2 c3=texture2D(inputBuffer,vUv3).rg;float d0=(c0.x-c1.x)*0.5;float d1=(c2.x-c3.x)*0.5;float d=length(vec2(d0,d1));float a0=min(c0.y,c1.y);float a1=min(c2.y,c3.y);float visibilityFactor=min(a0,a1);gl_FragColor.rg=(1.0-visibilityFactor>0.001)?vec2(d,0.0):vec2(0.0,d);}",T0="uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=vec2(uv.x+texelSize.x,uv.y);vUv1=vec2(uv.x-texelSize.x,uv.y);vUv2=vec2(uv.x,uv.y+texelSize.y);vUv3=vec2(uv.x,uv.y-texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}",k0=class extends cs{constructor(n=new ae){super({name:"OutlineMaterial",uniforms:{inputBuffer:new he(null),texelSize:new he(new ae)},blending:As,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:x0,vertexShader:T0}),this.uniforms.texelSize.value.set(n.x,n.y),this.uniforms.maskTexture=this.uniforms.inputBuffer}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.uniforms.inputBuffer.value=n}setTexelSize(n,e){this.uniforms.texelSize.value.set(n,e)}setSize(n,e){this.uniforms.texelSize.value.set(1/n,1/e)}},w0=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;
#else
uniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;
#endif
uniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);
#include <colorspace_fragment>
}`,S0="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}",b0=class extends cs{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new he(null),supportBuffer:new he(null),texelSize:new he(new ae),radius:new he(.85)},blending:As,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:w0,vertexShader:S0}),this.fragmentShader=Tr(this.fragmentShader)}set inputBuffer(n){this.uniforms.inputBuffer.value=n}set supportBuffer(n){this.uniforms.supportBuffer.value=n}get radius(){return this.uniforms.radius.value}set radius(n){this.uniforms.radius.value=n}setSize(n,e){this.uniforms.texelSize.value.set(1/n,1/e)}},C0=new lp,Rs=null;function E0(){if(Rs===null){const n=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]);Rs=new Ou,Rs.setAttribute!==void 0?(Rs.setAttribute("position",new Ur(n,3)),Rs.setAttribute("uv",new Ur(e,2))):(Rs.addAttribute("position",new Ur(n,3)),Rs.addAttribute("uv",new Ur(e,2)))}return Rs}var dt=class qu{constructor(e="Pass",t=new ul,s=C0){this.name=e,this.renderer=null,this.scene=t,this.camera=s,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const t=this.fullscreenMaterial;t!==null&&(t.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new ap(E0(),e),t.frustumCulled=!1,this.scene===null&&(this.scene=new ul),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=fi){}render(e,t,s,i,r){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,s){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof At||t instanceof Mu||t instanceof Pu||t instanceof qu)&&this[e].dispose()}}},O0=class extends dt{constructor(n,e=!0){super("CopyPass"),this.fullscreenMaterial=new Hu,this.needsSwap=!1,this.renderTarget=n,n===void 0&&(this.renderTarget=new At(1,1,{minFilter:oo,magFilter:oo,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(n){this.autoResize=n}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(n){this.autoResize=n}render(n,e,t,s,i){this.fullscreenMaterial.inputBuffer=e.texture,n.setRenderTarget(this.renderToScreen?null:this.renderTarget),n.render(this.scene,this.camera)}setSize(n,e){this.autoResize&&this.renderTarget.setSize(n,e)}initialize(n,e,t){t!==void 0&&(this.renderTarget.texture.type=t,t!==ks?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":ei(n)===Je&&js(this.renderTarget.texture,Je))}},A0=class extends dt{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(n,e,t,s,i){const r=n.state.buffers.stencil;r.setLocked(!1),r.setTest(!1)}},Cl=new ys,hc=class extends dt{constructor(n=!0,e=!0,t=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=n,this.depth=e,this.stencil=t,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(n,e,t){this.color=n,this.depth=e,this.stencil=t}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(n){this.overrideClearColor=n}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(n){this.overrideClearAlpha=n}render(n,e,t,s,i){const r=this.overrideClearColor,o=this.overrideClearAlpha,a=n.getClearAlpha(),c=r!==null,l=o>=0;c?(n.getClearColor(Cl),n.setClearColor(r,l?o:a)):l&&n.setClearAlpha(o),n.setRenderTarget(this.renderToScreen?null:e),n.clear(this.color,this.depth,this.stencil),c?n.setClearColor(Cl,a):l&&n.setClearAlpha(a)}},jo=class extends dt{constructor(n,e,t=null){super("RenderPass",n,e),this.needsSwap=!1,this.clearPass=new hc,this.overrideMaterialManager=t===null?null:new Ol(t),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(n){this.scene=n}set mainCamera(n){this.camera=n}get renderToScreen(){return super.renderToScreen}set renderToScreen(n){super.renderToScreen=n,this.clearPass.renderToScreen=n}get overrideMaterial(){const n=this.overrideMaterialManager;return n!==null?n.material:null}set overrideMaterial(n){const e=this.overrideMaterialManager;n!==null?e!==null?e.setMaterial(n):this.overrideMaterialManager=new Ol(n):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(n){this.overrideMaterial=n}get clear(){return this.clearPass.enabled}set clear(n){this.clearPass.enabled=n}getSelection(){return this.selection}setSelection(n){this.selection=n}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(n){this.ignoreBackground=n}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(n){this.skipShadowMapUpdate=n}getClearPass(){return this.clearPass}render(n,e,t,s,i){const r=this.scene,o=this.camera,a=this.selection,c=o.layers.mask,l=r.background,u=n.shadowMap.autoUpdate,h=this.renderToScreen?null:e;a!==null&&o.layers.set(a.getLayer()),this.skipShadowMapUpdate&&(n.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(r.background=null),this.clearPass.enabled&&this.clearPass.render(n,e),n.setRenderTarget(h),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(n,r,o):n.render(r,o),o.layers.mask=c,r.background=l,n.shadowMap.autoUpdate=u}},M0=class extends dt{constructor(n,e,{renderTarget:t,resolutionScale:s=1,width:i=Be.AUTO_SIZE,height:r=Be.AUTO_SIZE,resolutionX:o=i,resolutionY:a=r}={}){super("DepthPass"),this.needsSwap=!1,this.renderPass=new jo(n,e,new cp({depthPacking:Da}));const c=this.renderPass;c.skipShadowMapUpdate=!0,c.ignoreBackground=!0;const l=c.clearPass;l.overrideClearColor=new ys(16777215),l.overrideClearAlpha=1,this.renderTarget=t,this.renderTarget===void 0&&(this.renderTarget=new At(1,1,{minFilter:Jn,magFilter:Jn}),this.renderTarget.texture.name="DepthPass.Target");const u=this.resolution=new Be(this,o,a,s);u.addEventListener("change",h=>this.setSize(u.baseWidth,u.baseHeight))}set mainScene(n){this.renderPass.mainScene=n}set mainCamera(n){this.renderPass.mainCamera=n}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(n){this.resolution.scale=n}render(n,e,t,s,i){const r=this.renderToScreen?null:this.renderTarget;this.renderPass.render(n,r)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e),this.renderTarget.setSize(t.width,t.height)}},P0=class extends dt{constructor({normalBuffer:n=null,resolutionScale:e=.5,width:t=Be.AUTO_SIZE,height:s=Be.AUTO_SIZE,resolutionX:i=t,resolutionY:r=s}={}){super("DepthDownsamplingPass");const o=new h0;o.normalBuffer=n,this.fullscreenMaterial=o,this.needsDepthTexture=!0,this.needsSwap=!1,this.renderTarget=new At(1,1,{minFilter:Jn,magFilter:Jn,depthBuffer:!1,type:Jf}),this.renderTarget.texture.name="DepthDownsamplingPass.Target",this.renderTarget.texture.generateMipmaps=!1;const a=this.resolution=new Be(this,i,r,e);a.addEventListener("change",c=>this.setSize(a.baseWidth,a.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}setDepthTexture(n,e=fi){this.fullscreenMaterial.depthBuffer=n,this.fullscreenMaterial.depthPacking=e}render(n,e,t,s,i){n.setRenderTarget(this.renderToScreen?null:this.renderTarget),n.render(this.scene,this.camera)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e),this.renderTarget.setSize(t.width,t.height),this.fullscreenMaterial.setSize(n,e)}initialize(n,e,t){const s=n.getContext();if(!(s.getExtension("EXT_color_buffer_float")||s.getExtension("EXT_color_buffer_half_float")))throw new Error("Rendering to float texture is not supported.")}};function El(n,e,t){for(const s of e){const i="$1"+n+s.charAt(0).toUpperCase()+s.slice(1),r=new RegExp("([^\\.])(\\b"+s+"\\b)","g");for(const o of t.entries())o[1]!==null&&t.set(o[0],o[1].replace(r,i))}}function D0(n,e,t){let s=e.getFragmentShader(),i=e.getVertexShader();const r=s!==void 0&&/mainImage/.test(s),o=s!==void 0&&/mainUv/.test(s);if(t.attributes|=e.getAttributes(),s===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(o&&t.attributes&xs.CONVOLUTION)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!r&&!o)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const a=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,c=t.shaderParts;let l=c.get(ye.FRAGMENT_HEAD)||"",u=c.get(ye.FRAGMENT_MAIN_UV)||"",h=c.get(ye.FRAGMENT_MAIN_IMAGE)||"",d=c.get(ye.VERTEX_HEAD)||"",f=c.get(ye.VERTEX_MAIN_SUPPORT)||"";const m=new Set,p=new Set;if(o&&(u+=`	${n}MainUv(UV);
`,t.uvTransformation=!0),i!==null&&/mainSupport/.test(i)){const k=/mainSupport *\([\w\s]*?uv\s*?\)/.test(i);f+=`	${n}MainSupport(`,f+=k?`vUv);
`:`);
`;for(const w of i.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const v of w[1].split(/\s*,\s*/))t.varyings.add(v),m.add(v),p.add(v);for(const w of i.matchAll(a))p.add(w[1])}for(const k of s.matchAll(a))p.add(k[1]);for(const k of e.defines.keys())p.add(k.replace(/\([\w\s,]*\)/g,""));for(const k of e.uniforms.keys())p.add(k);p.delete("while"),p.delete("for"),p.delete("if"),e.uniforms.forEach((k,w)=>t.uniforms.set(n+w.charAt(0).toUpperCase()+w.slice(1),k)),e.defines.forEach((k,w)=>t.defines.set(n+w.charAt(0).toUpperCase()+w.slice(1),k));const _=new Map([["fragment",s],["vertex",i]]);El(n,p,t.defines),El(n,p,_),s=_.get("fragment"),i=_.get("vertex");const y=e.blendMode;if(t.blendModes.set(y.blendFunction,y),r){e.inputColorSpace!==null&&e.inputColorSpace!==t.colorSpace&&(h+=e.inputColorSpace===Je?`color0 = LinearTosRGB(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==zu?t.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(t.colorSpace=e.inputColorSpace);const k=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;h+=`${n}MainImage(color0, UV, `,t.attributes&xs.DEPTH&&k.test(s)&&(h+="depth, ",t.readDepth=!0),h+=`color1);
	`;const w=n+"BlendOpacity";t.uniforms.set(w,y.opacity),h+=`color0 = blend${y.blendFunction}(color0, color1, ${w});

	`,l+=`uniform float ${w};

`}if(l+=s+`
`,i!==null&&(d+=i+`
`),c.set(ye.FRAGMENT_HEAD,l),c.set(ye.FRAGMENT_MAIN_UV,u),c.set(ye.FRAGMENT_MAIN_IMAGE,h),c.set(ye.VERTEX_HEAD,d),c.set(ye.VERTEX_MAIN_SUPPORT,f),e.extensions!==null)for(const k of e.extensions)t.extensions.add(k)}}var R0=class extends dt{constructor(n,...e){super("EffectPass"),this.fullscreenMaterial=new g0(null,null,null,n),this.listener=t=>this.handleEvent(t),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(n){for(const e of this.effects)e.mainScene=n}set mainCamera(n){this.fullscreenMaterial.copyCameraSettings(n);for(const e of this.effects)e.mainCamera=n}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(n){this.fullscreenMaterial.encodeOutput=n}get dithering(){return this.fullscreenMaterial.dithering}set dithering(n){const e=this.fullscreenMaterial;e.dithering=n,e.needsUpdate=!0}setEffects(n){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=n.sort((e,t)=>t.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const n=new j0;let e=0;for(const o of this.effects)if(o.blendMode.blendFunction===pe.DST)n.attributes|=o.getAttributes()&xs.DEPTH;else{if(n.attributes&o.getAttributes()&xs.CONVOLUTION)throw new Error(`Convolution effects cannot be merged (${o.name})`);D0("e"+e++,o,n)}let t=n.shaderParts.get(ye.FRAGMENT_HEAD),s=n.shaderParts.get(ye.FRAGMENT_MAIN_IMAGE),i=n.shaderParts.get(ye.FRAGMENT_MAIN_UV);const r=/\bblend\b/g;for(const o of n.blendModes.values())t+=o.getShaderCode().replace(r,`blend${o.blendFunction}`)+`
`;n.attributes&xs.DEPTH?(n.readDepth&&(s=`float depth = readDepth(UV);

	`+s),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,n.colorSpace===Je&&(s+=`color0 = sRGBToLinear(color0);
	`),n.uvTransformation?(i=`vec2 transformedUv = vUv;
`+i,n.defines.set("UV","transformedUv")):n.defines.set("UV","vUv"),n.shaderParts.set(ye.FRAGMENT_HEAD,t),n.shaderParts.set(ye.FRAGMENT_MAIN_IMAGE,s),n.shaderParts.set(ye.FRAGMENT_MAIN_UV,i);for(const[o,a]of n.shaderParts)a!==null&&n.shaderParts.set(o,a.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(n)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(n,e=fi){this.fullscreenMaterial.depthBuffer=n,this.fullscreenMaterial.depthPacking=e;for(const t of this.effects)t.setDepthTexture(n,e)}render(n,e,t,s,i){for(const r of this.effects)r.update(n,e,s);if(!this.skipRendering||this.renderToScreen){const r=this.fullscreenMaterial;r.inputBuffer=e.texture,r.time+=s*this.timeScale,n.setRenderTarget(this.renderToScreen?null:t),n.render(this.scene,this.camera)}}setSize(n,e){this.fullscreenMaterial.setSize(n,e);for(const t of this.effects)t.setSize(n,e)}initialize(n,e,t){this.renderer=n;for(const s of this.effects)s.initialize(n,e,t);this.updateMaterial(),t!==void 0&&t!==ks&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const n of this.effects)n.removeEventListener("change",this.listener),n.dispose()}handleEvent(n){switch(n.type){case"change":this.recompile();break}}},Gu=class extends dt{constructor({kernelSize:n=Vo.MEDIUM,resolutionScale:e=.5,width:t=Be.AUTO_SIZE,height:s=Be.AUTO_SIZE,resolutionX:i=t,resolutionY:r=s}={}){super("KawaseBlurPass"),this.renderTargetA=new At(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const o=this.resolution=new Be(this,i,r,e);o.addEventListener("change",a=>this.setSize(o.baseWidth,o.baseHeight)),this._blurMaterial=new i0,this._blurMaterial.kernelSize=n,this.copyMaterial=new Hu}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(n){this._blurMaterial=n}get dithering(){return this.copyMaterial.dithering}set dithering(n){this.copyMaterial.dithering=n}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(n){this.blurMaterial.kernelSize=n}get width(){return this.resolution.width}set width(n){this.resolution.preferredWidth=n}get height(){return this.resolution.height}set height(n){this.resolution.preferredHeight=n}get scale(){return this.blurMaterial.scale}set scale(n){this.blurMaterial.scale=n}getScale(){return this.blurMaterial.scale}setScale(n){this.blurMaterial.scale=n}getKernelSize(){return this.kernelSize}setKernelSize(n){this.kernelSize=n}getResolutionScale(){return this.resolution.scale}setResolutionScale(n){this.resolution.scale=n}render(n,e,t,s,i){const r=this.scene,o=this.camera,a=this.renderTargetA,c=this.renderTargetB,l=this.blurMaterial,u=l.kernelSequence;let h=e;this.fullscreenMaterial=l;for(let d=0,f=u.length;d<f;++d){const m=d&1?c:a;l.kernel=u[d],l.inputBuffer=h.texture,n.setRenderTarget(m),n.render(r,o),h=m}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=h.texture,n.setRenderTarget(this.renderToScreen?null:t),n.render(r,o)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e);const s=t.width,i=t.height;this.renderTargetA.setSize(s,i),this.renderTargetB.setSize(s,i),this.blurMaterial.setSize(n,e)}initialize(n,e,t){t!==void 0&&(this.renderTargetA.texture.type=t,this.renderTargetB.texture.type=t,t!==ks?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):ei(n)===Je&&(js(this.renderTargetA.texture,Je),js(this.renderTargetB.texture,Je)))}static get AUTO_SIZE(){return Be.AUTO_SIZE}},I0=class extends dt{constructor({renderTarget:n,luminanceRange:e,colorOutput:t,resolutionScale:s=1,width:i=Be.AUTO_SIZE,height:r=Be.AUTO_SIZE,resolutionX:o=i,resolutionY:a=r}={}){super("LuminancePass"),this.fullscreenMaterial=new y0(t,e),this.needsSwap=!1,this.renderTarget=n,this.renderTarget===void 0&&(this.renderTarget=new At(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const c=this.resolution=new Be(this,o,a,s);c.addEventListener("change",l=>this.setSize(c.baseWidth,c.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(n,e,t,s,i){const r=this.fullscreenMaterial;r.inputBuffer=e.texture,n.setRenderTarget(this.renderToScreen?null:this.renderTarget),n.render(this.scene,this.camera)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e),this.renderTarget.setSize(t.width,t.height)}initialize(n,e,t){t!==void 0&&t!==ks&&(this.renderTarget.texture.type=t,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},N0=class extends dt{constructor(n,e){super("MaskPass",n,e),this.needsSwap=!1,this.clearPass=new hc(!1,!1,!0),this.inverse=!1}set mainScene(n){this.scene=n}set mainCamera(n){this.camera=n}get inverted(){return this.inverse}set inverted(n){this.inverse=n}get clear(){return this.clearPass.enabled}set clear(n){this.clearPass.enabled=n}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(n){this.inverted=n}render(n,e,t,s,i){const r=n.getContext(),o=n.state.buffers,a=this.scene,c=this.camera,l=this.clearPass,u=this.inverted?0:1,h=1-u;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(r.REPLACE,r.REPLACE,r.REPLACE),o.stencil.setFunc(r.ALWAYS,u,4294967295),o.stencil.setClear(h),o.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?l.render(n,null):(l.render(n,e),l.render(n,t))),this.renderToScreen?(n.setRenderTarget(null),n.render(a,c)):(n.setRenderTarget(e),n.render(a,c),n.setRenderTarget(t),n.render(a,c)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(r.EQUAL,1,4294967295),o.stencil.setOp(r.KEEP,r.KEEP,r.KEEP),o.stencil.setLocked(!0)}},F0=class extends dt{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new At(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new p0,this.upsamplingMaterial=new b0,this.resolution=new ae}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(n){if(this.levels!==n){const e=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let t=0;t<n;++t){const s=e.clone();s.texture.name="Downsampling.Mipmap"+t,this.downsamplingMipmaps.push(s)}this.upsamplingMipmaps.push(e);for(let t=1,s=n-1;t<s;++t){const i=e.clone();i.texture.name="Upsampling.Mipmap"+t,this.upsamplingMipmaps.push(i)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(n){this.upsamplingMaterial.radius=n}render(n,e,t,s,i){const{scene:r,camera:o}=this,{downsamplingMaterial:a,upsamplingMaterial:c}=this,{downsamplingMipmaps:l,upsamplingMipmaps:u}=this;let h=e;this.fullscreenMaterial=a;for(let d=0,f=l.length;d<f;++d){const m=l[d];a.setSize(h.width,h.height),a.inputBuffer=h.texture,n.setRenderTarget(m),n.render(r,o),h=m}this.fullscreenMaterial=c;for(let d=u.length-1;d>=0;--d){const f=u[d];c.setSize(h.width,h.height),c.inputBuffer=h.texture,c.supportBuffer=l[d].texture,n.setRenderTarget(f),n.render(r,o),h=f}}setSize(n,e){const t=this.resolution;t.set(n,e);let s=t.width,i=t.height;for(let r=0,o=this.downsamplingMipmaps.length;r<o;++r)s=Math.round(s*.5),i=Math.round(i*.5),this.downsamplingMipmaps[r].setSize(s,i),r<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[r].setSize(s,i)}initialize(n,e,t){if(t!==void 0){const s=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const i of s)i.texture.type=t;if(t!==ks)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(ei(n)===Je)for(const i of s)js(i.texture,Je)}}dispose(){super.dispose();for(const n of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))n.dispose()}},U0=class extends dt{constructor(n,e,{renderTarget:t,resolutionScale:s=1,width:i=Be.AUTO_SIZE,height:r=Be.AUTO_SIZE,resolutionX:o=i,resolutionY:a=r}={}){super("NormalPass"),this.needsSwap=!1,this.renderPass=new jo(n,e,new ep);const c=this.renderPass;c.ignoreBackground=!0,c.skipShadowMapUpdate=!0;const l=c.getClearPass();l.overrideClearColor=new ys(7829503),l.overrideClearAlpha=1,this.renderTarget=t,this.renderTarget===void 0&&(this.renderTarget=new At(1,1,{minFilter:Jn,magFilter:Jn}),this.renderTarget.texture.name="NormalPass.Target");const u=this.resolution=new Be(this,o,a,s);u.addEventListener("change",h=>this.setSize(u.baseWidth,u.baseHeight))}set mainScene(n){this.renderPass.mainScene=n}set mainCamera(n){this.renderPass.mainCamera=n}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(n){this.resolution.scale=n}render(n,e,t,s,i){const r=this.renderToScreen?null:this.renderTarget;this.renderPass.render(n,r,r)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e),this.renderTarget.setSize(t.width,t.height)}},L0=class extends dt{constructor(n,e="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=n,this.input=e}setInput(n){this.input=n}render(n,e,t,s,i){const r=this.fullscreenMaterial.uniforms;e!==null&&r!==void 0&&r[this.input]!==void 0&&(r[this.input].value=e.texture),n.setRenderTarget(this.renderToScreen?null:t),n.render(this.scene,this.camera)}initialize(n,e,t){t!==void 0&&t!==ks&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},_a=1/1e3,B0=1e3,z0=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(n){typeof document<"u"&&document.hidden!==void 0&&(n?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=n)}get delta(){return this._delta*_a}get fixedDelta(){return this._fixedDelta*_a}set fixedDelta(n){this._fixedDelta=n*B0}get elapsed(){return this._elapsed*_a}update(n){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(n!==void 0?n:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}handleEvent(n){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},V0=class{constructor(e=null,{depthBuffer:t=!0,stencilBuffer:s=!1,multisampling:i=0,frameBufferType:r}={}){this.renderer=null,this.inputBuffer=this.createBuffer(t,s,r,i),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new O0,this.depthTexture=null,this.passes=[],this.timer=new z0,this.autoRenderToScreen=!0,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){const t=this.inputBuffer,s=this.multisampling;s>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):s!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){if(this.renderer=e,e!==null){const t=e.getSize(new ae),s=e.getContext().getContextAttributes().alpha,i=this.inputBuffer.texture.type;i===ks&&ei(e)===Je&&(js(this.inputBuffer.texture,Je),js(this.outputBuffer.texture,Je),this.inputBuffer.dispose(),this.outputBuffer.dispose()),e.autoClear=!1,this.setSize(t.width,t.height);for(const r of this.passes)r.initialize(e,s,i)}}replaceRenderer(e,t=!0){const s=this.renderer,i=s.domElement.parentNode;return this.setRenderer(e),t&&i!==null&&(i.removeChild(s.domElement),i.appendChild(e.domElement)),s}createDepthTexture(){const e=this.depthTexture=new tp;return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=sp,e.type=np):e.type=ip,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,s,i){const r=this.renderer,o=r===null?new ae:r.getDrawingBufferSize(new ae),a={minFilter:oo,magFilter:oo,stencilBuffer:t,depthBuffer:e,type:s},c=new At(o.width,o.height,a);return i>0&&(c.ignoreDepthForMultisampleCopy=!1,c.samples=i),s===ks&&ei(r)===Je&&js(c.texture,Je),c.texture.name="EffectComposer.Buffer",c.texture.generateMipmaps=!1,c}setMainScene(e){for(const t of this.passes)t.mainScene=e}setMainCamera(e){for(const t of this.passes)t.mainCamera=e}addPass(e,t){const s=this.passes,i=this.renderer,r=i.getDrawingBufferSize(new ae),o=i.getContext().getContextAttributes().alpha,a=this.inputBuffer.texture.type;if(e.setRenderer(i),e.setSize(r.width,r.height),e.initialize(i,o,a),this.autoRenderToScreen&&(s.length>0&&(s[s.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?s.splice(t,0,e):s.push(e),this.autoRenderToScreen&&(s[s.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const c=this.createDepthTexture();for(e of s)e.setDepthTexture(c)}else e.setDepthTexture(this.depthTexture)}removePass(e){const t=this.passes,s=t.indexOf(e);if(s!==-1&&t.splice(s,1).length>0){if(this.depthTexture!==null){const o=(c,l)=>c||l.needsDepthTexture;t.reduce(o,!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&s===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){const e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){const t=this.renderer,s=this.copyPass;let i=this.inputBuffer,r=this.outputBuffer,o=!1,a,c,l;e===void 0&&(this.timer.update(),e=this.timer.delta);for(const u of this.passes)u.enabled&&(u.render(t,i,r,e,o),u.needsSwap&&(o&&(s.renderToScreen=u.renderToScreen,a=t.getContext(),c=t.state.buffers.stencil,c.setFunc(a.NOTEQUAL,1,4294967295),s.render(t,i,r,e,o),c.setFunc(a.EQUAL,1,4294967295)),l=i,i=r,r=l),u instanceof N0?o=!0:u instanceof A0&&(o=!1))}setSize(e,t,s){const i=this.renderer,r=i.getSize(new ae);(e===void 0||t===void 0)&&(e=r.width,t=r.height),(r.width!==e||r.height!==t)&&i.setSize(e,t,s);const o=i.getDrawingBufferSize(new ae);this.inputBuffer.setSize(o.width,o.height),this.outputBuffer.setSize(o.width,o.height);for(const a of this.passes)a.setSize(o.width,o.height)}reset(){const e=this.timer.autoReset;this.dispose(),this.autoRenderToScreen=!0,this.timer.autoReset=e}dispose(){for(const e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},j0=class{constructor(){this.shaderParts=new Map([[ye.FRAGMENT_HEAD,null],[ye.FRAGMENT_MAIN_UV,null],[ye.FRAGMENT_MAIN_IMAGE,null],[ye.VERTEX_HEAD,null],[ye.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=xs.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=zo}},ga=!1,Ol=class{constructor(n=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(n),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let t;if(e.material.flatShading)switch(e.material.side){case hn:t=this.materialsFlatShadedDoubleSide;break;case Fr:t=this.materialsFlatShadedBackSide;break;default:t=this.materialsFlatShaded;break}else switch(e.material.side){case hn:t=this.materialsDoubleSide;break;case Fr:t=this.materialsBackSide;break;default:t=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=t[2]:e.isInstancedMesh?e.material=t[1]:e.material=t[0],++this.meshCount}}}cloneMaterial(n){if(!(n instanceof cs))return n.clone();const e=n.uniforms,t=new Map;for(const i in e){const r=e[i].value;r.isRenderTargetTexture&&(e[i].value=null,t.set(i,r))}const s=n.clone();for(const i of t)e[i[0]].value=i[1],s.uniforms[i[0]].value=i[1];return s}setMaterial(n){if(this.disposeMaterials(),this.material=n,n!==null){const e=this.materials=[this.cloneMaterial(n),this.cloneMaterial(n),this.cloneMaterial(n)];for(const t of e)t.uniforms=Object.assign({},n.uniforms),t.side=rp;e[2].skinning=!0,this.materialsBackSide=e.map(t=>{const s=this.cloneMaterial(t);return s.uniforms=Object.assign({},n.uniforms),s.side=Fr,s}),this.materialsDoubleSide=e.map(t=>{const s=this.cloneMaterial(t);return s.uniforms=Object.assign({},n.uniforms),s.side=hn,s}),this.materialsFlatShaded=e.map(t=>{const s=this.cloneMaterial(t);return s.uniforms=Object.assign({},n.uniforms),s.flatShading=!0,s}),this.materialsFlatShadedBackSide=e.map(t=>{const s=this.cloneMaterial(t);return s.uniforms=Object.assign({},n.uniforms),s.flatShading=!0,s.side=Fr,s}),this.materialsFlatShadedDoubleSide=e.map(t=>{const s=this.cloneMaterial(t);return s.uniforms=Object.assign({},n.uniforms),s.flatShading=!0,s.side=hn,s})}}render(n,e,t){const s=n.shadowMap.enabled;if(n.shadowMap.enabled=!1,ga){const i=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),n.render(e,t);for(const r of i)r[0].material=r[1];this.meshCount!==i.size&&i.clear()}else{const i=e.overrideMaterial;e.overrideMaterial=this.material,n.render(e,t),e.overrideMaterial=i}n.shadowMap.enabled=s}disposeMaterials(){if(this.material!==null){const n=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of n)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return ga}static set workaroundEnabled(n){ga=n}},Is=-1,Be=class extends ac{constructor(n,e=Is,t=Is,s=1){super(),this.resizable=n,this.baseSize=new ae(1,1),this.preferredSize=new ae(e,t),this.target=this.preferredSize,this.s=s,this.effectiveSize=new ae,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const n=this.baseSize,e=this.preferredSize,t=this.effectiveSize,s=this.scale;e.width!==Is?t.width=e.width:e.height!==Is?t.width=Math.round(e.height*(n.width/Math.max(n.height,1))):t.width=Math.round(n.width*s),e.height!==Is?t.height=e.height:e.width!==Is?t.height=Math.round(e.width/Math.max(n.width/Math.max(n.height,1),1)):t.height=Math.round(n.height*s)}get width(){return this.effectiveSize.width}set width(n){this.preferredWidth=n}get height(){return this.effectiveSize.height}set height(n){this.preferredHeight=n}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(n){this.s!==n&&(this.s=n,this.preferredSize.setScalar(Is),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(n){this.scale=n}get baseWidth(){return this.baseSize.width}set baseWidth(n){this.baseSize.width!==n&&(this.baseSize.width=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(n){this.baseWidth=n}get baseHeight(){return this.baseSize.height}set baseHeight(n){this.baseSize.height!==n&&(this.baseSize.height=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(n){this.baseHeight=n}setBaseSize(n,e){(this.baseSize.width!==n||this.baseSize.height!==e)&&(this.baseSize.set(n,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(n){this.preferredSize.width!==n&&(this.preferredSize.width=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(n){this.preferredWidth=n}get preferredHeight(){return this.preferredSize.height}set preferredHeight(n){this.preferredSize.height!==n&&(this.preferredSize.height=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(n){this.preferredHeight=n}setPreferredSize(n,e){(this.preferredSize.width!==n||this.preferredSize.height!==e)&&(this.preferredSize.set(n,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(n){this.s=n.scale,this.baseSize.set(n.baseWidth,n.baseHeight),this.preferredSize.set(n.preferredWidth,n.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return Is}},H0=class extends Set{constructor(n,e=10){super(),this.l=e,this.exclusive=!1,n!==void 0&&this.set(n)}get layer(){return this.l}set layer(n){const e=this.l;for(const t of this)t.layers.disable(e),t.layers.enable(n);this.l=n}getLayer(){return this.layer}setLayer(n){this.layer=n}isExclusive(){return this.exclusive}setExclusive(n){this.exclusive=n}clear(){const n=this.layer;for(const e of this)e.layers.disable(n);return super.clear()}set(n){this.clear();for(const e of n)this.add(e);return this}indexOf(n){return this.has(n)?0:-1}add(n){return this.exclusive?n.layers.set(this.layer):n.layers.enable(this.layer),super.add(n)}delete(n){return this.has(n)&&n.layers.disable(this.layer),super.delete(n)}toggle(n){let e;return this.has(n)?(this.delete(n),e=!1):(this.add(n),e=!0),e}setVisible(n){for(const e of this)n?e.layers.enable(0):e.layers.disable(0);return this}},q0="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y,opacity);}",G0="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,min(y.a,opacity));}",W0="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y)*0.5,opacity);}",Y0="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.rg,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",Z0="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(step(0.0,y)*(1.0-min(vec4(1.0),(1.0-x)/y)),vec4(1.0),step(1.0,x));return mix(x,z,opacity);}",$0="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=step(0.0,x)*mix(min(vec4(1.0),x/max(1.0-y,1e-9)),vec4(1.0),step(1.0,y));return mix(x,z,opacity);}",X0="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x,y),opacity);}",Q0="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,abs(x-y),opacity);}",K0="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x/max(y,1e-12),opacity);}",J0="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y-2.0*x*y),opacity);}",em="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 a=min(x,1.0),b=min(y,1.0);vec4 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,y));return mix(x,z,opacity);}",tm="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,step(1.0,x+y),opacity);}",sm="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.r,xHSL.gb));return vec4(mix(x.rgb,z,opacity),y.a);}",nm="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-y,opacity);}",im="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y*(1.0-x),opacity);}",rm="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x,y),opacity);}",om="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(y+x-1.0,0.0,1.0),opacity);}",am="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x+y,1.0),opacity);}",cm="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(2.0*y+x-1.0,0.0,1.0),opacity);}",lm="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.rg,yHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",um="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x*y,opacity);}",hm="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-abs(1.0-x-y),opacity);}",dm="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,opacity);}",fm="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(2.0*y*x,1.0-2.0*(1.0-y)*(1.0-x),step(0.5,x));return mix(x,z,opacity);}",pm="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 z=mix(mix(y2,x,step(0.5*x,y)),max(vec4(0.0),y2-1.0),step(x,(y2-1.0)));return mix(x,z,opacity);}",mm="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(min(x*x/max(1.0-y,1e-12),1.0),y,step(1.0,y));return mix(x,z,opacity);}",_m="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.r,yHSL.g,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",gm="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y-min(x*y,1.0),opacity);}",vm="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 w=step(0.5,y);vec4 z=mix(x-(1.0-y2)*x*(1.0-x),mix(x+(y2-1.0)*(sqrt(x)-x),x+(y2-1.0)*x*((16.0*x-12.0)*x+3.0),w*(1.0-step(0.25,x))),w);return mix(x,z,opacity);}",ym="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",xm="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x+y-1.0,0.0),opacity);}",Tm="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(max(1.0-min((1.0-x)/(2.0*y),1.0),0.0),min(x/(2.0*(1.0-y)),1.0),step(0.5,y));return mix(x,z,opacity);}",km=new Map([[pe.ADD,q0],[pe.ALPHA,G0],[pe.AVERAGE,W0],[pe.COLOR,Y0],[pe.COLOR_BURN,Z0],[pe.COLOR_DODGE,$0],[pe.DARKEN,X0],[pe.DIFFERENCE,Q0],[pe.DIVIDE,K0],[pe.DST,null],[pe.EXCLUSION,J0],[pe.HARD_LIGHT,em],[pe.HARD_MIX,tm],[pe.HUE,sm],[pe.INVERT,nm],[pe.INVERT_RGB,im],[pe.LIGHTEN,rm],[pe.LINEAR_BURN,om],[pe.LINEAR_DODGE,am],[pe.LINEAR_LIGHT,cm],[pe.LUMINOSITY,lm],[pe.MULTIPLY,um],[pe.NEGATION,hm],[pe.NORMAL,dm],[pe.OVERLAY,fm],[pe.PIN_LIGHT,pm],[pe.REFLECT,mm],[pe.SATURATION,_m],[pe.SCREEN,gm],[pe.SOFT_LIGHT,vm],[pe.SRC,ym],[pe.SUBTRACT,xm],[pe.VIVID_LIGHT,Tm]]),wm=class extends ac{constructor(n,e=1){super(),this._blendFunction=n,this.opacity=new he(e)}getOpacity(){return this.opacity.value}setOpacity(n){this.opacity.value=n}get blendFunction(){return this._blendFunction}set blendFunction(n){this._blendFunction=n,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(n){this.blendFunction=n}getShaderCode(){return km.get(this.blendFunction)}},Gi=class extends ac{constructor(e,t,{attributes:s=xs.NONE,blendFunction:i=pe.NORMAL,defines:r=new Map,uniforms:o=new Map,extensions:a=null,vertexShader:c=null}={}){super(),this.name=e,this.renderer=null,this.attributes=s,this.fragmentShader=t,this.vertexShader=c,this.defines=r,this.uniforms=o,this.extensions=a,this.blendMode=new wm(i),this.blendMode.addEventListener("change",l=>this.setChanged()),this._inputColorSpace=zo,this._outputColorSpace=zu}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(e){this._inputColorSpace=e,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e,this.setChanged()}set mainScene(e){}set mainCamera(e){}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e,t=fi){}update(e,t,s){}setSize(e,t){}initialize(e,t,s){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof At||t instanceof Mu||t instanceof Pu||t instanceof dt)&&this[e].dispose()}}},Sm=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 texel=texture2D(map,uv);outputColor=vec4(texel.rgb*intensity,texel.a);}`,bm=class extends Gi{constructor({blendFunction:n=pe.SCREEN,luminanceThreshold:e=.9,luminanceSmoothing:t=.025,mipmapBlur:s=!1,intensity:i=1,radius:r=.85,levels:o=8,kernelSize:a=Vo.LARGE,resolutionScale:c=.5,width:l=Be.AUTO_SIZE,height:u=Be.AUTO_SIZE,resolutionX:h=l,resolutionY:d=u}={}){super("BloomEffect",Sm,{blendFunction:n,uniforms:new Map([["map",new he(null)],["intensity",new he(i)]])}),this.renderTarget=new At(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new Gu({kernelSize:a}),this.luminancePass=new I0({colorOutput:!0}),this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothing=t,this.mipmapBlurPass=new F0,this.mipmapBlurPass.enabled=s,this.mipmapBlurPass.radius=r,this.mipmapBlurPass.levels=o,this.uniforms.get("map").value=s?this.mipmapBlurPass.texture:this.renderTarget.texture;const f=this.resolution=new Be(this,h,d,c);f.addEventListener("change",m=>this.setSize(f.baseWidth,f.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(n){this.resolution.preferredWidth=n}get height(){return this.resolution.height}set height(n){this.resolution.preferredHeight=n}get dithering(){return this.blurPass.dithering}set dithering(n){this.blurPass.dithering=n}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(n){this.blurPass.kernelSize=n}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(n){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(n){this.uniforms.get("intensity").value=n}getIntensity(){return this.intensity}setIntensity(n){this.intensity=n}getResolutionScale(){return this.resolution.scale}setResolutionScale(n){this.resolution.scale=n}update(n,e,t){const s=this.renderTarget,i=this.luminancePass;i.enabled?(i.render(n,e),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(n,i.renderTarget):this.blurPass.render(n,i.renderTarget,s)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(n,e):this.blurPass.render(n,e,s)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e),this.renderTarget.setSize(t.width,t.height),this.blurPass.resolution.copy(t),this.luminancePass.setSize(n,e),this.mipmapBlurPass.setSize(n,e)}initialize(n,e,t){this.blurPass.initialize(n,e,t),this.luminancePass.initialize(n,e,t),this.mipmapBlurPass.initialize(n,e,t),t!==void 0&&(this.renderTarget.texture.type=t,ei(n)===Je&&js(this.renderTarget.texture,Je))}},Cm=`uniform lowp sampler2D edgeTexture;uniform lowp sampler2D maskTexture;uniform vec3 visibleEdgeColor;uniform vec3 hiddenEdgeColor;uniform float pulse;uniform float edgeStrength;
#ifdef USE_PATTERN
uniform lowp sampler2D patternTexture;varying vec2 vUvPattern;
#endif
void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 edge=texture2D(edgeTexture,uv).rg;vec2 mask=texture2D(maskTexture,uv).rg;
#ifndef X_RAY
edge.y=0.0;
#endif
edge*=(edgeStrength*mask.x*pulse);vec3 color=edge.x*visibleEdgeColor+edge.y*hiddenEdgeColor;float visibilityFactor=0.0;
#ifdef USE_PATTERN
vec4 patternColor=texture2D(patternTexture,vUvPattern);
#ifdef X_RAY
float hiddenFactor=0.5;
#else
float hiddenFactor=0.0;
#endif
visibilityFactor=(1.0-mask.y>0.0)?1.0:hiddenFactor;visibilityFactor*=(1.0-mask.x)*patternColor.a;color+=visibilityFactor*patternColor.rgb;
#endif
float alpha=max(max(edge.x,edge.y),visibilityFactor);
#ifdef ALPHA
outputColor=vec4(color,alpha);
#else
outputColor=vec4(color,max(alpha,inputColor.a));
#endif
}`,Em="uniform float patternScale;varying vec2 vUvPattern;void mainSupport(const in vec2 uv){vUvPattern=uv*vec2(aspect,1.0)*patternScale;}",Om=class extends Gi{constructor(n,e,{blendFunction:t=pe.SCREEN,patternTexture:s=null,patternScale:i=1,edgeStrength:r=1,pulseSpeed:o=0,visibleEdgeColor:a=16777215,hiddenEdgeColor:c=2230538,kernelSize:l=Vo.VERY_SMALL,blur:u=!1,xRay:h=!0,multisampling:d=0,resolutionScale:f=.5,width:m=Be.AUTO_SIZE,height:p=Be.AUTO_SIZE,resolutionX:_=m,resolutionY:y=p}={}){super("OutlineEffect",Cm,{uniforms:new Map([["maskTexture",new he(null)],["edgeTexture",new he(null)],["edgeStrength",new he(r)],["visibleEdgeColor",new he(new ys(a))],["hiddenEdgeColor",new he(new ys(c))],["pulse",new he(1)],["patternScale",new he(i)],["patternTexture",new he(null)]])}),this.blendMode.addEventListener("change",g=>{this.blendMode.blendFunction===pe.ALPHA?this.defines.set("ALPHA","1"):this.defines.delete("ALPHA"),this.setChanged()}),this.blendMode.blendFunction=t,this.patternTexture=s,this.xRay=h,this.scene=n,this.camera=e,this.renderTargetMask=new At(1,1),this.renderTargetMask.samples=d,this.renderTargetMask.texture.name="Outline.Mask",this.uniforms.get("maskTexture").value=this.renderTargetMask.texture,this.renderTargetOutline=new At(1,1,{depthBuffer:!1}),this.renderTargetOutline.texture.name="Outline.Edges",this.uniforms.get("edgeTexture").value=this.renderTargetOutline.texture,this.clearPass=new hc,this.clearPass.overrideClearColor=new ys(0),this.clearPass.overrideClearAlpha=1,this.depthPass=new M0(n,e),this.maskPass=new jo(n,e,new c0(this.depthPass.texture,e));const k=this.maskPass.clearPass;k.overrideClearColor=new ys(16777215),k.overrideClearAlpha=1,this.blurPass=new Gu({resolutionScale:f,resolutionX:_,resolutionY:y,kernelSize:l}),this.blurPass.enabled=u;const w=this.blurPass.resolution;w.addEventListener("change",g=>this.setSize(w.baseWidth,w.baseHeight)),this.outlinePass=new L0(new k0);const v=this.outlinePass.fullscreenMaterial;v.inputBuffer=this.renderTargetMask.texture,this.time=0,this.forceUpdate=!0,this.selection=new H0,this.selection.layer=10,this.pulseSpeed=o}set mainScene(n){this.scene=n,this.depthPass.mainScene=n,this.maskPass.mainScene=n}set mainCamera(n){this.camera=n,this.depthPass.mainCamera=n,this.maskPass.mainCamera=n,this.maskPass.overrideMaterial.copyCameraSettings(n)}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.getResolution()}get multisampling(){return this.renderTargetMask.samples}set multisampling(n){this.renderTargetMask.samples=n,this.renderTargetMask.dispose()}get patternScale(){return this.uniforms.get("patternScale").value}set patternScale(n){this.uniforms.get("patternScale").value=n}get edgeStrength(){return this.uniforms.get("edgeStrength").value}set edgeStrength(n){this.uniforms.get("edgeStrength").value=n}get visibleEdgeColor(){return this.uniforms.get("visibleEdgeColor").value}set visibleEdgeColor(n){this.uniforms.get("visibleEdgeColor").value=n}get hiddenEdgeColor(){return this.uniforms.get("hiddenEdgeColor").value}set hiddenEdgeColor(n){this.uniforms.get("hiddenEdgeColor").value=n}getBlurPass(){return this.blurPass}getSelection(){return this.selection}getPulseSpeed(){return this.pulseSpeed}setPulseSpeed(n){this.pulseSpeed=n}get width(){return this.resolution.width}set width(n){this.resolution.preferredWidth=n}get height(){return this.resolution.height}set height(n){this.resolution.preferredHeight=n}get selectionLayer(){return this.selection.layer}set selectionLayer(n){this.selection.layer=n}get dithering(){return this.blurPass.dithering}set dithering(n){this.blurPass.dithering=n}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(n){this.blurPass.kernelSize=n}get blur(){return this.blurPass.enabled}set blur(n){this.blurPass.enabled=n}get xRay(){return this.defines.has("X_RAY")}set xRay(n){this.xRay!==n&&(n?this.defines.set("X_RAY","1"):this.defines.delete("X_RAY"),this.setChanged())}isXRayEnabled(){return this.xRay}setXRayEnabled(n){this.xRay=n}get patternTexture(){return this.uniforms.get("patternTexture").value}set patternTexture(n){n!==null?(n.wrapS=n.wrapT=op,this.defines.set("USE_PATTERN","1"),this.setVertexShader(Em)):(this.defines.delete("USE_PATTERN"),this.setVertexShader(null)),this.uniforms.get("patternTexture").value=n,this.setChanged()}setPatternTexture(n){this.patternTexture=n}getResolutionScale(){return this.resolution.scale}setResolutionScale(n){this.resolution.scale=n}setSelection(n){return this.selection.set(n),this}clearSelection(){return this.selection.clear(),this}selectObject(n){return this.selection.add(n),this}deselectObject(n){return this.selection.delete(n),this}update(n,e,t){const s=this.scene,i=this.camera,r=this.selection,a=this.uniforms.get("pulse"),c=s.background,l=i.layers.mask;(this.forceUpdate||r.size>0)&&(s.background=null,a.value=1,this.pulseSpeed>0&&(a.value=Math.cos(this.time*this.pulseSpeed*10)*.375+.625),this.time+=t,r.setVisible(!1),this.depthPass.render(n),r.setVisible(!0),i.layers.set(r.layer),this.maskPass.render(n,this.renderTargetMask),i.layers.mask=l,s.background=c,this.outlinePass.render(n,null,this.renderTargetOutline),this.blurPass.enabled&&this.blurPass.render(n,this.renderTargetOutline,this.renderTargetOutline)),this.forceUpdate=r.size>0}setSize(n,e){this.blurPass.setSize(n,e),this.renderTargetMask.setSize(n,e);const t=this.resolution;t.setBaseSize(n,e);const s=t.width,i=t.height;this.depthPass.setSize(s,i),this.renderTargetOutline.setSize(s,i),this.outlinePass.fullscreenMaterial.setSize(s,i)}initialize(n,e,t){this.blurPass.initialize(n,e,ks),t!==void 0&&(this.depthPass.initialize(n,e,t),this.maskPass.initialize(n,e,t),this.outlinePass.initialize(n,e,t))}},Am=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,Mm=class extends Gi{constructor({blendFunction:n,technique:e=qr.DEFAULT,eskil:t=!1,offset:s=.5,darkness:i=.5}={}){super("VignetteEffect",Am,{blendFunction:n,defines:new Map([["VIGNETTE_TECHNIQUE",e.toFixed(0)]]),uniforms:new Map([["offset",new he(s)],["darkness",new he(i)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(n){this.technique!==n&&(this.defines.set("VIGNETTE_TECHNIQUE",n.toFixed(0)),this.setChanged())}get eskil(){return this.technique===qr.ESKIL}set eskil(n){this.technique=n?qr.ESKIL:qr.DEFAULT}getTechnique(){return this.technique}setTechnique(n){this.technique=n}get offset(){return this.uniforms.get("offset").value}set offset(n){this.uniforms.get("offset").value=n}getOffset(){return this.offset}setOffset(n){this.offset=n}get darkness(){return this.uniforms.get("darkness").value}set darkness(n){this.uniforms.get("darkness").value=n}getDarkness(){return this.darkness}setDarkness(n){this.darkness=n}};const Wu=D.createContext(null),Al=n=>(n.getAttributes()&xs.CONVOLUTION)===xs.CONVOLUTION,Pm=ro.memo(D.forwardRef(({children:n,camera:e,scene:t,resolutionScale:s,enabled:i=!0,renderPriority:r=1,autoClear:o=!0,depthBuffer:a,disableNormalPass:c,stencilBuffer:l,multisampling:u=8,frameBufferType:h=up},d)=>{const{gl:f,scene:m,camera:p,size:_}=Pe(),y=t||m,k=e||p,[w,v,g]=D.useMemo(()=>{const b=Np(),A=new V0(f,{depthBuffer:a,stencilBuffer:l,multisampling:u>0&&b?u:0,frameBufferType:h});A.addPass(new jo(y,k));let R=null,M=null;return c||(M=new U0(y,k),M.enabled=!1,A.addPass(M),s!==void 0&&b&&(R=new P0({normalBuffer:M.texture,resolutionScale:s}),R.enabled=!1,A.addPass(R))),[A,M,R]},[k,f,a,l,u,h,y,c,s]);D.useEffect(()=>w==null?void 0:w.setSize(_.width,_.height),[w,_]),Bt((b,A)=>{if(i){const R=f.autoClear;f.autoClear=o,l&&!o&&f.clearStencil(),w.render(A),f.autoClear=R}},i?r:0);const S=D.useRef(null),T=Rf(S);D.useLayoutEffect(()=>{const b=[];if(S.current&&T.current&&w){const A=T.current.objects;for(let R=0;R<A.length;R++){const M=A[R];if(M instanceof Gi){const L=[M];if(!Al(M)){let Y=null;for(;(Y=A[R+1])instanceof Gi&&!Al(Y);)L.push(Y),R++}const q=new R0(k,...L);b.push(q)}else M instanceof dt&&b.push(M)}for(const R of b)w==null||w.addPass(R);v&&(v.enabled=!0),g&&(g.enabled=!0)}return()=>{for(const A of b)w==null||w.removePass(A);v&&(v.enabled=!1),g&&(g.enabled=!1)}},[w,n,k,v,g,T]);const x=D.useMemo(()=>({composer:w,normalPass:v,downSamplingPass:g,resolutionScale:s,camera:k,scene:y}),[w,v,g,s,k,y]);return D.useImperativeHandle(d,()=>w,[w]),U.jsx(Wu.Provider,{value:x,children:U.jsx("group",{ref:S,children:n})})})),Ml=n=>typeof n=="object"&&n!=null&&"current"in n?n.current:n;let Dm=0;const Pl=new WeakMap,Yu=(n,e)=>ro.forwardRef(function({blendFunction:s=e==null?void 0:e.blendFunction,opacity:i=e==null?void 0:e.opacity,...r},o){let a=Pl.get(n);if(!a){const u=`@react-three/postprocessing/${n.name}-${Dm++}`;oc({[u]:n}),Pl.set(n,a=u)}const c=Pe(u=>u.camera),l=ro.useMemo(()=>{var u,h;return[...(u=e==null?void 0:e.args)!=null?u:[],...(h=r.args)!=null?h:[{...e,...r}]]},[JSON.stringify(r)]);return U.jsx(a,{camera:c,"blendMode-blendFunction":s,"blendMode-opacity-value":i,...r,ref:o,args:l})}),Rm=Yu(bm,{blendFunction:pe.ADD}),Im=D.forwardRef(function({selection:e=[],selectionLayer:t=10,blendFunction:s,patternTexture:i,edgeStrength:r,pulseSpeed:o,visibleEdgeColor:a,hiddenEdgeColor:c,width:l,height:u,kernelSize:h,blur:d,xRay:f,...m},p){const _=Pe(g=>g.invalidate),{scene:y,camera:k}=D.useContext(Wu),w=D.useMemo(()=>new Om(y,k,{blendFunction:s,patternTexture:i,edgeStrength:r,pulseSpeed:o,visibleEdgeColor:a,hiddenEdgeColor:c,width:l,height:u,kernelSize:h,blur:d,xRay:f,...m}),[s,d,k,r,u,c,h,i,o,y,a,l,f]),v=D.useContext(uc);return D.useEffect(()=>{if(!v&&e)return w.selection.set(Array.isArray(e)?e.map(Ml):[Ml(e)]),_(),()=>{w.selection.clear(),_()}},[w,e,v,_]),D.useEffect(()=>{w.selectionLayer=t,_()},[w,_,t]),D.useRef(),D.useEffect(()=>{var g;if(v&&v.enabled&&(g=v.selected)!=null&&g.length)return w.selection.set(v.selected),_(),()=>{w.selection.clear(),_()}},[v,w.selection,_]),D.useEffect(()=>()=>{w.dispose()},[w]),U.jsx("primitive",{ref:p,object:w})}),Nm=Yu(Mm),Fm={isUserDragging:!1,isUserScrolling:!1,userMovedCamera:!1,isUserScrollingOnHtmlPanel:!1},Hs=ku(n=>({...Fm,setIsUserDragging:e=>n({isUserDragging:e}),setIsUserScrolling:e=>n({isUserScrolling:e}),setUserMovedCamera:e=>n({userMovedCamera:e}),setIsUserScrollingOnHtmlPanel:e=>n({isUserScrollingOnHtmlPanel:e})})),Um=()=>{const[n,e]=D.useState(""),t=D.useRef(null),{fetchData:s,setAbortRequests:i,seedQuestions:r}=On(v=>v),[o]=wu(v=>[v.setBudget]),{setUniverseQuestionIsOpen:a,setSidebarOpen:c,setShowCollapseButton:l}=vr(v=>({setUniverseQuestionIsOpen:v.setUniverseQuestionIsOpen,setSidebarOpen:v.setSidebarOpen,setShowCollapseButton:v.setShowCollapseButton})),u=pf(v=>v.resetAiSummaryAnswer),[h,d]=D.useState([]);D.useEffect(()=>{r&&d(k(r).slice(0,4))},[r]),D.useEffect(()=>{t.current&&t.current.focus()},[]);const f=async v=>{v&&(u(),a(),c(!0),l(!0)),await s(o,i,v)},m=!!n.trim().length,p=async v=>{v.keyCode===13&&v.shiftKey===!1&&m&&(v.preventDefault(),f(n))},_=async v=>{e(v),await f(v)},y=()=>{a(),c(!0),l(!0)},k=v=>{const g=[...v];let S=g.length-1;for(;S>0;){const T=Math.floor(Math.random()*(S+1));[g[S],g[T]]=[g[T],g[S]],S-=1}return g},w=!!n&&n.trim().length>0;return U.jsxs(zm,{children:["Ideas have shapes",U.jsxs(Bm,{onKeyDown:p,py:12,tabIndex:-1,children:[U.jsx(Lm,{ref:t,onChange:v=>e(v.target.value),placeholder:"What do you want to know?",value:n}),U.jsx(Vm,{color:"secondary",disabled:!w,onClick:()=>f(n),variant:"contained",children:w?U.jsxs(U.Fragment,{children:["Search ",U.jsx(ll,{})]}):U.jsx(ll,{})})]}),h.length>0&&U.jsx(Hm,{children:h.map(v=>U.jsxs(qm,{onClick:()=>_(v),children:[U.jsx(If,{}),v]},v))}),U.jsx(jm,{"data-testid":"explore-graph-btn",onClick:y,startIcon:U.jsx(Nf,{}),children:"Explore Graph"})]})},Lm=Ye(yp).attrs({maxRows:3})`
  background: ${Oe.BG1};
  max-width: 700px;
  width: 700px;
  color: ${Oe.white};
  padding: 0 16px 0 16px;
  overflow-y: auto !important;
  border: none;
  resize: none;
  outline: none;
  border-radius: 12px;
  font-family: 'Barlow';
  display: flex;
  align-items: center;
  text-align: justify;
  font-size: 16px;
  font-weight: 400;

  &:-moz-placeholder, /* Firefox 18- */
  &::-moz-placeholder, /* Firefox 19+ */
  &:-ms-input-placeholder, /* IE 10+ */
  &::-webkit-input-placeholder, /* Webkit based */
  &::placeholder {
    color: #0bf;
  }

  &::-webkit-scrollbar {
    width: 3px;
  }

  &::-webkit-scrollbar-track {
    border-radius: 12px;
    margin: 13px;
    overflow-y: hidden;
  }
`,Bm=Ye(Os)`
  position: relative;
  margin-top: 30px;
  background: ${Oe.BG1};
  max-width: 702px;
  width: 702px;
  color: ${Oe.white};
  min-height: 150px;
  border: 1px solid ${Oe.modalShield};
  resize: none;
  outline: none;
  border-radius: 12px;
  box-shadow: 0px 1px 6px 0px rgba(0, 0, 0, 0.5);
`,zm=Ye(Os)`
  background: #16161de3;
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  top: 0;
  color: #fff;
  align-items: center;
  justify-content: center;
  font-size: 32px;
  font-style: normal;
  font-weight: 700;
  line-height: 16px;
  font-family: 'Barlow';
`,Vm=Ye(Iu)`
  && {
    position: absolute;
    bottom: 16px;
    right: 16px;
    height: 32px;
    border-radius: 16px;
    min-width: 32px;
  }

  &&.MuiButton-root {
    padding: 0 10px 0 12px;
  }

  svg {
    margin-top: 1px;
    width: 11px;
    height: 11px;
  }
`,jm=Ye(Iu)`
  && {
    position: absolute;
    bottom: 20px;
    right: 20px;
    border-radius: 16px;
  }
`,Hm=Ye.div`
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
  margin-top: 20px;
  max-width: 702px;
  width: 100%;
`,qm=Ye.div`
  background: ${Oe.BG1};
  color: ${Oe.white};
  padding: 15px 12px;
  border-radius: 8px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: flex-start;
  text-align: left;
  font-family: Barlow;
  font-size: 14px;
  font-weight: 400;
  gap: 10px;
  &:hover {
    background: ${Oe.SEEDQUESTION_HOVER};
  }

  &:active {
    background: ${Oe.SEEDQUESTION};
  }
  svg {
    width: 20px;
    height: 20px;
  }

  path {
    fill: ${Oe.modalWhiteOverlayBg};
  }
`,zi=new le(0,0,0),Dl=100,Gm=600,Wm=2e3,va={x:172.7392402058252,y:-239.04675366094037,z:-2e3},Zu="14.8.49",Rl=(n,e,t)=>({endTime:e,insertTime:t,type:"exponentialRampToValue",value:n}),Il=(n,e,t)=>({endTime:e,insertTime:t,type:"linearRampToValue",value:n}),Ia=(n,e)=>({startTime:e,type:"setValue",value:n}),$u=(n,e,t)=>({duration:t,startTime:e,type:"setValueCurve",values:n}),Xu=(n,e,{startTime:t,target:s,timeConstant:i})=>s+(e-s)*Math.exp((t-n)/i),Hn=n=>n.type==="exponentialRampToValue",ao=n=>n.type==="linearRampToValue",Us=n=>Hn(n)||ao(n),dc=n=>n.type==="setValue",_s=n=>n.type==="setValueCurve",co=(n,e,t,s)=>{const i=n[e];return i===void 0?s:Us(i)||dc(i)?i.value:_s(i)?i.values[i.values.length-1]:Xu(t,co(n,e-1,i.startTime,s),i)},Nl=(n,e,t,s,i)=>t===void 0?[s.insertTime,i]:Us(t)?[t.endTime,t.value]:dc(t)?[t.startTime,t.value]:_s(t)?[t.startTime+t.duration,t.values[t.values.length-1]]:[t.startTime,co(n,e-1,t.startTime,i)],Na=n=>n.type==="cancelAndHold",Fa=n=>n.type==="cancelScheduledValues",Ns=n=>Na(n)||Fa(n)?n.cancelTime:Hn(n)||ao(n)?n.endTime:n.startTime,Fl=(n,e,t,{endTime:s,value:i})=>t===i?i:0<t&&0<i||t<0&&i<0?t*(i/t)**((n-e)/(s-e)):0,Ul=(n,e,t,{endTime:s,value:i})=>t+(n-e)/(s-e)*(i-t),Ym=(n,e)=>{const t=Math.floor(e),s=Math.ceil(e);return t===s?n[t]:(1-(e-t))*n[t]+(1-(s-e))*n[s]},Zm=(n,{duration:e,startTime:t,values:s})=>{const i=(n-t)/e*(s.length-1);return Ym(s,i)},Gr=n=>n.type==="setTarget";class $m{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const t=Ns(e);if(Na(e)||Fa(e)){const s=this._automationEvents.findIndex(r=>Fa(e)&&_s(r)?r.startTime+r.duration>=t:Ns(r)>=t),i=this._automationEvents[s];if(s!==-1&&(this._automationEvents=this._automationEvents.slice(0,s)),Na(e)){const r=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&Us(i)){if(r!==void 0&&Gr(r))throw new Error("The internal list is malformed.");const o=r===void 0?i.insertTime:_s(r)?r.startTime+r.duration:Ns(r),a=r===void 0?this._defaultValue:_s(r)?r.values[r.values.length-1]:r.value,c=Hn(i)?Fl(t,o,a,i):Ul(t,o,a,i),l=Hn(i)?Rl(c,t,this._currenTime):Il(c,t,this._currenTime);this._automationEvents.push(l)}if(r!==void 0&&Gr(r)&&this._automationEvents.push(Ia(this.getValue(t),t)),r!==void 0&&_s(r)&&r.startTime+r.duration>t){const o=t-r.startTime,a=(r.values.length-1)/r.duration,c=Math.max(2,1+Math.ceil(o*a)),l=o/(c-1)*a,u=r.values.slice(0,c);if(l<1)for(let h=1;h<c;h+=1){const d=l*h%1;u[h]=r.values[h-1]*(1-d)+r.values[h]*d}this._automationEvents[this._automationEvents.length-1]=$u(u,r.startTime,o)}}}else{const s=this._automationEvents.findIndex(o=>Ns(o)>t),i=s===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[s-1];if(i!==void 0&&_s(i)&&Ns(i)+i.duration>t)return!1;const r=Hn(e)?Rl(e.value,e.endTime,this._currenTime):ao(e)?Il(e.value,t,this._currenTime):e;if(s===-1)this._automationEvents.push(r);else{if(_s(e)&&t+e.duration>Ns(this._automationEvents[s]))return!1;this._automationEvents.splice(s,0,r)}}return!0}flush(e){const t=this._automationEvents.findIndex(s=>Ns(s)>e);if(t>1){const s=this._automationEvents.slice(t-1),i=s[0];Gr(i)&&s.unshift(Ia(co(this._automationEvents,t-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=s}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const t=this._automationEvents.findIndex(o=>Ns(o)>e),s=this._automationEvents[t],i=(t===-1?this._automationEvents.length:t)-1,r=this._automationEvents[i];if(r!==void 0&&Gr(r)&&(s===void 0||!Us(s)||s.insertTime>e))return Xu(e,co(this._automationEvents,i-1,r.startTime,this._defaultValue),r);if(r!==void 0&&dc(r)&&(s===void 0||!Us(s)))return r.value;if(r!==void 0&&_s(r)&&(s===void 0||!Us(s)||r.startTime+r.duration>e))return e<r.startTime+r.duration?Zm(e,r):r.values[r.values.length-1];if(r!==void 0&&Us(r)&&(s===void 0||!Us(s)))return r.value;if(s!==void 0&&Hn(s)){const[o,a]=Nl(this._automationEvents,i,r,s,this._defaultValue);return Fl(e,o,a,s)}if(s!==void 0&&ao(s)){const[o,a]=Nl(this._automationEvents,i,r,s,this._defaultValue);return Ul(e,o,a,s)}return this._defaultValue}}const Xm=n=>({cancelTime:n,type:"cancelAndHold"}),Qm=n=>({cancelTime:n,type:"cancelScheduledValues"}),Km=(n,e)=>({endTime:e,type:"exponentialRampToValue",value:n}),Jm=(n,e)=>({endTime:e,type:"linearRampToValue",value:n}),e_=(n,e,t)=>({startTime:e,target:n,timeConstant:t,type:"setTarget"}),t_=()=>new DOMException("","AbortError"),s_=n=>(e,t,[s,i,r],o)=>{n(e[i],[t,s,r],a=>a[0]===t&&a[1]===s,o)},n_=n=>(e,t,s)=>{const i=[];for(let r=0;r<s.numberOfInputs;r+=1)i.push(new Set);n.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},i_=n=>(e,t)=>{n.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},ti=new WeakSet,Qu=new WeakMap,fc=new WeakMap,Ku=new WeakMap,pc=new WeakMap,Ho=new WeakMap,Ju=new WeakMap,Ua=new WeakMap,La=new WeakMap,Ba=new WeakMap,eh={construct(){return eh}},r_=n=>{try{const e=new Proxy(n,eh);new e}catch{return!1}return!0},Ll=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,Bl=(n,e)=>{const t=[];let s=n.replace(/^[\s]+/,""),i=s.match(Ll);for(;i!==null;){const r=i[1].slice(1,-1),o=i[0].replace(/([\s]+)?;?$/,"").replace(r,new URL(r,e).toString());t.push(o),s=s.slice(i[0].length).replace(/^[\s]+/,""),i=s.match(Ll)}return[t.join(";"),s]},zl=n=>{if(n!==void 0&&!Array.isArray(n))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},Vl=n=>{if(!r_(n))throw new TypeError("The given value for processorCtor should be a constructor.");if(n.prototype===null||typeof n.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},o_=(n,e,t,s,i,r,o,a,c,l,u,h,d)=>{let f=0;return(m,p,_={credentials:"omit"})=>{const y=u.get(m);if(y!==void 0&&y.has(p))return Promise.resolve();const k=l.get(m);if(k!==void 0){const g=k.get(p);if(g!==void 0)return g}const w=r(m),v=w.audioWorklet===void 0?i(p).then(([g,S])=>{const[T,x]=Bl(g,S),b=`${T};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${x}
})})(window,'_AWGS')`;return t(b)}).then(()=>{const g=d._AWGS.pop();if(g===void 0)throw new SyntaxError;s(w.currentTime,w.sampleRate,()=>g(class{},void 0,(S,T)=>{if(S.trim()==="")throw e();const x=La.get(w);if(x!==void 0){if(x.has(S))throw e();Vl(T),zl(T.parameterDescriptors),x.set(S,T)}else Vl(T),zl(T.parameterDescriptors),La.set(w,new Map([[S,T]]))},w.sampleRate,void 0,void 0))}):Promise.all([i(p),Promise.resolve(n(h,h))]).then(([[g,S],T])=>{const x=f+1;f=x;const[b,A]=Bl(g,S),q=`${b};((AudioWorkletProcessor,registerProcessor)=>{${A}
})(${T?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${T?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${T?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${x}',class extends AudioWorkletProcessor{process(){return !1}})`,Y=new Blob([q],{type:"application/javascript; charset=utf-8"}),W=URL.createObjectURL(Y);return w.audioWorklet.addModule(W,_).then(()=>{if(a(w))return w;const V=o(w);return V.audioWorklet.addModule(W,_).then(()=>V)}).then(V=>{if(c===null)throw new SyntaxError;try{new c(V,`__sac${x}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(W))});return k===void 0?l.set(m,new Map([[p,v]])):k.set(p,v),v.then(()=>{const g=u.get(m);g===void 0?u.set(m,new Set([p])):g.add(p)}).finally(()=>{const g=l.get(m);g!==void 0&&g.delete(p)}),v}},Yt=(n,e)=>{const t=n.get(e);if(t===void 0)throw new Error("A value with the given key could not be found.");return t},qo=(n,e)=>{const t=Array.from(n).filter(e);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");const[s]=t;return n.delete(s),s},th=(n,e,t,s)=>{const i=Yt(n,e),r=qo(i,o=>o[0]===t&&o[1]===s);return i.size===0&&n.delete(e),r},kr=n=>Yt(Ju,n),si=n=>{if(ti.has(n))throw new Error("The AudioNode is already stored.");ti.add(n),kr(n).forEach(e=>e(!0))},sh=n=>"port"in n,wr=n=>{if(!ti.has(n))throw new Error("The AudioNode is not stored.");ti.delete(n),kr(n).forEach(e=>e(!1))},za=(n,e)=>{!sh(n)&&e.every(t=>t.size===0)&&wr(n)},a_=(n,e,t,s,i,r,o,a,c,l,u,h,d)=>{const f=new WeakMap;return(m,p,_,y,k)=>{const{activeInputs:w,passiveInputs:v}=r(p),{outputs:g}=r(m),S=a(m),T=x=>{const b=c(p),A=c(m);if(x){const R=th(v,m,_,y);n(w,m,R,!1),!k&&!h(m)&&t(A,b,_,y),d(p)&&si(p)}else{const R=s(w,m,_,y);e(v,y,R,!1),!k&&!h(m)&&i(A,b,_,y);const M=o(p);if(M===0)u(p)&&za(p,w);else{const L=f.get(p);L!==void 0&&clearTimeout(L),f.set(p,setTimeout(()=>{u(p)&&za(p,w)},M*1e3))}}};return l(g,[p,_,y],x=>x[0]===p&&x[1]===_&&x[2]===y,!0)?(S.add(T),u(m)?n(w,m,[_,y,T],!0):e(v,y,[m,_,T],!0),!0):!1}},c_=n=>(e,t,[s,i,r],o)=>{const a=e.get(s);a===void 0?e.set(s,new Set([[i,t,r]])):n(a,[i,t,r],c=>c[0]===i&&c[1]===t,o)},l_=n=>(e,t)=>{const s=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(s).connect(e.destination);const i=()=>{t.removeEventListener("ended",i),t.disconnect(s),s.disconnect()};t.addEventListener("ended",i)},u_=n=>(e,t)=>{n(e).add(t)},h_={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},d_=(n,e,t,s,i,r)=>class extends n{constructor(a,c){const l=i(a),u={...h_,...c},h=s(l,u),d=r(l)?e():null;super(a,!1,h,d),this._nativeAnalyserNode=h}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const c=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=c,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const c=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=c,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},at=(n,e)=>n.context===e,f_=(n,e,t)=>()=>{const s=new WeakMap,i=async(r,o)=>{let a=e(r);if(!at(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=n(o,l)}return s.set(o,a),await t(r,o,a),a};return{render(r,o){const a=s.get(o);return a!==void 0?Promise.resolve(a):i(r,o)}}},lo=n=>{try{n.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},ls=()=>new DOMException("","IndexSizeError"),mc=n=>{n.getChannelData=(e=>t=>{try{return e.call(n,t)}catch(s){throw s.code===12?ls():s}})(n.getChannelData)},p_={numberOfChannels:1},m_=(n,e,t,s,i,r,o,a)=>{let c=null;return class nh{constructor(u){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:h,numberOfChannels:d,sampleRate:f}={...p_,...u};c===null&&(c=new i(1,1,44100));const m=s!==null&&e(r,r)?new s({length:h,numberOfChannels:d,sampleRate:f}):c.createBuffer(d,h,f);if(m.numberOfChannels===0)throw t();return typeof m.copyFromChannel!="function"?(o(m),mc(m)):e(lo,()=>lo(m))||a(m),n.add(m),m}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===nh.prototype||n.has(u)}}},mt=-34028234663852886e22,ct=-mt,Ts=n=>ti.has(n),__={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},g_=(n,e,t,s,i,r,o,a)=>class extends n{constructor(l,u){const h=r(l),d={...__,...u},f=i(h,d),m=o(h),p=m?e():null;super(l,!1,f,p),this._audioBufferSourceNodeRenderer=p,this._isBufferNullified=!1,this._isBufferSet=d.buffer!==null,this._nativeAudioBufferSourceNode=f,this._onended=null,this._playbackRate=t(this,m,f.playbackRate,ct,mt)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(l){if(this._nativeAudioBufferSourceNode.buffer=l,l!==null){if(this._isBufferSet)throw s();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(l){this._nativeAudioBufferSourceNode.loop=l}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(l){this._nativeAudioBufferSourceNode.loopEnd=l}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(l){this._nativeAudioBufferSourceNode.loopStart=l}get onended(){return this._onended}set onended(l){const u=typeof l=="function"?a(this,l):null;this._nativeAudioBufferSourceNode.onended=u;const h=this._nativeAudioBufferSourceNode.onended;this._onended=h!==null&&h===u?l:h}get playbackRate(){return this._playbackRate}start(l=0,u=0,h){if(this._nativeAudioBufferSourceNode.start(l,u,h),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=h===void 0?[l,u]:[l,u,h]),this.context.state!=="closed"){si(this);const d=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",d),Ts(this)&&wr(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",d)}}stop(l=0){this._nativeAudioBufferSourceNode.stop(l),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=l)}},v_=(n,e,t,s,i)=>()=>{const r=new WeakMap;let o=null,a=null;const c=async(l,u)=>{let h=t(l);const d=at(h,u);if(!d){const f={buffer:h.buffer,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,loop:h.loop,loopEnd:h.loopEnd,loopStart:h.loopStart,playbackRate:h.playbackRate.value};h=e(u,f),o!==null&&h.start(...o),a!==null&&h.stop(a)}return r.set(u,h),d?await n(u,l.playbackRate,h.playbackRate):await s(u,l.playbackRate,h.playbackRate),await i(l,u,h),h};return{set start(l){o=l},set stop(l){a=l},render(l,u){const h=r.get(u);return h!==void 0?Promise.resolve(h):c(l,u)}}},y_=n=>"playbackRate"in n,x_=n=>"frequency"in n&&"gain"in n,T_=n=>"offset"in n,k_=n=>!("frequency"in n)&&"gain"in n,w_=n=>"detune"in n&&"frequency"in n,S_=n=>"pan"in n,ut=n=>Yt(Qu,n),Sr=n=>Yt(Ku,n),Va=(n,e)=>{const{activeInputs:t}=ut(n);t.forEach(i=>i.forEach(([r])=>{e.includes(n)||Va(r,[...e,n])}));const s=y_(n)?[n.playbackRate]:sh(n)?Array.from(n.parameters.values()):x_(n)?[n.Q,n.detune,n.frequency,n.gain]:T_(n)?[n.offset]:k_(n)?[n.gain]:w_(n)?[n.detune,n.frequency]:S_(n)?[n.pan]:[];for(const i of s){const r=Sr(i);r!==void 0&&r.activeInputs.forEach(([o])=>Va(o,e))}Ts(n)&&wr(n)},ih=n=>{Va(n.destination,[])},b_=n=>n===void 0||typeof n=="number"||typeof n=="string"&&(n==="balanced"||n==="interactive"||n==="playback"),C_=(n,e,t,s,i,r,o,a,c)=>class extends n{constructor(u={}){if(c===null)throw new Error("Missing the native AudioContext constructor.");let h;try{h=new c(u)}catch(m){throw m.code===12&&m.message==="sampleRate is not in range"?t():m}if(h===null)throw s();if(!b_(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&h.sampleRate!==u.sampleRate)throw t();super(h,2);const{latencyHint:d}=u,{sampleRate:f}=h;if(this._baseLatency=typeof h.baseLatency=="number"?h.baseLatency:d==="balanced"?512/f:d==="interactive"||d===void 0?256/f:d==="playback"?1024/f:Math.max(2,Math.min(128,Math.round(d*f/128)))*128/f,this._nativeAudioContext=h,c.name==="webkitAudioContext"?(this._nativeGainNode=h.createGain(),this._nativeOscillatorNode=h.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(h.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,h.state==="running"){this._state="suspended";const m=()=>{this._state==="suspended"&&(this._state=null),h.removeEventListener("statechange",m)};h.addEventListener("statechange",m)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),ih(this)}))}createMediaElementSource(u){return new i(this,{mediaElement:u})}createMediaStreamDestination(){return new r(this)}createMediaStreamSource(u){return new o(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new a(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,h)=>{const d=()=>{this._nativeAudioContext.removeEventListener("statechange",d),this._nativeAudioContext.state==="running"?u():this.resume().then(u,h)};this._nativeAudioContext.addEventListener("statechange",d)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?e():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?e():u})}},E_=(n,e,t,s,i,r,o,a)=>class extends n{constructor(l,u){const h=r(l),d=o(h),f=i(h,u,d),m=d?e(a):null;super(l,!1,f,m),this._isNodeOfNativeOfflineAudioContext=d,this._nativeAudioDestinationNode=f}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(l){if(this._isNodeOfNativeOfflineAudioContext)throw s();if(l>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=l}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(l){if(this._isNodeOfNativeOfflineAudioContext)throw s();this._nativeAudioDestinationNode.channelCountMode=l}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},O_=n=>{const e=new WeakMap,t=async(s,i)=>{const r=i.destination;return e.set(i,r),await n(s,i,r),r};return{render(s,i){const r=e.get(i);return r!==void 0?Promise.resolve(r):t(s,i)}}},A_=(n,e,t,s,i,r,o,a)=>(c,l)=>{const u=l.listener,h=()=>{const g=new Float32Array(1),S=e(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),T=o(l);let x=!1,b=[0,0,-1,0,1,0],A=[0,0,0];const R=()=>{if(x)return;x=!0;const Y=s(l,256,9,0);Y.onaudioprocess=({inputBuffer:W})=>{const V=[r(W,g,0),r(W,g,1),r(W,g,2),r(W,g,3),r(W,g,4),r(W,g,5)];V.some(($,Q)=>$!==b[Q])&&(u.setOrientation(...V),b=V);const z=[r(W,g,6),r(W,g,7),r(W,g,8)];z.some(($,Q)=>$!==A[Q])&&(u.setPosition(...z),A=z)},S.connect(Y)},M=Y=>W=>{W!==b[Y]&&(b[Y]=W,u.setOrientation(...b))},L=Y=>W=>{W!==A[Y]&&(A[Y]=W,u.setPosition(...A))},q=(Y,W,V)=>{const z=t(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:W});z.connect(S,0,Y),z.start(),Object.defineProperty(z.offset,"defaultValue",{get(){return W}});const $=n({context:c},T,z.offset,ct,mt);return a($,"value",Q=>()=>Q.call($),Q=>te=>{try{Q.call($,te)}catch(N){if(N.code!==9)throw N}R(),T&&V(te)}),$.cancelAndHoldAtTime=(Q=>T?()=>{throw i()}:(...te)=>{const N=Q.apply($,te);return R(),N})($.cancelAndHoldAtTime),$.cancelScheduledValues=(Q=>T?()=>{throw i()}:(...te)=>{const N=Q.apply($,te);return R(),N})($.cancelScheduledValues),$.exponentialRampToValueAtTime=(Q=>T?()=>{throw i()}:(...te)=>{const N=Q.apply($,te);return R(),N})($.exponentialRampToValueAtTime),$.linearRampToValueAtTime=(Q=>T?()=>{throw i()}:(...te)=>{const N=Q.apply($,te);return R(),N})($.linearRampToValueAtTime),$.setTargetAtTime=(Q=>T?()=>{throw i()}:(...te)=>{const N=Q.apply($,te);return R(),N})($.setTargetAtTime),$.setValueAtTime=(Q=>T?()=>{throw i()}:(...te)=>{const N=Q.apply($,te);return R(),N})($.setValueAtTime),$.setValueCurveAtTime=(Q=>T?()=>{throw i()}:(...te)=>{const N=Q.apply($,te);return R(),N})($.setValueCurveAtTime),$};return{forwardX:q(0,0,M(0)),forwardY:q(1,0,M(1)),forwardZ:q(2,-1,M(2)),positionX:q(6,0,L(0)),positionY:q(7,0,L(1)),positionZ:q(8,0,L(2)),upX:q(3,0,M(3)),upY:q(4,1,M(4)),upZ:q(5,0,M(5))}},{forwardX:d,forwardY:f,forwardZ:m,positionX:p,positionY:_,positionZ:y,upX:k,upY:w,upZ:v}=u.forwardX===void 0?h():u;return{get forwardX(){return d},get forwardY(){return f},get forwardZ(){return m},get positionX(){return p},get positionY(){return _},get positionZ(){return y},get upX(){return k},get upY(){return w},get upZ(){return v}}},uo=n=>"context"in n,br=n=>uo(n[0]),An=(n,e,t,s)=>{for(const i of n)if(t(i)){if(s)return!1;throw Error("The set contains at least one similar element.")}return n.add(e),!0},jl=(n,e,[t,s],i)=>{An(n,[e,t,s],r=>r[0]===e&&r[1]===t,i)},Hl=(n,[e,t,s],i)=>{const r=n.get(e);r===void 0?n.set(e,new Set([[t,s]])):An(r,[t,s],o=>o[0]===t,i)},pi=n=>"inputs"in n,ho=(n,e,t,s)=>{if(pi(e)){const i=e.inputs[s];return n.connect(i,t,0),[i,t,0]}return n.connect(e,t,s),[e,t,s]},rh=(n,e,t)=>{for(const s of n)if(s[0]===e&&s[1]===t)return n.delete(s),s;return null},M_=(n,e,t)=>qo(n,s=>s[0]===e&&s[1]===t),oh=(n,e)=>{if(!kr(n).delete(e))throw new Error("Missing the expected event listener.")},ah=(n,e,t)=>{const s=Yt(n,e),i=qo(s,r=>r[0]===t);return s.size===0&&n.delete(e),i},fo=(n,e,t,s)=>{pi(e)?n.disconnect(e.inputs[s],t,0):n.disconnect(e,t,s)},Ne=n=>Yt(fc,n),Wi=n=>Yt(pc,n),Tn=n=>Ua.has(n),eo=n=>!ti.has(n),ql=(n,e)=>new Promise(t=>{if(e!==null)t(!0);else{const s=n.createScriptProcessor(256,1,1),i=n.createGain(),r=n.createBuffer(1,2,44100),o=r.getChannelData(0);o[0]=1,o[1]=1;const a=n.createBufferSource();a.buffer=r,a.loop=!0,a.connect(s).connect(n.destination),a.connect(i),a.disconnect(i),s.onaudioprocess=c=>{const l=c.inputBuffer.getChannelData(0);Array.prototype.some.call(l,u=>u===1)?t(!0):t(!1),a.stop(),s.onaudioprocess=null,a.disconnect(s),s.disconnect(n.destination)},a.start()}}),ya=(n,e)=>{const t=new Map;for(const s of n)for(const i of s){const r=t.get(i);t.set(i,r===void 0?1:r+1)}t.forEach((s,i)=>e(i,s))},po=n=>"context"in n,P_=n=>{const e=new Map;n.connect=(t=>(s,i=0,r=0)=>{const o=po(s)?t(s,i,r):t(s,i),a=e.get(s);return a===void 0?e.set(s,[{input:r,output:i}]):a.every(c=>c.input!==r||c.output!==i)&&a.push({input:r,output:i}),o})(n.connect.bind(n)),n.disconnect=(t=>(s,i,r)=>{if(t.apply(n),s===void 0)e.clear();else if(typeof s=="number")for(const[o,a]of e){const c=a.filter(l=>l.output!==s);c.length===0?e.delete(o):e.set(o,c)}else if(e.has(s))if(i===void 0)e.delete(s);else{const o=e.get(s);if(o!==void 0){const a=o.filter(c=>c.output!==i&&(c.input!==r||r===void 0));a.length===0?e.delete(s):e.set(s,a)}}for(const[o,a]of e)a.forEach(c=>{po(o)?n.connect(o,c.output,c.input):n.connect(o,c.output)})})(n.disconnect)},D_=(n,e,t,s)=>{const{activeInputs:i,passiveInputs:r}=Sr(e),{outputs:o}=ut(n),a=kr(n),c=l=>{const u=Ne(n),h=Wi(e);if(l){const d=ah(r,n,t);jl(i,n,d,!1),!s&&!Tn(n)&&u.connect(h,t)}else{const d=M_(i,n,t);Hl(r,d,!1),!s&&!Tn(n)&&u.disconnect(h,t)}};return An(o,[e,t],l=>l[0]===e&&l[1]===t,!0)?(a.add(c),Ts(n)?jl(i,n,[t,c],!0):Hl(r,[n,t,c],!0),!0):!1},R_=(n,e,t,s)=>{const{activeInputs:i,passiveInputs:r}=ut(e),o=rh(i[s],n,t);return o===null?[th(r,n,t,s)[2],!1]:[o[2],!0]},I_=(n,e,t)=>{const{activeInputs:s,passiveInputs:i}=Sr(e),r=rh(s,n,t);return r===null?[ah(i,n,t)[1],!1]:[r[2],!0]},_c=(n,e,t,s,i)=>{const[r,o]=R_(n,t,s,i);if(r!==null&&(oh(n,r),o&&!e&&!Tn(n)&&fo(Ne(n),Ne(t),s,i)),Ts(t)){const{activeInputs:a}=ut(t);za(t,a)}},gc=(n,e,t,s)=>{const[i,r]=I_(n,t,s);i!==null&&(oh(n,i),r&&!e&&!Tn(n)&&Ne(n).disconnect(Wi(t),s))},N_=(n,e)=>{const t=ut(n),s=[];for(const i of t.outputs)br(i)?_c(n,e,...i):gc(n,e,...i),s.push(i[0]);return t.outputs.clear(),s},F_=(n,e,t)=>{const s=ut(n),i=[];for(const r of s.outputs)r[1]===t&&(br(r)?_c(n,e,...r):gc(n,e,...r),i.push(r[0]),s.outputs.delete(r));return i},U_=(n,e,t,s,i)=>{const r=ut(n);return Array.from(r.outputs).filter(o=>o[0]===t&&(s===void 0||o[1]===s)&&(i===void 0||o[2]===i)).map(o=>(br(o)?_c(n,e,...o):gc(n,e,...o),r.outputs.delete(o),o[0]))},L_=(n,e,t,s,i,r,o,a,c,l,u,h,d,f,m,p)=>class extends l{constructor(y,k,w,v){super(w),this._context=y,this._nativeAudioNode=w;const g=u(y);h(g)&&t(ql,()=>ql(g,p))!==!0&&P_(w),fc.set(this,w),Ju.set(this,new Set),y.state!=="closed"&&k&&si(this),n(this,v,w)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(y){this._nativeAudioNode.channelCount=y}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(y){this._nativeAudioNode.channelCountMode=y}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(y){this._nativeAudioNode.channelInterpretation=y}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(y,k=0,w=0){if(k<0||k>=this._nativeAudioNode.numberOfOutputs)throw i();const v=u(this._context),g=m(v);if(d(y)||f(y))throw r();if(uo(y)){const x=Ne(y);try{const A=ho(this._nativeAudioNode,x,k,w),R=eo(this);(g||R)&&this._nativeAudioNode.disconnect(...A),this.context.state!=="closed"&&!R&&eo(y)&&si(y)}catch(A){throw A.code===12?r():A}if(e(this,y,k,w,g)){const A=c([this],y);ya(A,s(g))}return y}const S=Wi(y);if(S.name==="playbackRate"&&S.maxValue===1024)throw o();try{this._nativeAudioNode.connect(S,k),(g||eo(this))&&this._nativeAudioNode.disconnect(S,k)}catch(x){throw x.code===12?r():x}if(D_(this,y,k,g)){const x=c([this],y);ya(x,s(g))}}disconnect(y,k,w){let v;const g=u(this._context),S=m(g);if(y===void 0)v=N_(this,S);else if(typeof y=="number"){if(y<0||y>=this.numberOfOutputs)throw i();v=F_(this,S,y)}else{if(k!==void 0&&(k<0||k>=this.numberOfOutputs)||uo(y)&&w!==void 0&&(w<0||w>=y.numberOfInputs))throw i();if(v=U_(this,S,y,k,w),v.length===0)throw r()}for(const T of v){const x=c([this],T);ya(x,a)}}},B_=(n,e,t,s,i,r,o,a,c,l,u,h,d)=>(f,m,p,_=null,y=null)=>{const k=p.value,w=new $m(k),v=m?s(w):null,g={get defaultValue(){return k},get maxValue(){return _===null?p.maxValue:_},get minValue(){return y===null?p.minValue:y},get value(){return p.value},set value(S){p.value=S,g.setValueAtTime(S,f.context.currentTime)},cancelAndHoldAtTime(S){if(typeof p.cancelAndHoldAtTime=="function")v===null&&w.flush(f.context.currentTime),w.add(i(S)),p.cancelAndHoldAtTime(S);else{const T=Array.from(w).pop();v===null&&w.flush(f.context.currentTime),w.add(i(S));const x=Array.from(w).pop();p.cancelScheduledValues(S),T!==x&&x!==void 0&&(x.type==="exponentialRampToValue"?p.exponentialRampToValueAtTime(x.value,x.endTime):x.type==="linearRampToValue"?p.linearRampToValueAtTime(x.value,x.endTime):x.type==="setValue"?p.setValueAtTime(x.value,x.startTime):x.type==="setValueCurve"&&p.setValueCurveAtTime(x.values,x.startTime,x.duration))}return g},cancelScheduledValues(S){return v===null&&w.flush(f.context.currentTime),w.add(r(S)),p.cancelScheduledValues(S),g},exponentialRampToValueAtTime(S,T){if(S===0)throw new RangeError;if(!Number.isFinite(T)||T<0)throw new RangeError;const x=f.context.currentTime;return v===null&&w.flush(x),Array.from(w).length===0&&(w.add(l(k,x)),p.setValueAtTime(k,x)),w.add(o(S,T)),p.exponentialRampToValueAtTime(S,T),g},linearRampToValueAtTime(S,T){const x=f.context.currentTime;return v===null&&w.flush(x),Array.from(w).length===0&&(w.add(l(k,x)),p.setValueAtTime(k,x)),w.add(a(S,T)),p.linearRampToValueAtTime(S,T),g},setTargetAtTime(S,T,x){return v===null&&w.flush(f.context.currentTime),w.add(c(S,T,x)),p.setTargetAtTime(S,T,x),g},setValueAtTime(S,T){return v===null&&w.flush(f.context.currentTime),w.add(l(S,T)),p.setValueAtTime(S,T),g},setValueCurveAtTime(S,T,x){const b=S instanceof Float32Array?S:new Float32Array(S);if(h!==null&&h.name==="webkitAudioContext"){const A=T+x,R=f.context.sampleRate,M=Math.ceil(T*R),L=Math.floor(A*R),q=L-M,Y=new Float32Array(q);for(let V=0;V<q;V+=1){const z=(b.length-1)/x*((M+V)/R-T),$=Math.floor(z),Q=Math.ceil(z);Y[V]=$===Q?b[$]:(1-(z-$))*b[$]+(1-(Q-z))*b[Q]}v===null&&w.flush(f.context.currentTime),w.add(u(Y,T,x)),p.setValueCurveAtTime(Y,T,x);const W=L/R;W<A&&d(g,Y[Y.length-1],W),d(g,b[b.length-1],A)}else v===null&&w.flush(f.context.currentTime),w.add(u(b,T,x)),p.setValueCurveAtTime(b,T,x);return g}};return t.set(g,p),e.set(g,f),n(g,v),g},z_=n=>({replay(e){for(const t of n)if(t.type==="exponentialRampToValue"){const{endTime:s,value:i}=t;e.exponentialRampToValueAtTime(i,s)}else if(t.type==="linearRampToValue"){const{endTime:s,value:i}=t;e.linearRampToValueAtTime(i,s)}else if(t.type==="setTarget"){const{startTime:s,target:i,timeConstant:r}=t;e.setTargetAtTime(i,s,r)}else if(t.type==="setValue"){const{startTime:s,value:i}=t;e.setValueAtTime(i,s)}else if(t.type==="setValueCurve"){const{duration:s,startTime:i,values:r}=t;e.setValueCurveAtTime(r,i,s)}else throw new Error("Can't apply an unknown automation.")}});class ch{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach((s,i)=>e.call(t,s,i,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const V_={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},j_=(n,e,t,s,i,r,o,a,c,l,u,h,d,f)=>class extends e{constructor(p,_,y){var k;const w=a(p),v=c(w),g=u({...V_,...y});d(g);const S=La.get(w),T=S==null?void 0:S.get(_),x=v||w.state!=="closed"?w:(k=o(w))!==null&&k!==void 0?k:w,b=i(x,v?null:p.baseLatency,l,_,T,g),A=v?s(_,g,T):null;super(p,!0,b,A);const R=[];b.parameters.forEach((L,q)=>{const Y=t(this,v,L);R.push([q,Y])}),this._nativeAudioWorkletNode=b,this._onprocessorerror=null,this._parameters=new ch(R),v&&n(w,this);const{activeInputs:M}=r(this);h(b,M)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(p){const _=typeof p=="function"?f(this,p):null;this._nativeAudioWorkletNode.onprocessorerror=_;const y=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=y!==null&&y===_?p:y}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function mo(n,e,t,s,i){if(typeof n.copyFromChannel=="function")e[t].byteLength===0&&(e[t]=new Float32Array(128)),n.copyFromChannel(e[t],s,i);else{const r=n.getChannelData(s);if(e[t].byteLength===0)e[t]=r.slice(i,i+128);else{const o=new Float32Array(r.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[t].set(o)}}}const lh=(n,e,t,s,i)=>{typeof n.copyToChannel=="function"?e[t].byteLength!==0&&n.copyToChannel(e[t],s,i):e[t].byteLength!==0&&n.getChannelData(s).set(e[t],i)},_o=(n,e)=>{const t=[];for(let s=0;s<n;s+=1){const i=[],r=typeof e=="number"?e:e[s];for(let o=0;o<r;o+=1)i.push(new Float32Array(128));t.push(i)}return t},H_=(n,e)=>{const t=Yt(Ba,n),s=Ne(e);return Yt(t,s)},q_=async(n,e,t,s,i,r,o)=>{const a=e===null?Math.ceil(n.context.length/128)*128:e.length,c=s.channelCount*s.numberOfInputs,l=i.reduce((_,y)=>_+y,0),u=l===0?null:t.createBuffer(l,a,t.sampleRate);if(r===void 0)throw new Error("Missing the processor constructor.");const h=ut(n),d=await H_(t,n),f=_o(s.numberOfInputs,s.channelCount),m=_o(s.numberOfOutputs,i),p=Array.from(n.parameters.keys()).reduce((_,y)=>({..._,[y]:new Float32Array(128)}),{});for(let _=0;_<a;_+=128){if(s.numberOfInputs>0&&e!==null)for(let y=0;y<s.numberOfInputs;y+=1)for(let k=0;k<s.channelCount;k+=1)mo(e,f[y],k,k,_);r.parameterDescriptors!==void 0&&e!==null&&r.parameterDescriptors.forEach(({name:y},k)=>{mo(e,p,y,c+k,_)});for(let y=0;y<s.numberOfInputs;y+=1)for(let k=0;k<i[y];k+=1)m[y][k].byteLength===0&&(m[y][k]=new Float32Array(128));try{const y=f.map((w,v)=>h.activeInputs[v].size===0?[]:w),k=o(_/t.sampleRate,t.sampleRate,()=>d.process(y,m,p));if(u!==null)for(let w=0,v=0;w<s.numberOfOutputs;w+=1){for(let g=0;g<i[w];g+=1)lh(u,m[w],g,v+g,_);v+=i[w]}if(!k)break}catch(y){n.dispatchEvent(new ErrorEvent("processorerror",{colno:y.colno,filename:y.filename,lineno:y.lineno,message:y.message}));break}}return u},G_=(n,e,t,s,i,r,o,a,c,l,u,h,d,f,m,p)=>(_,y,k)=>{const w=new WeakMap;let v=null;const g=async(S,T)=>{let x=u(S),b=null;const A=at(x,T),R=Array.isArray(y.outputChannelCount)?y.outputChannelCount:Array.from(y.outputChannelCount);if(h===null){const M=R.reduce((W,V)=>W+V,0),L=i(T,{channelCount:Math.max(1,M),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,M)}),q=[];for(let W=0;W<S.numberOfOutputs;W+=1)q.push(s(T,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:R[W]}));const Y=o(T,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1});Y.connect=e.bind(null,q),Y.disconnect=c.bind(null,q),b=[L,q,Y]}else A||(x=new h(T,_));if(w.set(T,b===null?x:b[2]),b!==null){if(v===null){if(k===void 0)throw new Error("Missing the processor constructor.");if(d===null)throw new Error("Missing the native OfflineAudioContext constructor.");const V=S.channelCount*S.numberOfInputs,z=k.parameterDescriptors===void 0?0:k.parameterDescriptors.length,$=V+z;v=q_(S,$===0?null:await(async()=>{const te=new d($,Math.ceil(S.context.length/128)*128,T.sampleRate),N=[],F=[];for(let G=0;G<y.numberOfInputs;G+=1)N.push(o(te,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1})),F.push(i(te,{channelCount:y.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:y.channelCount}));const C=await Promise.all(Array.from(S.parameters.values()).map(async G=>{const I=r(te,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:G.value});return await f(te,G,I.offset),I})),P=s(te,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,V+z)});for(let G=0;G<y.numberOfInputs;G+=1){N[G].connect(F[G]);for(let I=0;I<y.channelCount;I+=1)F[G].connect(P,I,G*y.channelCount+I)}for(const[G,I]of C.entries())I.connect(P,0,V+G),I.start(0);return P.connect(te.destination),await Promise.all(N.map(G=>m(S,te,G))),p(te)})(),T,y,R,k,l)}const M=await v,L=t(T,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[q,Y,W]=b;M!==null&&(L.buffer=M,L.start(0)),L.connect(q);for(let V=0,z=0;V<S.numberOfOutputs;V+=1){const $=Y[V];for(let Q=0;Q<R[V];Q+=1)q.connect($,z+Q,Q);z+=R[V]}return W}if(A)for(const[M,L]of S.parameters.entries())await n(T,L,x.parameters.get(M));else for(const[M,L]of S.parameters.entries())await f(T,L,x.parameters.get(M));return await m(S,T,x),x};return{render(S,T){a(T,S);const x=w.get(T);return x!==void 0?Promise.resolve(x):g(S,T)}}},W_=(n,e,t,s,i,r,o,a,c,l,u,h,d,f,m,p,_,y,k,w)=>class extends m{constructor(g,S){super(g,S),this._nativeContext=g,this._audioWorklet=n===void 0?void 0:{addModule:(T,x)=>n(this,T,x)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(g,S,T){return new t({length:S,numberOfChannels:g,sampleRate:T})}createBufferSource(){return new s(this)}createChannelMerger(g=6){return new r(this,{numberOfInputs:g})}createChannelSplitter(g=6){return new o(this,{numberOfOutputs:g})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(g=1){return new u(this,{maxDelayTime:g})}createDynamicsCompressor(){return new h(this)}createGain(){return new d(this)}createIIRFilter(g,S){return new f(this,{feedback:S,feedforward:g})}createOscillator(){return new p(this)}createPanner(){return new _(this)}createPeriodicWave(g,S,T={disableNormalization:!1}){return new y(this,{...T,imag:S,real:g})}createStereoPanner(){return new k(this)}createWaveShaper(){return new w(this)}decodeAudioData(g,S,T){return l(this._nativeContext,g).then(x=>(typeof S=="function"&&S(x),x),x=>{throw typeof T=="function"&&T(x),x})}},Y_={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},Z_=(n,e,t,s,i,r,o,a)=>class extends n{constructor(l,u){const h=r(l),d={...Y_,...u},f=i(h,d),m=o(h),p=m?t():null;super(l,!1,f,p),this._Q=e(this,m,f.Q,ct,mt),this._detune=e(this,m,f.detune,1200*Math.log2(ct),-1200*Math.log2(ct)),this._frequency=e(this,m,f.frequency,l.sampleRate/2,0),this._gain=e(this,m,f.gain,40*Math.log10(ct),mt),this._nativeBiquadFilterNode=f,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(l){this._nativeBiquadFilterNode.type=l}getFrequencyResponse(l,u,h){try{this._nativeBiquadFilterNode.getFrequencyResponse(l,u,h)}catch(d){throw d.code===11?s():d}if(l.length!==u.length||u.length!==h.length)throw s()}},$_=(n,e,t,s,i)=>()=>{const r=new WeakMap,o=async(a,c)=>{let l=t(a);const u=at(l,c);if(!u){const h={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=e(c,h)}return r.set(c,l),u?(await n(c,a.Q,l.Q),await n(c,a.detune,l.detune),await n(c,a.frequency,l.frequency),await n(c,a.gain,l.gain)):(await s(c,a.Q,l.Q),await s(c,a.detune,l.detune),await s(c,a.frequency,l.frequency),await s(c,a.gain,l.gain)),await i(a,c,l),l};return{render(a,c){const l=r.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},X_=(n,e)=>(t,s)=>{const i=e.get(t);if(i!==void 0)return i;const r=n.get(t);if(r!==void 0)return r;try{const o=s();return o instanceof Promise?(n.set(t,o),o.catch(()=>!1).then(a=>(n.delete(t),e.set(t,a),a))):(e.set(t,o),o)}catch{return e.set(t,!1),!1}},Q_={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},K_=(n,e,t,s,i)=>class extends n{constructor(o,a){const c=s(o),l={...Q_,...a},u=t(c,l),h=i(c)?e():null;super(o,!1,u,h)}},J_=(n,e,t)=>()=>{const s=new WeakMap,i=async(r,o)=>{let a=e(r);if(!at(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=n(o,l)}return s.set(o,a),await t(r,o,a),a};return{render(r,o){const a=s.get(o);return a!==void 0?Promise.resolve(a):i(r,o)}}},eg={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},tg=(n,e,t,s,i,r)=>class extends n{constructor(a,c){const l=s(a),u=r({...eg,...c}),h=t(l,u),d=i(l)?e():null;super(a,!1,h,d)}},sg=(n,e,t)=>()=>{const s=new WeakMap,i=async(r,o)=>{let a=e(r);if(!at(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=n(o,l)}return s.set(o,a),await t(r,o,a),a};return{render(r,o){const a=s.get(o);return a!==void 0?Promise.resolve(a):i(r,o)}}},ng=n=>(e,t,s)=>n(t,e,s),ig=n=>(e,t,s=0,i=0)=>{const r=e[s];if(r===void 0)throw n();return po(t)?r.connect(t,0,i):r.connect(t,0)},rg=n=>(e,t)=>{const s=n(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return s.buffer=i,s.loop=!0,s.connect(t),s.start(),()=>{s.stop(),s.disconnect(t)}},og={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},ag=(n,e,t,s,i,r,o)=>class extends n{constructor(c,l){const u=i(c),h={...og,...l},d=s(u,h),f=r(u),m=f?t():null;super(c,!1,d,m),this._constantSourceNodeRenderer=m,this._nativeConstantSourceNode=d,this._offset=e(this,f,d.offset,ct,mt),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?o(this,c):null;this._nativeConstantSourceNode.onended=l;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===l?c:u}start(c=0){if(this._nativeConstantSourceNode.start(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=c),this.context.state!=="closed"){si(this);const l=()=>{this._nativeConstantSourceNode.removeEventListener("ended",l),Ts(this)&&wr(this)};this._nativeConstantSourceNode.addEventListener("ended",l)}}stop(c=0){this._nativeConstantSourceNode.stop(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=c)}},cg=(n,e,t,s,i)=>()=>{const r=new WeakMap;let o=null,a=null;const c=async(l,u)=>{let h=t(l);const d=at(h,u);if(!d){const f={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,offset:h.offset.value};h=e(u,f),o!==null&&h.start(o),a!==null&&h.stop(a)}return r.set(u,h),d?await n(u,l.offset,h.offset):await s(u,l.offset,h.offset),await i(l,u,h),h};return{set start(l){o=l},set stop(l){a=l},render(l,u){const h=r.get(u);return h!==void 0?Promise.resolve(h):c(l,u)}}},lg=n=>e=>(n[0]=e,n[0]),ug={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},hg=(n,e,t,s,i,r)=>class extends n{constructor(a,c){const l=s(a),u={...ug,...c},h=t(l,u),f=i(l)?e():null;super(a,!1,h,f),this._isBufferNullified=!1,this._nativeConvolverNode=h,u.buffer!==null&&r(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const c=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=c.createBuffer(1,1,c.sampleRate),this._isBufferNullified=!0,r(this,0)}else this._isBufferNullified=!1,r(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},dg=(n,e,t)=>()=>{const s=new WeakMap,i=async(r,o)=>{let a=e(r);if(!at(a,o)){const l={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=n(o,l)}return s.set(o,a),pi(a)?await t(r,o,a.inputs[0]):await t(r,o,a),a};return{render(r,o){const a=s.get(o);return a!==void 0?Promise.resolve(a):i(r,o)}}},fg=(n,e)=>(t,s,i)=>{if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(t,s,i)}catch(r){throw r.name==="SyntaxError"?n():r}},pg=()=>new DOMException("","DataCloneError"),Gl=n=>{const{port1:e,port2:t}=new MessageChannel;return new Promise(s=>{const i=()=>{t.onmessage=null,e.close(),t.close(),s()};t.onmessage=()=>i();try{e.postMessage(n,[n])}catch{}finally{i()}})},mg=(n,e,t,s,i,r,o,a,c,l,u)=>(h,d)=>{const f=o(h)?h:r(h);if(i.has(d)){const m=t();return Promise.reject(m)}try{i.add(d)}catch{}return e(c,()=>c(f))?f.decodeAudioData(d).then(m=>(Gl(d).catch(()=>{}),e(a,()=>a(m))||u(m),n.add(m),m)):new Promise((m,p)=>{const _=async()=>{try{await Gl(d)}catch{}},y=k=>{p(k),_()};try{f.decodeAudioData(d,k=>{typeof k.copyFromChannel!="function"&&(l(k),mc(k)),n.add(k),_().then(()=>m(k))},k=>{y(k===null?s():k)})}catch(k){y(k)}})},_g=(n,e,t,s,i,r,o,a)=>(c,l)=>{const u=e.get(c);if(u===void 0)throw new Error("Missing the expected cycle count.");const h=r(c.context),d=a(h);if(u===l){if(e.delete(c),!d&&o(c)){const f=s(c),{outputs:m}=t(c);for(const p of m)if(br(p)){const _=s(p[0]);n(f,_,p[1],p[2])}else{const _=i(p[0]);f.connect(_,p[1])}}}else e.set(c,u-l)},gg={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},vg=(n,e,t,s,i,r,o)=>class extends n{constructor(c,l){const u=i(c),h={...gg,...l},d=s(u,h),f=r(u),m=f?t(h.maxDelayTime):null;super(c,!1,d,m),this._delayTime=e(this,f,d.delayTime),o(this,h.maxDelayTime)}get delayTime(){return this._delayTime}},yg=(n,e,t,s,i)=>r=>{const o=new WeakMap,a=async(c,l)=>{let u=t(c);const h=at(u,l);if(!h){const d={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:r};u=e(l,d)}return o.set(l,u),h?await n(l,c.delayTime,u.delayTime):await s(l,c.delayTime,u.delayTime),await i(c,l,u),u};return{render(c,l){const u=o.get(l);return u!==void 0?Promise.resolve(u):a(c,l)}}},xg=n=>(e,t,s,i)=>n(e[i],r=>r[0]===t&&r[1]===s),Tg=n=>(e,t)=>{n(e).delete(t)},kg=n=>"delayTime"in n,wg=(n,e,t)=>function s(i,r){const o=uo(r)?r:t(n,r);if(kg(o))return[];if(i[0]===o)return[i];if(i.includes(o))return[];const{outputs:a}=e(o);return Array.from(a).map(c=>s([...i,o],c[0])).reduce((c,l)=>c.concat(l),[])},Wr=(n,e,t)=>{const s=e[t];if(s===void 0)throw n();return s},Sg=n=>(e,t=void 0,s=void 0,i=0)=>t===void 0?e.forEach(r=>r.disconnect()):typeof t=="number"?Wr(n,e,t).disconnect():po(t)?s===void 0?e.forEach(r=>r.disconnect(t)):i===void 0?Wr(n,e,s).disconnect(t,0):Wr(n,e,s).disconnect(t,0,i):s===void 0?e.forEach(r=>r.disconnect(t)):Wr(n,e,s).disconnect(t,0),bg={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Cg=(n,e,t,s,i,r,o,a)=>class extends n{constructor(l,u){const h=r(l),d={...bg,...u},f=s(h,d),m=o(h),p=m?t():null;super(l,!1,f,p),this._attack=e(this,m,f.attack),this._knee=e(this,m,f.knee),this._nativeDynamicsCompressorNode=f,this._ratio=e(this,m,f.ratio),this._release=e(this,m,f.release),this._threshold=e(this,m,f.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(l){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=l,l>2)throw this._nativeDynamicsCompressorNode.channelCount=u,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(l){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=l,l==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},Eg=(n,e,t,s,i)=>()=>{const r=new WeakMap,o=async(a,c)=>{let l=t(a);const u=at(l,c);if(!u){const h={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=e(c,h)}return r.set(c,l),u?(await n(c,a.attack,l.attack),await n(c,a.knee,l.knee),await n(c,a.ratio,l.ratio),await n(c,a.release,l.release),await n(c,a.threshold,l.threshold)):(await s(c,a.attack,l.attack),await s(c,a.knee,l.knee),await s(c,a.ratio,l.ratio),await s(c,a.release,l.release),await s(c,a.threshold,l.threshold)),await i(a,c,l),l};return{render(a,c){const l=r.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},Og=()=>new DOMException("","EncodingError"),Ag=n=>e=>new Promise((t,s)=>{if(n===null){s(new SyntaxError);return}const i=n.document.head;if(i===null)s(new SyntaxError);else{const r=n.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(o),c=n.onerror,l=()=>{n.onerror=c,URL.revokeObjectURL(a)};n.onerror=(u,h,d,f,m)=>{if(h===a||h===n.location.href&&d===1&&f===1)return l(),s(m),!1;if(c!==null)return c(u,h,d,f,m)},r.onerror=()=>{l(),s(new SyntaxError)},r.onload=()=>{l(),t()},r.src=a,r.type="module",i.appendChild(r)}}),Mg=n=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,s,i){if(s!==null){let r=this._listeners.get(s);r===void 0&&(r=n(this,s),typeof s=="function"&&this._listeners.set(s,r)),this._nativeEventTarget.addEventListener(t,r,i)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,s,i){const r=s===null?void 0:this._listeners.get(s);this._nativeEventTarget.removeEventListener(t,r===void 0?null:r,i)}},Pg=n=>(e,t,s)=>{Object.defineProperties(n,{currentFrame:{configurable:!0,get(){return Math.round(e*t)}},currentTime:{configurable:!0,get(){return e}}});try{return s()}finally{n!==null&&(delete n.currentFrame,delete n.currentTime)}},Dg=n=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw n()},Rg={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},Ig=(n,e,t,s,i,r)=>class extends n{constructor(a,c){const l=i(a),u={...Rg,...c},h=s(l,u),d=r(l),f=d?t():null;super(a,!1,h,f),this._gain=e(this,d,h.gain,ct,mt)}get gain(){return this._gain}},Ng=(n,e,t,s,i)=>()=>{const r=new WeakMap,o=async(a,c)=>{let l=t(a);const u=at(l,c);if(!u){const h={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=e(c,h)}return r.set(c,l),u?await n(c,a.gain,l.gain):await s(c,a.gain,l.gain),await i(a,c,l),l};return{render(a,c){const l=r.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},Fg=(n,e)=>t=>e(n,t),Ug=n=>e=>{const t=n(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},Lg=n=>e=>{var t;return(t=n.get(e))!==null&&t!==void 0?t:0},Bg=n=>e=>{const t=n(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},zg=n=>e=>n.get(e),et=()=>new DOMException("","InvalidStateError"),Vg=n=>e=>{const t=n.get(e);if(t===void 0)throw et();return t},jg=(n,e)=>t=>{let s=n.get(t);if(s!==void 0)return s;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return s=new e(1,1,44100),n.set(t,s),s},Hg=n=>e=>{const t=n.get(e);if(t===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return t},Go=()=>new DOMException("","InvalidAccessError"),qg=n=>{n.getFrequencyResponse=(e=>(t,s,i)=>{if(t.length!==s.length||s.length!==i.length)throw Go();return e.call(n,t,s,i)})(n.getFrequencyResponse)},Gg={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},Wg=(n,e,t,s,i,r)=>class extends n{constructor(a,c){const l=s(a),u=i(l),h={...Gg,...c},d=e(l,u?null:a.baseLatency,h),f=u?t(h.feedback,h.feedforward):null;super(a,!1,d,f),qg(d),this._nativeIIRFilterNode=d,r(this,1)}getFrequencyResponse(a,c,l){return this._nativeIIRFilterNode.getFrequencyResponse(a,c,l)}},uh=(n,e,t,s,i,r,o,a,c,l,u)=>{const h=l.length;let d=a;for(let f=0;f<h;f+=1){let m=t[0]*l[f];for(let p=1;p<i;p+=1){const _=d-p&c-1;m+=t[p]*r[_],m-=n[p]*o[_]}for(let p=i;p<s;p+=1)m+=t[p]*r[d-p&c-1];for(let p=i;p<e;p+=1)m-=n[p]*o[d-p&c-1];r[d]=l[f],o[d]=m,d=d+1&c-1,u[f]=m}return d},Yg=(n,e,t,s)=>{const i=t instanceof Float64Array?t:new Float64Array(t),r=s instanceof Float64Array?s:new Float64Array(s),o=i.length,a=r.length,c=Math.min(o,a);if(i[0]!==1){for(let m=0;m<o;m+=1)r[m]/=i[0];for(let m=1;m<a;m+=1)i[m]/=i[0]}const l=32,u=new Float32Array(l),h=new Float32Array(l),d=e.createBuffer(n.numberOfChannels,n.length,n.sampleRate),f=n.numberOfChannels;for(let m=0;m<f;m+=1){const p=n.getChannelData(m),_=d.getChannelData(m);u.fill(0),h.fill(0),uh(i,o,r,a,c,u,h,0,l,p,_)}return d},Zg=(n,e,t,s,i)=>(r,o)=>{const a=new WeakMap;let c=null;const l=async(u,h)=>{let d=null,f=e(u);const m=at(f,h);if(h.createIIRFilter===void 0?d=n(h,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):m||(f=h.createIIRFilter(o,r)),a.set(h,d===null?f:d),d!==null){if(c===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");const _=new t(u.context.destination.channelCount,u.context.length,h.sampleRate);c=(async()=>{await s(u,_,_.destination);const y=await i(_);return Yg(y,h,r,o)})()}const p=await c;return d.buffer=p,d.start(0),d}return await s(u,h,f),f};return{render(u,h){const d=a.get(h);return d!==void 0?Promise.resolve(d):l(u,h)}}},$g=(n,e,t,s,i,r)=>o=>(a,c)=>{const l=n.get(a);if(l===void 0){if(!o&&r(a)){const u=s(a),{outputs:h}=t(a);for(const d of h)if(br(d)){const f=s(d[0]);e(u,f,d[1],d[2])}else{const f=i(d[0]);u.disconnect(f,d[1])}}n.set(a,c)}else n.set(a,l+c)},Xg=(n,e)=>t=>{const s=n.get(t);return e(s)||e(t)},Qg=(n,e)=>t=>n.has(t)||e(t),Kg=(n,e)=>t=>n.has(t)||e(t),Jg=(n,e)=>t=>{const s=n.get(t);return e(s)||e(t)},ev=n=>e=>n!==null&&e instanceof n,tv=n=>e=>n!==null&&typeof n.AudioNode=="function"&&e instanceof n.AudioNode,sv=n=>e=>n!==null&&typeof n.AudioParam=="function"&&e instanceof n.AudioParam,nv=(n,e)=>t=>n(t)||e(t),iv=n=>e=>n!==null&&e instanceof n,rv=n=>n!==null&&n.isSecureContext,ov=(n,e,t,s)=>class extends n{constructor(r,o){const a=t(r),c=e(a,o);if(s(a))throw TypeError();super(r,!0,c,null),this._nativeMediaElementAudioSourceNode=c}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},av={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},cv=(n,e,t,s)=>class extends n{constructor(r,o){const a=t(r);if(s(a))throw new TypeError;const c={...av,...o},l=e(a,c);super(r,!1,l,null),this._nativeMediaStreamAudioDestinationNode=l}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},lv=(n,e,t,s)=>class extends n{constructor(r,o){const a=t(r),c=e(a,o);if(s(a))throw new TypeError;super(r,!0,c,null),this._nativeMediaStreamAudioSourceNode=c}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},uv=(n,e,t)=>class extends n{constructor(i,r){const o=t(i),a=e(o,r);super(i,!0,a,null)}},hv=(n,e,t,s,i,r)=>class extends t{constructor(a,c){super(a),this._nativeContext=a,Ho.set(this,a),s(a)&&i.set(a,new Set),this._destination=new n(this,c),this._listener=e(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const c=typeof a=="function"?r(this,a):null;this._nativeContext.onstatechange=c;const l=this._nativeContext.onstatechange;this._onstatechange=l!==null&&l===c?a:l}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},Yi=n=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const t=n.decodeAudioData(e.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch{}return!1},dv=(n,e)=>(t,s,i)=>{const r=new Set;return t.connect=(o=>(a,c=0,l=0)=>{const u=r.size===0;if(e(a))return o.call(t,a,c,l),n(r,[a,c,l],h=>h[0]===a&&h[1]===c&&h[2]===l,!0),u&&s(),a;o.call(t,a,c),n(r,[a,c],h=>h[0]===a&&h[1]===c,!0),u&&s()})(t.connect),t.disconnect=(o=>(a,c,l)=>{const u=r.size>0;if(a===void 0)o.apply(t),r.clear();else if(typeof a=="number"){o.call(t,a);for(const d of r)d[1]===a&&r.delete(d)}else{e(a)?o.call(t,a,c,l):o.call(t,a,c);for(const d of r)d[0]===a&&(c===void 0||d[1]===c)&&(l===void 0||d[2]===l)&&r.delete(d)}const h=r.size===0;u&&h&&i()})(t.disconnect),t},Fe=(n,e,t)=>{const s=e[t];s!==void 0&&s!==n[t]&&(n[t]=s)},Qe=(n,e)=>{Fe(n,e,"channelCount"),Fe(n,e,"channelCountMode"),Fe(n,e,"channelInterpretation")},Wl=n=>typeof n.getFloatTimeDomainData=="function",fv=n=>{n.getFloatTimeDomainData=e=>{const t=new Uint8Array(e.length);n.getByteTimeDomainData(t);const s=Math.max(t.length,n.fftSize);for(let i=0;i<s;i+=1)e[i]=(t[i]-128)*.0078125;return e}},pv=(n,e)=>(t,s)=>{const i=t.createAnalyser();if(Qe(i,s),!(s.maxDecibels>s.minDecibels))throw e();return Fe(i,s,"fftSize"),Fe(i,s,"maxDecibels"),Fe(i,s,"minDecibels"),Fe(i,s,"smoothingTimeConstant"),n(Wl,()=>Wl(i))||fv(i),i},mv=n=>n===null?null:n.hasOwnProperty("AudioBuffer")?n.AudioBuffer:null,ze=(n,e,t)=>{const s=e[t];s!==void 0&&s!==n[t].value&&(n[t].value=s)},_v=n=>{n.start=(e=>{let t=!1;return(s=0,i=0,r)=>{if(t)throw et();e.call(n,s,i,r),t=!0}})(n.start)},vc=n=>{n.start=(e=>(t=0,s=0,i)=>{if(typeof i=="number"&&i<0||s<0||t<0)throw new RangeError("The parameters can't be negative.");e.call(n,t,s,i)})(n.start)},yc=n=>{n.stop=(e=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");e.call(n,t)})(n.stop)},gv=(n,e,t,s,i,r,o,a,c,l,u)=>(h,d)=>{const f=h.createBufferSource();return Qe(f,d),ze(f,d,"playbackRate"),Fe(f,d,"buffer"),Fe(f,d,"loop"),Fe(f,d,"loopEnd"),Fe(f,d,"loopStart"),e(t,()=>t(h))||_v(f),e(s,()=>s(h))||c(f),e(i,()=>i(h))||l(f,h),e(r,()=>r(h))||vc(f),e(o,()=>o(h))||u(f,h),e(a,()=>a(h))||yc(f),n(h,f),f},vv=n=>n===null?null:n.hasOwnProperty("AudioContext")?n.AudioContext:n.hasOwnProperty("webkitAudioContext")?n.webkitAudioContext:null,yv=(n,e)=>(t,s,i)=>{const r=t.destination;if(r.channelCount!==s)try{r.channelCount=s}catch{}i&&r.channelCountMode!=="explicit"&&(r.channelCountMode="explicit"),r.maxChannelCount===0&&Object.defineProperty(r,"maxChannelCount",{value:s});const o=n(t,{channelCount:s,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,gain:1});return e(o,"channelCount",a=>()=>a.call(o),a=>c=>{a.call(o,c);try{r.channelCount=c}catch(l){if(c>r.maxChannelCount)throw l}}),e(o,"channelCountMode",a=>()=>a.call(o),a=>c=>{a.call(o,c),r.channelCountMode=c}),e(o,"channelInterpretation",a=>()=>a.call(o),a=>c=>{a.call(o,c),r.channelInterpretation=c}),Object.defineProperty(o,"maxChannelCount",{get:()=>r.maxChannelCount}),o.connect(r),o},xv=n=>n===null?null:n.hasOwnProperty("AudioWorkletNode")?n.AudioWorkletNode:null,Tv=n=>{const{port1:e}=new MessageChannel;try{e.postMessage(n)}finally{e.close()}},kv=(n,e,t,s,i)=>(r,o,a,c,l,u)=>{if(a!==null)try{const h=new a(r,c,u),d=new Map;let f=null;if(Object.defineProperties(h,{channelCount:{get:()=>u.channelCount,set:()=>{throw n()}},channelCountMode:{get:()=>"explicit",set:()=>{throw n()}},onprocessorerror:{get:()=>f,set:m=>{typeof f=="function"&&h.removeEventListener("processorerror",f),f=typeof m=="function"?m:null,typeof f=="function"&&h.addEventListener("processorerror",f)}}}),h.addEventListener=(m=>(...p)=>{if(p[0]==="processorerror"){const _=typeof p[1]=="function"?p[1]:typeof p[1]=="object"&&p[1]!==null&&typeof p[1].handleEvent=="function"?p[1].handleEvent:null;if(_!==null){const y=d.get(p[1]);y!==void 0?p[1]=y:(p[1]=k=>{k.type==="error"?(Object.defineProperties(k,{type:{value:"processorerror"}}),_(k)):_(new ErrorEvent(p[0],{...k}))},d.set(_,p[1]))}}return m.call(h,"error",p[1],p[2]),m.call(h,...p)})(h.addEventListener),h.removeEventListener=(m=>(...p)=>{if(p[0]==="processorerror"){const _=d.get(p[1]);_!==void 0&&(d.delete(p[1]),p[1]=_)}return m.call(h,"error",p[1],p[2]),m.call(h,p[0],p[1],p[2])})(h.removeEventListener),u.numberOfOutputs!==0){const m=t(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return h.connect(m).connect(r.destination),i(h,()=>m.disconnect(),()=>m.connect(r.destination))}return h}catch(h){throw h.code===11?s():h}if(l===void 0)throw s();return Tv(u),e(r,o,l,u)},hh=(n,e)=>n===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(n*e))))),wv=n=>new Promise((e,t)=>{const{port1:s,port2:i}=new MessageChannel;s.onmessage=({data:r})=>{s.close(),i.close(),e(r)},s.onmessageerror=({data:r})=>{s.close(),i.close(),t(r)},i.postMessage(n)}),Sv=async(n,e)=>{const t=await wv(e);return new n(t)},bv=(n,e,t,s)=>{let i=Ba.get(n);i===void 0&&(i=new WeakMap,Ba.set(n,i));const r=Sv(t,s);return i.set(e,r),r},Cv=(n,e,t,s,i,r,o,a,c,l,u,h,d)=>(f,m,p,_)=>{if(_.numberOfInputs===0&&_.numberOfOutputs===0)throw c();const y=Array.isArray(_.outputChannelCount)?_.outputChannelCount:Array.from(_.outputChannelCount);if(y.some(j=>j<1))throw c();if(y.length!==_.numberOfOutputs)throw e();if(_.channelCountMode!=="explicit")throw c();const k=_.channelCount*_.numberOfInputs,w=y.reduce((j,O)=>j+O,0),v=p.parameterDescriptors===void 0?0:p.parameterDescriptors.length;if(k+v>6||w>6)throw c();const g=new MessageChannel,S=[],T=[];for(let j=0;j<_.numberOfInputs;j+=1)S.push(o(f,{channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,gain:1})),T.push(i(f,{channelCount:_.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:_.channelCount}));const x=[];if(p.parameterDescriptors!==void 0)for(const{defaultValue:j,maxValue:O,minValue:E,name:X}of p.parameterDescriptors){const ee=r(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:_.parameterData[X]!==void 0?_.parameterData[X]:j===void 0?0:j});Object.defineProperties(ee.offset,{defaultValue:{get:()=>j===void 0?0:j},maxValue:{get:()=>O===void 0?ct:O},minValue:{get:()=>E===void 0?mt:E}}),x.push(ee)}const b=s(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,k+v)}),A=hh(m,f.sampleRate),R=a(f,A,k+v,Math.max(1,w)),M=i(f,{channelCount:Math.max(1,w),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,w)}),L=[];for(let j=0;j<_.numberOfOutputs;j+=1)L.push(s(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:y[j]}));for(let j=0;j<_.numberOfInputs;j+=1){S[j].connect(T[j]);for(let O=0;O<_.channelCount;O+=1)T[j].connect(b,O,j*_.channelCount+O)}const q=new ch(p.parameterDescriptors===void 0?[]:p.parameterDescriptors.map(({name:j},O)=>{const E=x[O];return E.connect(b,0,k+O),E.start(0),[j,E.offset]}));b.connect(R);let Y=_.channelInterpretation,W=null;const V=_.numberOfOutputs===0?[R]:L,z={get bufferSize(){return A},get channelCount(){return _.channelCount},set channelCount(j){throw t()},get channelCountMode(){return _.channelCountMode},set channelCountMode(j){throw t()},get channelInterpretation(){return Y},set channelInterpretation(j){for(const O of S)O.channelInterpretation=j;Y=j},get context(){return R.context},get inputs(){return S},get numberOfInputs(){return _.numberOfInputs},get numberOfOutputs(){return _.numberOfOutputs},get onprocessorerror(){return W},set onprocessorerror(j){typeof W=="function"&&z.removeEventListener("processorerror",W),W=typeof j=="function"?j:null,typeof W=="function"&&z.addEventListener("processorerror",W)},get parameters(){return q},get port(){return g.port2},addEventListener(...j){return R.addEventListener(j[0],j[1],j[2])},connect:n.bind(null,V),disconnect:l.bind(null,V),dispatchEvent(...j){return R.dispatchEvent(j[0])},removeEventListener(...j){return R.removeEventListener(j[0],j[1],j[2])}},$=new Map;g.port1.addEventListener=(j=>(...O)=>{if(O[0]==="message"){const E=typeof O[1]=="function"?O[1]:typeof O[1]=="object"&&O[1]!==null&&typeof O[1].handleEvent=="function"?O[1].handleEvent:null;if(E!==null){const X=$.get(O[1]);X!==void 0?O[1]=X:(O[1]=ee=>{u(f.currentTime,f.sampleRate,()=>E(ee))},$.set(E,O[1]))}}return j.call(g.port1,O[0],O[1],O[2])})(g.port1.addEventListener),g.port1.removeEventListener=(j=>(...O)=>{if(O[0]==="message"){const E=$.get(O[1]);E!==void 0&&($.delete(O[1]),O[1]=E)}return j.call(g.port1,O[0],O[1],O[2])})(g.port1.removeEventListener);let Q=null;Object.defineProperty(g.port1,"onmessage",{get:()=>Q,set:j=>{typeof Q=="function"&&g.port1.removeEventListener("message",Q),Q=typeof j=="function"?j:null,typeof Q=="function"&&(g.port1.addEventListener("message",Q),g.port1.start())}}),p.prototype.port=g.port1;let te=null;bv(f,z,p,_).then(j=>te=j);const F=_o(_.numberOfInputs,_.channelCount),C=_o(_.numberOfOutputs,y),P=p.parameterDescriptors===void 0?[]:p.parameterDescriptors.reduce((j,{name:O})=>({...j,[O]:new Float32Array(128)}),{});let G=!0;const I=()=>{_.numberOfOutputs>0&&R.disconnect(M);for(let j=0,O=0;j<_.numberOfOutputs;j+=1){const E=L[j];for(let X=0;X<y[j];X+=1)M.disconnect(E,O+X,X);O+=y[j]}},B=new Map;R.onaudioprocess=({inputBuffer:j,outputBuffer:O})=>{if(te!==null){const E=h(z);for(let X=0;X<A;X+=128){for(let ee=0;ee<_.numberOfInputs;ee+=1)for(let ue=0;ue<_.channelCount;ue+=1)mo(j,F[ee],ue,ue,X);p.parameterDescriptors!==void 0&&p.parameterDescriptors.forEach(({name:ee},ue)=>{mo(j,P,ee,k+ue,X)});for(let ee=0;ee<_.numberOfInputs;ee+=1)for(let ue=0;ue<y[ee];ue+=1)C[ee][ue].byteLength===0&&(C[ee][ue]=new Float32Array(128));try{const ee=F.map((ke,Xe)=>{if(E[Xe].size>0)return B.set(Xe,A/128),ke;const yi=B.get(Xe);return yi===void 0?[]:(ke.every(ra=>ra.every(Rr=>Rr===0))&&(yi===1?B.delete(Xe):B.set(Xe,yi-1)),ke)});G=u(f.currentTime+X/f.sampleRate,f.sampleRate,()=>te.process(ee,C,P));for(let ke=0,Xe=0;ke<_.numberOfOutputs;ke+=1){for(let zt=0;zt<y[ke];zt+=1)lh(O,C[ke],zt,Xe+zt,X);Xe+=y[ke]}}catch(ee){G=!1,z.dispatchEvent(new ErrorEvent("processorerror",{colno:ee.colno,filename:ee.filename,lineno:ee.lineno,message:ee.message}))}if(!G){for(let ee=0;ee<_.numberOfInputs;ee+=1){S[ee].disconnect(T[ee]);for(let ue=0;ue<_.channelCount;ue+=1)T[X].disconnect(b,ue,ee*_.channelCount+ue)}if(p.parameterDescriptors!==void 0){const ee=p.parameterDescriptors.length;for(let ue=0;ue<ee;ue+=1){const ke=x[ue];ke.disconnect(b,0,k+ue),ke.stop()}}b.disconnect(R),R.onaudioprocess=null,ie?I():J();break}}}};let ie=!1;const se=o(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),ne=()=>R.connect(se).connect(f.destination),J=()=>{R.disconnect(se),se.disconnect()},ge=()=>{if(G){J(),_.numberOfOutputs>0&&R.connect(M);for(let j=0,O=0;j<_.numberOfOutputs;j+=1){const E=L[j];for(let X=0;X<y[j];X+=1)M.connect(E,O+X,X);O+=y[j]}}ie=!0},K=()=>{G&&(ne(),I()),ie=!1};return ne(),d(z,ge,K)},dh=(n,e)=>{const t=n.createBiquadFilter();return Qe(t,e),ze(t,e,"Q"),ze(t,e,"detune"),ze(t,e,"frequency"),ze(t,e,"gain"),Fe(t,e,"type"),t},Ev=(n,e)=>(t,s)=>{const i=t.createChannelMerger(s.numberOfInputs);return n!==null&&n.name==="webkitAudioContext"&&e(t,i),Qe(i,s),i},Ov=n=>{const e=n.numberOfOutputs;Object.defineProperty(n,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw et()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw et()}}),Object.defineProperty(n,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw et()}})},Cr=(n,e)=>{const t=n.createChannelSplitter(e.numberOfOutputs);return Qe(t,e),Ov(t),t},Av=(n,e,t,s,i)=>(r,o)=>{if(r.createConstantSource===void 0)return t(r,o);const a=r.createConstantSource();return Qe(a,o),ze(a,o,"offset"),e(s,()=>s(r))||vc(a),e(i,()=>i(r))||yc(a),n(r,a),a},mi=(n,e)=>(n.connect=e.connect.bind(e),n.disconnect=e.disconnect.bind(e),n),Mv=(n,e,t,s)=>(i,{offset:r,...o})=>{const a=i.createBuffer(1,2,44100),c=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=t(i,{...o,gain:r}),u=a.getChannelData(0);u[0]=1,u[1]=1,c.buffer=a,c.loop=!0;const h={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(m){l.channelCount=m},get channelCountMode(){return l.channelCountMode},set channelCountMode(m){l.channelCountMode=m},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(m){l.channelInterpretation=m},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(m){c.onended=m},addEventListener(...m){return c.addEventListener(m[0],m[1],m[2])},dispatchEvent(...m){return c.dispatchEvent(m[0])},removeEventListener(...m){return c.removeEventListener(m[0],m[1],m[2])},start(m=0){c.start.call(c,m)},stop(m=0){c.stop.call(c,m)}},d=()=>c.connect(l),f=()=>c.disconnect(l);return n(i,c),s(mi(h,l),d,f)},Pv=(n,e)=>(t,s)=>{const i=t.createConvolver();if(Qe(i,s),s.disableNormalization===i.normalize&&(i.normalize=!s.disableNormalization),Fe(i,s,"buffer"),s.channelCount>2||(e(i,"channelCount",r=>()=>r.call(i),r=>o=>{if(o>2)throw n();return r.call(i,o)}),s.channelCountMode==="max"))throw n();return e(i,"channelCountMode",r=>()=>r.call(i),r=>o=>{if(o==="max")throw n();return r.call(i,o)}),i},fh=(n,e)=>{const t=n.createDelay(e.maxDelayTime);return Qe(t,e),ze(t,e,"delayTime"),t},Dv=n=>(e,t)=>{const s=e.createDynamicsCompressor();if(Qe(s,t),t.channelCount>2||t.channelCountMode==="max")throw n();return ze(s,t,"attack"),ze(s,t,"knee"),ze(s,t,"ratio"),ze(s,t,"release"),ze(s,t,"threshold"),s},Tt=(n,e)=>{const t=n.createGain();return Qe(t,e),ze(t,e,"gain"),t},Rv=n=>(e,t,s)=>{if(e.createIIRFilter===void 0)return n(e,t,s);const i=e.createIIRFilter(s.feedforward,s.feedback);return Qe(i,s),i};function Iv(n,e){const t=e[0]*e[0]+e[1]*e[1];return[(n[0]*e[0]+n[1]*e[1])/t,(n[1]*e[0]-n[0]*e[1])/t]}function Nv(n,e){return[n[0]*e[0]-n[1]*e[1],n[0]*e[1]+n[1]*e[0]]}function Yl(n,e){let t=[0,0];for(let s=n.length-1;s>=0;s-=1)t=Nv(t,e),t[0]+=n[s];return t}const Fv=(n,e,t,s)=>(i,r,{channelCount:o,channelCountMode:a,channelInterpretation:c,feedback:l,feedforward:u})=>{const h=hh(r,i.sampleRate),d=l instanceof Float64Array?l:new Float64Array(l),f=u instanceof Float64Array?u:new Float64Array(u),m=d.length,p=f.length,_=Math.min(m,p);if(m===0||m>20)throw s();if(d[0]===0)throw e();if(p===0||p>20)throw s();if(f[0]===0)throw e();if(d[0]!==1){for(let x=0;x<p;x+=1)f[x]/=d[0];for(let x=1;x<m;x+=1)d[x]/=d[0]}const y=t(i,h,o,o);y.channelCount=o,y.channelCountMode=a,y.channelInterpretation=c;const k=32,w=[],v=[],g=[];for(let x=0;x<o;x+=1){w.push(0);const b=new Float32Array(k),A=new Float32Array(k);b.fill(0),A.fill(0),v.push(b),g.push(A)}y.onaudioprocess=x=>{const b=x.inputBuffer,A=x.outputBuffer,R=b.numberOfChannels;for(let M=0;M<R;M+=1){const L=b.getChannelData(M),q=A.getChannelData(M);w[M]=uh(d,m,f,p,_,v[M],g[M],w[M],k,L,q)}};const S=i.sampleRate/2;return mi({get bufferSize(){return h},get channelCount(){return y.channelCount},set channelCount(x){y.channelCount=x},get channelCountMode(){return y.channelCountMode},set channelCountMode(x){y.channelCountMode=x},get channelInterpretation(){return y.channelInterpretation},set channelInterpretation(x){y.channelInterpretation=x},get context(){return y.context},get inputs(){return[y]},get numberOfInputs(){return y.numberOfInputs},get numberOfOutputs(){return y.numberOfOutputs},addEventListener(...x){return y.addEventListener(x[0],x[1],x[2])},dispatchEvent(...x){return y.dispatchEvent(x[0])},getFrequencyResponse(x,b,A){if(x.length!==b.length||b.length!==A.length)throw n();const R=x.length;for(let M=0;M<R;M+=1){const L=-Math.PI*(x[M]/S),q=[Math.cos(L),Math.sin(L)],Y=Yl(f,q),W=Yl(d,q),V=Iv(Y,W);b[M]=Math.sqrt(V[0]*V[0]+V[1]*V[1]),A[M]=Math.atan2(V[1],V[0])}},removeEventListener(...x){return y.removeEventListener(x[0],x[1],x[2])}},y)},Uv=(n,e)=>n.createMediaElementSource(e.mediaElement),Lv=(n,e)=>{const t=n.createMediaStreamDestination();return Qe(t,e),t.numberOfOutputs===1&&Object.defineProperty(t,"numberOfOutputs",{get:()=>0}),t},Bv=(n,{mediaStream:e})=>{const t=e.getAudioTracks();t.sort((r,o)=>r.id<o.id?-1:r.id>o.id?1:0);const s=t.slice(0,1),i=n.createMediaStreamSource(new MediaStream(s));return Object.defineProperty(i,"mediaStream",{value:e}),i},zv=(n,e)=>(t,{mediaStreamTrack:s})=>{if(typeof t.createMediaStreamTrackSource=="function")return t.createMediaStreamTrackSource(s);const i=new MediaStream([s]),r=t.createMediaStreamSource(i);if(s.kind!=="audio")throw n();if(e(t))throw new TypeError;return r},Vv=n=>n===null?null:n.hasOwnProperty("OfflineAudioContext")?n.OfflineAudioContext:n.hasOwnProperty("webkitOfflineAudioContext")?n.webkitOfflineAudioContext:null,jv=(n,e,t,s,i,r)=>(o,a)=>{const c=o.createOscillator();return Qe(c,a),ze(c,a,"detune"),ze(c,a,"frequency"),a.periodicWave!==void 0?c.setPeriodicWave(a.periodicWave):Fe(c,a,"type"),e(t,()=>t(o))||vc(c),e(s,()=>s(o))||r(c,o),e(i,()=>i(o))||yc(c),n(o,c),c},Hv=n=>(e,t)=>{const s=e.createPanner();return s.orientationX===void 0?n(e,t):(Qe(s,t),ze(s,t,"orientationX"),ze(s,t,"orientationY"),ze(s,t,"orientationZ"),ze(s,t,"positionX"),ze(s,t,"positionY"),ze(s,t,"positionZ"),Fe(s,t,"coneInnerAngle"),Fe(s,t,"coneOuterAngle"),Fe(s,t,"coneOuterGain"),Fe(s,t,"distanceModel"),Fe(s,t,"maxDistance"),Fe(s,t,"panningModel"),Fe(s,t,"refDistance"),Fe(s,t,"rolloffFactor"),s)},qv=(n,e,t,s,i,r,o,a,c,l)=>(u,{coneInnerAngle:h,coneOuterAngle:d,coneOuterGain:f,distanceModel:m,maxDistance:p,orientationX:_,orientationY:y,orientationZ:k,panningModel:w,positionX:v,positionY:g,positionZ:S,refDistance:T,rolloffFactor:x,...b})=>{const A=u.createPanner();if(b.channelCount>2||b.channelCountMode==="max")throw o();Qe(A,b);const R={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},M=t(u,{...R,channelInterpretation:"speakers",numberOfInputs:6}),L=s(u,{...b,gain:1}),q=s(u,{...R,gain:1}),Y=s(u,{...R,gain:0}),W=s(u,{...R,gain:0}),V=s(u,{...R,gain:0}),z=s(u,{...R,gain:0}),$=s(u,{...R,gain:0}),Q=i(u,256,6,1),te=r(u,{...R,curve:new Float32Array([1,1]),oversample:"none"});let N=[_,y,k],F=[v,g,S];const C=new Float32Array(1);Q.onaudioprocess=({inputBuffer:B})=>{const ie=[c(B,C,0),c(B,C,1),c(B,C,2)];ie.some((ne,J)=>ne!==N[J])&&(A.setOrientation(...ie),N=ie);const se=[c(B,C,3),c(B,C,4),c(B,C,5)];se.some((ne,J)=>ne!==F[J])&&(A.setPosition(...se),F=se)},Object.defineProperty(Y.gain,"defaultValue",{get:()=>0}),Object.defineProperty(W.gain,"defaultValue",{get:()=>0}),Object.defineProperty(V.gain,"defaultValue",{get:()=>0}),Object.defineProperty(z.gain,"defaultValue",{get:()=>0}),Object.defineProperty($.gain,"defaultValue",{get:()=>0});const P={get bufferSize(){},get channelCount(){return A.channelCount},set channelCount(B){if(B>2)throw o();L.channelCount=B,A.channelCount=B},get channelCountMode(){return A.channelCountMode},set channelCountMode(B){if(B==="max")throw o();L.channelCountMode=B,A.channelCountMode=B},get channelInterpretation(){return A.channelInterpretation},set channelInterpretation(B){L.channelInterpretation=B,A.channelInterpretation=B},get coneInnerAngle(){return A.coneInnerAngle},set coneInnerAngle(B){A.coneInnerAngle=B},get coneOuterAngle(){return A.coneOuterAngle},set coneOuterAngle(B){A.coneOuterAngle=B},get coneOuterGain(){return A.coneOuterGain},set coneOuterGain(B){if(B<0||B>1)throw e();A.coneOuterGain=B},get context(){return A.context},get distanceModel(){return A.distanceModel},set distanceModel(B){A.distanceModel=B},get inputs(){return[L]},get maxDistance(){return A.maxDistance},set maxDistance(B){if(B<0)throw new RangeError;A.maxDistance=B},get numberOfInputs(){return A.numberOfInputs},get numberOfOutputs(){return A.numberOfOutputs},get orientationX(){return q.gain},get orientationY(){return Y.gain},get orientationZ(){return W.gain},get panningModel(){return A.panningModel},set panningModel(B){A.panningModel=B},get positionX(){return V.gain},get positionY(){return z.gain},get positionZ(){return $.gain},get refDistance(){return A.refDistance},set refDistance(B){if(B<0)throw new RangeError;A.refDistance=B},get rolloffFactor(){return A.rolloffFactor},set rolloffFactor(B){if(B<0)throw new RangeError;A.rolloffFactor=B},addEventListener(...B){return L.addEventListener(B[0],B[1],B[2])},dispatchEvent(...B){return L.dispatchEvent(B[0])},removeEventListener(...B){return L.removeEventListener(B[0],B[1],B[2])}};h!==P.coneInnerAngle&&(P.coneInnerAngle=h),d!==P.coneOuterAngle&&(P.coneOuterAngle=d),f!==P.coneOuterGain&&(P.coneOuterGain=f),m!==P.distanceModel&&(P.distanceModel=m),p!==P.maxDistance&&(P.maxDistance=p),_!==P.orientationX.value&&(P.orientationX.value=_),y!==P.orientationY.value&&(P.orientationY.value=y),k!==P.orientationZ.value&&(P.orientationZ.value=k),w!==P.panningModel&&(P.panningModel=w),v!==P.positionX.value&&(P.positionX.value=v),g!==P.positionY.value&&(P.positionY.value=g),S!==P.positionZ.value&&(P.positionZ.value=S),T!==P.refDistance&&(P.refDistance=T),x!==P.rolloffFactor&&(P.rolloffFactor=x),(N[0]!==1||N[1]!==0||N[2]!==0)&&A.setOrientation(...N),(F[0]!==0||F[1]!==0||F[2]!==0)&&A.setPosition(...F);const G=()=>{L.connect(A),n(L,te,0,0),te.connect(q).connect(M,0,0),te.connect(Y).connect(M,0,1),te.connect(W).connect(M,0,2),te.connect(V).connect(M,0,3),te.connect(z).connect(M,0,4),te.connect($).connect(M,0,5),M.connect(Q).connect(u.destination)},I=()=>{L.disconnect(A),a(L,te,0,0),te.disconnect(q),q.disconnect(M),te.disconnect(Y),Y.disconnect(M),te.disconnect(W),W.disconnect(M),te.disconnect(V),V.disconnect(M),te.disconnect(z),z.disconnect(M),te.disconnect($),$.disconnect(M),M.disconnect(Q),Q.disconnect(u.destination)};return l(mi(P,A),G,I)},Gv=n=>(e,{disableNormalization:t,imag:s,real:i})=>{const r=s instanceof Float32Array?s:new Float32Array(s),o=i instanceof Float32Array?i:new Float32Array(i),a=e.createPeriodicWave(o,r,{disableNormalization:t});if(Array.from(s).length<2)throw n();return a},Er=(n,e,t,s)=>n.createScriptProcessor(e,t,s),Wv=(n,e)=>(t,s)=>{const i=s.channelCountMode;if(i==="clamped-max")throw e();if(t.createStereoPanner===void 0)return n(t,s);const r=t.createStereoPanner();return Qe(r,s),ze(r,s,"pan"),Object.defineProperty(r,"channelCountMode",{get:()=>i,set:o=>{if(o!==i)throw e()}}),r},Yv=(n,e,t,s,i,r)=>{const a=new Float32Array([1,1]),c=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...l,oversample:"none"},h=(m,p,_,y)=>{const k=new Float32Array(16385),w=new Float32Array(16385);for(let b=0;b<16385;b+=1){const A=b/16384*c;k[b]=Math.cos(A),w[b]=Math.sin(A)}const v=t(m,{...l,gain:0}),g=s(m,{...u,curve:k}),S=s(m,{...u,curve:a}),T=t(m,{...l,gain:0}),x=s(m,{...u,curve:w});return{connectGraph(){p.connect(v),p.connect(S.inputs===void 0?S:S.inputs[0]),p.connect(T),S.connect(_),_.connect(g.inputs===void 0?g:g.inputs[0]),_.connect(x.inputs===void 0?x:x.inputs[0]),g.connect(v.gain),x.connect(T.gain),v.connect(y,0,0),T.connect(y,0,1)},disconnectGraph(){p.disconnect(v),p.disconnect(S.inputs===void 0?S:S.inputs[0]),p.disconnect(T),S.disconnect(_),_.disconnect(g.inputs===void 0?g:g.inputs[0]),_.disconnect(x.inputs===void 0?x:x.inputs[0]),g.disconnect(v.gain),x.disconnect(T.gain),v.disconnect(y,0,0),T.disconnect(y,0,1)}}},d=(m,p,_,y)=>{const k=new Float32Array(16385),w=new Float32Array(16385),v=new Float32Array(16385),g=new Float32Array(16385),S=Math.floor(16385/2);for(let V=0;V<16385;V+=1)if(V>S){const z=(V-S)/(16384-S)*c;k[V]=Math.cos(z),w[V]=Math.sin(z),v[V]=0,g[V]=1}else{const z=V/(16384-S)*c;k[V]=1,w[V]=0,v[V]=Math.cos(z),g[V]=Math.sin(z)}const T=e(m,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),x=t(m,{...l,gain:0}),b=s(m,{...u,curve:k}),A=t(m,{...l,gain:0}),R=s(m,{...u,curve:w}),M=s(m,{...u,curve:a}),L=t(m,{...l,gain:0}),q=s(m,{...u,curve:v}),Y=t(m,{...l,gain:0}),W=s(m,{...u,curve:g});return{connectGraph(){p.connect(T),p.connect(M.inputs===void 0?M:M.inputs[0]),T.connect(x,0),T.connect(A,0),T.connect(L,1),T.connect(Y,1),M.connect(_),_.connect(b.inputs===void 0?b:b.inputs[0]),_.connect(R.inputs===void 0?R:R.inputs[0]),_.connect(q.inputs===void 0?q:q.inputs[0]),_.connect(W.inputs===void 0?W:W.inputs[0]),b.connect(x.gain),R.connect(A.gain),q.connect(L.gain),W.connect(Y.gain),x.connect(y,0,0),L.connect(y,0,0),A.connect(y,0,1),Y.connect(y,0,1)},disconnectGraph(){p.disconnect(T),p.disconnect(M.inputs===void 0?M:M.inputs[0]),T.disconnect(x,0),T.disconnect(A,0),T.disconnect(L,1),T.disconnect(Y,1),M.disconnect(_),_.disconnect(b.inputs===void 0?b:b.inputs[0]),_.disconnect(R.inputs===void 0?R:R.inputs[0]),_.disconnect(q.inputs===void 0?q:q.inputs[0]),_.disconnect(W.inputs===void 0?W:W.inputs[0]),b.disconnect(x.gain),R.disconnect(A.gain),q.disconnect(L.gain),W.disconnect(Y.gain),x.disconnect(y,0,0),L.disconnect(y,0,0),A.disconnect(y,0,1),Y.disconnect(y,0,1)}}},f=(m,p,_,y,k)=>{if(p===1)return h(m,_,y,k);if(p===2)return d(m,_,y,k);throw i()};return(m,{channelCount:p,channelCountMode:_,pan:y,...k})=>{if(_==="max")throw i();const w=n(m,{...k,channelCount:1,channelCountMode:_,numberOfInputs:2}),v=t(m,{...k,channelCount:p,channelCountMode:_,gain:1}),g=t(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:y});let{connectGraph:S,disconnectGraph:T}=f(m,p,v,g,w);Object.defineProperty(g.gain,"defaultValue",{get:()=>0}),Object.defineProperty(g.gain,"maxValue",{get:()=>1}),Object.defineProperty(g.gain,"minValue",{get:()=>-1});const x={get bufferSize(){},get channelCount(){return v.channelCount},set channelCount(M){v.channelCount!==M&&(b&&T(),{connectGraph:S,disconnectGraph:T}=f(m,M,v,g,w),b&&S()),v.channelCount=M},get channelCountMode(){return v.channelCountMode},set channelCountMode(M){if(M==="clamped-max"||M==="max")throw i();v.channelCountMode=M},get channelInterpretation(){return v.channelInterpretation},set channelInterpretation(M){v.channelInterpretation=M},get context(){return v.context},get inputs(){return[v]},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},get pan(){return g.gain},addEventListener(...M){return v.addEventListener(M[0],M[1],M[2])},dispatchEvent(...M){return v.dispatchEvent(M[0])},removeEventListener(...M){return v.removeEventListener(M[0],M[1],M[2])}};let b=!1;const A=()=>{S(),b=!0},R=()=>{T(),b=!1};return r(mi(x,w),A,R)}},Zv=(n,e,t,s,i,r,o)=>(a,c)=>{const l=a.createWaveShaper();if(r!==null&&r.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return t(a,c);Qe(l,c);const u=c.curve===null||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(u!==null&&u.length<2)throw e();Fe(l,{curve:u},"curve"),Fe(l,c,"oversample");let h=null,d=!1;return o(l,"curve",p=>()=>p.call(l),p=>_=>(p.call(l,_),d&&(s(_)&&h===null?h=n(a,l):!s(_)&&h!==null&&(h(),h=null)),_)),i(l,()=>{d=!0,s(l.curve)&&(h=n(a,l))},()=>{d=!1,h!==null&&(h(),h=null)})},$v=(n,e,t,s,i)=>(r,{curve:o,oversample:a,...c})=>{const l=r.createWaveShaper(),u=r.createWaveShaper();Qe(l,c),Qe(u,c);const h=t(r,{...c,gain:1}),d=t(r,{...c,gain:-1}),f=t(r,{...c,gain:1}),m=t(r,{...c,gain:-1});let p=null,_=!1,y=null;const k={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(g){h.channelCount=g,d.channelCount=g,l.channelCount=g,f.channelCount=g,u.channelCount=g,m.channelCount=g},get channelCountMode(){return l.channelCountMode},set channelCountMode(g){h.channelCountMode=g,d.channelCountMode=g,l.channelCountMode=g,f.channelCountMode=g,u.channelCountMode=g,m.channelCountMode=g},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(g){h.channelInterpretation=g,d.channelInterpretation=g,l.channelInterpretation=g,f.channelInterpretation=g,u.channelInterpretation=g,m.channelInterpretation=g},get context(){return l.context},get curve(){return y},set curve(g){if(g!==null&&g.length<2)throw e();if(g===null)l.curve=g,u.curve=g;else{const S=g.length,T=new Float32Array(S+2-S%2),x=new Float32Array(S+2-S%2);T[0]=g[0],x[0]=-g[S-1];const b=Math.ceil((S+1)/2),A=(S+1)/2-1;for(let R=1;R<b;R+=1){const M=R/b*A,L=Math.floor(M),q=Math.ceil(M);T[R]=L===q?g[L]:(1-(M-L))*g[L]+(1-(q-M))*g[q],x[R]=L===q?-g[S-1-L]:-((1-(M-L))*g[S-1-L])-(1-(q-M))*g[S-1-q]}T[b]=S%2===1?g[b-1]:(g[b-2]+g[b-1])/2,l.curve=T,u.curve=x}y=g,_&&(s(y)&&p===null?p=n(r,h):p!==null&&(p(),p=null))},get inputs(){return[h]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(g){l.oversample=g,u.oversample=g},addEventListener(...g){return h.addEventListener(g[0],g[1],g[2])},dispatchEvent(...g){return h.dispatchEvent(g[0])},removeEventListener(...g){return h.removeEventListener(g[0],g[1],g[2])}};o!==null&&(k.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==k.oversample&&(k.oversample=a);const w=()=>{h.connect(l).connect(f),h.connect(d).connect(u).connect(m).connect(f),_=!0,s(y)&&(p=n(r,h))},v=()=>{h.disconnect(l),l.disconnect(f),h.disconnect(d),d.disconnect(u),u.disconnect(m),m.disconnect(f),_=!1,p!==null&&(p(),p=null)};return i(mi(k,f),w,v)},ft=()=>new DOMException("","NotSupportedError"),Xv={numberOfChannels:1},Qv=(n,e,t,s,i)=>class extends n{constructor(o,a,c){let l;if(typeof o=="number"&&a!==void 0&&c!==void 0)l={length:a,numberOfChannels:o,sampleRate:c};else if(typeof o=="object")l=o;else throw new Error("The given parameters are not valid.");const{length:u,numberOfChannels:h,sampleRate:d}={...Xv,...l},f=s(h,u,d);e(Yi,()=>Yi(f))||f.addEventListener("statechange",(()=>{let m=0;const p=_=>{this._state==="running"&&(m>0?(f.removeEventListener("statechange",p),_.stopImmediatePropagation(),this._waitForThePromiseToSettle(_)):m+=1)};return p})()),super(f,h),this._length=u,this._nativeOfflineAudioContext=f,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(t()):(this._state="running",i(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,ih(this)}))}_waitForThePromiseToSettle(o){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(o):setTimeout(()=>this._waitForThePromiseToSettle(o))}},Kv={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Jv=(n,e,t,s,i,r,o)=>class extends n{constructor(c,l){const u=i(c),h={...Kv,...l},d=t(u,h),f=r(u),m=f?s():null,p=c.sampleRate/2;super(c,!1,d,m),this._detune=e(this,f,d.detune,153600,-153600),this._frequency=e(this,f,d.frequency,p,-p),this._nativeOscillatorNode=d,this._onended=null,this._oscillatorNodeRenderer=m,this._oscillatorNodeRenderer!==null&&h.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=h.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?o(this,c):null;this._nativeOscillatorNode.onended=l;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===l?c:u}get type(){return this._nativeOscillatorNode.type}set type(c){this._nativeOscillatorNode.type=c,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(c){this._nativeOscillatorNode.setPeriodicWave(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=c)}start(c=0){if(this._nativeOscillatorNode.start(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=c),this.context.state!=="closed"){si(this);const l=()=>{this._nativeOscillatorNode.removeEventListener("ended",l),Ts(this)&&wr(this)};this._nativeOscillatorNode.addEventListener("ended",l)}}stop(c=0){this._nativeOscillatorNode.stop(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=c)}},ey=(n,e,t,s,i)=>()=>{const r=new WeakMap;let o=null,a=null,c=null;const l=async(u,h)=>{let d=t(u);const f=at(d,h);if(!f){const m={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,detune:d.detune.value,frequency:d.frequency.value,periodicWave:o===null?void 0:o,type:d.type};d=e(h,m),a!==null&&d.start(a),c!==null&&d.stop(c)}return r.set(h,d),f?(await n(h,u.detune,d.detune),await n(h,u.frequency,d.frequency)):(await s(h,u.detune,d.detune),await s(h,u.frequency,d.frequency)),await i(u,h,d),d};return{set periodicWave(u){o=u},set start(u){a=u},set stop(u){c=u},render(u,h){const d=r.get(h);return d!==void 0?Promise.resolve(d):l(u,h)}}},ty={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},sy=(n,e,t,s,i,r,o)=>class extends n{constructor(c,l){const u=i(c),h={...ty,...l},d=t(u,h),f=r(u),m=f?s():null;super(c,!1,d,m),this._nativePannerNode=d,this._orientationX=e(this,f,d.orientationX,ct,mt),this._orientationY=e(this,f,d.orientationY,ct,mt),this._orientationZ=e(this,f,d.orientationZ,ct,mt),this._positionX=e(this,f,d.positionX,ct,mt),this._positionY=e(this,f,d.positionY,ct,mt),this._positionZ=e(this,f,d.positionZ,ct,mt),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(c){this._nativePannerNode.coneInnerAngle=c}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(c){this._nativePannerNode.coneOuterAngle=c}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(c){this._nativePannerNode.coneOuterGain=c}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(c){this._nativePannerNode.distanceModel=c}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(c){this._nativePannerNode.maxDistance=c}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(c){this._nativePannerNode.panningModel=c}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(c){this._nativePannerNode.refDistance=c}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(c){this._nativePannerNode.rolloffFactor=c}},ny=(n,e,t,s,i,r,o,a,c,l)=>()=>{const u=new WeakMap;let h=null;const d=async(f,m)=>{let p=null,_=r(f);const y={channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation},k={...y,coneInnerAngle:_.coneInnerAngle,coneOuterAngle:_.coneOuterAngle,coneOuterGain:_.coneOuterGain,distanceModel:_.distanceModel,maxDistance:_.maxDistance,panningModel:_.panningModel,refDistance:_.refDistance,rolloffFactor:_.rolloffFactor},w=at(_,m);if("bufferSize"in _)p=s(m,{...y,gain:1});else if(!w){const v={...k,orientationX:_.orientationX.value,orientationY:_.orientationY.value,orientationZ:_.orientationZ.value,positionX:_.positionX.value,positionY:_.positionY.value,positionZ:_.positionZ.value};_=i(m,v)}if(u.set(m,p===null?_:p),p!==null){if(h===null){if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");const R=new o(6,f.context.length,m.sampleRate),M=e(R,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});M.connect(R.destination),h=(async()=>{const L=await Promise.all([f.orientationX,f.orientationY,f.orientationZ,f.positionX,f.positionY,f.positionZ].map(async(q,Y)=>{const W=t(R,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Y===0?1:0});return await a(R,q,W.offset),W}));for(let q=0;q<6;q+=1)L[q].connect(M,0,q),L[q].start(0);return l(R)})()}const v=await h,g=s(m,{...y,gain:1});await c(f,m,g);const S=[];for(let R=0;R<v.numberOfChannels;R+=1)S.push(v.getChannelData(R));let T=[S[0][0],S[1][0],S[2][0]],x=[S[3][0],S[4][0],S[5][0]],b=s(m,{...y,gain:1}),A=i(m,{...k,orientationX:T[0],orientationY:T[1],orientationZ:T[2],positionX:x[0],positionY:x[1],positionZ:x[2]});g.connect(b).connect(A.inputs[0]),A.connect(p);for(let R=128;R<v.length;R+=128){const M=[S[0][R],S[1][R],S[2][R]],L=[S[3][R],S[4][R],S[5][R]];if(M.some((q,Y)=>q!==T[Y])||L.some((q,Y)=>q!==x[Y])){T=M,x=L;const q=R/m.sampleRate;b.gain.setValueAtTime(0,q),b=s(m,{...y,gain:0}),A=i(m,{...k,orientationX:T[0],orientationY:T[1],orientationZ:T[2],positionX:x[0],positionY:x[1],positionZ:x[2]}),b.gain.setValueAtTime(1,q),g.connect(b).connect(A.inputs[0]),A.connect(p)}}return p}return w?(await n(m,f.orientationX,_.orientationX),await n(m,f.orientationY,_.orientationY),await n(m,f.orientationZ,_.orientationZ),await n(m,f.positionX,_.positionX),await n(m,f.positionY,_.positionY),await n(m,f.positionZ,_.positionZ)):(await a(m,f.orientationX,_.orientationX),await a(m,f.orientationY,_.orientationY),await a(m,f.orientationZ,_.orientationZ),await a(m,f.positionX,_.positionX),await a(m,f.positionY,_.positionY),await a(m,f.positionZ,_.positionZ)),pi(_)?await c(f,m,_.inputs[0]):await c(f,m,_),_};return{render(f,m){const p=u.get(m);return p!==void 0?Promise.resolve(p):d(f,m)}}},iy={disableNormalization:!1},ry=(n,e,t,s)=>class ph{constructor(r,o){const a=e(r),c=s({...iy,...o}),l=n(a,c);return t.add(l),l}static[Symbol.hasInstance](r){return r!==null&&typeof r=="object"&&Object.getPrototypeOf(r)===ph.prototype||t.has(r)}},oy=(n,e)=>(t,s,i)=>(n(s).replay(i),e(s,t,i)),ay=(n,e,t)=>async(s,i,r)=>{const o=n(s);await Promise.all(o.activeInputs.map((a,c)=>Array.from(a).map(async([l,u])=>{const d=await e(l).render(l,i),f=s.context.destination;!t(l)&&(s!==f||!t(s))&&d.connect(r,u,c)})).reduce((a,c)=>[...a,...c],[]))},cy=(n,e,t)=>async(s,i,r)=>{const o=e(s);await Promise.all(Array.from(o.activeInputs).map(async([a,c])=>{const u=await n(a).render(a,i);t(a)||u.connect(r,c)}))},ly=(n,e,t,s)=>i=>n(Yi,()=>Yi(i))?Promise.resolve(n(s,s)).then(r=>{if(!r){const o=t(i,512,0,1);i.oncomplete=()=>{o.onaudioprocess=null,o.disconnect()},o.onaudioprocess=()=>i.currentTime,o.connect(i.destination)}return i.startRendering()}):new Promise(r=>{const o=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=a=>{o.disconnect(),r(a.renderedBuffer)},o.connect(i.destination),i.startRendering()}),uy=n=>(e,t)=>{n.set(e,t)},hy=n=>(e,t)=>n.set(e,t),dy=(n,e,t,s,i,r,o,a)=>(c,l)=>t(c).render(c,l).then(()=>Promise.all(Array.from(s(l)).map(u=>t(u).render(u,l)))).then(()=>i(l)).then(u=>(typeof u.copyFromChannel!="function"?(o(u),mc(u)):e(r,()=>r(u))||a(u),n.add(u),u)),fy={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},py=(n,e,t,s,i,r)=>class extends n{constructor(a,c){const l=i(a),u={...fy,...c},h=t(l,u),d=r(l),f=d?s():null;super(a,!1,h,f),this._pan=e(this,d,h.pan)}get pan(){return this._pan}},my=(n,e,t,s,i)=>()=>{const r=new WeakMap,o=async(a,c)=>{let l=t(a);const u=at(l,c);if(!u){const h={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=e(c,h)}return r.set(c,l),u?await n(c,a.pan,l.pan):await s(c,a.pan,l.pan),pi(l)?await i(a,c,l.inputs[0]):await i(a,c,l),l};return{render(a,c){const l=r.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},_y=n=>()=>{if(n===null)return!1;try{new n({length:1,sampleRate:44100})}catch{return!1}return!0},gy=(n,e)=>async()=>{if(n===null)return!0;if(e===null)return!1;const t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),s=new e(1,128,44100),i=URL.createObjectURL(t);let r=!1,o=!1;try{await s.audioWorklet.addModule(i);const a=new n(s,"a",{numberOfOutputs:0}),c=s.createOscillator();a.port.onmessage=()=>r=!0,a.onprocessorerror=()=>o=!0,c.connect(a),c.start(0),await s.startRendering(),await new Promise(l=>setTimeout(l))}catch{}finally{URL.revokeObjectURL(i)}return r&&!o},vy=(n,e)=>()=>{if(e===null)return Promise.resolve(!1);const t=new e(1,1,44100),s=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{t.oncomplete=()=>{s.disconnect(),i(t.currentTime!==0)},t.startRendering()})},yy=()=>new DOMException("","UnknownError"),xy={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},Ty=(n,e,t,s,i,r,o)=>class extends n{constructor(c,l){const u=i(c),h={...xy,...l},d=t(u,h),m=r(u)?s():null;super(c,!0,d,m),this._isCurveNullified=!1,this._nativeWaveShaperNode=d,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(c){if(c===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(c.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=c}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(c){this._nativeWaveShaperNode.oversample=c}},ky=(n,e,t)=>()=>{const s=new WeakMap,i=async(r,o)=>{let a=e(r);if(!at(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=n(o,l)}return s.set(o,a),pi(a)?await t(r,o,a.inputs[0]):await t(r,o,a),a};return{render(r,o){const a=s.get(o);return a!==void 0?Promise.resolve(a):i(r,o)}}},wy=()=>typeof window>"u"?null:window,Sy=(n,e)=>t=>{t.copyFromChannel=(s,i,r=0)=>{const o=n(r),a=n(i);if(a>=t.numberOfChannels)throw e();const c=t.length,l=t.getChannelData(a),u=s.length;for(let h=o<0?-o:0;h+o<c&&h<u;h+=1)s[h]=l[h+o]},t.copyToChannel=(s,i,r=0)=>{const o=n(r),a=n(i);if(a>=t.numberOfChannels)throw e();const c=t.length,l=t.getChannelData(a),u=s.length;for(let h=o<0?-o:0;h+o<c&&h<u;h+=1)l[h+o]=s[h]}},by=n=>e=>{e.copyFromChannel=(t=>(s,i,r=0)=>{const o=n(r),a=n(i);if(o<e.length)return t.call(e,s,a,o)})(e.copyFromChannel),e.copyToChannel=(t=>(s,i,r=0)=>{const o=n(r),a=n(i);if(o<e.length)return t.call(e,s,a,o)})(e.copyToChannel)},Cy=n=>(e,t)=>{const s=t.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=s),n(e,"buffer",i=>()=>{const r=i.call(e);return r===s?null:r},i=>r=>i.call(e,r===null?s:r))},Ey=(n,e)=>(t,s)=>{s.channelCount=1,s.channelCountMode="explicit",Object.defineProperty(s,"channelCount",{get:()=>1,set:()=>{throw n()}}),Object.defineProperty(s,"channelCountMode",{get:()=>"explicit",set:()=>{throw n()}});const i=t.createBufferSource();e(s,()=>{const a=s.numberOfInputs;for(let c=0;c<a;c+=1)i.connect(s,0,c)},()=>i.disconnect(s))},mh=(n,e,t)=>n.copyFromChannel===void 0?n.getChannelData(t)[0]:(n.copyFromChannel(e,t),e[0]),_h=n=>{if(n===null)return!1;const e=n.length;return e%2!==0?n[Math.floor(e/2)]!==0:n[e/2-1]+n[e/2]!==0},Or=(n,e,t,s)=>{let i=n;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:r,set:o}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(n,e,{get:t(r),set:s(o)})},Oy=n=>({...n,outputChannelCount:n.outputChannelCount!==void 0?n.outputChannelCount:n.numberOfInputs===1&&n.numberOfOutputs===1?[n.channelCount]:Array.from({length:n.numberOfOutputs},()=>1)}),Ay=n=>({...n,channelCount:n.numberOfOutputs}),My=n=>{const{imag:e,real:t}=n;return e===void 0?t===void 0?{...n,imag:[0,0],real:[0,0]}:{...n,imag:Array.from(t,()=>0),real:t}:t===void 0?{...n,imag:e,real:Array.from(e,()=>0)}:{...n,imag:e,real:t}},gh=(n,e,t)=>{try{n.setValueAtTime(e,t)}catch(s){if(s.code!==9)throw s;gh(n,e,t+1e-7)}},Py=n=>{const e=n.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},Dy=n=>{const e=n.createBufferSource(),t=n.createBuffer(1,1,44100);e.buffer=t;try{e.start(0,1)}catch{return!1}return!0},Ry=n=>{const e=n.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},xc=n=>{const e=n.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},vh=n=>{const e=n.createBuffer(1,1,44100),t=n.createBufferSource();t.buffer=e,t.start(),t.stop();try{return t.stop(),!0}catch{return!1}},Tc=n=>{const e=n.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},Iy=n=>{const{port1:e,port2:t}=new MessageChannel;try{e.postMessage(n)}finally{e.close(),t.close()}},Ny=n=>{n.start=(e=>(t=0,s=0,i)=>{const r=n.buffer,o=r===null?s:Math.min(r.duration,s);r!==null&&o>r.duration-.5/n.context.sampleRate?e.call(n,t,0,0):e.call(n,t,o,i)})(n.start)},yh=(n,e)=>{const t=e.createGain();n.connect(t);const s=(i=>()=>{i.call(n,t),n.removeEventListener("ended",s)})(n.disconnect);n.addEventListener("ended",s),mi(n,t),n.stop=(i=>{let r=!1;return(o=0)=>{if(r)try{i.call(n,o)}catch{t.gain.setValueAtTime(0,o)}else i.call(n,o),r=!0}})(n.stop)},_i=(n,e)=>t=>{const s={value:n};return Object.defineProperties(t,{currentTarget:s,target:s}),typeof e=="function"?e.call(n,t):e.handleEvent.call(n,t)},Fy=s_(An),Uy=c_(An),Ly=xg(qo),xh=new WeakMap,By=Lg(xh),Xt=X_(new Map,new WeakMap),rs=wy(),Th=pv(Xt,ls),kc=Ug(ut),st=ay(ut,kc,Tn),zy=f_(Th,Ne,st),Re=Vg(Ho),Ms=Vv(rs),be=iv(Ms),kh=new WeakMap,wh=Mg(_i),Ar=vv(rs),wc=ev(Ar),Sc=tv(rs),Sh=sv(rs),Zi=xv(rs),Ze=L_(n_(Qu),a_(Fy,Uy,ho,Ly,fo,ut,By,kr,Ne,An,Ts,Tn,eo),Xt,$g(Ua,fo,ut,Ne,Wi,Ts),ls,Go,ft,_g(ho,Ua,ut,Ne,Wi,Re,Ts,be),wg(kh,ut,Yt),wh,Re,wc,Sc,Sh,be,Zi),Vy=d_(Ze,zy,ls,Th,Re,be),bc=new WeakSet,Zl=mv(rs),bh=lg(new Uint32Array(1)),Cc=Sy(bh,ls),Ec=by(bh),Ch=m_(bc,Xt,ft,Zl,Ms,_y(Zl),Cc,Ec),Wo=l_(Tt),Eh=cy(kc,Sr,Tn),us=ng(Eh),gi=gv(Wo,Xt,Py,Dy,Ry,xc,vh,Tc,Ny,Cy(Or),yh),hs=oy(Bg(Sr),Eh),jy=v_(us,gi,Ne,hs,st),Qt=B_(i_(Ku),kh,pc,z_,Xm,Qm,Km,Jm,e_,Ia,$u,Ar,gh),Hy=g_(Ze,jy,Qt,et,gi,Re,be,_i),qy=E_(Ze,O_,ls,et,yv(Tt,Or),Re,be,st),Gy=$_(us,dh,Ne,hs,st),Mn=hy(xh),Wy=Z_(Ze,Qt,Gy,Go,dh,Re,be,Mn),en=dv(An,Sc),Yy=Ey(et,en),tn=Ev(Ar,Yy),Zy=J_(tn,Ne,st),$y=K_(Ze,Zy,tn,Re,be),Xy=sg(Cr,Ne,st),Qy=tg(Ze,Xy,Cr,Re,be,Ay),Ky=Mv(Wo,gi,Tt,en),vi=Av(Wo,Xt,Ky,xc,Tc),Jy=cg(us,vi,Ne,hs,st),e1=ag(Ze,Qt,Jy,vi,Re,be,_i),Oh=Pv(ft,Or),t1=dg(Oh,Ne,st),s1=hg(Ze,t1,Oh,Re,be,Mn),n1=yg(us,fh,Ne,hs,st),i1=vg(Ze,Qt,n1,fh,Re,be,Mn),Ah=Dv(ft),r1=Eg(us,Ah,Ne,hs,st),o1=Cg(Ze,Qt,r1,Ah,ft,Re,be,Mn),a1=Ng(us,Tt,Ne,hs,st),c1=Ig(Ze,Qt,a1,Tt,Re,be),l1=Fv(Go,et,Er,ft),Yo=ly(Xt,Tt,Er,vy(Tt,Ms)),u1=Zg(gi,Ne,Ms,st,Yo),h1=Rv(l1),d1=Wg(Ze,h1,u1,Re,be,Mn),f1=A_(Qt,tn,vi,Er,ft,mh,be,Or),Mh=new WeakMap,p1=hv(qy,f1,wh,be,Mh,_i),Ph=jv(Wo,Xt,xc,vh,Tc,yh),m1=ey(us,Ph,Ne,hs,st),_1=Jv(Ze,Qt,Ph,m1,Re,be,_i),Dh=rg(gi),g1=$v(Dh,et,Tt,_h,en),Zo=Zv(Dh,et,g1,_h,en,Ar,Or),v1=qv(ho,et,tn,Tt,Er,Zo,ft,fo,mh,en),Rh=Hv(v1),y1=ny(us,tn,vi,Tt,Rh,Ne,Ms,hs,st,Yo),x1=sy(Ze,Qt,Rh,y1,Re,be,Mn),T1=Gv(ls),k1=ry(T1,Re,new WeakSet,My),w1=Yv(tn,Cr,Tt,Zo,ft,en),Ih=Wv(w1,ft),S1=my(us,Ih,Ne,hs,st),b1=py(Ze,Qt,Ih,S1,Re,be),C1=ky(Zo,Ne,st),E1=Ty(Ze,et,Zo,C1,Re,be,Mn),Nh=rv(rs),Oc=Pg(rs),Fh=new WeakMap,O1=jg(Fh,Ms),A1=Nh?o_(Xt,ft,Ag(rs),Oc,Dg(t_),Re,O1,be,Zi,new WeakMap,new WeakMap,gy(Zi,Ms),rs):void 0,M1=nv(wc,be),P1=mg(bc,Xt,pg,Og,new WeakSet,Re,M1,lo,Yi,Cc,Ec),Uh=W_(A1,Vy,Ch,Hy,Wy,$y,Qy,e1,s1,P1,i1,o1,c1,d1,p1,_1,x1,k1,b1,E1),D1=ov(Ze,Uv,Re,be),R1=cv(Ze,Lv,Re,be),I1=lv(Ze,Bv,Re,be),N1=zv(et,be),F1=uv(Ze,N1,Re),U1=C_(Uh,et,ft,yy,D1,R1,I1,F1,Ar),Ac=Hg(Mh),L1=u_(Ac),Lh=ig(ls),B1=Tg(Ac),Bh=Sg(ls),zh=new WeakMap,z1=Fg(zh,Yt),V1=Cv(Lh,ls,et,tn,Cr,vi,Tt,Er,ft,Bh,Oc,z1,en),j1=kv(et,V1,Tt,ft,en),H1=G_(us,Lh,gi,tn,Cr,vi,Tt,B1,Bh,Oc,Ne,Zi,Ms,hs,st,Yo),q1=zg(Fh),G1=uy(zh),$l=Nh?j_(L1,Ze,Qt,H1,j1,ut,q1,Re,be,Zi,Oy,G1,Iy,_i):void 0,W1=fg(ft,Ms),Y1=dy(bc,Xt,kc,Ac,Yo,lo,Cc,Ec),Z1=Qv(Uh,Xt,et,W1,Y1),$1=Xg(Ho,wc),X1=Qg(fc,Sc),Q1=Kg(pc,Sh),K1=Jg(Ho,be);function Et(n){return typeof n>"u"}function me(n){return!Et(n)}function J1(n){return typeof n=="function"}function Ys(n){return typeof n=="number"}function mn(n){return Object.prototype.toString.call(n)==="[object Object]"&&n.constructor===Object}function ex(n){return typeof n=="boolean"}function Wt(n){return Array.isArray(n)}function ws(n){return typeof n=="string"}function Yr(n){return ws(n)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(n)}function de(n,e){if(!n)throw new Error(e)}function Zt(n,e,t=1/0){if(!(e<=n&&n<=t))throw new RangeError(`Value must be within [${e}, ${t}], got: ${n}`)}function Vh(n){!n.isOffline&&n.state!=="running"&&Mc('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let jh=!1,Xl=!1;function Ql(n){jh=n}function tx(n){Et(n)&&jh&&!Xl&&(Xl=!0,Mc("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing"))}let Hh=console;function sx(...n){Hh.log(...n)}function Mc(...n){Hh.warn(...n)}function nx(n){return new U1(n)}function ix(n,e,t){return new Z1(n,e,t)}const _n=typeof self=="object"?self:null,rx=_n&&(_n.hasOwnProperty("AudioContext")||_n.hasOwnProperty("webkitAudioContext"));function ox(n,e,t){return de(me($l),"This node only works in a secure context (https or localhost)"),new $l(n,e,t)}class ax{constructor(e,t,s,i){this._callback=e,this._type=t,this._minimumUpdateInterval=Math.max(128/(i||44100),.001),this.updateInterval=s,this._createClock()}_createWorker(){const e=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),t=URL.createObjectURL(e),s=new Worker(t);s.onmessage=this._callback.bind(this),this._worker=s}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){var t;this._updateInterval=Math.max(e,this._minimumUpdateInterval),this._type==="worker"&&((t=this._worker)===null||t===void 0||t.postMessage(this._updateInterval*1e3))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}}function kn(n){return Q1(n)}function qs(n){return X1(n)}function to(n){return K1(n)}function jn(n){return $1(n)}function cx(n){return n instanceof Ch}function lx(n,e){return n==="value"||kn(e)||qs(e)||cx(e)}function Zn(n,...e){if(!e.length)return n;const t=e.shift();if(mn(n)&&mn(t))for(const s in t)lx(s,t[s])?n[s]=t[s]:mn(t[s])?(n[s]||Object.assign(n,{[s]:{}}),Zn(n[s],t[s])):Object.assign(n,{[s]:t[s]});return Zn(n,...e)}function ux(n,e){return n.length===e.length&&n.every((t,s)=>e[s]===t)}function Z(n,e,t=[],s){const i={},r=Array.from(e);if(mn(r[0])&&s&&!Reflect.has(r[0],s)&&(Object.keys(r[0]).some(a=>Reflect.has(n,a))||(Zn(i,{[s]:r[0]}),t.splice(t.indexOf(s),1),r.shift())),r.length===1&&mn(r[0]))Zn(i,r[0]);else for(let o=0;o<t.length;o++)me(r[o])&&(i[t[o]]=r[o]);return Zn(n,i)}function hx(n){return n.constructor.getDefaults()}function $n(n,e){return Et(n)?e:n}function qn(n,e){return e.forEach(t=>{Reflect.has(n,t)&&delete n[t]}),n}/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2019 Yotam Mann
 */class Ps{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...e){(this.debug||_n&&this.toString()===_n.TONE_DEBUG_CLASS)&&sx(this,...e)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}Ps.version=Zu;const Pc=1e-6;function ni(n,e){return n>e+Pc}function ja(n,e){return ni(n,e)||Ht(n,e)}function go(n,e){return n+Pc<e}function Ht(n,e){return Math.abs(n-e)<Pc}function dx(n,e,t){return Math.max(Math.min(n,t),e)}let ns=class qh extends Ps{constructor(){super(),this.name="Timeline",this._timeline=[];const e=Z(qh.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(de(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){const t=this._timeline[this.length-1];de(ja(e.time,t.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{const t=this._search(e.time);this._timeline.splice(t+1,0,e)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(e){const t=this._timeline.indexOf(e);return t!==-1&&this._timeline.splice(t,1),this}get(e,t="time"){const s=this._search(e,t);return s!==-1?this._timeline[s]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,t="time"){const s=this._search(e,t);return s+1<this._timeline.length?this._timeline[s+1]:null}getBefore(e){const t=this._timeline.length;if(t>0&&this._timeline[t-1].time<e)return this._timeline[t-1];const s=this._search(e);return s-1>=0?this._timeline[s-1]:null}cancel(e){if(this._timeline.length>1){let t=this._search(e);if(t>=0)if(Ht(this._timeline[t].time,e)){for(let s=t;s>=0&&Ht(this._timeline[s].time,e);s--)t=s;this._timeline=this._timeline.slice(0,t)}else this._timeline=this._timeline.slice(0,t+1);else this._timeline=[]}else this._timeline.length===1&&ja(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){const t=this._search(e);return t>=0&&(this._timeline=this._timeline.slice(t+1)),this}previousEvent(e){const t=this._timeline.indexOf(e);return t>0?this._timeline[t-1]:null}_search(e,t="time"){if(this._timeline.length===0)return-1;let s=0;const i=this._timeline.length;let r=i;if(i>0&&this._timeline[i-1][t]<=e)return i-1;for(;s<r;){let o=Math.floor(s+(r-s)/2);const a=this._timeline[o],c=this._timeline[o+1];if(Ht(a[t],e)){for(let l=o;l<this._timeline.length;l++){const u=this._timeline[l];if(Ht(u[t],e))o=l;else break}return o}else{if(go(a[t],e)&&ni(c[t],e))return o;ni(a[t],e)?r=o:s=o+1}}return-1}_iterate(e,t=0,s=this._timeline.length-1){this._timeline.slice(t,s+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,t){const s=this._search(e);return s!==-1&&this._iterate(t,0,s),this}forEachAfter(e,t){const s=this._search(e);return this._iterate(t,s+1),this}forEachBetween(e,t,s){let i=this._search(e),r=this._search(t);return i!==-1&&r!==-1?(this._timeline[i].time!==e&&(i+=1),this._timeline[r].time===t&&(r-=1),this._iterate(s,i,r)):i===-1&&this._iterate(s,0,r),this}forEachFrom(e,t){let s=this._search(e);for(;s>=0&&this._timeline[s].time>=e;)s--;return this._iterate(t,s+1),this}forEachAtTime(e,t){const s=this._search(e);if(s!==-1&&Ht(this._timeline[s].time,e)){let i=s;for(let r=s;r>=0&&Ht(this._timeline[r].time,e);r--)i=r;this._iterate(r=>{t(r)},i,s)}return this}dispose(){return super.dispose(),this._timeline=[],this}};const Gh=[];function $o(n){Gh.push(n)}function fx(n){Gh.forEach(e=>e(n))}const Wh=[];function Xo(n){Wh.push(n)}function px(n){Wh.forEach(e=>e(n))}class Mr extends Ps{constructor(){super(...arguments),this.name="Emitter"}on(e,t){return e.split(/\W+/).forEach(i=>{Et(this._events)&&(this._events={}),this._events.hasOwnProperty(i)||(this._events[i]=[]),this._events[i].push(t)}),this}once(e,t){const s=(...i)=>{t(...i),this.off(e,s)};return this.on(e,s),this}off(e,t){return e.split(/\W+/).forEach(i=>{if(Et(this._events)&&(this._events={}),this._events.hasOwnProperty(i))if(Et(t))this._events[i]=[];else{const r=this._events[i];for(let o=r.length-1;o>=0;o--)r[o]===t&&r.splice(o,1)}}),this}emit(e,...t){if(this._events&&this._events.hasOwnProperty(e)){const s=this._events[e].slice(0);for(let i=0,r=s.length;i<r;i++)s[i].apply(this,t)}return this}static mixin(e){["on","once","off","emit"].forEach(t=>{const s=Object.getOwnPropertyDescriptor(Mr.prototype,t);Object.defineProperty(e.prototype,t,s)})}dispose(){return super.dispose(),this._events=void 0,this}}class Yh extends Mr{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}let Dc=class Zh extends Yh{constructor(){var e,t;super(),this.name="Context",this._constants=new Map,this._timeouts=new ns,this._timeoutIds=0,this._initialized=!1,this._closeStarted=!1,this.isOffline=!1,this._workletPromise=null;const s=Z(Zh.getDefaults(),arguments,["context"]);s.context?(this._context=s.context,this._latencyHint=((e=arguments[0])===null||e===void 0?void 0:e.latencyHint)||""):(this._context=nx({latencyHint:s.latencyHint}),this._latencyHint=s.latencyHint),this._ticker=new ax(this.emit.bind(this,"tick"),s.clockSource,s.updateInterval,this._context.sampleRate),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this[!((t=arguments[0])===null||t===void 0)&&t.hasOwnProperty("updateInterval")?"_lookAhead":"lookAhead"]=s.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(fx(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,t,s){return this._context.createBuffer(e,t,s)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,t){return this._context.createIIRFilter(e,t)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,t,s){return this._context.createPeriodicWave(e,t,s)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){return de(jn(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}createMediaElementSource(e){return de(jn(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(e)}createMediaStreamDestination(){return de(jn(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){de(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){de(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){de(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){de(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,t){return ox(this.rawContext,e,t)}addAudioWorkletModule(e){return We(this,void 0,void 0,function*(){de(me(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(e)),yield this._workletPromise})}workletsAreReady(){return We(this,void 0,void 0,function*(){(yield this._workletPromise)?this._workletPromise:Promise.resolve()})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get lookAhead(){return this._lookAhead}set lookAhead(e){this._lookAhead=e,this.updateInterval=e?e/2:.01}get latencyHint(){return this._latencyHint}get rawContext(){return this._context}now(){return this._context.currentTime+this._lookAhead}immediate(){return this._context.currentTime}resume(){return jn(this._context)?this._context.resume():Promise.resolve()}close(){return We(this,void 0,void 0,function*(){jn(this._context)&&this.state!=="closed"&&!this._closeStarted&&(this._closeStarted=!0,yield this._context.close()),this._initialized&&px(this)})}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{const t=this._context.createBuffer(1,128,this._context.sampleRate),s=t.getChannelData(0);for(let r=0;r<s.length;r++)s[r]=e;const i=this._context.createBufferSource();return i.channelCount=1,i.channelCountMode="explicit",i.buffer=t,i.loop=!0,i.start(0),this._constants.set(e,i),i}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this.close(),this}_timeoutLoop(){const e=this.now();let t=this._timeouts.peek();for(;this._timeouts.length&&t&&t.time<=e;)t.callback(),this._timeouts.shift(),t=this._timeouts.peek()}setTimeout(e,t){this._timeoutIds++;const s=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:s+t}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(t=>{t.id===e&&this._timeouts.remove(t)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,t){const s=++this._timeoutIds,i=()=>{const r=this.now();this._timeouts.add({callback:()=>{e(),i()},id:s,time:r+t})};return i(),s}};class mx extends Yh{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,t,s){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,t){return{}}createPanner(){return{}}createPeriodicWave(e,t,s){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,t){return{}}get rawContext(){return{}}addAudioWorkletModule(e){return We(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(e,t){return 0}clearTimeout(e){return this}setInterval(e,t){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}}function Ie(n,e){Wt(e)?e.forEach(t=>Ie(n,t)):Object.defineProperty(n,e,{enumerable:!0,writable:!1})}function Rc(n,e){Wt(e)?e.forEach(t=>Rc(n,t)):Object.defineProperty(n,e,{writable:!0})}const Te=()=>{};class we extends Ps{constructor(){super(),this.name="ToneAudioBuffer",this.onload=Te;const e=Z(we.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,ws(e.url)?this.load(e.url).catch(e.onerror):e.url&&this.set(e.url)}static getDefaults(){return{onerror:Te,onload:Te,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:qt().sampleRate}set(e){return e instanceof we?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return We(this,void 0,void 0,function*(){const t=we.load(e).then(s=>{this.set(s),this.onload(this)});we.downloads.push(t);try{yield t}finally{const s=we.downloads.indexOf(t);we.downloads.splice(s,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){const t=Wt(e)&&e[0].length>0,s=t?e.length:1,i=t?e[0].length:e.length,r=qt(),o=r.createBuffer(s,i,r.sampleRate),a=!t&&s===1?[e]:e;for(let c=0;c<s;c++)o.copyToChannel(a[c],c);return this._buffer=o,this}toMono(e){if(Ys(e))this.fromArray(this.toArray(e));else{let t=new Float32Array(this.length);const s=this.numberOfChannels;for(let i=0;i<s;i++){const r=this.toArray(i);for(let o=0;o<r.length;o++)t[o]+=r[o]}t=t.map(i=>i/s),this.fromArray(t)}return this}toArray(e){if(Ys(e))return this.getChannelData(e);if(this.numberOfChannels===1)return this.toArray(0);{const t=[];for(let s=0;s<this.numberOfChannels;s++)t[s]=this.getChannelData(s);return t}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e,t=this.duration){de(this.loaded,"Buffer is not loaded");const s=Math.floor(e*this.sampleRate),i=Math.floor(t*this.sampleRate);de(s<i,"The start time must be less than the end time");const r=i-s,o=qt().createBuffer(this.numberOfChannels,r,this.sampleRate);for(let a=0;a<this.numberOfChannels;a++)o.copyToChannel(this.getChannelData(a).subarray(s,i),a);return new we(o)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return new we().fromArray(e)}static fromUrl(e){return We(this,void 0,void 0,function*(){return yield new we().load(e)})}static load(e){return We(this,void 0,void 0,function*(){const t=e.match(/\[([^\]\[]+\|.+)\]$/);if(t){const c=t[1].split("|");let l=c[0];for(const u of c)if(we.supportsType(u)){l=u;break}e=e.replace(t[0],l)}const s=we.baseUrl===""||we.baseUrl.endsWith("/")?we.baseUrl:we.baseUrl+"/",i=document.createElement("a");i.href=s+e,i.pathname=(i.pathname+i.hash).split("/").map(encodeURIComponent).join("/");const r=yield fetch(i.href);if(!r.ok)throw new Error(`could not load url: ${e}`);const o=yield r.arrayBuffer();return yield qt().decodeAudioData(o)})}static supportsType(e){const t=e.split("."),s=t[t.length-1];return document.createElement("audio").canPlayType("audio/"+s)!==""}static loaded(){return We(this,void 0,void 0,function*(){for(yield Promise.resolve();we.downloads.length;)yield we.downloads[0]})}}we.baseUrl="";we.downloads=[];class Qo extends Dc{constructor(){super({clockSource:"offline",context:to(arguments[0])?arguments[0]:ix(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:to(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=to(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return We(this,void 0,void 0,function*(){let t=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,t++;const s=Math.floor(this.sampleRate/128);e&&t%s===0&&(yield new Promise(i=>setTimeout(i,1)))}})}render(e=!0){return We(this,void 0,void 0,function*(){yield this.workletsAreReady(),yield this._renderClock(e);const t=yield this._context.startRendering();return new we(t)})}close(){return Promise.resolve()}}const $h=new mx;let dn=$h;function qt(){return dn===$h&&rx&&_x(new Dc),dn}function _x(n,e=!1){e&&dn.dispose(),jn(n)?dn=new Dc(n):to(n)?dn=new Qo(n):dn=n}function gx(){return dn.resume()}if(_n&&!_n.TONE_SILENCE_LOGGING){const e=` * Tone.js v${Zu} * `;console.log(`%c${e}`,"background: #000; color: #fff")}function vx(n){return Math.pow(10,n/20)}function yx(n){return 20*(Math.log(n)/Math.LN10)}function Xh(n){return Math.pow(2,n/12)}let Ko=440;function xx(){return Ko}function Tx(n){Ko=n}function Ha(n){return Math.round(Qh(n))}function Qh(n){return 69+12*Math.log2(n/Ko)}function kx(n){return Ko*Math.pow(2,(n-69)/12)}class Ic extends Ps{constructor(e,t,s){super(),this.defaultUnits="s",this._val=t,this._units=s,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,t)=>{const s=parseInt(e,10),i=t==="."?1.5:1;return s===1?this._beatsToUnits(this._getTimeSignature())*i:this._beatsToUnits(4/s)*i},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{const t=parseInt(e,10);return this._beatsToUnits(8/(Math.floor(t)*3))},regexp:/^(\d+)t$/i},tr:{method:(e,t,s)=>{let i=0;return e&&e!=="0"&&(i+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(i+=this._beatsToUnits(parseFloat(t))),s&&s!=="0"&&(i+=this._beatsToUnits(parseFloat(s)/4)),i},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof Ic&&this.fromType(this._val),Et(this._val))return this._noArg();if(ws(this._val)&&Et(this._units)){for(const e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(mn(this._val)){let e=0;for(const t in this._val)if(me(this._val[t])){const s=this._val[t],i=new this.constructor(this.context,t).valueOf()*s;e+=i}return e}if(me(this._units)){const e=this._expressions[this._units],t=this._val.toString().trim().match(e.regexp);return t?e.method.apply(this,t.slice(1)):e.method.call(this,this._val)}else return ws(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}}class Gt extends Ic{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{const t=new Gt(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(t))},regexp:/^@(.+)/}})}quantize(e,t=1){const s=new this.constructor(this.context,e).valueOf(),i=this.valueOf(),a=Math.round(i/s)*s-i;return i+a*t}toNotation(){const e=this.toSeconds(),t=["1m"];for(let r=1;r<9;r++){const o=Math.pow(2,r);t.push(o+"n."),t.push(o+"n"),t.push(o+"t")}t.push("0");let s=t[0],i=new Gt(this.context,t[0]).toSeconds();return t.forEach(r=>{const o=new Gt(this.context,r).toSeconds();Math.abs(o-e)<Math.abs(i-e)&&(s=r,i=o)}),s}toBarsBeatsSixteenths(){const e=this._beatsToUnits(1);let t=this.valueOf()/e;t=parseFloat(t.toFixed(4));const s=Math.floor(t/this._getTimeSignature());let i=t%1*4;t=Math.floor(t)%this._getTimeSignature();const r=i.toString();return r.length>3&&(i=parseFloat(parseFloat(r).toFixed(3))),[s,t,i].join(":")}toTicks(){const e=this._beatsToUnits(1);return this.valueOf()/e*this._getPPQ()}toSeconds(){return this.valueOf()}toMidi(){return Ha(this.toFrequency())}_now(){return this.context.now()}}class It extends Gt{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return xx()}static set A4(e){Tx(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return this.defaultUnits==="midi"?e:It.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method(e,t){const i=wx[e.toLowerCase()]+(parseInt(t,10)+1)*12;return this.defaultUnits==="midi"?i:It.mtof(i)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,t,s){let i=1;return e&&e!=="0"&&(i*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(i*=this._beatsToUnits(parseFloat(t))),s&&s!=="0"&&(i*=this._beatsToUnits(parseFloat(s)/4)),i}}})}transpose(e){return new It(this.context,this.valueOf()*Xh(e))}harmonize(e){return e.map(t=>this.transpose(t))}toMidi(){return Ha(this.valueOf())}toNote(){const e=this.toFrequency(),t=Math.log2(e/It.A4);let s=Math.round(12*t)+57;const i=Math.floor(s/12);return i<0&&(s+=-12*i),Sx[s%12]+i.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.floor(t*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(e*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return kx(e)}static ftom(e){return Ha(e)}}const wx={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},Sx=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class Vi extends Gt{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class _t extends Ps{constructor(){super();const e=Z(_t.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:qt()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return tx(e),new Gt(this.context,e).toSeconds()}toFrequency(e){return new It(this.context,e).toFrequency()}toTicks(e){return new Vi(this.context,e).toTicks()}_getPartialProperties(e){const t=this.get();return Object.keys(t).forEach(s=>{Et(e[s])&&delete t[s]}),t}get(){const e=hx(this);return Object.keys(e).forEach(t=>{if(Reflect.has(this,t)){const s=this[t];me(s)&&me(s.value)&&me(s.setValueAtTime)?e[t]=s.value:s instanceof _t?e[t]=s._getPartialProperties(e[t]):Wt(s)||Ys(s)||ws(s)||ex(s)?e[t]=s:delete e[t]}}),e}set(e){return Object.keys(e).forEach(t=>{Reflect.has(this,t)&&me(this[t])&&(this[t]&&me(this[t].value)&&me(this[t].setValueAtTime)?this[t].value!==e[t]&&(this[t].value=e[t]):this[t]instanceof _t?this[t].set(e[t]):this[t]=e[t])}),this}}class Nc extends ns{constructor(e="stopped"){super(),this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){const t=this.get(e);return t!==null?t.state:this._initial}setStateAtTime(e,t,s){return Zt(t,0),this.add(Object.assign({},s,{state:e,time:t})),this}getLastState(e,t){const s=this._search(t);for(let i=s;i>=0;i--){const r=this._timeline[i];if(r.state===e)return r}}getNextState(e,t){const s=this._search(t);if(s!==-1)for(let i=s;i<this._timeline.length;i++){const r=this._timeline[i];if(r.state===e)return r}}}class Se extends _t{constructor(){super(Z(Se.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const e=Z(Se.getDefaults(),arguments,["param","units","convert"]);for(de(me(e.param)&&(kn(e.param)||e.param instanceof Se),"param must be an AudioParam");!kn(e.param);)e.param=e.param._param;this._swappable=me(e.swappable)?e.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new ns(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,me(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(_t.getDefaults(),{convert:!0,units:"number"})}get value(){const e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return me(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return me(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(e,t){return this.units===t}_assertRange(e){return me(this.maxValue)&&me(this.minValue)&&Zt(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?vx(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&this.units==="decibels"?yx(e):e}setValueAtTime(e,t){const s=this.toSeconds(t),i=this._fromType(e);return de(isFinite(i)&&isFinite(s),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(i),this.log(this.units,"setValueAtTime",e,s),this._events.add({time:s,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,s),this}getValueAtTime(e){const t=Math.max(this.toSeconds(e),0),s=this._events.getAfter(t),i=this._events.get(t);let r=this._initialValue;if(i===null)r=this._initialValue;else if(i.type==="setTargetAtTime"&&(s===null||s.type==="setValueAtTime")){const o=this._events.getBefore(i.time);let a;o===null?a=this._initialValue:a=o.value,i.type==="setTargetAtTime"&&(r=this._exponentialApproach(i.time,a,i.value,i.constant,t))}else if(s===null)r=i.value;else if(s.type==="linearRampToValueAtTime"||s.type==="exponentialRampToValueAtTime"){let o=i.value;if(i.type==="setTargetAtTime"){const a=this._events.getBefore(i.time);a===null?o=this._initialValue:o=a.value}s.type==="linearRampToValueAtTime"?r=this._linearInterpolate(i.time,o,s.time,s.value,t):r=this._exponentialInterpolate(i.time,o,s.time,s.value,t)}else r=i.value;return this._toType(r)}setRampPoint(e){e=this.toSeconds(e);let t=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),this._fromType(t)===0&&(t=this._toType(this._minOutput)),this.setValueAtTime(t,e),this}linearRampToValueAtTime(e,t){const s=this._fromType(e),i=this.toSeconds(t);return de(isFinite(s)&&isFinite(i),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(s),this._events.add({time:i,type:"linearRampToValueAtTime",value:s}),this.log(this.units,"linearRampToValueAtTime",e,i),this._param.linearRampToValueAtTime(s,i),this}exponentialRampToValueAtTime(e,t){let s=this._fromType(e);s=Ht(s,0)?this._minOutput:s,this._assertRange(s);const i=this.toSeconds(t);return de(isFinite(s)&&isFinite(i),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({time:i,type:"exponentialRampToValueAtTime",value:s}),this.log(this.units,"exponentialRampToValueAtTime",e,i),this._param.exponentialRampToValueAtTime(s,i),this}exponentialRampTo(e,t,s){return s=this.toSeconds(s),this.setRampPoint(s),this.exponentialRampToValueAtTime(e,s+this.toSeconds(t)),this}linearRampTo(e,t,s){return s=this.toSeconds(s),this.setRampPoint(s),this.linearRampToValueAtTime(e,s+this.toSeconds(t)),this}targetRampTo(e,t,s){return s=this.toSeconds(s),this.setRampPoint(s),this.exponentialApproachValueAtTime(e,s,t),this}exponentialApproachValueAtTime(e,t,s){t=this.toSeconds(t),s=this.toSeconds(s);const i=Math.log(s+1)/Math.log(200);return this.setTargetAtTime(e,t,i),this.cancelAndHoldAtTime(t+s*.9),this.linearRampToValueAtTime(e,t+s),this}setTargetAtTime(e,t,s){const i=this._fromType(e);de(isFinite(s)&&s>0,"timeConstant must be a number greater than 0");const r=this.toSeconds(t);return this._assertRange(i),de(isFinite(i)&&isFinite(r),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({constant:s,time:r,type:"setTargetAtTime",value:i}),this.log(this.units,"setTargetAtTime",e,r,s),this._param.setTargetAtTime(i,r,s),this}setValueCurveAtTime(e,t,s,i=1){s=this.toSeconds(s),t=this.toSeconds(t);const r=this._fromType(e[0])*i;this.setValueAtTime(this._toType(r),t);const o=s/(e.length-1);for(let a=1;a<e.length;a++){const c=this._fromType(e[a])*i;this.linearRampToValueAtTime(this._toType(c),t+a*o)}return this}cancelScheduledValues(e){const t=this.toSeconds(e);return de(isFinite(t),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(t),this._param.cancelScheduledValues(t),this.log(this.units,"cancelScheduledValues",t),this}cancelAndHoldAtTime(e){const t=this.toSeconds(e),s=this._fromType(this.getValueAtTime(t));de(isFinite(t),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",t,"value="+s);const i=this._events.get(t),r=this._events.getAfter(t);return i&&Ht(i.time,t)?r?(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time)):(this._param.cancelAndHoldAtTime(t),this._events.cancel(t+this.sampleTime)):r&&(this._param.cancelScheduledValues(r.time),this._events.cancel(r.time),r.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(s),t):r.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(s),t)),this._events.add({time:t,type:"setValueAtTime",value:s}),this._param.setValueAtTime(s,t),this}rampTo(e,t=.1,s){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(e,t,s):this.linearRampTo(e,t,s),this}apply(e){const t=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(t),t);const s=this._events.get(t);if(s&&s.type==="setTargetAtTime"){const i=this._events.getAfter(s.time),r=i?i.time:t+2,o=(r-t)/10;for(let a=t;a<r;a+=o)e.linearRampToValueAtTime(this.getValueAtTime(a),a)}return this._events.forEachAfter(this.context.currentTime,i=>{i.type==="cancelScheduledValues"?e.cancelScheduledValues(i.time):i.type==="setTargetAtTime"?e.setTargetAtTime(i.value,i.time,i.constant):e[i.type](i.value,i.time)}),this}setParam(e){de(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const t=this.input;return t.disconnect(this._param),this.apply(e),this._param=e,t.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,t,s,i,r){return s+(t-s)*Math.exp(-(r-e)/i)}_linearInterpolate(e,t,s,i,r){return t+(i-t)*((r-e)/(s-e))}_exponentialInterpolate(e,t,s,i,r){return t*Math.pow(i/t,(r-e)/(s-e))}}class re extends _t{constructor(){super(...arguments),this._internalChannels=[]}get numberOfInputs(){return me(this.input)?kn(this.input)||this.input instanceof Se?1:this.input.numberOfInputs:0}get numberOfOutputs(){return me(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return me(e)&&(e instanceof re||qs(e))}_getInternalNodes(){const e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach(s=>{s.channelCount=e.channelCount,s.channelCountMode=e.channelCountMode,s.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){const e=this._getInternalNodes();de(e.length>0,"ToneAudioNode does not have any internal nodes");const t=e[0];return{channelCount:t.channelCount,channelCountMode:t.channelCountMode,channelInterpretation:t.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelInterpretation:e}))}connect(e,t=0,s=0){return Zs(this,e,t,s),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return Mc("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,t=0,s=0){return bx(this,e,t,s),this}chain(...e){return $i(this,...e),this}fan(...e){return e.forEach(t=>this.connect(t)),this}dispose(){return super.dispose(),me(this.input)&&(this.input instanceof re?this.input.dispose():qs(this.input)&&this.input.disconnect()),me(this.output)&&(this.output instanceof re?this.output.dispose():qs(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function $i(...n){const e=n.shift();n.reduce((t,s)=>(t instanceof re?t.connect(s):qs(t)&&Zs(t,s),s),e)}function Zs(n,e,t=0,s=0){for(de(me(n),"Cannot connect from undefined node"),de(me(e),"Cannot connect to undefined node"),(e instanceof re||qs(e))&&de(e.numberOfInputs>0,"Cannot connect to node with no inputs"),de(n.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof re||e instanceof Se;)me(e.input)&&(e=e.input);for(;n instanceof re;)me(n.output)&&(n=n.output);kn(e)?n.connect(e,t):n.connect(e,t,s)}function bx(n,e,t=0,s=0){if(me(e))for(;e instanceof re;)e=e.input;for(;!qs(n);)me(n.output)&&(n=n.output);kn(e)?n.disconnect(e,t):qs(e)?n.disconnect(e,t,s):n.disconnect()}class Ae extends re{constructor(){super(Z(Ae.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const e=Z(Ae.getDefaults(),arguments,["gain","units"]);this.gain=new Se({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),Ie(this,"gain")}static getDefaults(){return Object.assign(re.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class ii extends re{constructor(e){super(e),this.onended=Te,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Ae({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const s=this.toSeconds(t);return this._startTime!==-1&&s>=this._startTime&&(this._stopTime===-1||s<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(re.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:Te})}_startGain(e,t=1){de(this._startTime===-1,"Source cannot be started more than once");const s=this.toSeconds(this._fadeIn);return this._startTime=e+s,this._startTime=Math.max(this._startTime,this.context.currentTime),s>0?(this._gainNode.gain.setValueAtTime(0,e),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(t,e+s):this._gainNode.gain.exponentialApproachValueAtTime(t,e,s)):this._gainNode.gain.setValueAtTime(t,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){de(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();const t=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+t,this._stopTime=Math.max(this._stopTime,this.now()),t>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,t,e):this._gainNode.gain.targetRampTo(0,t,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const s=this._curve==="exponential"?t*2:0;this._stopSource(this.now()+s),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==Te&&(this.onended(this),this.onended=Te,!this.context.isOffline)){const e=()=>this.dispose();typeof window.requestIdleCallback<"u"?window.requestIdleCallback(e):setTimeout(e,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),de(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.dispose(),this.onended=Te,this}}class vo extends ii{constructor(){super(Z(vo.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const e=Z(vo.getDefaults(),arguments,["offset"]);Zs(this._source,this._gainNode),this.offset=new Se({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(ii.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._source.start(t),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class De extends re{constructor(){super(Z(De.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const e=Z(De.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new vo({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(re.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,t=0,s=0){return Fc(this,e,t,s),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,t){return this._param.setValueAtTime(e,t),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,t){return this._param.linearRampToValueAtTime(e,t),this}exponentialRampToValueAtTime(e,t){return this._param.exponentialRampToValueAtTime(e,t),this}exponentialRampTo(e,t,s){return this._param.exponentialRampTo(e,t,s),this}linearRampTo(e,t,s){return this._param.linearRampTo(e,t,s),this}targetRampTo(e,t,s){return this._param.targetRampTo(e,t,s),this}exponentialApproachValueAtTime(e,t,s){return this._param.exponentialApproachValueAtTime(e,t,s),this}setTargetAtTime(e,t,s){return this._param.setTargetAtTime(e,t,s),this}setValueCurveAtTime(e,t,s,i){return this._param.setValueCurveAtTime(e,t,s,i),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,t,s){return this._param.rampTo(e,t,s),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}}function Fc(n,e,t,s){(e instanceof Se||kn(e)||e instanceof De&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof De&&(e.overridden=!0)),Zs(n,e,t,s)}class yo extends Se{constructor(){super(Z(yo.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new ns(1/0),this._multiplier=1;const e=Z(yo.getDefaults(),arguments,["value"]);this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Se.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,t,s){t=this.toSeconds(t),this.setRampPoint(t);const i=this._fromType(e),r=this._events.get(t),o=Math.round(Math.max(1/s,1));for(let a=0;a<=o;a++){const c=s*a+t,l=this._exponentialApproach(r.time,r.value,i,s,c);this.linearRampToValueAtTime(this._toType(l),c)}return this}setValueAtTime(e,t){const s=this.toSeconds(t);super.setValueAtTime(e,t);const i=this._events.get(s),r=this._events.previousEvent(i),o=this._getTicksUntilEvent(r,s);return i.ticks=Math.max(o,0),this}linearRampToValueAtTime(e,t){const s=this.toSeconds(t);super.linearRampToValueAtTime(e,t);const i=this._events.get(s),r=this._events.previousEvent(i),o=this._getTicksUntilEvent(r,s);return i.ticks=Math.max(o,0),this}exponentialRampToValueAtTime(e,t){t=this.toSeconds(t);const s=this._fromType(e),i=this._events.get(t),r=Math.round(Math.max((t-i.time)*10,1)),o=(t-i.time)/r;for(let a=0;a<=r;a++){const c=o*a+i.time,l=this._exponentialInterpolate(i.time,i.value,t,s,c);this.linearRampToValueAtTime(this._toType(l),c)}return this}_getTicksUntilEvent(e,t){if(e===null)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(Et(e.ticks)){const o=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(o,e.time)}const s=this._fromType(this.getValueAtTime(e.time));let i=this._fromType(this.getValueAtTime(t));const r=this._events.get(t);return r&&r.time===t&&r.type==="setValueAtTime"&&(i=this._fromType(this.getValueAtTime(t-this.sampleTime))),.5*(t-e.time)*(s+i)+e.ticks}getTicksAtTime(e){const t=this.toSeconds(e),s=this._events.get(t);return Math.max(this._getTicksUntilEvent(s,t),0)}getDurationOfTicks(e,t){const s=this.toSeconds(t),i=this.getTicksAtTime(t);return this.getTimeOfTick(i+e)-s}getTimeOfTick(e){const t=this._events.get(e,"ticks"),s=this._events.getAfter(e,"ticks");if(t&&t.ticks===e)return t.time;if(t&&s&&s.type==="linearRampToValueAtTime"&&t.value!==s.value){const i=this._fromType(this.getValueAtTime(t.time)),o=(this._fromType(this.getValueAtTime(s.time))-i)/(s.time-t.time),a=Math.sqrt(Math.pow(i,2)-2*o*(t.ticks-e)),c=(-i+a)/o,l=(-i-a)/o;return(c>0?c:l)+t.time}else return t?t.value===0?1/0:t.time+(e-t.ticks)/t.value:e/this._initialValue}ticksToTime(e,t){return this.getDurationOfTicks(e,t)}timeToTicks(e,t){const s=this.toSeconds(t),i=this.toSeconds(e),r=this.getTicksAtTime(s);return this.getTicksAtTime(s+i)-r}_fromType(e){return this.units==="bpm"&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return this.units==="bpm"&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){const t=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(t,0)}}class xo extends De{constructor(){super(Z(xo.getDefaults(),arguments,["value"])),this.name="TickSignal";const e=Z(xo.getDefaults(),arguments,["value"]);this.input=this._param=new yo({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(De.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,t){return this._param.ticksToTime(e,t)}timeToTicks(e,t){return this._param.timeToTicks(e,t)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,t){return this._param.getDurationOfTicks(e,t)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}}class To extends _t{constructor(){super(Z(To.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new Nc,this._tickOffset=new ns,this._ticksAtTime=new ns,this._secondsAtTime=new ns;const e=Z(To.getDefaults(),arguments,["frequency"]);this.frequency=new xo({context:this.context,units:e.units,value:e.frequency}),Ie(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},_t.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,t){const s=this.toSeconds(e);return this._state.getValueAtTime(s)!=="started"&&(this._state.setStateAtTime("started",s),me(t)&&this.setTicksAtTime(t,s),this._ticksAtTime.cancel(s),this._secondsAtTime.cancel(s)),this}stop(e){const t=this.toSeconds(e);if(this._state.getValueAtTime(t)==="stopped"){const s=this._state.get(t);s&&s.time>0&&(this._tickOffset.cancel(s.time),this._state.cancel(s.time))}return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this.setTicksAtTime(0,t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}pause(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&(this._state.setStateAtTime("paused",t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t)),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}getTicksAtTime(e){const t=this.toSeconds(e),s=this._state.getLastState("stopped",t),i=this._ticksAtTime.get(t),r={state:"paused",time:t};this._state.add(r);let o=i||s,a=i?i.ticks:0,c=null;return this._state.forEachBetween(o.time,t+this.sampleTime,l=>{let u=o.time;const h=this._tickOffset.get(l.time);h&&h.time>=o.time&&(a=h.ticks,u=h.time),o.state==="started"&&l.state!=="started"&&(a+=this.frequency.getTicksAtTime(l.time)-this.frequency.getTicksAtTime(u),l.time!=r.time&&(c={state:l.state,time:l.time,ticks:a})),o=l}),this._state.remove(r),c&&this._ticksAtTime.add(c),a}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){const t=this.now(),s=this.frequency.timeToTicks(e,t);this.setTicksAtTime(s,t)}getSecondsAtTime(e){e=this.toSeconds(e);const t=this._state.getLastState("stopped",e),s={state:"paused",time:e};this._state.add(s);const i=this._secondsAtTime.get(e);let r=i||t,o=i?i.seconds:0,a=null;return this._state.forEachBetween(r.time,e+this.sampleTime,c=>{let l=r.time;const u=this._tickOffset.get(c.time);u&&u.time>=r.time&&(o=u.seconds,l=u.time),r.state==="started"&&c.state!=="started"&&(o+=c.time-l,c.time!=s.time&&(a={state:c.state,time:c.time,seconds:o})),r=c}),this._state.remove(s),a&&this._secondsAtTime.add(a),o}setTicksAtTime(e,t){return t=this.toSeconds(t),this._tickOffset.cancel(t),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,t),ticks:e,time:t}),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,t=this.now()){const s=this._tickOffset.get(t),i=this._state.get(t),r=Math.max(s.time,i.time),o=this.frequency.getTicksAtTime(r)+e-s.ticks;return this.frequency.getTimeOfTick(o)}forEachTickBetween(e,t,s){let i=this._state.get(e);this._state.forEachBetween(e,t,o=>{i&&i.state==="started"&&o.state!=="started"&&this.forEachTickBetween(Math.max(i.time,e),o.time-this.sampleTime,s),i=o});let r=null;if(i&&i.state==="started"){const o=Math.max(i.time,e),a=this.frequency.getTicksAtTime(o),c=this.frequency.getTicksAtTime(i.time),l=a-c;let u=Math.ceil(l)-l;u=Ht(u,1)?0:u;let h=this.frequency.getTimeOfTick(a+u);for(;h<t;){try{s(h,Math.round(this.getTicksAtTime(h)))}catch(d){r=d;break}h+=this.frequency.getDurationOfTicks(1,h)}}if(r)throw r;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}}class Xi extends _t{constructor(){super(Z(Xi.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=Te,this._lastUpdate=0,this._state=new Nc("stopped"),this._boundLoop=this._loop.bind(this);const e=Z(Xi.getDefaults(),arguments,["callback","frequency"]);this.callback=e.callback,this._tickSource=new To({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,Ie(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(_t.getDefaults(),{callback:Te,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,t){Vh(this.context);const s=this.toSeconds(e);return this.log("start",s),this._state.getValueAtTime(s)!=="started"&&(this._state.setStateAtTime("started",s),this._tickSource.start(s,t),s<this._lastUpdate&&this.emit("start",s,t)),this}stop(e){const t=this.toSeconds(e);return this.log("stop",t),this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._tickSource.stop(t),t<this._lastUpdate&&this.emit("stop",t),this}pause(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&(this._state.setStateAtTime("paused",t),this._tickSource.pause(t),t<this._lastUpdate&&this.emit("pause",t)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,t){return this._tickSource.setTicksAtTime(e,t),this}getTimeOfTick(e,t=this.now()){return this._tickSource.getTimeOfTick(e,t)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,t){const s=this.toSeconds(t),i=this.getTicksAtTime(s);return this._tickSource.getTimeOfTick(i+e,s)}_loop(){const e=this._lastUpdate,t=this.now();this._lastUpdate=t,this.log("loop",e,t),e!==t&&(this._state.forEachBetween(e,t,s=>{switch(s.state){case"started":const i=this._tickSource.getTicksAtTime(s.time);this.emit("start",s.time,i);break;case"stopped":s.time!==0&&this.emit("stop",s.time);break;case"paused":this.emit("pause",s.time);break}}),this._tickSource.forEachTickBetween(e,t,(s,i)=>{this.callback(s,i)}))}getStateAtTime(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}Mr.mixin(Xi);class Uc extends Ps{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const e=Z(Uc.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach(t=>{this._loadingCount++;const s=e.urls[t];this.add(t,s,this._bufferLoaded.bind(this,e.onload),e.onerror)})}static getDefaults(){return{baseUrl:"",onerror:Te,onload:Te,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return de(this.has(e),`ToneAudioBuffers has no buffer named: ${e}`),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,this._loadingCount===0&&e&&e()}get loaded(){return Array.from(this._buffers).every(([e,t])=>t.loaded)}add(e,t,s=Te,i=Te){return ws(t)?(this.baseUrl&&t.trim().substring(0,11).toLowerCase()==="data:audio/"&&(this.baseUrl=""),this._buffers.set(e.toString(),new we(this.baseUrl+t,s,i))):this._buffers.set(e.toString(),new we(t,s,i)),this}dispose(){return super.dispose(),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this}}class Gn extends Vi{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class Cx extends _t{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new ns,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(e,t){return this._events.add({callback:e,time:this.toSeconds(t)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(e){return this._events.cancel(this.toSeconds(e)),this}_drawLoop(){const e=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=e;){const t=this._events.shift();t&&e-t.time<=this.expiration&&t.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}$o(n=>{n.draw=new Cx({context:n})});Xo(n=>{n.draw.dispose()});class Ex extends Ps{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(e){de(me(e.time),"Events must have a time property"),de(me(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let t=new Ox(e.time,e.time+e.duration,e);for(this._root===null?this._root=t:this._root.insert(t),this._length++;t!==null;)t.updateHeight(),t.updateMax(),this._rebalance(t),t=t.parent;return this}remove(e){if(this._root!==null){const t=[];this._root.search(e.time,t);for(const s of t)if(s.event===e){this._removeNode(s),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,t=>this.remove(t)),this}_setRoot(e){this._root=e,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(e,t){e.parent!==null?(e.isLeftChild()?e.parent.left=t:e.parent.right=t,this._rebalance(e.parent)):this._setRoot(t)}_removeNode(e){if(e.left===null&&e.right===null)this._replaceNodeInParent(e,null);else if(e.right===null)this._replaceNodeInParent(e,e.left);else if(e.left===null)this._replaceNodeInParent(e,e.right);else{const t=e.getBalance();let s,i=null;if(t>0)if(e.left.right===null)s=e.left,s.right=e.right,i=s;else{for(s=e.left.right;s.right!==null;)s=s.right;s.parent&&(s.parent.right=s.left,i=s.parent,s.left=e.left,s.right=e.right)}else if(e.right.left===null)s=e.right,s.left=e.left,i=s;else{for(s=e.right.left;s.left!==null;)s=s.left;s.parent&&(s.parent.left=s.right,i=s.parent,s.left=e.left,s.right=e.right)}e.parent!==null?e.isLeftChild()?e.parent.left=s:e.parent.right=s:this._setRoot(s),i&&this._rebalance(i)}e.dispose()}_rotateLeft(e){const t=e.parent,s=e.isLeftChild(),i=e.right;i&&(e.right=i.left,i.left=e),t!==null?s?t.left=i:t.right=i:this._setRoot(i)}_rotateRight(e){const t=e.parent,s=e.isLeftChild(),i=e.left;i&&(e.left=i.right,i.right=e),t!==null?s?t.left=i:t.right=i:this._setRoot(i)}_rebalance(e){const t=e.getBalance();t>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):t<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(this._root!==null){const t=[];if(this._root.search(e,t),t.length>0){let s=t[0];for(let i=1;i<t.length;i++)t[i].low>s.low&&(s=t[i]);return s.event}}return null}forEach(e){if(this._root!==null){const t=[];this._root.traverse(s=>t.push(s)),t.forEach(s=>{s.event&&e(s.event)})}return this}forEachAtTime(e,t){if(this._root!==null){const s=[];this._root.search(e,s),s.forEach(i=>{i.event&&t(i.event)})}return this}forEachFrom(e,t){if(this._root!==null){const s=[];this._root.searchAfter(e,s),s.forEach(i=>{i.event&&t(i.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(e=>e.dispose()),this._root=null,this}}class Ox{constructor(e,t,s){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=s,this.low=e,this.high=t,this.max=this.high}insert(e){e.low<=this.low?this.left===null?this.left=e:this.left.insert(e):this.right===null?this.right=e:this.right.insert(e)}search(e,t){e>this.max||(this.left!==null&&this.left.search(e,t),this.low<=e&&this.high>e&&t.push(this),!(this.low>e)&&this.right!==null&&this.right.search(e,t))}searchAfter(e,t){this.low>=e&&(t.push(this),this.left!==null&&this.left.searchAfter(e,t)),this.right!==null&&this.right.searchAfter(e,t)}traverse(e){e(this),this.left!==null&&this.left.traverse(e),this.right!==null&&this.right.traverse(e)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return this.left!==null&&this.right!==null?e=this.left.height-this.right.height:this.left!==null?e=this.left.height+1:this.right!==null&&(e=-(this.right.height+1)),e}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class $s extends re{constructor(){super(Z($s.getDefaults(),arguments,["volume"])),this.name="Volume";const e=Z($s.getDefaults(),arguments,["volume"]);this.input=this.output=new Ae({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,Ie(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(re.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}let Ax=class qa extends re{constructor(){super(Z(qa.getDefaults(),arguments)),this.name="Destination",this.input=new $s({context:this.context}),this.output=new Ae({context:this.context}),this.volume=this.input.volume;const e=Z(qa.getDefaults(),arguments);$i(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(re.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),$i(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}};$o(n=>{n.destination=new Ax({context:n})});Xo(n=>{n.destination.dispose()});class Mx extends Ps{constructor(e){super(),this.name="TimelineValue",this._timeline=new ns({memory:10}),this._initialValue=e}set(e,t){return this._timeline.add({value:e,time:t}),this}get(e){const t=this._timeline.get(e);return t?t.value:this._initialValue}}class Ss extends re{constructor(){super(Object.assign(Z(Ss.getDefaults(),arguments,["context"])))}connect(e,t=0,s=0){return Fc(this,e,t,s),this}}class wn extends Ss{constructor(){super(Object.assign(Z(wn.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const e=Z(wn.getDefaults(),arguments,["mapping","length"]);Wt(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):J1(e.mapping)&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(De.getDefaults(),{length:1024})}setMap(e,t=1024){const s=new Float32Array(t);for(let i=0,r=t;i<r;i++){const o=i/(r-1)*2-1;s[i]=e(o,i)}return this.curve=s,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){const t=["none","2x","4x"].some(s=>s.includes(e));de(t,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class Qi extends Ss{constructor(){super(Object.assign(Z(Qi.getDefaults(),arguments,["value"]))),this.name="Pow";const e=Z(Qi.getDefaults(),arguments,["value"]);this._exponentScaler=this.input=this.output=new wn({context:this.context,mapping:this._expFunc(e.value),length:8192}),this._exponent=e.value}static getDefaults(){return Object.assign(Ss.getDefaults(),{value:1})}_expFunc(e){return t=>Math.pow(Math.abs(t),e)}get value(){return this._exponent}set value(e){this._exponent=e,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class Xs{constructor(e,t){this.id=Xs._eventId++,this._remainderTime=0;const s=Object.assign(Xs.getDefaults(),t);this.transport=e,this.callback=s.callback,this._once=s.once,this.time=Math.floor(s.time),this._remainderTime=s.time-this.time}static getDefaults(){return{callback:Te,once:!1,time:0}}get floatTime(){return this.time+this._remainderTime}invoke(e){if(this.callback){const t=this.transport.bpm.getDurationOfTicks(1,e);this.callback(e+this._remainderTime*t),this._once&&this.transport.clear(this.id)}}dispose(){return this.callback=void 0,this}}Xs._eventId=0;class Lc extends Xs{constructor(e,t){super(e,t),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const s=Object.assign(Lc.getDefaults(),t);this.duration=s.duration,this._interval=s.interval,this._nextTick=s.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.transport.on("ticks",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},Xs.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvent(){return go(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new Gn(this.context,this._nextTick).toSeconds()):-1}_createEvents(e){go(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Gn(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;const t=this.transport.getTicksAtTime(e);ni(t,this.time)&&(this._nextTick=this.floatTime+Math.ceil((t-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}}class Ki extends _t{constructor(){super(Z(Ki.getDefaults(),arguments)),this.name="Transport",this._loop=new Mx(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new ns,this._repeatedEvents=new Ex,this._syncedSignals=[],this._swingAmount=0;const e=Z(Ki.getDefaults(),arguments);this._ppq=e.ppq,this._clock=new Xi({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),Ie(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(_t.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,t){if(this._loop.get(e)&&t>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),t=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&t%this._ppq!==0&&t%(this._swingTicks*2)!==0){const s=t%(this._swingTicks*2)/(this._swingTicks*2),i=Math.sin(s*Math.PI)*this._swingAmount;e+=new Gn(this.context,this._swingTicks*2/3).toSeconds()*i}Ql(!0),this._timeline.forEachAtTime(t,s=>s.invoke(e)),Ql(!1)}schedule(e,t){const s=new Xs(this,{callback:e,time:new Vi(this.context,t).toTicks()});return this._addEvent(s,this._timeline)}scheduleRepeat(e,t,s,i=1/0){const r=new Lc(this,{callback:e,duration:new Gt(this.context,i).toTicks(),interval:new Gt(this.context,t).toTicks(),time:new Vi(this.context,s).toTicks()});return this._addEvent(r,this._repeatedEvents)}scheduleOnce(e,t){const s=new Xs(this,{callback:e,once:!0,time:new Vi(this.context,t).toTicks()});return this._addEvent(s,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){const t=this._scheduledEvents[e.toString()];t.timeline.remove(t.event),t.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,t){return this._scheduledEvents[e.id.toString()]={event:e,timeline:t},t.add(e),e.id}cancel(e=0){const t=this.toTicks(e);return this._timeline.forEachFrom(t,s=>this.clear(s.id)),this._repeatedEvents.forEachFrom(t,s=>this.clear(s.id)),this}_bindClockEvents(){this._clock.on("start",(e,t)=>{t=new Gn(this.context,t).toSeconds(),this.emit("start",e,t)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,t){this.context.resume();let s;return me(t)&&(s=this.toTicks(t)),this._clock.start(e,s),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),this._clock.getStateAtTime(e)!=="started"?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){Wt(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new Gt(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new Gt(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new Gn(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){const e=this.now(),t=this._clock.getTicksAtTime(e);return new Gn(this.context,t).toBarsBeatsSixteenths()}set position(e){const t=this.toTicks(e);this.ticks=t}get seconds(){return this._clock.seconds}set seconds(e){const t=this.now(),s=this._clock.frequency.timeToTicks(e,t);this.ticks=s}get progress(){if(this.loop){const e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){const t=this.now();if(this.state==="started"){const s=this._clock.getTicksAtTime(t),i=this._clock.frequency.getDurationOfTicks(Math.ceil(s)-s,t),r=t+i;this.emit("stop",r),this._clock.setTicksAtTime(e,r),this.emit("start",r,this._clock.getSecondsAtTime(r))}else this.emit("ticks",t),this._clock.setTicksAtTime(e,t)}}getTicksAtTime(e){return this._clock.getTicksAtTime(e)}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),this.state!=="started")return 0;{const t=this.now(),s=this.getTicksAtTime(t),i=e-s%e;return this._clock.nextTickTime(i,t)}}syncSignal(e,t){const s=this.now();let i=this.bpm,r=1/(60/i.getValueAtTime(s)/this.PPQ),o=[];if(e.units==="time"){const c=.015625/r,l=new Ae(c),u=new Qi(-1),h=new Ae(c);i.chain(l,u,h),i=h,r=1/r,o=[l,u,h]}t||(e.getValueAtTime(s)!==0?t=e.getValueAtTime(s)/r:t=0);const a=new Ae(t);return i.connect(a),a.connect(e._param),o.push(a),this._syncedSignals.push({initial:e.value,nodes:o,signal:e}),e.value=0,this}unsyncSignal(e){for(let t=this._syncedSignals.length-1;t>=0;t--){const s=this._syncedSignals[t];s.signal===e&&(s.nodes.forEach(i=>i.dispose()),s.signal.value=s.initial,this._syncedSignals.splice(t,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),Rc(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}Mr.mixin(Ki);$o(n=>{n.transport=new Ki({context:n})});Xo(n=>{n.transport.dispose()});class ot extends re{constructor(e){super(e),this.input=void 0,this._state=new Nc("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=Te,this._syncedStop=Te,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new $s({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,Ie(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(re.getDefaults(),{mute:!1,onstop:Te,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,t,s){let i=Et(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(i=this._clampToCurrentTime(i),!this._synced&&this._state.getValueAtTime(i)==="started")de(ni(i,this._state.get(i).time),"Start time must be strictly greater than previous start time"),this._state.cancel(i),this._state.setStateAtTime("started",i),this.log("restart",i),this.restart(i,t,s);else if(this.log("start",i),this._state.setStateAtTime("started",i),this._synced){const r=this._state.get(i);r&&(r.offset=this.toSeconds($n(t,0)),r.duration=s?this.toSeconds(s):void 0);const o=this.context.transport.schedule(a=>{this._start(a,t,s)},i);this._scheduled.push(o),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>i&&this._syncedStart(this.now(),this.context.transport.seconds)}else Vh(this.context),this._start(i,t,s);return this}stop(e){let t=Et(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(t=this._clampToCurrentTime(t),this._state.getValueAtTime(t)==="started"||me(this._state.getNextState("started",t))){if(this.log("stop",t),!this._synced)this._stop(t);else{const s=this.context.transport.schedule(this._stop.bind(this),t);this._scheduled.push(s)}this._state.cancel(t),this._state.setStateAtTime("stopped",t)}return this}restart(e,t,s){return e=this.toSeconds(e),this._state.getValueAtTime(e)==="started"&&(this._state.cancel(e),this._restart(e,t,s)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,t)=>{if(ni(t,0)){const s=this._state.get(t);if(s&&s.state==="started"&&s.time!==t){const i=t-this.toSeconds(s.time);let r;s.duration&&(r=this.toSeconds(s.duration)-i),this._start(e,this.toSeconds(s.offset)+i,r)}}},this._syncedStop=e=>{const t=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));this._state.getValueAtTime(t)==="started"&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=Te,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class ri extends ii{constructor(){super(Z(ri.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const e=Z(ri.getDefaults(),arguments,["url","onload"]);Zs(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Se({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new we(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(ii.getDefaults(),{url:new we,loop:!1,loopEnd:0,loopStart:0,onload:Te,onerror:Te,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,t,s,i=1){de(this.buffer.loaded,"buffer is either not set or not loaded");const r=this.toSeconds(e);this._startGain(r,i),this.loop?t=$n(t,this.loopStart):t=$n(t,0);let o=Math.max(this.toSeconds(t),0);if(this.loop){const a=this.toSeconds(this.loopEnd)||this.buffer.duration,c=this.toSeconds(this.loopStart),l=a-c;ja(o,a)&&(o=(o-c)%l+c),Ht(o,this.buffer.duration)&&(o=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,go(o,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(r,o)),me(s)){let a=this.toSeconds(s);a=Math.max(a,0),this.stop(r+a)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class Ji extends ot{constructor(){super(Z(Ji.getDefaults(),arguments,["type"])),this.name="Noise",this._source=null;const e=Z(Ji.getDefaults(),arguments,["type"]);this._playbackRate=e.playbackRate,this.type=e.type,this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut}static getDefaults(){return Object.assign(ot.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(e){if(de(e in Kl,"Noise: invalid type: "+e),this._type!==e&&(this._type=e,this.state==="started")){const t=this.now();this._stop(t),this._start(t)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._source&&(this._source.playbackRate.value=e)}_start(e){const t=Kl[this._type];this._source=new ri({url:t,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(e),Math.random()*(t.duration-.001))}_stop(e){this._source&&(this._source.stop(this.toSeconds(e)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(e){this._stop(e),this._start(e)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}const Bn=44100*5,xa=2,ms={brown:null,pink:null,white:null},Kl={get brown(){if(!ms.brown){const n=[];for(let e=0;e<xa;e++){const t=new Float32Array(Bn);n[e]=t;let s=0;for(let i=0;i<Bn;i++){const r=Math.random()*2-1;t[i]=(s+.02*r)/1.02,s=t[i],t[i]*=3.5}}ms.brown=new we().fromArray(n)}return ms.brown},get pink(){if(!ms.pink){const n=[];for(let e=0;e<xa;e++){const t=new Float32Array(Bn);n[e]=t;let s,i,r,o,a,c,l;s=i=r=o=a=c=l=0;for(let u=0;u<Bn;u++){const h=Math.random()*2-1;s=.99886*s+h*.0555179,i=.99332*i+h*.0750759,r=.969*r+h*.153852,o=.8665*o+h*.3104856,a=.55*a+h*.5329522,c=-.7616*c-h*.016898,t[u]=s+i+r+o+a+c+l+h*.5362,t[u]*=.11,l=h*.115926}}ms.pink=new we().fromArray(n)}return ms.pink},get white(){if(!ms.white){const n=[];for(let e=0;e<xa;e++){const t=new Float32Array(Bn);n[e]=t;for(let s=0;s<Bn;s++)t[s]=Math.random()*2-1}ms.white=new we().fromArray(n)}return ms.white}};function Pn(n,e){return We(this,void 0,void 0,function*(){const t=e/n.context.sampleRate,s=new Qo(1,t,n.context.sampleRate);return new n.constructor(Object.assign(n.get(),{frequency:2/t,detune:0,context:s})).toDestination().start(0),(yield s.render()).getChannelData(0)})}class ko extends ii{constructor(){super(Z(ko.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const e=Z(ko.getDefaults(),arguments,["frequency","type"]);Zs(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new Se({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new Se({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),Ie(this,["frequency","detune"])}static getDefaults(){return Object.assign(ii.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._oscillator.start(t),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class Ge extends ot{constructor(){super(Z(Ge.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const e=Z(Ge.getDefaults(),arguments,["frequency","type"]);this.frequency=new De({context:this.context,units:"frequency",value:e.frequency}),Ie(this,"frequency"),this.detune=new De({context:this.context,units:"cents",value:e.detune}),Ie(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&e.type!=="custom"&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(ot.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){const t=this.toSeconds(e),s=new ko({context:this.context,onended:()=>this.onstop(this)});this._oscillator=s,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(t)}_stop(e){const t=this.toSeconds(e);this._oscillator&&this._oscillator.stop(t)}_restart(e){const t=this.toSeconds(e);return this.log("restart",t),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(t),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return Ge._periodicWaveCache.find(t=>t.phase===this._phase&&ux(t.partials,this._partials));{const e=Ge._periodicWaveCache.find(t=>t.type===this._type&&t.phase===this._phase);return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;const t=["sine","square","sawtooth","triangle"].indexOf(e)!==-1;if(this._phase===0&&t)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=e);else{const s=this._getCachedPeriodicWave();if(me(s)){const{partials:i,wave:r}=s;this._wave=r,this._partials=i,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{const[i,r]=this._getRealImaginary(e,this._phase),o=this.context.createPeriodicWave(i,r);this._wave=o,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),Ge._periodicWaveCache.push({imag:r,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:i,type:this._type,wave:this._wave}),Ge._periodicWaveCache.length>100&&Ge._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&this._type!=="custom"&&e!=="custom"?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){Zt(e,0);let t=this._type;const s=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(s&&(t=s[1]),this._type!=="custom")e===0?this.type=t:this.type=t+e.toString();else{const i=new Float32Array(e);this._partials.forEach((r,o)=>i[o]=r),this._partials=Array.from(i),this.type=this._type}}_getRealImaginary(e,t){let i=2048;const r=new Float32Array(i),o=new Float32Array(i);let a=1;if(e==="custom"){if(a=this._partials.length+1,this._partialCount=this._partials.length,i=a,this._partials.length===0)return[r,o]}else{const c=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);c?(a=parseInt(c[2],10)+1,this._partialCount=parseInt(c[2],10),e=c[1],a=Math.max(a,2),i=a):this._partialCount=0,this._partials=[]}for(let c=1;c<i;++c){const l=2/(c*Math.PI);let u;switch(e){case"sine":u=c<=a?1:0,this._partials[c-1]=u;break;case"square":u=c&1?2*l:0,this._partials[c-1]=u;break;case"sawtooth":u=l*(c&1?1:-1),this._partials[c-1]=u;break;case"triangle":c&1?u=2*(l*l)*(c-1>>1&1?-1:1):u=0,this._partials[c-1]=u;break;case"custom":u=this._partials[c-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}u!==0?(r[c]=-u*Math.sin(t*c),o[c]=u*Math.cos(t*c)):(r[c]=0,o[c]=0)}return[r,o]}_inverseFFT(e,t,s){let i=0;const r=e.length;for(let o=0;o<r;o++)i+=e[o]*Math.cos(o*s)+t[o]*Math.sin(o*s);return i}getInitialValue(){const[e,t]=this._getRealImaginary(this._type,0);let s=0;const i=Math.PI*2,r=32;for(let o=0;o<r;o++)s=Math.max(this._inverseFFT(e,t,o/r*i),s);return dx(-this._inverseFFT(e,t,this._phase)/s,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(e=1024){return We(this,void 0,void 0,function*(){return Pn(this,e)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}Ge._periodicWaveCache=[];class Px extends Ss{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new wn({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Qs extends De{constructor(){super(Object.assign(Z(Qs.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const e=Z(Qs.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new Ae({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(De.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class er extends ot{constructor(){super(Z(er.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new Px({context:this.context}),this._modulationNode=new Ae({context:this.context});const e=Z(er.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Ge({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new Ge({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Qs({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),Ie(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Ge.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return We(this,void 0,void 0,function*(){return Pn(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class tr extends ot{constructor(){super(Z(tr.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new Ae({context:this.context,gain:0});const e=Z(tr.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Ge({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new De({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new Ge({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Qs({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new Qs({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),Ie(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Ge.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return We(this,void 0,void 0,function*(){return Pn(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class oi extends ot{constructor(){super(Z(oi.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new Ae({context:this.context,gain:0}),this._thresh=new wn({context:this.context,mapping:t=>t<=0?-1:1});const e=Z(oi.getDefaults(),arguments,["frequency","width"]);this.width=new De({context:this.context,units:"audioRange",value:e.width}),this._triangle=new Ge({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),Ie(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(ot.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(e=1024){return We(this,void 0,void 0,function*(){return Pn(this,e)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class sr extends ot{constructor(){super(Z(sr.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const e=Z(sr.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new De({context:this.context,units:"frequency",value:e.frequency}),this.detune=new De({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,Ie(this,["frequency","detune"])}static getDefaults(){return Object.assign(Ge.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach(t=>t.start(e))}_stop(e){e=this.toSeconds(e),this._forEach(t=>t.stop(e))}_restart(e){this._forEach(t=>t.restart(e))}_forEach(e){for(let t=0;t<this._oscillators.length;t++)e(this._oscillators[t],t)}get type(){return this._type}set type(e){this._type=e,this._forEach(t=>t.type=e)}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){const t=-e/2,s=e/(this._oscillators.length-1);this._forEach((i,r)=>i.detune.value=t+s*r)}}get count(){return this._oscillators.length}set count(e){if(Zt(e,1),this._oscillators.length!==e){this._forEach(t=>t.dispose()),this._oscillators=[];for(let t=0;t<e;t++){const s=new Ge({context:this.context,volume:-6-e*1.1,type:this._type,phase:this._phase+t/e*360,partialCount:this._partialCount,onstop:t===0?()=>this.onstop(this):Te});this.type==="custom"&&(s.partials=this._partials),this.frequency.connect(s.frequency),this.detune.connect(s.detune),s.detune.overridden=!1,s.connect(this.output),this._oscillators[t]=s}this.spread=this._spread,this.state==="started"&&this._forEach(t=>t.start())}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach((t,s)=>t.phase=this._phase+s/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach(t=>t.baseType=e),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach(t=>t.partials=e))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach(t=>t.partialCount=e),this._type=this._oscillators[0].type}asArray(e=1024){return We(this,void 0,void 0,function*(){return Pn(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(e=>e.dispose()),this}}class nr extends ot{constructor(){super(Z(nr.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Qs({context:this.context,value:2});const e=Z(nr.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new oi({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new Ge({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),Ie(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(ot.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(e=1024){return We(this,void 0,void 0,function*(){return Pn(this,e)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const Jl={am:er,fat:sr,fm:tr,oscillator:Ge,pulse:oi,pwm:nr};class Sn extends ot{constructor(){super(Z(Sn.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const e=Z(Sn.getDefaults(),arguments,["frequency","type"]);this.frequency=new De({context:this.context,units:"frequency",value:e.frequency}),this.detune=new De({context:this.context,units:"cents",value:e.detune}),Ie(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(Ge.getDefaults(),tr.getDefaults(),er.getDefaults(),sr.getDefaults(),oi.getDefaults(),nr.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some(t=>this._sourceType===t)&&(e=this._sourceType),e+this._oscillator.type}set type(e){e.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):e==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):e==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;const t=Jl[e],s=this.now();if(this._oscillator){const i=this._oscillator;i.stop(s),this.context.setTimeout(()=>i.dispose(),this.blockTime)}this._oscillator=new t({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(s)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let t="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(t=this._oscillator.type),e==="fm"?this.type="fm"+t:e==="am"?this.type="am"+t:e==="fat"?this.type="fat"+t:e==="oscillator"?this.type=t:e==="pulse"?this.type="pulse":e==="pwm"&&(this.type="pwm")}_getOscType(e,t){return e instanceof Jl[t]}get baseType(){return this._oscillator.baseType}set baseType(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&e!=="pulse"&&e!=="pwm"&&(this._oscillator.baseType=e)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(e){this._getOscType(this._oscillator,"fat")&&Ys(e)&&(this._oscillator.count=e)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(e){this._getOscType(this._oscillator,"fat")&&Ys(e)&&(this._oscillator.spread=e)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&ws(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(e=1024){return We(this,void 0,void 0,function*(){return Pn(this,e)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class Bc extends De{constructor(){super(Object.assign(Z(Bc.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Add",this._sum=new Ae({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,$i(this._constantSource,this._sum)}static getDefaults(){return Object.assign(De.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class wo extends Ss{constructor(){super(Object.assign(Z(wo.getDefaults(),arguments,["min","max"]))),this.name="Scale";const e=Z(wo.getDefaults(),arguments,["min","max"]);this._mult=this.input=new Qs({context:this.context,value:e.max-e.min}),this._add=this.output=new Bc({context:this.context,value:e.min}),this._min=e.min,this._max=e.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(Ss.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(e){this._min=e,this._setRange()}get max(){return this._max}set max(e){this._max=e,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}function Kh(n,e=1/0){const t=new WeakMap;return function(s,i){Reflect.defineProperty(s,i,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(r){Zt(r,n,e),t.set(this,r)}})}}function Ds(n,e=1/0){const t=new WeakMap;return function(s,i){Reflect.defineProperty(s,i,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(r){Zt(this.toSeconds(r),n,e),t.set(this,r)}})}}class ir extends ot{constructor(){super(Z(ir.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const e=Z(ir.getDefaults(),arguments,["url","onload"]);this._buffer=new we({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(ot.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Te,onerror:Te,playbackRate:1,reverse:!1})}load(e){return We(this,void 0,void 0,function*(){return yield this._buffer.load(e),this._onload(),this})}_onload(e=Te){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,t,s){return super.start(e,t,s),this}_start(e,t,s){this._loop?t=$n(t,this._loopStart):t=$n(t,0);const i=this.toSeconds(t),r=s;s=$n(s,Math.max(this._buffer.duration-i,0));let o=this.toSeconds(s);o=o/this._playbackRate,e=this.toSeconds(e);const a=new ri({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(e+o),this._state.setStateAtTime("stopped",e+o,{implicitEnd:!0})),this._activeSources.add(a),this._loop&&Et(r)?a.start(e,i):a.start(e,i,o-this.toSeconds(this.fadeOut))}_stop(e){const t=this.toSeconds(e);this._activeSources.forEach(s=>s.stop(t))}restart(e,t,s){return super.restart(e,t,s),this}_restart(e,t,s){var i;(i=[...this._activeSources].pop())===null||i===void 0||i.stop(e),this._start(e,t,s)}seek(e,t){const s=this.toSeconds(t);if(this._state.getValueAtTime(s)==="started"){const i=this.toSeconds(e);this._stop(s),this._start(s,i)}return this}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&Zt(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&Zt(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(t=>{t.loop=e}),e)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;const t=this.now(),s=this._state.getNextState("stopped",t);s&&s.implicitEnd&&(this._state.cancel(s.time),this._activeSources.forEach(i=>i.cancelStop())),this._activeSources.forEach(i=>{i.playbackRate.setValueAtTime(e,t)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}$t([Ds(0)],ir.prototype,"fadeIn",void 0);$t([Ds(0)],ir.prototype,"fadeOut",void 0);class Dx extends Ss{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new wn({context:this.context,mapping:e=>Math.abs(e)*2-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Ut extends re{constructor(){super(Z(Ut.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new De({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const e=Z(Ut.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(re.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,t){if(ws(e))return e;{let s;for(s in Zr)if(Zr[s][t]===e)return s;return e}}_setCurve(e,t,s){if(ws(s)&&Reflect.has(Zr,s)){const i=Zr[s];mn(i)?e!=="_decayCurve"&&(this[e]=i[t]):this[e]=i}else if(Wt(s)&&e!=="_decayCurve")this[e]=s;else throw new Error("Envelope: invalid curve: "+s)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._getCurve(this._decayCurve,"Out")}set decayCurve(e){this._setCurve("_decayCurve","Out",e)}triggerAttack(e,t=1){this.log("triggerAttack",e,t),e=this.toSeconds(e);let i=this.toSeconds(this.attack);const r=this.toSeconds(this.decay),o=this.getValueAtTime(e);if(o>0){const a=1/i;i=(1-o)/a}if(i<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(t,e);else if(this._attackCurve==="linear")this._sig.linearRampTo(t,i,e);else if(this._attackCurve==="exponential")this._sig.targetRampTo(t,i,e);else{this._sig.cancelAndHoldAtTime(e);let a=this._attackCurve;for(let c=1;c<a.length;c++)if(a[c-1]<=o&&o<=a[c]){a=this._attackCurve.slice(c),a[0]=o;break}this._sig.setValueCurveAtTime(a,e,i,t)}if(r&&this.sustain<1){const a=t*this.sustain,c=e+i;this.log("decay",c),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(a,r+c):this._sig.exponentialApproachValueAtTime(a,c,r)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);const t=this.getValueAtTime(e);if(t>0){const s=this.toSeconds(this.release);s<this.sampleTime?this._sig.setValueAtTime(0,e):this._releaseCurve==="linear"?this._sig.linearRampTo(0,s,e):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,s,e):(de(Wt(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,s,t))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,t,s=1){return t=this.toSeconds(t),this.triggerAttack(t,s),this.triggerRelease(t+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,t=0,s=0){return Fc(this,e,t,s),this}asArray(e=1024){return We(this,void 0,void 0,function*(){const t=e/this.context.sampleRate,s=new Qo(1,t,this.context.sampleRate),i=this.toSeconds(this.attack)+this.toSeconds(this.decay),r=i+this.toSeconds(this.release),o=r*.1,a=r+o,c=new this.constructor(Object.assign(this.get(),{attack:t*this.toSeconds(this.attack)/a,decay:t*this.toSeconds(this.decay)/a,release:t*this.toSeconds(this.release)/a,context:s}));return c._sig.toDestination(),c.triggerAttackRelease(t*(i+o)/a,0),(yield s.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}$t([Ds(0)],Ut.prototype,"attack",void 0);$t([Ds(0)],Ut.prototype,"decay",void 0);$t([Kh(0,1)],Ut.prototype,"sustain",void 0);$t([Ds(0)],Ut.prototype,"release",void 0);const Zr=(()=>{let e,t;const s=[];for(e=0;e<128;e++)s[e]=Math.sin(e/(128-1)*(Math.PI/2));const i=[],r=6.4;for(e=0;e<128-1;e++){t=e/(128-1);const d=Math.sin(t*(Math.PI*2)*r-Math.PI/2)+1;i[e]=d/10+t*.83}i[128-1]=1;const o=[],a=5;for(e=0;e<128;e++)o[e]=Math.ceil(e/(128-1)*a)/a;const c=[];for(e=0;e<128;e++)t=e/(128-1),c[e]=.5*(1-Math.cos(Math.PI*t));const l=[];for(e=0;e<128;e++){t=e/(128-1);const d=Math.pow(t,3)*4+.2,f=Math.cos(d*Math.PI*2*t);l[e]=Math.abs(f*(1-t))}function u(d){const f=new Array(d.length);for(let m=0;m<d.length;m++)f[m]=1-d[m];return f}function h(d){return d.slice(0).reverse()}return{bounce:{In:u(l),Out:l},cosine:{In:s,Out:h(s)},exponential:"exponential",linear:"linear",ripple:{In:i,Out:u(i)},sine:{In:c,Out:u(c)},step:{In:o,Out:u(o)}}})();class bn extends re{constructor(){super(Z(bn.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease,this._syncedRelease=t=>this._original_triggerRelease(t);const e=Z(bn.getDefaults(),arguments);this._volume=this.output=new $s({context:this.context,volume:e.volume}),this.volume=this._volume.volume,Ie(this,"volume")}static getDefaults(){return Object.assign(re.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}_syncState(){let e=!1;return this._synced||(this._synced=!0,e=!0),e}_syncMethod(e,t){const s=this["_original_"+e]=this[e];this[e]=(...i)=>{const r=i[t],o=this.context.transport.schedule(a=>{i[t]=a,s.apply(this,i)},r);this._scheduledEvents.push(o)}}unsync(){return this._scheduledEvents.forEach(e=>this.context.transport.clear(e)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease,this.context.transport.off("stop",this._syncedRelease),this.context.transport.off("pause",this._syncedRelease),this.context.transport.off("loopEnd",this._syncedRelease)),this}triggerAttackRelease(e,t,s,i){const r=this.toSeconds(s),o=this.toSeconds(t);return this.triggerAttack(e,r,i),this.triggerRelease(r+o),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class bs extends bn{constructor(){super(Z(bs.getDefaults(),arguments));const e=Z(bs.getDefaults(),arguments);this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign(bn.getDefaults(),{detune:0,onsilence:Te,portamento:0})}triggerAttack(e,t,s=1){this.log("triggerAttack",e,t,s);const i=this.toSeconds(t);return this._triggerEnvelopeAttack(i,s),this.setNote(e,i),this}triggerRelease(e){this.log("triggerRelease",e);const t=this.toSeconds(e);return this._triggerEnvelopeRelease(t),this}setNote(e,t){const s=this.toSeconds(t),i=e instanceof It?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(s)>.05){const r=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(i,r,s)}else this.frequency.setValueAtTime(i,s);return this}}$t([Ds(0)],bs.prototype,"portamento",void 0);class Jo extends Ut{constructor(){super(Z(Jo.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new Ae({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class rr extends bs{constructor(){super(Z(rr.getDefaults(),arguments)),this.name="Synth";const e=Z(rr.getDefaults(),arguments);this.oscillator=new Sn(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new Jo(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),Ie(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(bs.getDefaults(),{envelope:Object.assign(qn(Ut.getDefaults(),Object.keys(re.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(qn(Sn.getDefaults(),[...Object.keys(ot.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,t){if(this.envelope.triggerAttack(e,t),this.oscillator.start(e),this.envelope.sustain===0){const s=this.toSeconds(this.envelope.attack),i=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+s+i)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class or extends re{constructor(){super(Z(or.getDefaults(),arguments,["frequency","type"])),this.name="BiquadFilter";const e=Z(or.getDefaults(),arguments,["frequency","type"]);this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new Se({context:this.context,units:"number",value:e.Q,param:this._filter.Q}),this.frequency=new Se({context:this.context,units:"frequency",value:e.frequency,param:this._filter.frequency}),this.detune=new Se({context:this.context,units:"cents",value:e.detune,param:this._filter.detune}),this.gain=new Se({context:this.context,units:"decibels",convert:!1,value:e.gain,param:this._filter.gain}),this.type=e.type}static getDefaults(){return Object.assign(re.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(e){de(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e)!==-1,`Invalid filter type: ${e}`),this._filter.type=e}getFrequencyResponse(e=128){const t=new Float32Array(e);for(let o=0;o<e;o++){const c=Math.pow(o/e,2)*(2e4-20)+20;t[o]=c}const s=new Float32Array(e),i=new Float32Array(e),r=this.context.createBiquadFilter();return r.type=this.type,r.Q.value=this.Q.value,r.frequency.value=this.frequency.value,r.gain.value=this.gain.value,r.getFrequencyResponse(t,s,i),s}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class ai extends re{constructor(){super(Z(ai.getDefaults(),arguments,["frequency","type","rolloff"])),this.name="Filter",this.input=new Ae({context:this.context}),this.output=new Ae({context:this.context}),this._filters=[];const e=Z(ai.getDefaults(),arguments,["frequency","type","rolloff"]);this._filters=[],this.Q=new De({context:this.context,units:"positive",value:e.Q}),this.frequency=new De({context:this.context,units:"frequency",value:e.frequency}),this.detune=new De({context:this.context,units:"cents",value:e.detune}),this.gain=new De({context:this.context,units:"decibels",convert:!1,value:e.gain}),this._type=e.type,this.rolloff=e.rolloff,Ie(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(re.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(e){de(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e)!==-1,`Invalid filter type: ${e}`),this._type=e,this._filters.forEach(s=>s.type=e)}get rolloff(){return this._rolloff}set rolloff(e){const t=Ys(e)?e:parseInt(e,10),s=[-12,-24,-48,-96];let i=s.indexOf(t);de(i!==-1,`rolloff can only be ${s.join(", ")}`),i+=1,this._rolloff=t,this.input.disconnect(),this._filters.forEach(r=>r.disconnect()),this._filters=new Array(i);for(let r=0;r<i;r++){const o=new or({context:this.context});o.type=this._type,this.frequency.connect(o.frequency),this.detune.connect(o.detune),this.Q.connect(o.Q),this.gain.connect(o.gain),this._filters[r]=o}this._internalChannels=this._filters,$i(this.input,...this._internalChannels,this.output)}getFrequencyResponse(e=128){const t=new or({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),s=new Float32Array(e).map(()=>1);return this._filters.forEach(()=>{t.getFrequencyResponse(e).forEach((r,o)=>s[o]*=r)}),t.dispose(),s}dispose(){return super.dispose(),this._filters.forEach(e=>{e.dispose()}),Rc(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class ar extends Ut{constructor(){super(Z(ar.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="FrequencyEnvelope";const e=Z(ar.getDefaults(),arguments,["attack","decay","sustain","release"]);this._octaves=e.octaves,this._baseFrequency=this.toFrequency(e.baseFrequency),this._exponent=this.input=new Qi({context:this.context,value:e.exponent}),this._scale=this.output=new wo({context:this.context,min:this._baseFrequency,max:this._baseFrequency*Math.pow(2,this._octaves)}),this._sig.chain(this._exponent,this._scale)}static getDefaults(){return Object.assign(Ut.getDefaults(),{baseFrequency:200,exponent:1,octaves:4})}get baseFrequency(){return this._baseFrequency}set baseFrequency(e){const t=this.toFrequency(e);Zt(t,0),this._baseFrequency=t,this._scale.min=this._baseFrequency,this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(e){this._octaves=e,this._scale.max=this._baseFrequency*Math.pow(2,e)}get exponent(){return this._exponent.value}set exponent(e){this._exponent.value=e}dispose(){return super.dispose(),this._exponent.dispose(),this._scale.dispose(),this}}class cr extends bs{constructor(){super(Z(cr.getDefaults(),arguments)),this.name="MonoSynth";const e=Z(cr.getDefaults(),arguments);this.oscillator=new Sn(Object.assign(e.oscillator,{context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)})),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.filter=new ai(Object.assign(e.filter,{context:this.context})),this.filterEnvelope=new ar(Object.assign(e.filterEnvelope,{context:this.context})),this.envelope=new Jo(Object.assign(e.envelope,{context:this.context})),this.oscillator.chain(this.filter,this.envelope,this.output),this.filterEnvelope.connect(this.filter.frequency),Ie(this,["oscillator","frequency","detune","filter","filterEnvelope","envelope"])}static getDefaults(){return Object.assign(bs.getDefaults(),{envelope:Object.assign(qn(Ut.getDefaults(),Object.keys(re.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.9}),filter:Object.assign(qn(ai.getDefaults(),Object.keys(re.getDefaults())),{Q:1,rolloff:-12,type:"lowpass"}),filterEnvelope:Object.assign(qn(ar.getDefaults(),Object.keys(re.getDefaults())),{attack:.6,baseFrequency:200,decay:.2,exponent:2,octaves:3,release:2,sustain:.5}),oscillator:Object.assign(qn(Sn.getDefaults(),Object.keys(ot.getDefaults())),{type:"sawtooth"})})}_triggerEnvelopeAttack(e,t=1){if(this.envelope.triggerAttack(e,t),this.filterEnvelope.triggerAttack(e),this.oscillator.start(e),this.envelope.sustain===0){const s=this.toSeconds(this.envelope.attack),i=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+s+i)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.filterEnvelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this.filterEnvelope.dispose(),this.filter.dispose(),this}}class lr extends rr{constructor(){super(Z(lr.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const e=Z(lr.getDefaults(),arguments);this.pitchDecay=e.pitchDecay,this.octaves=e.octaves,Ie(this,["oscillator","envelope"])}static getDefaults(){return Zn(bs.getDefaults(),rr.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(e,t){const s=this.toSeconds(t),i=this.toFrequency(e instanceof It?e.toFrequency():e),r=i*this.octaves;return this.oscillator.frequency.setValueAtTime(r,s),this.oscillator.frequency.exponentialRampToValueAtTime(i,s+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}$t([Kh(0)],lr.prototype,"octaves",void 0);$t([Ds(0)],lr.prototype,"pitchDecay",void 0);const Jh=new Set;function zc(n){Jh.add(n)}function ed(n,e){const t=`registerProcessor("${n}", ${e})`;Jh.add(t)}const Rx=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;zc(Rx);const Ix=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;zc(Ix);const Nx=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;zc(Nx);const Fx="feedback-comb-filter",Ux=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;ed(Fx,Ux);class ur extends bn{constructor(){super(Z(ur.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const e=Z(ur.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),t={};Object.keys(e.urls).forEach(s=>{const i=parseInt(s,10);if(de(Yr(s)||Ys(i)&&isFinite(i),`url key is neither a note or midi pitch: ${s}`),Yr(s)){const r=new It(this.context,s).toMidi();t[r]=e.urls[s]}else Ys(i)&&isFinite(i)&&(t[i]=e.urls[i])}),this._buffers=new Uc({urls:t,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign(bn.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:Te,onerror:Te,release:.1,urls:{}})}_findClosest(e){let s=0;for(;s<96;){if(this._buffers.has(e+s))return-s;if(this._buffers.has(e-s))return s;s++}throw new Error(`No available buffers for note: ${e}`)}triggerAttack(e,t,s=1){return this.log("triggerAttack",e,t,s),Array.isArray(e)||(e=[e]),e.forEach(i=>{const r=Qh(new It(this.context,i).toFrequency()),o=Math.round(r),a=r-o,c=this._findClosest(o),l=o-c,u=this._buffers.get(l),h=Xh(c+a),d=new ri({url:u,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:h}).connect(this.output);d.start(t,0,u.duration/h,s),Wt(this._activeSources.get(o))||this._activeSources.set(o,[]),this._activeSources.get(o).push(d),d.onended=()=>{if(this._activeSources&&this._activeSources.has(o)){const f=this._activeSources.get(o),m=f.indexOf(d);m!==-1&&f.splice(m,1)}}}),this}triggerRelease(e,t){return this.log("triggerRelease",e,t),Array.isArray(e)||(e=[e]),e.forEach(s=>{const i=new It(this.context,s).toMidi();if(this._activeSources.has(i)&&this._activeSources.get(i).length){const r=this._activeSources.get(i);t=this.toSeconds(t),r.forEach(o=>{o.stop(t)}),this._activeSources.set(i,[])}}),this}releaseAll(e){const t=this.toSeconds(e);return this._activeSources.forEach(s=>{for(;s.length;)s.shift().stop(t)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(e,t,s,i=1){const r=this.toSeconds(s);return this.triggerAttack(e,r,i),Wt(t)?(de(Wt(e),"notes must be an array when duration is array"),e.forEach((o,a)=>{const c=t[Math.min(a,t.length-1)];this.triggerRelease(o,r+this.toSeconds(c))})):this.triggerRelease(e,r+this.toSeconds(t)),this}add(e,t,s){if(de(Yr(e)||isFinite(e),`note must be a pitch or midi: ${e}`),Yr(e)){const i=new It(this.context,e).toMidi();this._buffers.add(i,t,s)}else this._buffers.add(e,t,s);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(e=>{e.forEach(t=>t.dispose())}),this._activeSources.clear(),this}}$t([Ds(0)],ur.prototype,"attack",void 0);$t([Ds(0)],ur.prototype,"release",void 0);class So extends re{constructor(){super(Object.assign(Z(So.getDefaults(),arguments,["fade"]))),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new Dx({context:this.context}),this.a=new Ae({context:this.context,gain:0}),this.b=new Ae({context:this.context,gain:0}),this.output=new Ae({context:this.context}),this._internalChannels=[this.a,this.b];const e=Z(So.getDefaults(),arguments,["fade"]);this.fade=new De({context:this.context,units:"normalRange",value:e.fade}),Ie(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",Zs(this._split,this.a.gain,0),Zs(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(re.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}class eu extends re{constructor(e){super(e),this.name="Effect",this._dryWet=new So({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new Ae({context:this.context}),this.effectReturn=new Ae({context:this.context}),this.input=new Ae({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(e.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],Ie(this,"wet")}static getDefaults(){return Object.assign(re.getDefaults(),{wet:1})}connectEffect(e){return this._internalChannels.push(e),this.effectSend.chain(e,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}class bo extends re{constructor(){super(Object.assign(Z(bo.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const e=Z(bo.getDefaults(),arguments,["pan"]);this.pan=new Se({context:this.context,param:this._panner.pan,value:e.pan,minValue:-1,maxValue:1}),this._panner.channelCount=e.channelCount,this._panner.channelCountMode="explicit",Ie(this,"pan")}static getDefaults(){return Object.assign(re.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}const Lx="bit-crusher",Bx=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;ed(Lx,Bx);class Co extends re{constructor(){super(Z(Co.getDefaults(),arguments,["channels"])),this.name="Merge";const e=Z(Co.getDefaults(),arguments,["channels"]);this._merger=this.output=this.input=this.context.createChannelMerger(e.channels)}static getDefaults(){return Object.assign(re.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class Eo extends eu{constructor(){super(Z(Eo.getDefaults(),arguments,["decay"])),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();const e=Z(Eo.getDefaults(),arguments,["decay"]);this._decay=e.decay,this._preDelay=e.preDelay,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(eu.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(e){e=this.toSeconds(e),Zt(e,.001),this._decay=e,this.generate()}get preDelay(){return this._preDelay}set preDelay(e){e=this.toSeconds(e),Zt(e,0),this._preDelay=e,this.generate()}generate(){return We(this,void 0,void 0,function*(){const e=this.ready,t=new Qo(2,this._decay+this._preDelay,this.context.sampleRate),s=new Ji({context:t}),i=new Ji({context:t}),r=new Co({context:t});s.connect(r,0,0),i.connect(r,0,1);const o=new Ae({context:t}).toDestination();r.connect(o),s.start(0),i.start(0),o.gain.setValueAtTime(0,0),o.gain.setValueAtTime(1,this._preDelay),o.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);const a=t.render();return this.ready=a.then(Te),yield e,this._convolver.buffer=(yield a).get(),this})}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class He extends re{constructor(){super(Z(He.getDefaults(),arguments,["solo"])),this.name="Solo";const e=Z(He.getDefaults(),arguments,["solo"]);this.input=this.output=new Ae({context:this.context}),He._allSolos.has(this.context)||He._allSolos.set(this.context,new Set),He._allSolos.get(this.context).add(this),this.solo=e.solo}static getDefaults(){return Object.assign(re.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(e){e?this._addSolo():this._removeSolo(),He._allSolos.get(this.context).forEach(t=>t._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){He._soloed.has(this.context)||He._soloed.set(this.context,new Set),He._soloed.get(this.context).add(this)}_removeSolo(){He._soloed.has(this.context)&&He._soloed.get(this.context).delete(this)}_isSoloed(){return He._soloed.has(this.context)&&He._soloed.get(this.context).has(this)}_noSolos(){return!He._soloed.has(this.context)||He._soloed.has(this.context)&&He._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),He._allSolos.get(this.context).delete(this),this._removeSolo(),this}}He._allSolos=new Map;He._soloed=new Map;class Oo extends re{constructor(){super(Z(Oo.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const e=Z(Oo.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new bo({context:this.context,pan:e.pan,channelCount:e.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new $s({context:this.context,volume:e.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=e.mute,Ie(this,["pan","volume"])}static getDefaults(){return Object.assign(re.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class un extends re{constructor(){super(Z(un.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const e=Z(un.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new He({solo:e.solo,context:this.context}),this._panVol=this.output=new Oo({context:this.context,pan:e.pan,volume:e.volume,mute:e.mute,channelCount:e.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),Ie(this,["pan","volume"])}static getDefaults(){return Object.assign(re.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(e){this._solo.solo=e}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(e){this._panVol.mute=e}_getBus(e){return un.buses.has(e)||un.buses.set(e,new Ae({context:this.context})),un.buses.get(e)}send(e,t=0){const s=this._getBus(e),i=new Ae({context:this.context,units:"decibels",gain:t});return this.connect(i),i.connect(s),i}receive(e){return this._getBus(e).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}un.buses=new Map;class zx extends re{constructor(){super(...arguments),this.name="Listener",this.positionX=new Se({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Se({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Se({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Se({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Se({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Se({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Se({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Se({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Se({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(re.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}$o(n=>{n.listener=new zx({context:n})});Xo(n=>{n.listener.dispose()});qt().transport;const Vc=qt().destination;qt().destination;qt().listener;qt().draw;qt();const jc=new ai(900,"highpass"),td=new $s(-6);td.chain(jc,Vc);const Vx=new Eo(3).connect(td),ea=new cr({envelope:{attack:0,decay:.9,sustain:.2,release:.1}});ea.oscillator.type="triangle2";ea.volume.value=-6;ea.chain(jc,Vc);const ta=new cr({envelope:{attack:.4,decay:.9,sustain:.7,release:.6}}).connect(Vx);ta.oscillator.type="triangle";ta.volume.value=-6;ta.chain(jc,Vc);function jx(){return Math.floor((Math.random()-.5)*20)}let tu=!1;const Hx=async(n=0)=>{tu||(await gx(),tu=!0);try{if(n>2e3)ta.triggerAttackRelease(60,.3);else if(n>1e3){let e=310;e+=jx(),ea.triggerAttackRelease(e,.001)}}catch(e){console.warn(e)}},$r=1800,qx=(n,e)=>n.clone().normalize().clone().negate().normalize().multiplyScalar(e).add(n),Gx=(n,e,t,s,i)=>{const r=new Eu,o=1e-5;r.absarc(o,o,o,-Math.PI/2,-Math.PI,!0),r.absarc(o,e-s*2,o,Math.PI,Math.PI/2,!0),r.absarc(n-s*2,e-s*2,o,Math.PI/2,0,!0),r.absarc(n-s*2,o,o,0,-Math.PI/2,!0);const a=new dp(r,{depth:t-s*2,bevelEnabled:!0,bevelSegments:i,steps:2,bevelSize:s,bevelThickness:s,curveSegments:i});a.center();const c=[],l=a.getAttribute("normal"),u=a.getAttribute("position");for(let h=0;h<u.count;h+=1){const d=new le(l.getX(h),l.getY(h),l.getZ(h)),f=new le(u.getX(h),u.getY(h),u.getZ(h));let m=0,p=0;Math.abs(d.y)>.9?(m=f.x/n+.5,p=1-(f.z/t+.5)):Math.abs(d.x)>.9?(m=-f.z/t+.5,p=1-(-f.y/e+.5)):Math.abs(d.z)>.9&&(m=f.x/n+.5,p=1-(-f.y/e+.5)),c.push(m,p)}return a.setAttribute("uv",new Jr(c,2)),a};Gx(10,10,10,2,10);const su=new hp(10,10,10),Wx=500,Yx=800,Zx=new le(0,0,0),$x=16777215,Xx=20,Qx=(n,e)=>{var r,o;if(!(n!=null&&n.ref_id)||!(e!=null&&e.ref_id))return!1;let t=!1;const s=n.guests,i=e.guests;return((r=n.children)!=null&&r.includes(e.ref_id)||(o=e.children)!=null&&o.includes(n.ref_id))&&(t=!0),(s!=null&&s.find(a=>a.ref_id===e.ref_id)||i!=null&&i.find(a=>a.ref_id===n.ref_id))&&(t=!0),t};let Ri=null;const Kx=500,sd=(n,e)=>{if(Ri)return null;Ri=setTimeout(()=>{Ri&&(clearTimeout(Ri),Ri=null)},Kx);const t=[];return n.forEach(i=>{const r=e.position.distanceTo(Zx.set(i.x,i.y,i.z));r<Yx&&t.push({id:i.ref_id||"",distance:r})}),t.sort((i,r)=>i.distance-r.distance).slice(0,Wx).map(i=>i.id)};let zn,Ii;const Jx=1e3,eT=2e3,tT=n=>{const e=as(),t=Hs(x=>x.isUserDragging),s=Hs(x=>x.isUserScrolling),i=Hs(x=>x.setUserMovedCamera),{data:r,graphStyle:o,showSelectionGraph:a,setNearbyNodeIds:c,cameraFocusTrigger:l,graphRadius:u}=ht(x=>x),{camera:h}=Pe(),[d,f]=D.useState(!1),[m,p]=D.useState(!1),[_,y]=D.useState(Dl),k=D.useMemo(()=>{if(a)return new le(0,0,0);const x=r==null?void 0:r.nodes.find(R=>R.ref_id===(e==null?void 0:e.ref_id)),b=u+300;let A=new le(0,0,b);if(x&&r){const R=r==null?void 0:r.nodes.filter(W=>{var V;return(V=x.children)==null?void 0:V.find(z=>z===W.id)}),M=new le(x.x,x.y,x.z);let L=new le(0,0,0);R.map(W=>(L=L.add(new le(W.x,W.y,W.z).normalize()),W));const q=x.scale?1-1/(x.scale+10):1,Y=M.sub(L).multiplyScalar(.8*q);A=M.add(Y)}return A},[a,e,r,u]),w=D.useMemo(()=>{if(a)return new le(0,0,0);const x=r==null?void 0:r.nodes.find(b=>b.ref_id===(e==null?void 0:e.ref_id));return new le((x==null?void 0:x.x)||0,(x==null?void 0:x.y)||0,(x==null?void 0:x.z)||0)},[a,e,r]);D.useEffect(()=>{var x;a&&((x=n.current)==null||x.setLookAt(va.x,va.y,va.z,0,0,0,!1)),v()},[a]),D.useEffect(()=>{a?y(Wm):(e==null?void 0:e.node_type)==="topic"?y(Gm):y(Dl)},[e,y,a]),D.useEffect(()=>{g()},[l]),D.useEffect(()=>{(t||s)&&(f(!0),p(!0))},[t,s,f,p]),D.useEffect(()=>{if(e)if(!a&&o==="earth"&&(n!=null&&n.current)){const x=n.current.camera.position.distanceTo(new le),b=qx(w,-x/2);n.current.setLookAt(b.x,b.y,b.z,0,0,0,!0)}else zn&&clearTimeout(zn),zn=setTimeout(()=>{p(!0),clearTimeout(zn)},eT),v();return()=>{zn&&clearTimeout(zn),Ii&&clearTimeout(Ii)}},[e]),Bt(x=>{n.current&&(d||S(k,x.camera),m||T(w,x.camera))});const v=()=>{if(e){const x=h.position.distanceTo(k);Hx(x)}g()},g=()=>{f(!1),p(!1),i(!1),Ii&&clearTimeout(Ii),Ii=setTimeout(()=>{f(!0),p(!0)},Jx)},S=(x,b)=>{if(b.position.distanceTo(x)<_)f(!0);else{b.position.lerp(x,.5);const R=sd((r==null?void 0:r.nodes)||[],h);R&&c(R)}},T=(x,b)=>{var A;(A=n==null?void 0:n.current)==null||A.setLookAt(b.position.x,b.position.y,b.position.z,x.x,x.y,x.z,!0)};return null},sT=1;let Xr=null;const nT=(n,{enabled:e})=>{const t=as();tT(n);const s=Hs(a=>a.isUserDragging),{graphStyle:i,graphRadius:r,disableCameraRotation:o}=ht(a=>a);return D.useEffect(()=>{e||(Xr==null||Xr.kill(),Xr=null)},[e]),D.useEffect(()=>{n.current&&r&&(i==="sphere"?(n.current.maxDistance=8e3,n.current.minDistance=200,n.current.setTarget(0,0,500,!0)):(n.current.maxDistance=n.current.getDistanceToFitSphere(r+200),n.current.minDistance=100))},[r,i,n]),D.useEffect(()=>{!t&&n.current&&n.current.setLookAt(zi.x,zi.y,r,0,0,0,!0)},[t,r]),Bt((a,c)=>{n.current&&(!o&&!s&&(n.current.azimuthAngle+=sT*c*fp.DEG2RAD),n.current.update(c))}),null},iT=({disableAnimations:n})=>{const e=D.useRef(null),{data:t,setNearbyNodeIds:s,setDisableCameraRotation:i}=ht(h=>h),[r]=D.useState(.8),{camera:o}=Pe(),[a,c,l,u]=Hs(h=>[h.isUserDragging,h.setIsUserDragging,h.isUserScrolling,h.isUserScrollingOnHtmlPanel]);return nT(e,{enabled:!n&&!l&&!a}),D.useEffect(()=>{if(!a){const h=sd((t==null?void 0:t.nodes)||[],o);h&&s(h)}},[o,o.position,o.position.x,o.position.y,o.position.z,t==null?void 0:t.nodes,s,a]),D.useEffect(()=>{a&&i(!0)},[a,i]),U.jsx(Gp,{ref:e,boundaryEnclosesCamera:!0,enabled:!u,makeDefault:!0,maxDistance:12e3,minDistance:100,onEnd:()=>c(!1),onStart:()=>c(!0),smoothTime:r})};function gs(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function nd(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,n.__proto__=e}/*!
 * GSAP 3.12.4
 * https://gsap.com
 *
 * @license Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Ot={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},ci={duration:.5,overwrite:!1,delay:0},Hc,it,Ve,Nt=1e8,Ee=1/Nt,Ga=Math.PI*2,rT=Ga/4,oT=0,id=Math.sqrt,aT=Math.cos,cT=Math.sin,tt=function(e){return typeof e=="string"},je=function(e){return typeof e=="function"},Cs=function(e){return typeof e=="number"},qc=function(e){return typeof e>"u"},os=function(e){return typeof e=="object"},gt=function(e){return e!==!1},Gc=function(){return typeof window<"u"},Qr=function(e){return je(e)||tt(e)},rd=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},rt=Array.isArray,Wa=/(?:-?\.?\d|\.)+/gi,od=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Wn=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Ta=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,ad=/[+-]=-?[.\d]+/,cd=/[^,'"\[\]\s]+/gi,lT=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,Ue,Rt,Ya,Wc,Mt={},Ao={},ld,ud=function(e){return(Ao=Cn(e,Mt))&&kt},Yc=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},hr=function(e,t){return!t&&console.warn(e)},hd=function(e,t){return e&&(Mt[e]=t)&&Ao&&(Ao[e]=t)||Mt},dr=function(){return 0},uT={suppressEvents:!0,isStart:!0,kill:!1},so={suppressEvents:!0,kill:!1},hT={suppressEvents:!0},Zc={},Gs=[],Za={},dd,St={},ka={},nu=30,no=[],$c="",Xc=function(e){var t=e[0],s,i;if(os(t)||je(t)||(e=[e]),!(s=(t._gsap||{}).harness)){for(i=no.length;i--&&!no[i].targetTest(t););s=no[i]}for(i=e.length;i--;)e[i]&&(e[i]._gsap||(e[i]._gsap=new Fd(e[i],s)))||e.splice(i,1);return e},gn=function(e){return e._gsap||Xc(Ft(e))[0]._gsap},fd=function(e,t,s){return(s=e[t])&&je(s)?e[t]():qc(s)&&e.getAttribute&&e.getAttribute(t)||s},vt=function(e,t){return(e=e.split(",")).forEach(t)||e},qe=function(e){return Math.round(e*1e5)/1e5||0},Ke=function(e){return Math.round(e*1e7)/1e7||0},Xn=function(e,t){var s=t.charAt(0),i=parseFloat(t.substr(2));return e=parseFloat(e),s==="+"?e+i:s==="-"?e-i:s==="*"?e*i:e/i},dT=function(e,t){for(var s=t.length,i=0;e.indexOf(t[i])<0&&++i<s;);return i<s},Mo=function(){var e=Gs.length,t=Gs.slice(0),s,i;for(Za={},Gs.length=0,s=0;s<e;s++)i=t[s],i&&i._lazy&&(i.render(i._lazy[0],i._lazy[1],!0)._lazy=0)},pd=function(e,t,s,i){Gs.length&&!it&&Mo(),e.render(t,s,i||it&&t<0&&(e._initted||e._startAt)),Gs.length&&!it&&Mo()},md=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(cd).length<2?t:tt(e)?e.trim():e},_d=function(e){return e},Lt=function(e,t){for(var s in t)s in e||(e[s]=t[s]);return e},fT=function(e){return function(t,s){for(var i in s)i in t||i==="duration"&&e||i==="ease"||(t[i]=s[i])}},Cn=function(e,t){for(var s in t)e[s]=t[s];return e},iu=function n(e,t){for(var s in t)s!=="__proto__"&&s!=="constructor"&&s!=="prototype"&&(e[s]=os(t[s])?n(e[s]||(e[s]={}),t[s]):t[s]);return e},Po=function(e,t){var s={},i;for(i in e)i in t||(s[i]=e[i]);return s},ji=function(e){var t=e.parent||Ue,s=e.keyframes?fT(rt(e.keyframes)):Lt;if(gt(e.inherit))for(;t;)s(e,t.vars.defaults),t=t.parent||t._dp;return e},pT=function(e,t){for(var s=e.length,i=s===t.length;i&&s--&&e[s]===t[s];);return s<0},gd=function(e,t,s,i,r){s===void 0&&(s="_first"),i===void 0&&(i="_last");var o=e[i],a;if(r)for(a=t[r];o&&o[r]>a;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=e[s],e[s]=t),t._next?t._next._prev=t:e[i]=t,t._prev=o,t.parent=t._dp=e,t},sa=function(e,t,s,i){s===void 0&&(s="_first"),i===void 0&&(i="_last");var r=t._prev,o=t._next;r?r._next=o:e[s]===t&&(e[s]=o),o?o._prev=r:e[i]===t&&(e[i]=r),t._next=t._prev=t.parent=null},Ks=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},vn=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var s=e;s;)s._dirty=1,s=s.parent;return e},mT=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},$a=function(e,t,s,i){return e._startAt&&(it?e._startAt.revert(so):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,i))},_T=function n(e){return!e||e._ts&&n(e.parent)},ru=function(e){return e._repeat?li(e._tTime,e=e.duration()+e._rDelay)*e:0},li=function(e,t){var s=Math.floor(e/=t);return e&&s===e?s-1:s},Do=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},na=function(e){return e._end=Ke(e._start+(e._tDur/Math.abs(e._ts||e._rts||Ee)||0))},ia=function(e,t){var s=e._dp;return s&&s.smoothChildTiming&&e._ts&&(e._start=Ke(s._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),na(e),s._dirty||vn(s,e)),e},vd=function(e,t){var s;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(s=Do(e.rawTime(),t),(!t._dur||Pr(0,t.totalDuration(),s)-t._tTime>Ee)&&t.render(s,!0)),vn(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(s=e;s._dp;)s.rawTime()>=0&&s.totalTime(s._tTime),s=s._dp;e._zTime=-Ee}},ts=function(e,t,s,i){return t.parent&&Ks(t),t._start=Ke((Cs(s)?s:s||e!==Ue?Dt(e,s,t):e._time)+t._delay),t._end=Ke(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),gd(e,t,"_first","_last",e._sort?"_start":0),Xa(t)||(e._recent=t),i||vd(e,t),e._ts<0&&ia(e,e._tTime),e},yd=function(e,t){return(Mt.ScrollTrigger||Yc("scrollTrigger",t))&&Mt.ScrollTrigger.create(t,e)},xd=function(e,t,s,i,r){if(Kc(e,t,r),!e._initted)return 1;if(!s&&e._pt&&!it&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&dd!==bt.frame)return Gs.push(e),e._lazy=[r,i],1},gT=function n(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||n(t))},Xa=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},vT=function(e,t,s,i){var r=e.ratio,o=t<0||!t&&(!e._start&&gT(e)&&!(!e._initted&&Xa(e))||(e._ts<0||e._dp._ts<0)&&!Xa(e))?0:1,a=e._rDelay,c=0,l,u,h;if(a&&e._repeat&&(c=Pr(0,e._tDur,t),u=li(c,a),e._yoyo&&u&1&&(o=1-o),u!==li(e._tTime,a)&&(r=1-o,e.vars.repeatRefresh&&e._initted&&e.invalidate())),o!==r||it||i||e._zTime===Ee||!t&&e._zTime){if(!e._initted&&xd(e,t,i,s,c))return;for(h=e._zTime,e._zTime=t||(s?Ee:0),s||(s=t&&!h),e.ratio=o,e._from&&(o=1-o),e._time=0,e._tTime=c,l=e._pt;l;)l.r(o,l.d),l=l._next;t<0&&$a(e,t,s,!0),e._onUpdate&&!s&&Ct(e,"onUpdate"),c&&e._repeat&&!s&&e.parent&&Ct(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===o&&(o&&Ks(e,1),!s&&!it&&(Ct(e,o?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},yT=function(e,t,s){var i;if(s>t)for(i=e._first;i&&i._start<=s;){if(i.data==="isPause"&&i._start>t)return i;i=i._next}else for(i=e._last;i&&i._start>=s;){if(i.data==="isPause"&&i._start<t)return i;i=i._prev}},ui=function(e,t,s,i){var r=e._repeat,o=Ke(t)||0,a=e._tTime/e._tDur;return a&&!i&&(e._time*=o/e._dur),e._dur=o,e._tDur=r?r<0?1e10:Ke(o*(r+1)+e._rDelay*r):o,a>0&&!i&&ia(e,e._tTime=e._tDur*a),e.parent&&na(e),s||vn(e.parent,e),e},ou=function(e){return e instanceof lt?vn(e):ui(e,e._dur)},xT={_start:0,endTime:dr,totalDuration:dr},Dt=function n(e,t,s){var i=e.labels,r=e._recent||xT,o=e.duration()>=Nt?r.endTime(!1):e._dur,a,c,l;return tt(t)&&(isNaN(t)||t in i)?(c=t.charAt(0),l=t.substr(-1)==="%",a=t.indexOf("="),c==="<"||c===">"?(a>=0&&(t=t.replace(/=/,"")),(c==="<"?r._start:r.endTime(r._repeat>=0))+(parseFloat(t.substr(1))||0)*(l?(a<0?r:s).totalDuration()/100:1)):a<0?(t in i||(i[t]=o),i[t]):(c=parseFloat(t.charAt(a-1)+t.substr(a+1)),l&&s&&(c=c/100*(rt(s)?s[0]:s).totalDuration()),a>1?n(e,t.substr(0,a-1),s)+c:o+c)):t==null?o:+t},Hi=function(e,t,s){var i=Cs(t[1]),r=(i?2:1)+(e<2?0:1),o=t[r],a,c;if(i&&(o.duration=t[1]),o.parent=s,e){for(a=o,c=s;c&&!("immediateRender"in a);)a=c.vars.defaults||{},c=gt(c.vars.inherit)&&c.parent;o.immediateRender=gt(a.immediateRender),e<2?o.runBackwards=1:o.startAt=t[r-1]}return new $e(t[0],o,t[r+1])},sn=function(e,t){return e||e===0?t(e):t},Pr=function(e,t,s){return s<e?e:s>t?t:s},nt=function(e,t){return!tt(e)||!(t=lT.exec(e))?"":t[1]},TT=function(e,t,s){return sn(s,function(i){return Pr(e,t,i)})},Qa=[].slice,Td=function(e,t){return e&&os(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&os(e[0]))&&!e.nodeType&&e!==Rt},kT=function(e,t,s){return s===void 0&&(s=[]),e.forEach(function(i){var r;return tt(i)&&!t||Td(i,1)?(r=s).push.apply(r,Ft(i)):s.push(i)})||s},Ft=function(e,t,s){return Ve&&!t&&Ve.selector?Ve.selector(e):tt(e)&&!s&&(Ya||!hi())?Qa.call((t||Wc).querySelectorAll(e),0):rt(e)?kT(e,s):Td(e)?Qa.call(e,0):e?[e]:[]},Ka=function(e){return e=Ft(e)[0]||hr("Invalid scope")||{},function(t){var s=e.current||e.nativeElement||e;return Ft(t,s.querySelectorAll?s:s===e?hr("Invalid scope")||Wc.createElement("div"):e)}},kd=function(e){return e.sort(function(){return .5-Math.random()})},wd=function(e){if(je(e))return e;var t=os(e)?e:{each:e},s=yn(t.ease),i=t.from||0,r=parseFloat(t.base)||0,o={},a=i>0&&i<1,c=isNaN(i)||a,l=t.axis,u=i,h=i;return tt(i)?u=h={center:.5,edges:.5,end:1}[i]||0:!a&&c&&(u=i[0],h=i[1]),function(d,f,m){var p=(m||t).length,_=o[p],y,k,w,v,g,S,T,x,b;if(!_){if(b=t.grid==="auto"?0:(t.grid||[1,Nt])[1],!b){for(T=-Nt;T<(T=m[b++].getBoundingClientRect().left)&&b<p;);b<p&&b--}for(_=o[p]=[],y=c?Math.min(b,p)*u-.5:i%b,k=b===Nt?0:c?p*h/b-.5:i/b|0,T=0,x=Nt,S=0;S<p;S++)w=S%b-y,v=k-(S/b|0),_[S]=g=l?Math.abs(l==="y"?v:w):id(w*w+v*v),g>T&&(T=g),g<x&&(x=g);i==="random"&&kd(_),_.max=T-x,_.min=x,_.v=p=(parseFloat(t.amount)||parseFloat(t.each)*(b>p?p-1:l?l==="y"?p/b:b:Math.max(b,p/b))||0)*(i==="edges"?-1:1),_.b=p<0?r-p:r,_.u=nt(t.amount||t.each)||0,s=s&&p<0?Rd(s):s}return p=(_[d]-_.min)/_.max||0,Ke(_.b+(s?s(p):p)*_.v)+_.u}},Ja=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(s){var i=Ke(Math.round(parseFloat(s)/e)*e*t);return(i-i%1)/t+(Cs(s)?0:nt(s))}},Sd=function(e,t){var s=rt(e),i,r;return!s&&os(e)&&(i=s=e.radius||Nt,e.values?(e=Ft(e.values),(r=!Cs(e[0]))&&(i*=i)):e=Ja(e.increment)),sn(t,s?je(e)?function(o){return r=e(o),Math.abs(r-o)<=i?r:o}:function(o){for(var a=parseFloat(r?o.x:o),c=parseFloat(r?o.y:0),l=Nt,u=0,h=e.length,d,f;h--;)r?(d=e[h].x-a,f=e[h].y-c,d=d*d+f*f):d=Math.abs(e[h]-a),d<l&&(l=d,u=h);return u=!i||l<=i?e[u]:o,r||u===o||Cs(o)?u:u+nt(o)}:Ja(e))},bd=function(e,t,s,i){return sn(rt(e)?!t:s===!0?!!(s=0):!i,function(){return rt(e)?e[~~(Math.random()*e.length)]:(s=s||1e-5)&&(i=s<1?Math.pow(10,(s+"").length-2):1)&&Math.floor(Math.round((e-s/2+Math.random()*(t-e+s*.99))/s)*s*i)/i})},wT=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return function(i){return t.reduce(function(r,o){return o(r)},i)}},ST=function(e,t){return function(s){return e(parseFloat(s))+(t||nt(s))}},bT=function(e,t,s){return Ed(e,t,0,1,s)},Cd=function(e,t,s){return sn(s,function(i){return e[~~t(i)]})},CT=function n(e,t,s){var i=t-e;return rt(e)?Cd(e,n(0,e.length),t):sn(s,function(r){return(i+(r-e)%i)%i+e})},ET=function n(e,t,s){var i=t-e,r=i*2;return rt(e)?Cd(e,n(0,e.length-1),t):sn(s,function(o){return o=(r+(o-e)%r)%r||0,e+(o>i?r-o:o)})},fr=function(e){for(var t=0,s="",i,r,o,a;~(i=e.indexOf("random(",t));)o=e.indexOf(")",i),a=e.charAt(i+7)==="[",r=e.substr(i+7,o-i-7).match(a?cd:Wa),s+=e.substr(t,i-t)+bd(a?r:+r[0],a?0:+r[1],+r[2]||1e-5),t=o+1;return s+e.substr(t,e.length-t)},Ed=function(e,t,s,i,r){var o=t-e,a=i-s;return sn(r,function(c){return s+((c-e)/o*a||0)})},OT=function n(e,t,s,i){var r=isNaN(e+t)?0:function(f){return(1-f)*e+f*t};if(!r){var o=tt(e),a={},c,l,u,h,d;if(s===!0&&(i=1)&&(s=null),o)e={p:e},t={p:t};else if(rt(e)&&!rt(t)){for(u=[],h=e.length,d=h-2,l=1;l<h;l++)u.push(n(e[l-1],e[l]));h--,r=function(m){m*=h;var p=Math.min(d,~~m);return u[p](m-p)},s=t}else i||(e=Cn(rt(e)?[]:{},e));if(!u){for(c in t)Qc.call(a,e,c,"get",t[c]);r=function(m){return tl(m,a)||(o?e.p:e)}}}return sn(s,r)},au=function(e,t,s){var i=e.labels,r=Nt,o,a,c;for(o in i)a=i[o]-t,a<0==!!s&&a&&r>(a=Math.abs(a))&&(c=o,r=a);return c},Ct=function(e,t,s){var i=e.vars,r=i[t],o=Ve,a=e._ctx,c,l,u;if(r)return c=i[t+"Params"],l=i.callbackScope||e,s&&Gs.length&&Mo(),a&&(Ve=a),u=c?r.apply(l,c):r.call(l),Ve=o,u},Ui=function(e){return Ks(e),e.scrollTrigger&&e.scrollTrigger.kill(!!it),e.progress()<1&&Ct(e,"onInterrupt"),e},Yn,Od=[],Ad=function(e){if(Gc()&&e){e=!e.name&&e.default||e;var t=e.name,s=je(e),i=t&&!s&&e.init?function(){this._props=[]}:e,r={init:dr,render:tl,add:Qc,kill:qT,modifier:HT,rawVars:0},o={targetTest:0,get:0,getSetter:el,aliases:{},register:0};if(hi(),e!==i){if(St[t])return;Lt(i,Lt(Po(e,r),o)),Cn(i.prototype,Cn(r,Po(e,o))),St[i.prop=t]=i,e.targetTest&&(no.push(i),Zc[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}hd(t,i),e.register&&e.register(kt,i,yt)}else e&&Od.push(e)},Ce=255,Li={aqua:[0,Ce,Ce],lime:[0,Ce,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Ce],navy:[0,0,128],white:[Ce,Ce,Ce],olive:[128,128,0],yellow:[Ce,Ce,0],orange:[Ce,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Ce,0,0],pink:[Ce,192,203],cyan:[0,Ce,Ce],transparent:[Ce,Ce,Ce,0]},wa=function(e,t,s){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(s-t)*e*6:e<.5?s:e*3<2?t+(s-t)*(2/3-e)*6:t)*Ce+.5|0},Md=function(e,t,s){var i=e?Cs(e)?[e>>16,e>>8&Ce,e&Ce]:0:Li.black,r,o,a,c,l,u,h,d,f,m;if(!i){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),Li[e])i=Li[e];else if(e.charAt(0)==="#"){if(e.length<6&&(r=e.charAt(1),o=e.charAt(2),a=e.charAt(3),e="#"+r+r+o+o+a+a+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return i=parseInt(e.substr(1,6),16),[i>>16,i>>8&Ce,i&Ce,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),i=[e>>16,e>>8&Ce,e&Ce]}else if(e.substr(0,3)==="hsl"){if(i=m=e.match(Wa),!t)c=+i[0]%360/360,l=+i[1]/100,u=+i[2]/100,o=u<=.5?u*(l+1):u+l-u*l,r=u*2-o,i.length>3&&(i[3]*=1),i[0]=wa(c+1/3,r,o),i[1]=wa(c,r,o),i[2]=wa(c-1/3,r,o);else if(~e.indexOf("="))return i=e.match(od),s&&i.length<4&&(i[3]=1),i}else i=e.match(Wa)||Li.transparent;i=i.map(Number)}return t&&!m&&(r=i[0]/Ce,o=i[1]/Ce,a=i[2]/Ce,h=Math.max(r,o,a),d=Math.min(r,o,a),u=(h+d)/2,h===d?c=l=0:(f=h-d,l=u>.5?f/(2-h-d):f/(h+d),c=h===r?(o-a)/f+(o<a?6:0):h===o?(a-r)/f+2:(r-o)/f+4,c*=60),i[0]=~~(c+.5),i[1]=~~(l*100+.5),i[2]=~~(u*100+.5)),s&&i.length<4&&(i[3]=1),i},Pd=function(e){var t=[],s=[],i=-1;return e.split(Ws).forEach(function(r){var o=r.match(Wn)||[];t.push.apply(t,o),s.push(i+=o.length+1)}),t.c=s,t},cu=function(e,t,s){var i="",r=(e+i).match(Ws),o=t?"hsla(":"rgba(",a=0,c,l,u,h;if(!r)return e;if(r=r.map(function(d){return(d=Md(d,t,1))&&o+(t?d[0]+","+d[1]+"%,"+d[2]+"%,"+d[3]:d.join(","))+")"}),s&&(u=Pd(e),c=s.c,c.join(i)!==u.c.join(i)))for(l=e.replace(Ws,"1").split(Wn),h=l.length-1;a<h;a++)i+=l[a]+(~c.indexOf(a)?r.shift()||o+"0,0,0,0)":(u.length?u:r.length?r:s).shift());if(!l)for(l=e.split(Ws),h=l.length-1;a<h;a++)i+=l[a]+r[a];return i+l[h]},Ws=function(){var n="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in Li)n+="|"+e+"\\b";return new RegExp(n+")","gi")}(),AT=/hsl[a]?\(/,Dd=function(e){var t=e.join(" "),s;if(Ws.lastIndex=0,Ws.test(t))return s=AT.test(t),e[1]=cu(e[1],s),e[0]=cu(e[0],s,Pd(e[1])),!0},pr,bt=function(){var n=Date.now,e=500,t=33,s=n(),i=s,r=1e3/240,o=r,a=[],c,l,u,h,d,f,m=function p(_){var y=n()-i,k=_===!0,w,v,g,S;if(y>e&&(s+=y-t),i+=y,g=i-s,w=g-o,(w>0||k)&&(S=++h.frame,d=g-h.time*1e3,h.time=g=g/1e3,o+=w+(w>=r?4:r-w),v=1),k||(c=l(p)),v)for(f=0;f<a.length;f++)a[f](g,d,S,_)};return h={time:0,frame:0,tick:function(){m(!0)},deltaRatio:function(_){return d/(1e3/(_||60))},wake:function(){ld&&(!Ya&&Gc()&&(Rt=Ya=window,Wc=Rt.document||{},Mt.gsap=kt,(Rt.gsapVersions||(Rt.gsapVersions=[])).push(kt.version),ud(Ao||Rt.GreenSockGlobals||!Rt.gsap&&Rt||{}),u=Rt.requestAnimationFrame,Od.forEach(Ad)),c&&h.sleep(),l=u||function(_){return setTimeout(_,o-h.time*1e3+1|0)},pr=1,m(2))},sleep:function(){(u?Rt.cancelAnimationFrame:clearTimeout)(c),pr=0,l=dr},lagSmoothing:function(_,y){e=_||1/0,t=Math.min(y||33,e)},fps:function(_){r=1e3/(_||240),o=h.time*1e3+r},add:function(_,y,k){var w=y?function(v,g,S,T){_(v,g,S,T),h.remove(w)}:_;return h.remove(_),a[k?"unshift":"push"](w),hi(),w},remove:function(_,y){~(y=a.indexOf(_))&&a.splice(y,1)&&f>=y&&f--},_listeners:a},h}(),hi=function(){return!pr&&bt.wake()},_e={},MT=/^[\d.\-M][\d.\-,\s]/,PT=/["']/g,DT=function(e){for(var t={},s=e.substr(1,e.length-3).split(":"),i=s[0],r=1,o=s.length,a,c,l;r<o;r++)c=s[r],a=r!==o-1?c.lastIndexOf(","):c.length,l=c.substr(0,a),t[i]=isNaN(l)?l.replace(PT,"").trim():+l,i=c.substr(a+1).trim();return t},RT=function(e){var t=e.indexOf("(")+1,s=e.indexOf(")"),i=e.indexOf("(",t);return e.substring(t,~i&&i<s?e.indexOf(")",s+1):s)},IT=function(e){var t=(e+"").split("("),s=_e[t[0]];return s&&t.length>1&&s.config?s.config.apply(null,~e.indexOf("{")?[DT(t[1])]:RT(e).split(",").map(md)):_e._CE&&MT.test(e)?_e._CE("",e):s},Rd=function(e){return function(t){return 1-e(1-t)}},Id=function n(e,t){for(var s=e._first,i;s;)s instanceof lt?n(s,t):s.vars.yoyoEase&&(!s._yoyo||!s._repeat)&&s._yoyo!==t&&(s.timeline?n(s.timeline,t):(i=s._ease,s._ease=s._yEase,s._yEase=i,s._yoyo=t)),s=s._next},yn=function(e,t){return e&&(je(e)?e:_e[e]||IT(e))||t},Dn=function(e,t,s,i){s===void 0&&(s=function(c){return 1-t(1-c)}),i===void 0&&(i=function(c){return c<.5?t(c*2)/2:1-t((1-c)*2)/2});var r={easeIn:t,easeOut:s,easeInOut:i},o;return vt(e,function(a){_e[a]=Mt[a]=r,_e[o=a.toLowerCase()]=s;for(var c in r)_e[o+(c==="easeIn"?".in":c==="easeOut"?".out":".inOut")]=_e[a+"."+c]=r[c]}),r},Nd=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},Sa=function n(e,t,s){var i=t>=1?t:1,r=(s||(e?.3:.45))/(t<1?t:1),o=r/Ga*(Math.asin(1/i)||0),a=function(u){return u===1?1:i*Math.pow(2,-10*u)*cT((u-o)*r)+1},c=e==="out"?a:e==="in"?function(l){return 1-a(1-l)}:Nd(a);return r=Ga/r,c.config=function(l,u){return n(e,l,u)},c},ba=function n(e,t){t===void 0&&(t=1.70158);var s=function(o){return o?--o*o*((t+1)*o+t)+1:0},i=e==="out"?s:e==="in"?function(r){return 1-s(1-r)}:Nd(s);return i.config=function(r){return n(e,r)},i};vt("Linear,Quad,Cubic,Quart,Quint,Strong",function(n,e){var t=e<5?e+1:e;Dn(n+",Power"+(t-1),e?function(s){return Math.pow(s,t)}:function(s){return s},function(s){return 1-Math.pow(1-s,t)},function(s){return s<.5?Math.pow(s*2,t)/2:1-Math.pow((1-s)*2,t)/2})});_e.Linear.easeNone=_e.none=_e.Linear.easeIn;Dn("Elastic",Sa("in"),Sa("out"),Sa());(function(n,e){var t=1/e,s=2*t,i=2.5*t,r=function(a){return a<t?n*a*a:a<s?n*Math.pow(a-1.5/e,2)+.75:a<i?n*(a-=2.25/e)*a+.9375:n*Math.pow(a-2.625/e,2)+.984375};Dn("Bounce",function(o){return 1-r(1-o)},r)})(7.5625,2.75);Dn("Expo",function(n){return n?Math.pow(2,10*(n-1)):0});Dn("Circ",function(n){return-(id(1-n*n)-1)});Dn("Sine",function(n){return n===1?1:-aT(n*rT)+1});Dn("Back",ba("in"),ba("out"),ba());_e.SteppedEase=_e.steps=Mt.SteppedEase={config:function(e,t){e===void 0&&(e=1);var s=1/e,i=e+(t?0:1),r=t?1:0,o=1-Ee;return function(a){return((i*Pr(0,o,a)|0)+r)*s}}};ci.ease=_e["quad.out"];vt("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(n){return $c+=n+","+n+"Params,"});var Fd=function(e,t){this.id=oT++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:fd,this.set=t?t.getSetter:el},mr=function(){function n(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,ui(this,+t.duration,1,1),this.data=t.data,Ve&&(this._ctx=Ve,Ve.data.push(this)),pr||bt.wake()}var e=n.prototype;return e.delay=function(s){return s||s===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+s-this._delay),this._delay=s,this):this._delay},e.duration=function(s){return arguments.length?this.totalDuration(this._repeat>0?s+(s+this._rDelay)*this._repeat:s):this.totalDuration()&&this._dur},e.totalDuration=function(s){return arguments.length?(this._dirty=0,ui(this,this._repeat<0?s:(s-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(s,i){if(hi(),!arguments.length)return this._tTime;var r=this._dp;if(r&&r.smoothChildTiming&&this._ts){for(ia(this,s),!r._dp||r.parent||vd(r,this);r&&r.parent;)r.parent._time!==r._start+(r._ts>=0?r._tTime/r._ts:(r.totalDuration()-r._tTime)/-r._ts)&&r.totalTime(r._tTime,!0),r=r.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&s<this._tDur||this._ts<0&&s>0||!this._tDur&&!s)&&ts(this._dp,this,this._start-this._delay)}return(this._tTime!==s||!this._dur&&!i||this._initted&&Math.abs(this._zTime)===Ee||!s&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=s),pd(this,s,i)),this},e.time=function(s,i){return arguments.length?this.totalTime(Math.min(this.totalDuration(),s+ru(this))%(this._dur+this._rDelay)||(s?this._dur:0),i):this._time},e.totalProgress=function(s,i){return arguments.length?this.totalTime(this.totalDuration()*s,i):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>0?1:0},e.progress=function(s,i){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-s:s)+ru(this),i):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(s,i){var r=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(s-1)*r,i):this._repeat?li(this._tTime,r)+1:1},e.timeScale=function(s,i){if(!arguments.length)return this._rts===-Ee?0:this._rts;if(this._rts===s)return this;var r=this.parent&&this._ts?Do(this.parent._time,this):this._tTime;return this._rts=+s||0,this._ts=this._ps||s===-Ee?0:this._rts,this.totalTime(Pr(-Math.abs(this._delay),this._tDur,r),i!==!1),na(this),mT(this)},e.paused=function(s){return arguments.length?(this._ps!==s&&(this._ps=s,s?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(hi(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==Ee&&(this._tTime-=Ee)))),this):this._ps},e.startTime=function(s){if(arguments.length){this._start=s;var i=this.parent||this._dp;return i&&(i._sort||!this.parent)&&ts(i,this,s-this._delay),this}return this._start},e.endTime=function(s){return this._start+(gt(s)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(s){var i=this.parent||this._dp;return i?s&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Do(i.rawTime(s),this):this._tTime:this._tTime},e.revert=function(s){s===void 0&&(s=hT);var i=it;return it=s,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(s),this.totalTime(-.01,s.suppressEvents)),this.data!=="nested"&&s.kill!==!1&&this.kill(),it=i,this},e.globalTime=function(s){for(var i=this,r=arguments.length?s:i.rawTime();i;)r=i._start+r/(Math.abs(i._ts)||1),i=i._dp;return!this.parent&&this._sat?this._sat.globalTime(s):r},e.repeat=function(s){return arguments.length?(this._repeat=s===1/0?-2:s,ou(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(s){if(arguments.length){var i=this._time;return this._rDelay=s,ou(this),i?this.time(i):this}return this._rDelay},e.yoyo=function(s){return arguments.length?(this._yoyo=s,this):this._yoyo},e.seek=function(s,i){return this.totalTime(Dt(this,s),gt(i))},e.restart=function(s,i){return this.play().totalTime(s?-this._delay:0,gt(i))},e.play=function(s,i){return s!=null&&this.seek(s,i),this.reversed(!1).paused(!1)},e.reverse=function(s,i){return s!=null&&this.seek(s||this.totalDuration(),i),this.reversed(!0).paused(!1)},e.pause=function(s,i){return s!=null&&this.seek(s,i),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(s){return arguments.length?(!!s!==this.reversed()&&this.timeScale(-this._rts||(s?-Ee:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-Ee,this},e.isActive=function(){var s=this.parent||this._dp,i=this._start,r;return!!(!s||this._ts&&this._initted&&s.isActive()&&(r=s.rawTime(!0))>=i&&r<this.endTime(!0)-Ee)},e.eventCallback=function(s,i,r){var o=this.vars;return arguments.length>1?(i?(o[s]=i,r&&(o[s+"Params"]=r),s==="onUpdate"&&(this._onUpdate=i)):delete o[s],this):o[s]},e.then=function(s){var i=this;return new Promise(function(r){var o=je(s)?s:_d,a=function(){var l=i.then;i.then=null,je(o)&&(o=o(i))&&(o.then||o===i)&&(i.then=l),r(o),i.then=l};i._initted&&i.totalProgress()===1&&i._ts>=0||!i._tTime&&i._ts<0?a():i._prom=a})},e.kill=function(){Ui(this)},n}();Lt(mr.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-Ee,_prom:0,_ps:!1,_rts:1});var lt=function(n){nd(e,n);function e(s,i){var r;return s===void 0&&(s={}),r=n.call(this,s)||this,r.labels={},r.smoothChildTiming=!!s.smoothChildTiming,r.autoRemoveChildren=!!s.autoRemoveChildren,r._sort=gt(s.sortChildren),Ue&&ts(s.parent||Ue,gs(r),i),s.reversed&&r.reverse(),s.paused&&r.paused(!0),s.scrollTrigger&&yd(gs(r),s.scrollTrigger),r}var t=e.prototype;return t.to=function(i,r,o){return Hi(0,arguments,this),this},t.from=function(i,r,o){return Hi(1,arguments,this),this},t.fromTo=function(i,r,o,a){return Hi(2,arguments,this),this},t.set=function(i,r,o){return r.duration=0,r.parent=this,ji(r).repeatDelay||(r.repeat=0),r.immediateRender=!!r.immediateRender,new $e(i,r,Dt(this,o),1),this},t.call=function(i,r,o){return ts(this,$e.delayedCall(0,i,r),o)},t.staggerTo=function(i,r,o,a,c,l,u){return o.duration=r,o.stagger=o.stagger||a,o.onComplete=l,o.onCompleteParams=u,o.parent=this,new $e(i,o,Dt(this,c)),this},t.staggerFrom=function(i,r,o,a,c,l,u){return o.runBackwards=1,ji(o).immediateRender=gt(o.immediateRender),this.staggerTo(i,r,o,a,c,l,u)},t.staggerFromTo=function(i,r,o,a,c,l,u,h){return a.startAt=o,ji(a).immediateRender=gt(a.immediateRender),this.staggerTo(i,r,a,c,l,u,h)},t.render=function(i,r,o){var a=this._time,c=this._dirty?this.totalDuration():this._tDur,l=this._dur,u=i<=0?0:Ke(i),h=this._zTime<0!=i<0&&(this._initted||!l),d,f,m,p,_,y,k,w,v,g,S,T;if(this!==Ue&&u>c&&i>=0&&(u=c),u!==this._tTime||o||h){if(a!==this._time&&l&&(u+=this._time-a,i+=this._time-a),d=u,v=this._start,w=this._ts,y=!w,h&&(l||(a=this._zTime),(i||!r)&&(this._zTime=i)),this._repeat){if(S=this._yoyo,_=l+this._rDelay,this._repeat<-1&&i<0)return this.totalTime(_*100+i,r,o);if(d=Ke(u%_),u===c?(p=this._repeat,d=l):(p=~~(u/_),p&&p===u/_&&(d=l,p--),d>l&&(d=l)),g=li(this._tTime,_),!a&&this._tTime&&g!==p&&this._tTime-g*_-this._dur<=0&&(g=p),S&&p&1&&(d=l-d,T=1),p!==g&&!this._lock){var x=S&&g&1,b=x===(S&&p&1);if(p<g&&(x=!x),a=x?0:u%l?l:u,this._lock=1,this.render(a||(T?0:Ke(p*_)),r,!l)._lock=0,this._tTime=u,!r&&this.parent&&Ct(this,"onRepeat"),this.vars.repeatRefresh&&!T&&(this.invalidate()._lock=1),a&&a!==this._time||y!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(l=this._dur,c=this._tDur,b&&(this._lock=2,a=x?l:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!T&&this.invalidate()),this._lock=0,!this._ts&&!y)return this;Id(this,T)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(k=yT(this,Ke(a),Ke(d)),k&&(u-=d-(d=k._start))),this._tTime=u,this._time=d,this._act=!w,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=i,a=0),!a&&d&&!r&&!p&&(Ct(this,"onStart"),this._tTime!==u))return this;if(d>=a&&i>=0)for(f=this._first;f;){if(m=f._next,(f._act||d>=f._start)&&f._ts&&k!==f){if(f.parent!==this)return this.render(i,r,o);if(f.render(f._ts>0?(d-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(d-f._start)*f._ts,r,o),d!==this._time||!this._ts&&!y){k=0,m&&(u+=this._zTime=-Ee);break}}f=m}else{f=this._last;for(var A=i<0?i:d;f;){if(m=f._prev,(f._act||A<=f._end)&&f._ts&&k!==f){if(f.parent!==this)return this.render(i,r,o);if(f.render(f._ts>0?(A-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(A-f._start)*f._ts,r,o||it&&(f._initted||f._startAt)),d!==this._time||!this._ts&&!y){k=0,m&&(u+=this._zTime=A?-Ee:Ee);break}}f=m}}if(k&&!r&&(this.pause(),k.render(d>=a?0:-Ee)._zTime=d>=a?1:-1,this._ts))return this._start=v,na(this),this.render(i,r,o);this._onUpdate&&!r&&Ct(this,"onUpdate",!0),(u===c&&this._tTime>=this.totalDuration()||!u&&a)&&(v===this._start||Math.abs(w)!==Math.abs(this._ts))&&(this._lock||((i||!l)&&(u===c&&this._ts>0||!u&&this._ts<0)&&Ks(this,1),!r&&!(i<0&&!a)&&(u||a||!c)&&(Ct(this,u===c&&i>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(u<c&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(i,r){var o=this;if(Cs(r)||(r=Dt(this,r,i)),!(i instanceof mr)){if(rt(i))return i.forEach(function(a){return o.add(a,r)}),this;if(tt(i))return this.addLabel(i,r);if(je(i))i=$e.delayedCall(0,i);else return this}return this!==i?ts(this,i,r):this},t.getChildren=function(i,r,o,a){i===void 0&&(i=!0),r===void 0&&(r=!0),o===void 0&&(o=!0),a===void 0&&(a=-Nt);for(var c=[],l=this._first;l;)l._start>=a&&(l instanceof $e?r&&c.push(l):(o&&c.push(l),i&&c.push.apply(c,l.getChildren(!0,r,o)))),l=l._next;return c},t.getById=function(i){for(var r=this.getChildren(1,1,1),o=r.length;o--;)if(r[o].vars.id===i)return r[o]},t.remove=function(i){return tt(i)?this.removeLabel(i):je(i)?this.killTweensOf(i):(sa(this,i),i===this._recent&&(this._recent=this._last),vn(this))},t.totalTime=function(i,r){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Ke(bt.time-(this._ts>0?i/this._ts:(this.totalDuration()-i)/-this._ts))),n.prototype.totalTime.call(this,i,r),this._forcing=0,this):this._tTime},t.addLabel=function(i,r){return this.labels[i]=Dt(this,r),this},t.removeLabel=function(i){return delete this.labels[i],this},t.addPause=function(i,r,o){var a=$e.delayedCall(0,r||dr,o);return a.data="isPause",this._hasPause=1,ts(this,a,Dt(this,i))},t.removePause=function(i){var r=this._first;for(i=Dt(this,i);r;)r._start===i&&r.data==="isPause"&&Ks(r),r=r._next},t.killTweensOf=function(i,r,o){for(var a=this.getTweensOf(i,o),c=a.length;c--;)Bs!==a[c]&&a[c].kill(i,r);return this},t.getTweensOf=function(i,r){for(var o=[],a=Ft(i),c=this._first,l=Cs(r),u;c;)c instanceof $e?dT(c._targets,a)&&(l?(!Bs||c._initted&&c._ts)&&c.globalTime(0)<=r&&c.globalTime(c.totalDuration())>r:!r||c.isActive())&&o.push(c):(u=c.getTweensOf(a,r)).length&&o.push.apply(o,u),c=c._next;return o},t.tweenTo=function(i,r){r=r||{};var o=this,a=Dt(o,i),c=r,l=c.startAt,u=c.onStart,h=c.onStartParams,d=c.immediateRender,f,m=$e.to(o,Lt({ease:r.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:r.duration||Math.abs((a-(l&&"time"in l?l.time:o._time))/o.timeScale())||Ee,onStart:function(){if(o.pause(),!f){var _=r.duration||Math.abs((a-(l&&"time"in l?l.time:o._time))/o.timeScale());m._dur!==_&&ui(m,_,0,1).render(m._time,!0,!0),f=1}u&&u.apply(m,h||[])}},r));return d?m.render(0):m},t.tweenFromTo=function(i,r,o){return this.tweenTo(r,Lt({startAt:{time:Dt(this,i)}},o))},t.recent=function(){return this._recent},t.nextLabel=function(i){return i===void 0&&(i=this._time),au(this,Dt(this,i))},t.previousLabel=function(i){return i===void 0&&(i=this._time),au(this,Dt(this,i),1)},t.currentLabel=function(i){return arguments.length?this.seek(i,!0):this.previousLabel(this._time+Ee)},t.shiftChildren=function(i,r,o){o===void 0&&(o=0);for(var a=this._first,c=this.labels,l;a;)a._start>=o&&(a._start+=i,a._end+=i),a=a._next;if(r)for(l in c)c[l]>=o&&(c[l]+=i);return vn(this)},t.invalidate=function(i){var r=this._first;for(this._lock=0;r;)r.invalidate(i),r=r._next;return n.prototype.invalidate.call(this,i)},t.clear=function(i){i===void 0&&(i=!0);for(var r=this._first,o;r;)o=r._next,this.remove(r),r=o;return this._dp&&(this._time=this._tTime=this._pTime=0),i&&(this.labels={}),vn(this)},t.totalDuration=function(i){var r=0,o=this,a=o._last,c=Nt,l,u,h;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-i:i));if(o._dirty){for(h=o.parent;a;)l=a._prev,a._dirty&&a.totalDuration(),u=a._start,u>c&&o._sort&&a._ts&&!o._lock?(o._lock=1,ts(o,a,u-a._delay,1)._lock=0):c=u,u<0&&a._ts&&(r-=u,(!h&&!o._dp||h&&h.smoothChildTiming)&&(o._start+=u/o._ts,o._time-=u,o._tTime-=u),o.shiftChildren(-u,!1,-1/0),c=0),a._end>r&&a._ts&&(r=a._end),a=l;ui(o,o===Ue&&o._time>r?o._time:r,1,1),o._dirty=0}return o._tDur},e.updateRoot=function(i){if(Ue._ts&&(pd(Ue,Do(i,Ue)),dd=bt.frame),bt.frame>=nu){nu+=Ot.autoSleep||120;var r=Ue._first;if((!r||!r._ts)&&Ot.autoSleep&&bt._listeners.length<2){for(;r&&!r._ts;)r=r._next;r||bt.sleep()}}},e}(mr);Lt(lt.prototype,{_lock:0,_hasPause:0,_forcing:0});var NT=function(e,t,s,i,r,o,a){var c=new yt(this._pt,e,t,0,1,jd,null,r),l=0,u=0,h,d,f,m,p,_,y,k;for(c.b=s,c.e=i,s+="",i+="",(y=~i.indexOf("random("))&&(i=fr(i)),o&&(k=[s,i],o(k,e,t),s=k[0],i=k[1]),d=s.match(Ta)||[];h=Ta.exec(i);)m=h[0],p=i.substring(l,h.index),f?f=(f+1)%5:p.substr(-5)==="rgba("&&(f=1),m!==d[u++]&&(_=parseFloat(d[u-1])||0,c._pt={_next:c._pt,p:p||u===1?p:",",s:_,c:m.charAt(1)==="="?Xn(_,m)-_:parseFloat(m)-_,m:f&&f<4?Math.round:0},l=Ta.lastIndex);return c.c=l<i.length?i.substring(l,i.length):"",c.fp=a,(ad.test(i)||y)&&(c.e=0),this._pt=c,c},Qc=function(e,t,s,i,r,o,a,c,l,u){je(i)&&(i=i(r||0,e,o));var h=e[t],d=s!=="get"?s:je(h)?l?e[t.indexOf("set")||!je(e["get"+t.substr(3)])?t:"get"+t.substr(3)](l):e[t]():h,f=je(h)?l?zT:zd:Jc,m;if(tt(i)&&(~i.indexOf("random(")&&(i=fr(i)),i.charAt(1)==="="&&(m=Xn(d,i)+(nt(d)||0),(m||m===0)&&(i=m))),!u||d!==i||ec)return!isNaN(d*i)&&i!==""?(m=new yt(this._pt,e,t,+d||0,i-(d||0),typeof h=="boolean"?jT:Vd,0,f),l&&(m.fp=l),a&&m.modifier(a,this,e),this._pt=m):(!h&&!(t in e)&&Yc(t,i),NT.call(this,e,t,d,i,f,c||Ot.stringFilter,l))},FT=function(e,t,s,i,r){if(je(e)&&(e=qi(e,r,t,s,i)),!os(e)||e.style&&e.nodeType||rt(e)||rd(e))return tt(e)?qi(e,r,t,s,i):e;var o={},a;for(a in e)o[a]=qi(e[a],r,t,s,i);return o},Ud=function(e,t,s,i,r,o){var a,c,l,u;if(St[e]&&(a=new St[e]).init(r,a.rawVars?t[e]:FT(t[e],i,r,o,s),s,i,o)!==!1&&(s._pt=c=new yt(s._pt,r,e,0,1,a.render,a,0,a.priority),s!==Yn))for(l=s._ptLookup[s._targets.indexOf(r)],u=a._props.length;u--;)l[a._props[u]]=c;return a},Bs,ec,Kc=function n(e,t,s){var i=e.vars,r=i.ease,o=i.startAt,a=i.immediateRender,c=i.lazy,l=i.onUpdate,u=i.runBackwards,h=i.yoyoEase,d=i.keyframes,f=i.autoRevert,m=e._dur,p=e._startAt,_=e._targets,y=e.parent,k=y&&y.data==="nested"?y.vars.targets:_,w=e._overwrite==="auto"&&!Hc,v=e.timeline,g,S,T,x,b,A,R,M,L,q,Y,W,V;if(v&&(!d||!r)&&(r="none"),e._ease=yn(r,ci.ease),e._yEase=h?Rd(yn(h===!0?r:h,ci.ease)):0,h&&e._yoyo&&!e._repeat&&(h=e._yEase,e._yEase=e._ease,e._ease=h),e._from=!v&&!!i.runBackwards,!v||d&&!i.stagger){if(M=_[0]?gn(_[0]).harness:0,W=M&&i[M.prop],g=Po(i,Zc),p&&(p._zTime<0&&p.progress(1),t<0&&u&&a&&!f?p.render(-1,!0):p.revert(u&&m?so:uT),p._lazy=0),o){if(Ks(e._startAt=$e.set(_,Lt({data:"isStart",overwrite:!1,parent:y,immediateRender:!0,lazy:!p&&gt(c),startAt:null,delay:0,onUpdate:l&&function(){return Ct(e,"onUpdate")},stagger:0},o))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(it||!a&&!f)&&e._startAt.revert(so),a&&m&&t<=0&&s<=0){t&&(e._zTime=t);return}}else if(u&&m&&!p){if(t&&(a=!1),T=Lt({overwrite:!1,data:"isFromStart",lazy:a&&!p&&gt(c),immediateRender:a,stagger:0,parent:y},g),W&&(T[M.prop]=W),Ks(e._startAt=$e.set(_,T)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(it?e._startAt.revert(so):e._startAt.render(-1,!0)),e._zTime=t,!a)n(e._startAt,Ee,Ee);else if(!t)return}for(e._pt=e._ptCache=0,c=m&&gt(c)||c&&!m,S=0;S<_.length;S++){if(b=_[S],R=b._gsap||Xc(_)[S]._gsap,e._ptLookup[S]=q={},Za[R.id]&&Gs.length&&Mo(),Y=k===_?S:k.indexOf(b),M&&(L=new M).init(b,W||g,e,Y,k)!==!1&&(e._pt=x=new yt(e._pt,b,L.name,0,1,L.render,L,0,L.priority),L._props.forEach(function(z){q[z]=x}),L.priority&&(A=1)),!M||W)for(T in g)St[T]&&(L=Ud(T,g,e,Y,b,k))?L.priority&&(A=1):q[T]=x=Qc.call(e,b,T,"get",g[T],Y,k,0,i.stringFilter);e._op&&e._op[S]&&e.kill(b,e._op[S]),w&&e._pt&&(Bs=e,Ue.killTweensOf(b,q,e.globalTime(t)),V=!e.parent,Bs=0),e._pt&&c&&(Za[R.id]=1)}A&&Hd(e),e._onInit&&e._onInit(e)}e._onUpdate=l,e._initted=(!e._op||e._pt)&&!V,d&&t<=0&&v.render(Nt,!0,!0)},UT=function(e,t,s,i,r,o,a,c){var l=(e._pt&&e._ptCache||(e._ptCache={}))[t],u,h,d,f;if(!l)for(l=e._ptCache[t]=[],d=e._ptLookup,f=e._targets.length;f--;){if(u=d[f][t],u&&u.d&&u.d._pt)for(u=u.d._pt;u&&u.p!==t&&u.fp!==t;)u=u._next;if(!u)return ec=1,e.vars[t]="+=0",Kc(e,a),ec=0,c?hr(t+" not eligible for reset"):1;l.push(u)}for(f=l.length;f--;)h=l[f],u=h._pt||h,u.s=(i||i===0)&&!r?i:u.s+(i||0)+o*u.c,u.c=s-u.s,h.e&&(h.e=qe(s)+nt(h.e)),h.b&&(h.b=u.s+nt(h.b))},LT=function(e,t){var s=e[0]?gn(e[0]).harness:0,i=s&&s.aliases,r,o,a,c;if(!i)return t;r=Cn({},t);for(o in i)if(o in r)for(c=i[o].split(","),a=c.length;a--;)r[c[a]]=r[o];return r},BT=function(e,t,s,i){var r=t.ease||i||"power1.inOut",o,a;if(rt(t))a=s[e]||(s[e]=[]),t.forEach(function(c,l){return a.push({t:l/(t.length-1)*100,v:c,e:r})});else for(o in t)a=s[o]||(s[o]=[]),o==="ease"||a.push({t:parseFloat(e),v:t[o],e:r})},qi=function(e,t,s,i,r){return je(e)?e.call(t,s,i,r):tt(e)&&~e.indexOf("random(")?fr(e):e},Ld=$c+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",Bd={};vt(Ld+",id,stagger,delay,duration,paused,scrollTrigger",function(n){return Bd[n]=1});var $e=function(n){nd(e,n);function e(s,i,r,o){var a;typeof i=="number"&&(r.duration=i,i=r,r=null),a=n.call(this,o?i:ji(i))||this;var c=a.vars,l=c.duration,u=c.delay,h=c.immediateRender,d=c.stagger,f=c.overwrite,m=c.keyframes,p=c.defaults,_=c.scrollTrigger,y=c.yoyoEase,k=i.parent||Ue,w=(rt(s)||rd(s)?Cs(s[0]):"length"in i)?[s]:Ft(s),v,g,S,T,x,b,A,R;if(a._targets=w.length?Xc(w):hr("GSAP target "+s+" not found. https://gsap.com",!Ot.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=f,m||d||Qr(l)||Qr(u)){if(i=a.vars,v=a.timeline=new lt({data:"nested",defaults:p||{},targets:k&&k.data==="nested"?k.vars.targets:w}),v.kill(),v.parent=v._dp=gs(a),v._start=0,d||Qr(l)||Qr(u)){if(T=w.length,A=d&&wd(d),os(d))for(x in d)~Ld.indexOf(x)&&(R||(R={}),R[x]=d[x]);for(g=0;g<T;g++)S=Po(i,Bd),S.stagger=0,y&&(S.yoyoEase=y),R&&Cn(S,R),b=w[g],S.duration=+qi(l,gs(a),g,b,w),S.delay=(+qi(u,gs(a),g,b,w)||0)-a._delay,!d&&T===1&&S.delay&&(a._delay=u=S.delay,a._start+=u,S.delay=0),v.to(b,S,A?A(g,b,w):0),v._ease=_e.none;v.duration()?l=u=0:a.timeline=0}else if(m){ji(Lt(v.vars.defaults,{ease:"none"})),v._ease=yn(m.ease||i.ease||"none");var M=0,L,q,Y;if(rt(m))m.forEach(function(W){return v.to(w,W,">")}),v.duration();else{S={};for(x in m)x==="ease"||x==="easeEach"||BT(x,m[x],S,m.easeEach);for(x in S)for(L=S[x].sort(function(W,V){return W.t-V.t}),M=0,g=0;g<L.length;g++)q=L[g],Y={ease:q.e,duration:(q.t-(g?L[g-1].t:0))/100*l},Y[x]=q.v,v.to(w,Y,M),M+=Y.duration;v.duration()<l&&v.to({},{duration:l-v.duration()})}}l||a.duration(l=v.duration())}else a.timeline=0;return f===!0&&!Hc&&(Bs=gs(a),Ue.killTweensOf(w),Bs=0),ts(k,gs(a),r),i.reversed&&a.reverse(),i.paused&&a.paused(!0),(h||!l&&!m&&a._start===Ke(k._time)&&gt(h)&&_T(gs(a))&&k.data!=="nested")&&(a._tTime=-Ee,a.render(Math.max(0,-u)||0)),_&&yd(gs(a),_),a}var t=e.prototype;return t.render=function(i,r,o){var a=this._time,c=this._tDur,l=this._dur,u=i<0,h=i>c-Ee&&!u?c:i<Ee?0:i,d,f,m,p,_,y,k,w,v;if(!l)vT(this,i,r,o);else if(h!==this._tTime||!i||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==u){if(d=h,w=this.timeline,this._repeat){if(p=l+this._rDelay,this._repeat<-1&&u)return this.totalTime(p*100+i,r,o);if(d=Ke(h%p),h===c?(m=this._repeat,d=l):(m=~~(h/p),m&&m===Ke(h/p)&&(d=l,m--),d>l&&(d=l)),y=this._yoyo&&m&1,y&&(v=this._yEase,d=l-d),_=li(this._tTime,p),d===a&&!o&&this._initted&&m===_)return this._tTime=h,this;m!==_&&(w&&this._yEase&&Id(w,y),this.vars.repeatRefresh&&!y&&!this._lock&&this._time!==l&&this._initted&&(this._lock=o=1,this.render(Ke(p*m),!0).invalidate()._lock=0))}if(!this._initted){if(xd(this,u?i:d,o,r,h))return this._tTime=0,this;if(a!==this._time&&!(o&&this.vars.repeatRefresh&&m!==_))return this;if(l!==this._dur)return this.render(i,r,o)}if(this._tTime=h,this._time=d,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=k=(v||this._ease)(d/l),this._from&&(this.ratio=k=1-k),d&&!a&&!r&&!m&&(Ct(this,"onStart"),this._tTime!==h))return this;for(f=this._pt;f;)f.r(k,f.d),f=f._next;w&&w.render(i<0?i:!d&&y?-Ee:w._dur*w._ease(d/this._dur),r,o)||this._startAt&&(this._zTime=i),this._onUpdate&&!r&&(u&&$a(this,i,r,o),Ct(this,"onUpdate")),this._repeat&&m!==_&&this.vars.onRepeat&&!r&&this.parent&&Ct(this,"onRepeat"),(h===this._tDur||!h)&&this._tTime===h&&(u&&!this._onUpdate&&$a(this,i,!0,!0),(i||!l)&&(h===this._tDur&&this._ts>0||!h&&this._ts<0)&&Ks(this,1),!r&&!(u&&!a)&&(h||a||y)&&(Ct(this,h===c?"onComplete":"onReverseComplete",!0),this._prom&&!(h<c&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(i){return(!i||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(i),n.prototype.invalidate.call(this,i)},t.resetTo=function(i,r,o,a,c){pr||bt.wake(),this._ts||this.play();var l=Math.min(this._dur,(this._dp._time-this._start)*this._ts),u;return this._initted||Kc(this,l),u=this._ease(l/this._dur),UT(this,i,r,o,a,u,l,c)?this.resetTo(i,r,o,a,1):(ia(this,0),this.parent||gd(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(i,r){if(r===void 0&&(r="all"),!i&&(!r||r==="all"))return this._lazy=this._pt=0,this.parent?Ui(this):this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(i,r,Bs&&Bs.vars.overwrite!==!0)._first||Ui(this),this.parent&&o!==this.timeline.totalDuration()&&ui(this,this._dur*this.timeline._tDur/o,0,1),this}var a=this._targets,c=i?Ft(i):a,l=this._ptLookup,u=this._pt,h,d,f,m,p,_,y;if((!r||r==="all")&&pT(a,c))return r==="all"&&(this._pt=0),Ui(this);for(h=this._op=this._op||[],r!=="all"&&(tt(r)&&(p={},vt(r,function(k){return p[k]=1}),r=p),r=LT(a,r)),y=a.length;y--;)if(~c.indexOf(a[y])){d=l[y],r==="all"?(h[y]=r,m=d,f={}):(f=h[y]=h[y]||{},m=r);for(p in m)_=d&&d[p],_&&((!("kill"in _.d)||_.d.kill(p)===!0)&&sa(this,_,"_pt"),delete d[p]),f!=="all"&&(f[p]=1)}return this._initted&&!this._pt&&u&&Ui(this),this},e.to=function(i,r){return new e(i,r,arguments[2])},e.from=function(i,r){return Hi(1,arguments)},e.delayedCall=function(i,r,o,a){return new e(r,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:i,onComplete:r,onReverseComplete:r,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},e.fromTo=function(i,r,o){return Hi(2,arguments)},e.set=function(i,r){return r.duration=0,r.repeatDelay||(r.repeat=0),new e(i,r)},e.killTweensOf=function(i,r,o){return Ue.killTweensOf(i,r,o)},e}(mr);Lt($e.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});vt("staggerTo,staggerFrom,staggerFromTo",function(n){$e[n]=function(){var e=new lt,t=Qa.call(arguments,0);return t.splice(n==="staggerFromTo"?5:4,0,0),e[n].apply(e,t)}});var Jc=function(e,t,s){return e[t]=s},zd=function(e,t,s){return e[t](s)},zT=function(e,t,s,i){return e[t](i.fp,s)},VT=function(e,t,s){return e.setAttribute(t,s)},el=function(e,t){return je(e[t])?zd:qc(e[t])&&e.setAttribute?VT:Jc},Vd=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},jT=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},jd=function(e,t){var s=t._pt,i="";if(!e&&t.b)i=t.b;else if(e===1&&t.e)i=t.e;else{for(;s;)i=s.p+(s.m?s.m(s.s+s.c*e):Math.round((s.s+s.c*e)*1e4)/1e4)+i,s=s._next;i+=t.c}t.set(t.t,t.p,i,t)},tl=function(e,t){for(var s=t._pt;s;)s.r(e,s.d),s=s._next},HT=function(e,t,s,i){for(var r=this._pt,o;r;)o=r._next,r.p===i&&r.modifier(e,t,s),r=o},qT=function(e){for(var t=this._pt,s,i;t;)i=t._next,t.p===e&&!t.op||t.op===e?sa(this,t,"_pt"):t.dep||(s=1),t=i;return!s},GT=function(e,t,s,i){i.mSet(e,t,i.m.call(i.tween,s,i.mt),i)},Hd=function(e){for(var t=e._pt,s,i,r,o;t;){for(s=t._next,i=r;i&&i.pr>t.pr;)i=i._next;(t._prev=i?i._prev:o)?t._prev._next=t:r=t,(t._next=i)?i._prev=t:o=t,t=s}e._pt=r},yt=function(){function n(t,s,i,r,o,a,c,l,u){this.t=s,this.s=r,this.c=o,this.p=i,this.r=a||Vd,this.d=c||this,this.set=l||Jc,this.pr=u||0,this._next=t,t&&(t._prev=this)}var e=n.prototype;return e.modifier=function(s,i,r){this.mSet=this.mSet||this.set,this.set=GT,this.m=s,this.mt=r,this.tween=i},n}();vt($c+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(n){return Zc[n]=1});Mt.TweenMax=Mt.TweenLite=$e;Mt.TimelineLite=Mt.TimelineMax=lt;Ue=new lt({sortChildren:!1,defaults:ci,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Ot.stringFilter=Dd;var xn=[],io={},WT=[],lu=0,YT=0,Ca=function(e){return(io[e]||WT).map(function(t){return t()})},tc=function(){var e=Date.now(),t=[];e-lu>2&&(Ca("matchMediaInit"),xn.forEach(function(s){var i=s.queries,r=s.conditions,o,a,c,l;for(a in i)o=Rt.matchMedia(i[a]).matches,o&&(c=1),o!==r[a]&&(r[a]=o,l=1);l&&(s.revert(),c&&t.push(s))}),Ca("matchMediaRevert"),t.forEach(function(s){return s.onMatch(s,function(i){return s.add(null,i)})}),lu=e,Ca("matchMedia"))},qd=function(){function n(t,s){this.selector=s&&Ka(s),this.data=[],this._r=[],this.isReverted=!1,this.id=YT++,t&&this.add(t)}var e=n.prototype;return e.add=function(s,i,r){je(s)&&(r=i,i=s,s=je);var o=this,a=function(){var l=Ve,u=o.selector,h;return l&&l!==o&&l.data.push(o),r&&(o.selector=Ka(r)),Ve=o,h=i.apply(o,arguments),je(h)&&o._r.push(h),Ve=l,o.selector=u,o.isReverted=!1,h};return o.last=a,s===je?a(o,function(c){return o.add(null,c)}):s?o[s]=a:a},e.ignore=function(s){var i=Ve;Ve=null,s(this),Ve=i},e.getTweens=function(){var s=[];return this.data.forEach(function(i){return i instanceof n?s.push.apply(s,i.getTweens()):i instanceof $e&&!(i.parent&&i.parent.data==="nested")&&s.push(i)}),s},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(s,i){var r=this;if(s?function(){for(var a=r.getTweens(),c=r.data.length,l;c--;)l=r.data[c],l.data==="isFlip"&&(l.revert(),l.getChildren(!0,!0,!1).forEach(function(u){return a.splice(a.indexOf(u),1)}));for(a.map(function(u){return{g:u._dur||u._delay||u._sat&&!u._sat.vars.immediateRender?u.globalTime(0):-1/0,t:u}}).sort(function(u,h){return h.g-u.g||-1/0}).forEach(function(u){return u.t.revert(s)}),c=r.data.length;c--;)l=r.data[c],l instanceof lt?l.data!=="nested"&&(l.scrollTrigger&&l.scrollTrigger.revert(),l.kill()):!(l instanceof $e)&&l.revert&&l.revert(s);r._r.forEach(function(u){return u(s,r)}),r.isReverted=!0}():this.data.forEach(function(a){return a.kill&&a.kill()}),this.clear(),i)for(var o=xn.length;o--;)xn[o].id===this.id&&xn.splice(o,1)},e.revert=function(s){this.kill(s||{})},n}(),ZT=function(){function n(t){this.contexts=[],this.scope=t}var e=n.prototype;return e.add=function(s,i,r){os(s)||(s={matches:s});var o=new qd(0,r||this.scope),a=o.conditions={},c,l,u;Ve&&!o.selector&&(o.selector=Ve.selector),this.contexts.push(o),i=o.add("onMatch",i),o.queries=s;for(l in s)l==="all"?u=1:(c=Rt.matchMedia(s[l]),c&&(xn.indexOf(o)<0&&xn.push(o),(a[l]=c.matches)&&(u=1),c.addListener?c.addListener(tc):c.addEventListener("change",tc)));return u&&i(o,function(h){return o.add(null,h)}),this},e.revert=function(s){this.kill(s||{})},e.kill=function(s){this.contexts.forEach(function(i){return i.kill(s,!0)})},n}(),Ro={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];t.forEach(function(i){return Ad(i)})},timeline:function(e){return new lt(e)},getTweensOf:function(e,t){return Ue.getTweensOf(e,t)},getProperty:function(e,t,s,i){tt(e)&&(e=Ft(e)[0]);var r=gn(e||{}).get,o=s?_d:md;return s==="native"&&(s=""),e&&(t?o((St[t]&&St[t].get||r)(e,t,s,i)):function(a,c,l){return o((St[a]&&St[a].get||r)(e,a,c,l))})},quickSetter:function(e,t,s){if(e=Ft(e),e.length>1){var i=e.map(function(u){return kt.quickSetter(u,t,s)}),r=i.length;return function(u){for(var h=r;h--;)i[h](u)}}e=e[0]||{};var o=St[t],a=gn(e),c=a.harness&&(a.harness.aliases||{})[t]||t,l=o?function(u){var h=new o;Yn._pt=0,h.init(e,s?u+s:u,Yn,0,[e]),h.render(1,h),Yn._pt&&tl(1,Yn)}:a.set(e,c);return o?l:function(u){return l(e,c,s?u+s:u,a,1)}},quickTo:function(e,t,s){var i,r=kt.to(e,Cn((i={},i[t]="+=0.1",i.paused=!0,i),s||{})),o=function(c,l,u){return r.resetTo(t,c,l,u)};return o.tween=r,o},isTweening:function(e){return Ue.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=yn(e.ease,ci.ease)),iu(ci,e||{})},config:function(e){return iu(Ot,e||{})},registerEffect:function(e){var t=e.name,s=e.effect,i=e.plugins,r=e.defaults,o=e.extendTimeline;(i||"").split(",").forEach(function(a){return a&&!St[a]&&!Mt[a]&&hr(t+" effect requires "+a+" plugin.")}),ka[t]=function(a,c,l){return s(Ft(a),Lt(c||{},r),l)},o&&(lt.prototype[t]=function(a,c,l){return this.add(ka[t](a,os(c)?c:(l=c)&&{},this),l)})},registerEase:function(e,t){_e[e]=yn(t)},parseEase:function(e,t){return arguments.length?yn(e,t):_e},getById:function(e){return Ue.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var s=new lt(e),i,r;for(s.smoothChildTiming=gt(e.smoothChildTiming),Ue.remove(s),s._dp=0,s._time=s._tTime=Ue._time,i=Ue._first;i;)r=i._next,(t||!(!i._dur&&i instanceof $e&&i.vars.onComplete===i._targets[0]))&&ts(s,i,i._start-i._delay),i=r;return ts(Ue,s,0),s},context:function(e,t){return e?new qd(e,t):Ve},matchMedia:function(e){return new ZT(e)},matchMediaRefresh:function(){return xn.forEach(function(e){var t=e.conditions,s,i;for(i in t)t[i]&&(t[i]=!1,s=1);s&&e.revert()})||tc()},addEventListener:function(e,t){var s=io[e]||(io[e]=[]);~s.indexOf(t)||s.push(t)},removeEventListener:function(e,t){var s=io[e],i=s&&s.indexOf(t);i>=0&&s.splice(i,1)},utils:{wrap:CT,wrapYoyo:ET,distribute:wd,random:bd,snap:Sd,normalize:bT,getUnit:nt,clamp:TT,splitColor:Md,toArray:Ft,selector:Ka,mapRange:Ed,pipe:wT,unitize:ST,interpolate:OT,shuffle:kd},install:ud,effects:ka,ticker:bt,updateRoot:lt.updateRoot,plugins:St,globalTimeline:Ue,core:{PropTween:yt,globals:hd,Tween:$e,Timeline:lt,Animation:mr,getCache:gn,_removeLinkedListItem:sa,reverting:function(){return it},context:function(e){return e&&Ve&&(Ve.data.push(e),e._ctx=Ve),Ve},suppressOverwrites:function(e){return Hc=e}}};vt("to,from,fromTo,delayedCall,set,killTweensOf",function(n){return Ro[n]=$e[n]});bt.add(lt.updateRoot);Yn=Ro.to({},{duration:0});var $T=function(e,t){for(var s=e._pt;s&&s.p!==t&&s.op!==t&&s.fp!==t;)s=s._next;return s},XT=function(e,t){var s=e._targets,i,r,o;for(i in t)for(r=s.length;r--;)o=e._ptLookup[r][i],o&&(o=o.d)&&(o._pt&&(o=$T(o,i)),o&&o.modifier&&o.modifier(t[i],e,s[r],i))},Ea=function(e,t){return{name:e,rawVars:1,init:function(i,r,o){o._onInit=function(a){var c,l;if(tt(r)&&(c={},vt(r,function(u){return c[u]=1}),r=c),t){c={};for(l in r)c[l]=t(r[l]);r=c}XT(a,r)}}}},kt=Ro.registerPlugin({name:"attr",init:function(e,t,s,i,r){var o,a,c;this.tween=s;for(o in t)c=e.getAttribute(o)||"",a=this.add(e,"setAttribute",(c||0)+"",t[o],i,r,0,0,o),a.op=o,a.b=c,this._props.push(o)},render:function(e,t){for(var s=t._pt;s;)it?s.set(s.t,s.p,s.b,s):s.r(e,s.d),s=s._next}},{name:"endArray",init:function(e,t){for(var s=t.length;s--;)this.add(e,s,e[s]||0,t[s],0,0,0,0,0,1)}},Ea("roundProps",Ja),Ea("modifiers"),Ea("snap",Sd))||Ro;$e.version=lt.version=kt.version="3.12.4";ld=1;Gc()&&hi();_e.Power0;_e.Power1;_e.Power2;_e.Power3;_e.Power4;_e.Linear;_e.Quad;_e.Cubic;_e.Quart;_e.Quint;_e.Strong;_e.Elastic;_e.Back;_e.SteppedEase;_e.Bounce;_e.Sine;_e.Expo;_e.Circ;/*!
 * CSSPlugin 3.12.4
 * https://gsap.com
 *
 * Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var uu,zs,Qn,sl,fn,hu,nl,QT=function(){return typeof window<"u"},Es={},ln=180/Math.PI,Kn=Math.PI/180,Vn=Math.atan2,du=1e8,il=/([A-Z])/g,KT=/(left|right|width|margin|padding|x)/i,JT=/[\s,\(]\S/,ss={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},sc=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},ek=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},tk=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},sk=function(e,t){var s=t.s+t.c*e;t.set(t.t,t.p,~~(s+(s<0?-.5:.5))+t.u,t)},Gd=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},Wd=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},nk=function(e,t,s){return e.style[t]=s},ik=function(e,t,s){return e.style.setProperty(t,s)},rk=function(e,t,s){return e._gsap[t]=s},ok=function(e,t,s){return e._gsap.scaleX=e._gsap.scaleY=s},ak=function(e,t,s,i,r){var o=e._gsap;o.scaleX=o.scaleY=s,o.renderTransform(r,o)},ck=function(e,t,s,i,r){var o=e._gsap;o[t]=s,o.renderTransform(r,o)},Le="transform",xt=Le+"Origin",lk=function n(e,t){var s=this,i=this.target,r=i.style,o=i._gsap;if(e in Es&&r){if(this.tfm=this.tfm||{},e!=="transform")e=ss[e]||e,~e.indexOf(",")?e.split(",").forEach(function(a){return s.tfm[a]=vs(i,a)}):this.tfm[e]=o.x?o[e]:vs(i,e),e===xt&&(this.tfm.zOrigin=o.zOrigin);else return ss.transform.split(",").forEach(function(a){return n.call(s,a,t)});if(this.props.indexOf(Le)>=0)return;o.svg&&(this.svgo=i.getAttribute("data-svg-origin"),this.props.push(xt,t,"")),e=Le}(r||t)&&this.props.push(e,t,r[e])},Yd=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},uk=function(){var e=this.props,t=this.target,s=t.style,i=t._gsap,r,o;for(r=0;r<e.length;r+=3)e[r+1]?t[e[r]]=e[r+2]:e[r+2]?s[e[r]]=e[r+2]:s.removeProperty(e[r].substr(0,2)==="--"?e[r]:e[r].replace(il,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)i[o]=this.tfm[o];i.svg&&(i.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),r=nl(),(!r||!r.isStart)&&!s[Le]&&(Yd(s),i.zOrigin&&s[xt]&&(s[xt]+=" "+i.zOrigin+"px",i.zOrigin=0,i.renderTransform()),i.uncache=1)}},Zd=function(e,t){var s={target:e,props:[],revert:uk,save:lk};return e._gsap||kt.core.getCache(e),t&&t.split(",").forEach(function(i){return s.save(i)}),s},$d,nc=function(e,t){var s=zs.createElementNS?zs.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):zs.createElement(e);return s&&s.style?s:zs.createElement(e)},is=function n(e,t,s){var i=getComputedStyle(e);return i[t]||i.getPropertyValue(t.replace(il,"-$1").toLowerCase())||i.getPropertyValue(t)||!s&&n(e,di(t)||t,1)||""},fu="O,Moz,ms,Ms,Webkit".split(","),di=function(e,t,s){var i=t||fn,r=i.style,o=5;if(e in r&&!s)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);o--&&!(fu[o]+e in r););return o<0?null:(o===3?"ms":o>=0?fu[o]:"")+e},ic=function(){QT()&&window.document&&(uu=window,zs=uu.document,Qn=zs.documentElement,fn=nc("div")||{style:{}},nc("div"),Le=di(Le),xt=Le+"Origin",fn.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",$d=!!di("perspective"),nl=kt.core.reverting,sl=1)},Oa=function n(e){var t=nc("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),s=this.parentNode,i=this.nextSibling,r=this.style.cssText,o;if(Qn.appendChild(t),t.appendChild(this),this.style.display="block",e)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=n}catch{}else this._gsapBBox&&(o=this._gsapBBox());return s&&(i?s.insertBefore(this,i):s.appendChild(this)),Qn.removeChild(t),this.style.cssText=r,o},pu=function(e,t){for(var s=t.length;s--;)if(e.hasAttribute(t[s]))return e.getAttribute(t[s])},Xd=function(e){var t;try{t=e.getBBox()}catch{t=Oa.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===Oa||(t=Oa.call(e,!0)),t&&!t.width&&!t.x&&!t.y?{x:+pu(e,["x","cx","x1"])||0,y:+pu(e,["y","cy","y1"])||0,width:0,height:0}:t},Qd=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&Xd(e))},En=function(e,t){if(t){var s=e.style,i;t in Es&&t!==xt&&(t=Le),s.removeProperty?(i=t.substr(0,2),(i==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),s.removeProperty(i==="--"?t:t.replace(il,"-$1").toLowerCase())):s.removeAttribute(t)}},Vs=function(e,t,s,i,r,o){var a=new yt(e._pt,t,s,0,1,o?Wd:Gd);return e._pt=a,a.b=i,a.e=r,e._props.push(s),a},mu={deg:1,rad:1,turn:1},hk={grid:1,flex:1},Js=function n(e,t,s,i){var r=parseFloat(s)||0,o=(s+"").trim().substr((r+"").length)||"px",a=fn.style,c=KT.test(t),l=e.tagName.toLowerCase()==="svg",u=(l?"client":"offset")+(c?"Width":"Height"),h=100,d=i==="px",f=i==="%",m,p,_,y;if(i===o||!r||mu[i]||mu[o])return r;if(o!=="px"&&!d&&(r=n(e,t,s,"px")),y=e.getCTM&&Qd(e),(f||o==="%")&&(Es[t]||~t.indexOf("adius")))return m=y?e.getBBox()[c?"width":"height"]:e[u],qe(f?r/m*h:r/100*m);if(a[c?"width":"height"]=h+(d?o:i),p=~t.indexOf("adius")||i==="em"&&e.appendChild&&!l?e:e.parentNode,y&&(p=(e.ownerSVGElement||{}).parentNode),(!p||p===zs||!p.appendChild)&&(p=zs.body),_=p._gsap,_&&f&&_.width&&c&&_.time===bt.time&&!_.uncache)return qe(r/_.width*h);if(f&&(t==="height"||t==="width")){var k=e.style[t];e.style[t]=h+i,m=e[u],k?e.style[t]=k:En(e,t)}else(f||o==="%")&&!hk[is(p,"display")]&&(a.position=is(e,"position")),p===e&&(a.position="static"),p.appendChild(fn),m=fn[u],p.removeChild(fn),a.position="absolute";return c&&f&&(_=gn(p),_.time=bt.time,_.width=p[u]),qe(d?m*r/h:m&&r?h/m*r:0)},vs=function(e,t,s,i){var r;return sl||ic(),t in ss&&t!=="transform"&&(t=ss[t],~t.indexOf(",")&&(t=t.split(",")[0])),Es[t]&&t!=="transform"?(r=gr(e,i),r=t!=="transformOrigin"?r[t]:r.svg?r.origin:No(is(e,xt))+" "+r.zOrigin+"px"):(r=e.style[t],(!r||r==="auto"||i||~(r+"").indexOf("calc("))&&(r=Io[t]&&Io[t](e,t,s)||is(e,t)||fd(e,t)||(t==="opacity"?1:0))),s&&!~(r+"").trim().indexOf(" ")?Js(e,t,r,s)+s:r},dk=function(e,t,s,i){if(!s||s==="none"){var r=di(t,e,1),o=r&&is(e,r,1);o&&o!==s?(t=r,s=o):t==="borderColor"&&(s=is(e,"borderTopColor"))}var a=new yt(this._pt,e.style,t,0,1,jd),c=0,l=0,u,h,d,f,m,p,_,y,k,w,v,g;if(a.b=s,a.e=i,s+="",i+="",i==="auto"&&(p=e.style[t],e.style[t]=i,i=is(e,t)||i,p?e.style[t]=p:En(e,t)),u=[s,i],Dd(u),s=u[0],i=u[1],d=s.match(Wn)||[],g=i.match(Wn)||[],g.length){for(;h=Wn.exec(i);)_=h[0],k=i.substring(c,h.index),m?m=(m+1)%5:(k.substr(-5)==="rgba("||k.substr(-5)==="hsla(")&&(m=1),_!==(p=d[l++]||"")&&(f=parseFloat(p)||0,v=p.substr((f+"").length),_.charAt(1)==="="&&(_=Xn(f,_)+v),y=parseFloat(_),w=_.substr((y+"").length),c=Wn.lastIndex-w.length,w||(w=w||Ot.units[t]||v,c===i.length&&(i+=w,a.e+=w)),v!==w&&(f=Js(e,t,p,w)||0),a._pt={_next:a._pt,p:k||l===1?k:",",s:f,c:y-f,m:m&&m<4||t==="zIndex"?Math.round:0});a.c=c<i.length?i.substring(c,i.length):""}else a.r=t==="display"&&i==="none"?Wd:Gd;return ad.test(i)&&(a.e=0),this._pt=a,a},_u={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},fk=function(e){var t=e.split(" "),s=t[0],i=t[1]||"50%";return(s==="top"||s==="bottom"||i==="left"||i==="right")&&(e=s,s=i,i=e),t[0]=_u[s]||s,t[1]=_u[i]||i,t.join(" ")},pk=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var s=t.t,i=s.style,r=t.u,o=s._gsap,a,c,l;if(r==="all"||r===!0)i.cssText="",c=1;else for(r=r.split(","),l=r.length;--l>-1;)a=r[l],Es[a]&&(c=1,a=a==="transformOrigin"?xt:Le),En(s,a);c&&(En(s,Le),o&&(o.svg&&s.removeAttribute("transform"),gr(s,1),o.uncache=1,Yd(i)))}},Io={clearProps:function(e,t,s,i,r){if(r.data!=="isFromStart"){var o=e._pt=new yt(e._pt,t,s,0,0,pk);return o.u=i,o.pr=-10,o.tween=r,e._props.push(s),1}}},_r=[1,0,0,1,0,0],Kd={},Jd=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},gu=function(e){var t=is(e,Le);return Jd(t)?_r:t.substr(7).match(od).map(qe)},rl=function(e,t){var s=e._gsap||gn(e),i=e.style,r=gu(e),o,a,c,l;return s.svg&&e.getAttribute("transform")?(c=e.transform.baseVal.consolidate().matrix,r=[c.a,c.b,c.c,c.d,c.e,c.f],r.join(",")==="1,0,0,1,0,0"?_r:r):(r===_r&&!e.offsetParent&&e!==Qn&&!s.svg&&(c=i.display,i.display="block",o=e.parentNode,(!o||!e.offsetParent)&&(l=1,a=e.nextElementSibling,Qn.appendChild(e)),r=gu(e),c?i.display=c:En(e,"display"),l&&(a?o.insertBefore(e,a):o?o.appendChild(e):Qn.removeChild(e))),t&&r.length>6?[r[0],r[1],r[4],r[5],r[12],r[13]]:r)},rc=function(e,t,s,i,r,o){var a=e._gsap,c=r||rl(e,!0),l=a.xOrigin||0,u=a.yOrigin||0,h=a.xOffset||0,d=a.yOffset||0,f=c[0],m=c[1],p=c[2],_=c[3],y=c[4],k=c[5],w=t.split(" "),v=parseFloat(w[0])||0,g=parseFloat(w[1])||0,S,T,x,b;s?c!==_r&&(T=f*_-m*p)&&(x=v*(_/T)+g*(-p/T)+(p*k-_*y)/T,b=v*(-m/T)+g*(f/T)-(f*k-m*y)/T,v=x,g=b):(S=Xd(e),v=S.x+(~w[0].indexOf("%")?v/100*S.width:v),g=S.y+(~(w[1]||w[0]).indexOf("%")?g/100*S.height:g)),i||i!==!1&&a.smooth?(y=v-l,k=g-u,a.xOffset=h+(y*f+k*p)-y,a.yOffset=d+(y*m+k*_)-k):a.xOffset=a.yOffset=0,a.xOrigin=v,a.yOrigin=g,a.smooth=!!i,a.origin=t,a.originIsAbsolute=!!s,e.style[xt]="0px 0px",o&&(Vs(o,a,"xOrigin",l,v),Vs(o,a,"yOrigin",u,g),Vs(o,a,"xOffset",h,a.xOffset),Vs(o,a,"yOffset",d,a.yOffset)),e.setAttribute("data-svg-origin",v+" "+g)},gr=function(e,t){var s=e._gsap||new Fd(e);if("x"in s&&!t&&!s.uncache)return s;var i=e.style,r=s.scaleX<0,o="px",a="deg",c=getComputedStyle(e),l=is(e,xt)||"0",u,h,d,f,m,p,_,y,k,w,v,g,S,T,x,b,A,R,M,L,q,Y,W,V,z,$,Q,te,N,F,C,P;return u=h=d=p=_=y=k=w=v=0,f=m=1,s.svg=!!(e.getCTM&&Qd(e)),c.translate&&((c.translate!=="none"||c.scale!=="none"||c.rotate!=="none")&&(i[Le]=(c.translate!=="none"?"translate3d("+(c.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(c.rotate!=="none"?"rotate("+c.rotate+") ":"")+(c.scale!=="none"?"scale("+c.scale.split(" ").join(",")+") ":"")+(c[Le]!=="none"?c[Le]:"")),i.scale=i.rotate=i.translate="none"),T=rl(e,s.svg),s.svg&&(s.uncache?(z=e.getBBox(),l=s.xOrigin-z.x+"px "+(s.yOrigin-z.y)+"px",V=""):V=!t&&e.getAttribute("data-svg-origin"),rc(e,V||l,!!V||s.originIsAbsolute,s.smooth!==!1,T)),g=s.xOrigin||0,S=s.yOrigin||0,T!==_r&&(R=T[0],M=T[1],L=T[2],q=T[3],u=Y=T[4],h=W=T[5],T.length===6?(f=Math.sqrt(R*R+M*M),m=Math.sqrt(q*q+L*L),p=R||M?Vn(M,R)*ln:0,k=L||q?Vn(L,q)*ln+p:0,k&&(m*=Math.abs(Math.cos(k*Kn))),s.svg&&(u-=g-(g*R+S*L),h-=S-(g*M+S*q))):(P=T[6],F=T[7],Q=T[8],te=T[9],N=T[10],C=T[11],u=T[12],h=T[13],d=T[14],x=Vn(P,N),_=x*ln,x&&(b=Math.cos(-x),A=Math.sin(-x),V=Y*b+Q*A,z=W*b+te*A,$=P*b+N*A,Q=Y*-A+Q*b,te=W*-A+te*b,N=P*-A+N*b,C=F*-A+C*b,Y=V,W=z,P=$),x=Vn(-L,N),y=x*ln,x&&(b=Math.cos(-x),A=Math.sin(-x),V=R*b-Q*A,z=M*b-te*A,$=L*b-N*A,C=q*A+C*b,R=V,M=z,L=$),x=Vn(M,R),p=x*ln,x&&(b=Math.cos(x),A=Math.sin(x),V=R*b+M*A,z=Y*b+W*A,M=M*b-R*A,W=W*b-Y*A,R=V,Y=z),_&&Math.abs(_)+Math.abs(p)>359.9&&(_=p=0,y=180-y),f=qe(Math.sqrt(R*R+M*M+L*L)),m=qe(Math.sqrt(W*W+P*P)),x=Vn(Y,W),k=Math.abs(x)>2e-4?x*ln:0,v=C?1/(C<0?-C:C):0),s.svg&&(V=e.getAttribute("transform"),s.forceCSS=e.setAttribute("transform","")||!Jd(is(e,Le)),V&&e.setAttribute("transform",V))),Math.abs(k)>90&&Math.abs(k)<270&&(r?(f*=-1,k+=p<=0?180:-180,p+=p<=0?180:-180):(m*=-1,k+=k<=0?180:-180)),t=t||s.uncache,s.x=u-((s.xPercent=u&&(!t&&s.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-u)?-50:0)))?e.offsetWidth*s.xPercent/100:0)+o,s.y=h-((s.yPercent=h&&(!t&&s.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-h)?-50:0)))?e.offsetHeight*s.yPercent/100:0)+o,s.z=d+o,s.scaleX=qe(f),s.scaleY=qe(m),s.rotation=qe(p)+a,s.rotationX=qe(_)+a,s.rotationY=qe(y)+a,s.skewX=k+a,s.skewY=w+a,s.transformPerspective=v+o,(s.zOrigin=parseFloat(l.split(" ")[2])||!t&&s.zOrigin||0)&&(i[xt]=No(l)),s.xOffset=s.yOffset=0,s.force3D=Ot.force3D,s.renderTransform=s.svg?_k:$d?ef:mk,s.uncache=0,s},No=function(e){return(e=e.split(" "))[0]+" "+e[1]},Aa=function(e,t,s){var i=nt(t);return qe(parseFloat(t)+parseFloat(Js(e,"x",s+"px",i)))+i},mk=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,ef(e,t)},an="0deg",Ni="0px",cn=") ",ef=function(e,t){var s=t||this,i=s.xPercent,r=s.yPercent,o=s.x,a=s.y,c=s.z,l=s.rotation,u=s.rotationY,h=s.rotationX,d=s.skewX,f=s.skewY,m=s.scaleX,p=s.scaleY,_=s.transformPerspective,y=s.force3D,k=s.target,w=s.zOrigin,v="",g=y==="auto"&&e&&e!==1||y===!0;if(w&&(h!==an||u!==an)){var S=parseFloat(u)*Kn,T=Math.sin(S),x=Math.cos(S),b;S=parseFloat(h)*Kn,b=Math.cos(S),o=Aa(k,o,T*b*-w),a=Aa(k,a,-Math.sin(S)*-w),c=Aa(k,c,x*b*-w+w)}_!==Ni&&(v+="perspective("+_+cn),(i||r)&&(v+="translate("+i+"%, "+r+"%) "),(g||o!==Ni||a!==Ni||c!==Ni)&&(v+=c!==Ni||g?"translate3d("+o+", "+a+", "+c+") ":"translate("+o+", "+a+cn),l!==an&&(v+="rotate("+l+cn),u!==an&&(v+="rotateY("+u+cn),h!==an&&(v+="rotateX("+h+cn),(d!==an||f!==an)&&(v+="skew("+d+", "+f+cn),(m!==1||p!==1)&&(v+="scale("+m+", "+p+cn),k.style[Le]=v||"translate(0, 0)"},_k=function(e,t){var s=t||this,i=s.xPercent,r=s.yPercent,o=s.x,a=s.y,c=s.rotation,l=s.skewX,u=s.skewY,h=s.scaleX,d=s.scaleY,f=s.target,m=s.xOrigin,p=s.yOrigin,_=s.xOffset,y=s.yOffset,k=s.forceCSS,w=parseFloat(o),v=parseFloat(a),g,S,T,x,b;c=parseFloat(c),l=parseFloat(l),u=parseFloat(u),u&&(u=parseFloat(u),l+=u,c+=u),c||l?(c*=Kn,l*=Kn,g=Math.cos(c)*h,S=Math.sin(c)*h,T=Math.sin(c-l)*-d,x=Math.cos(c-l)*d,l&&(u*=Kn,b=Math.tan(l-u),b=Math.sqrt(1+b*b),T*=b,x*=b,u&&(b=Math.tan(u),b=Math.sqrt(1+b*b),g*=b,S*=b)),g=qe(g),S=qe(S),T=qe(T),x=qe(x)):(g=h,x=d,S=T=0),(w&&!~(o+"").indexOf("px")||v&&!~(a+"").indexOf("px"))&&(w=Js(f,"x",o,"px"),v=Js(f,"y",a,"px")),(m||p||_||y)&&(w=qe(w+m-(m*g+p*T)+_),v=qe(v+p-(m*S+p*x)+y)),(i||r)&&(b=f.getBBox(),w=qe(w+i/100*b.width),v=qe(v+r/100*b.height)),b="matrix("+g+","+S+","+T+","+x+","+w+","+v+")",f.setAttribute("transform",b),k&&(f.style[Le]=b)},gk=function(e,t,s,i,r){var o=360,a=tt(r),c=parseFloat(r)*(a&&~r.indexOf("rad")?ln:1),l=c-i,u=i+l+"deg",h,d;return a&&(h=r.split("_")[1],h==="short"&&(l%=o,l!==l%(o/2)&&(l+=l<0?o:-o)),h==="cw"&&l<0?l=(l+o*du)%o-~~(l/o)*o:h==="ccw"&&l>0&&(l=(l-o*du)%o-~~(l/o)*o)),e._pt=d=new yt(e._pt,t,s,i,l,ek),d.e=u,d.u="deg",e._props.push(s),d},vu=function(e,t){for(var s in t)e[s]=t[s];return e},vk=function(e,t,s){var i=vu({},s._gsap),r="perspective,force3D,transformOrigin,svgOrigin",o=s.style,a,c,l,u,h,d,f,m;i.svg?(l=s.getAttribute("transform"),s.setAttribute("transform",""),o[Le]=t,a=gr(s,1),En(s,Le),s.setAttribute("transform",l)):(l=getComputedStyle(s)[Le],o[Le]=t,a=gr(s,1),o[Le]=l);for(c in Es)l=i[c],u=a[c],l!==u&&r.indexOf(c)<0&&(f=nt(l),m=nt(u),h=f!==m?Js(s,c,l,m):parseFloat(l),d=parseFloat(u),e._pt=new yt(e._pt,a,c,h,d-h,sc),e._pt.u=m||0,e._props.push(c));vu(a,i)};vt("padding,margin,Width,Radius",function(n,e){var t="Top",s="Right",i="Bottom",r="Left",o=(e<3?[t,s,i,r]:[t+r,t+s,i+s,i+r]).map(function(a){return e<2?n+a:"border"+a+n});Io[e>1?"border"+n:n]=function(a,c,l,u,h){var d,f;if(arguments.length<4)return d=o.map(function(m){return vs(a,m,l)}),f=d.join(" "),f.split(d[0]).length===5?d[0]:f;d=(u+"").split(" "),f={},o.forEach(function(m,p){return f[m]=d[p]=d[p]||d[(p-1)/2|0]}),a.init(c,f,h)}});var tf={name:"css",register:ic,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,s,i,r){var o=this._props,a=e.style,c=s.vars.startAt,l,u,h,d,f,m,p,_,y,k,w,v,g,S,T,x;sl||ic(),this.styles=this.styles||Zd(e),x=this.styles.props,this.tween=s;for(p in t)if(p!=="autoRound"&&(u=t[p],!(St[p]&&Ud(p,t,s,i,e,r)))){if(f=typeof u,m=Io[p],f==="function"&&(u=u.call(s,i,e,r),f=typeof u),f==="string"&&~u.indexOf("random(")&&(u=fr(u)),m)m(this,e,p,u,s)&&(T=1);else if(p.substr(0,2)==="--")l=(getComputedStyle(e).getPropertyValue(p)+"").trim(),u+="",Ws.lastIndex=0,Ws.test(l)||(_=nt(l),y=nt(u)),y?_!==y&&(l=Js(e,p,l,y)+y):_&&(u+=_),this.add(a,"setProperty",l,u,i,r,0,0,p),o.push(p),x.push(p,0,a[p]);else if(f!=="undefined"){if(c&&p in c?(l=typeof c[p]=="function"?c[p].call(s,i,e,r):c[p],tt(l)&&~l.indexOf("random(")&&(l=fr(l)),nt(l+"")||l==="auto"||(l+=Ot.units[p]||nt(vs(e,p))||""),(l+"").charAt(1)==="="&&(l=vs(e,p))):l=vs(e,p),d=parseFloat(l),k=f==="string"&&u.charAt(1)==="="&&u.substr(0,2),k&&(u=u.substr(2)),h=parseFloat(u),p in ss&&(p==="autoAlpha"&&(d===1&&vs(e,"visibility")==="hidden"&&h&&(d=0),x.push("visibility",0,a.visibility),Vs(this,a,"visibility",d?"inherit":"hidden",h?"inherit":"hidden",!h)),p!=="scale"&&p!=="transform"&&(p=ss[p],~p.indexOf(",")&&(p=p.split(",")[0]))),w=p in Es,w){if(this.styles.save(p),v||(g=e._gsap,g.renderTransform&&!t.parseTransform||gr(e,t.parseTransform),S=t.smoothOrigin!==!1&&g.smooth,v=this._pt=new yt(this._pt,a,Le,0,1,g.renderTransform,g,0,-1),v.dep=1),p==="scale")this._pt=new yt(this._pt,g,"scaleY",g.scaleY,(k?Xn(g.scaleY,k+h):h)-g.scaleY||0,sc),this._pt.u=0,o.push("scaleY",p),p+="X";else if(p==="transformOrigin"){x.push(xt,0,a[xt]),u=fk(u),g.svg?rc(e,u,0,S,0,this):(y=parseFloat(u.split(" ")[2])||0,y!==g.zOrigin&&Vs(this,g,"zOrigin",g.zOrigin,y),Vs(this,a,p,No(l),No(u)));continue}else if(p==="svgOrigin"){rc(e,u,1,S,0,this);continue}else if(p in Kd){gk(this,g,p,d,k?Xn(d,k+u):u);continue}else if(p==="smoothOrigin"){Vs(this,g,"smooth",g.smooth,u);continue}else if(p==="force3D"){g[p]=u;continue}else if(p==="transform"){vk(this,u,e);continue}}else p in a||(p=di(p)||p);if(w||(h||h===0)&&(d||d===0)&&!JT.test(u)&&p in a)_=(l+"").substr((d+"").length),h||(h=0),y=nt(u)||(p in Ot.units?Ot.units[p]:_),_!==y&&(d=Js(e,p,l,y)),this._pt=new yt(this._pt,w?g:a,p,d,(k?Xn(d,k+h):h)-d,!w&&(y==="px"||p==="zIndex")&&t.autoRound!==!1?sk:sc),this._pt.u=y||0,_!==y&&y!=="%"&&(this._pt.b=l,this._pt.r=tk);else if(p in a)dk.call(this,e,p,l,k?k+u:u);else if(p in e)this.add(e,p,l||e[p],k?k+u:u,i,r);else if(p!=="parseTransform"){Yc(p,u);continue}w||(p in a?x.push(p,0,a[p]):x.push(p,1,l||e[p])),o.push(p)}}T&&Hd(this)},render:function(e,t){if(t.tween._time||!nl())for(var s=t._pt;s;)s.r(e,s.d),s=s._next;else t.styles.revert()},get:vs,aliases:ss,getSetter:function(e,t,s){var i=ss[t];return i&&i.indexOf(",")<0&&(t=i),t in Es&&t!==xt&&(e._gsap.x||vs(e,"x"))?s&&hu===s?t==="scale"?ok:rk:(hu=s||{})&&(t==="scale"?ak:ck):e.style&&!qc(e.style[t])?nk:~t.indexOf("-")?ik:el(e,t)},core:{_removeProperty:En,_getMatrix:rl}};kt.utils.checkPrefix=di;kt.core.getStyleSaver=Zd;(function(n,e,t,s){var i=vt(n+","+e+","+t,function(r){Es[r]=1});vt(e,function(r){Ot.units[r]="deg",Kd[r]=1}),ss[i[13]]=n+","+e,vt(s,function(r){var o=r.split(":");ss[o[1]]=i[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");vt("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(n){Ot.units[n]="px"});kt.registerPlugin(tf);var sf=kt.registerPlugin(tf)||kt;sf.core.Tween;const nf=D.forwardRef(({source:n,target:e,isSelected:t,lineWidth:s,visible:i},r)=>(D.useEffect(()=>{const o=r.current;o&&sf.fromTo(o.material,{linewidth:5},{linewidth:t?2:s,duration:1})},[t,s,r]),U.jsx(Ff,{ref:r,color:"rgba(136, 136, 136, 1)",isLine2:!0,lineWidth:1,opacity:1,points:[n,e],transparent:!0,visible:i})));nf.displayName="LineComponent";const rf=D.memo(({linksPositions:n})=>{const e=On(r=>r.dataInitial),{showSelectionGraph:t}=ht(r=>r),s=as(),i=D.useRef([]);return U.jsx("group",{name:"simulation-3d-group__connections",children:e==null?void 0:e.links.map((r,o)=>{var h,d,f,m,p,_;const a=new le(((h=n[o])==null?void 0:h.sx)||0,((d=n[o])==null?void 0:d.sy)||0,((f=n[o])==null?void 0:f.sz)||0),c=new le(((m=n[o])==null?void 0:m.tx)||0,((p=n[o])==null?void 0:p.ty)||0,((_=n[o])==null?void 0:_.tz)||0),l=(s==null?void 0:s.ref_id)===r.source||(s==null?void 0:s.ref_id)===r.target,u=s?0:.5;return U.jsx(nf,{ref:y=>{i.current[o]=y},isSelected:l,lineWidth:u,source:a,target:c,visible:!t},r.ref_id)})})});rf.displayName="Connections";const Dr={metalness:.9,roughness:0},yk={...Dr};new xr(yk);const of=new Bo,Fo=of.load("noimage.jpeg"),yu=new xr({...Dr,map:Fo}),af=.4,xk=new xr({...Dr,map:Fo,transparent:!0,opacity:af}),Kr={},Tk=(n,e)=>{const[t,s]=D.useState(Fo),[i,r]=D.useState(yu);return D.useEffect(()=>{const o=`${n}${e&&"-transparent"}`;if(Kr[o]){s(Kr[o].texture),r(Kr[o].material);return}of.load(n,a=>{const c=new xr({map:a,transparent:e,opacity:e?af:1,...Dr});Kr[o]={texture:a,material:c},s(a),r(c)},void 0,()=>{s(Fo),r(e?xk:yu)})},[n,e]),D.useEffect(()=>function(){t.dispose(),i.dispose()},[t,i]),i},ol=D.memo(({node:n,hide:e,animated:t})=>{const s=D.useRef(null),[i]=D.useState(su),r=as(),{showSelectionGraph:o}=ht(u=>u),a=!!r&&n.ref_id===r.ref_id,c=Tk(n.image_url||"noimage.jpeg",!1);Bt((u,h)=>{t&&s.current&&a&&(s.current.rotation.y+=h*1,s.current.rotation.x-=h*.6)}),D.useEffect(()=>function(){i.dispose()},[i]);const l=D.useMemo(()=>o&&a?20:a?(n.scale||1)*1.2:n.scale,[n,a,o]);return U.jsx(Lu,{enabled:!!a,children:U.jsx("mesh",{ref:s,geometry:su,material:c,name:n.id,scale:l,userData:n,visible:!e})})});ol.displayName="Cube";const kk=Ye(Os)`
  text-align: center;
  width: ${n=>n.type==="topic"?"auto":`${n.size}px`};
  height: ${n=>n.type==="topic"?"auto":`${n.size}px`};
  outline: 1px solid ${n=>Oe.white||n.color};
  outline-offset: 0px;
  background: rgba(0, 0, 0, 0.75);
  color: ${n=>n.fontColor};
  border-radius: ${n=>`${n.type==="guest"?"100%":"6px"}`};
  font-size: ${n=>`${n.fontSize}px`};
  cursor: pointer;
  transition: font-size 0.4s, outline 0.4s;
  transform: scale(${n=>n.scale});
  align-items: center;
  justify-content: center;
  font-family: Barlow;
  font-size: 26px;
  font-style: normal;
  font-weight: 700;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);

  &:hover {
    outline-offset: 4px;
  }

  &.selected {
    .badge-wrapper {
      top: 0;
    }

    font-size: 36px;

    &:hover {
      outline-offset: 0px;
    }
  }

  &.topic {
    outline: none;
    background: none;
    &:hover {
      font-size: 36px;
    }
    white-space: nowrap;
    .badge-wrapper {
      display: none;
    }
  }

  .badge-wrapper {
    position: absolute;
    top: -7px;
    left: -14px;
  }
`,wk=Ye(Os)`
  text-align: center;
  outline: 1px solid ${Oe.white};
  outline-offset: 0px;
  white-space: nowrap;
  padding: 4px;
  background: rgba(0, 0, 0, 0.75);
  color: ${Oe.white};
  border-radius: 6px;
  font-size: 20px;
  cursor: pointer;
  transition: font-size 0.4s, outline 0.4s;
  align-items: center;
  justify-content: flex-start;
  font-family: Barlow;
  font-size: 26px;
  font-style: normal;
  font-weight: 700;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
  max-width: auto;
  max-height: 100px;
  white-space: normal;
  font-size: 16px;

  &:hover {
    outline-offset: 4px;
  }

  &.selected {
    .badge-wrapper {
      top: 0;
    }

    font-size: 36px;

    &:hover {
      outline-offset: 0px;
    }
  }

  &.topic {
    outline: none;
    background: none;
    &:hover {
      font-size: 36px;
    }
    white-space: nowrap;
    .badge-wrapper {
      display: none;
    }
  }

  .badge-wrapper {
    position: absolute;
    top: -7px;
    left: -14px;
  }
`;Ye.img`
  background-image: ${({src:n})=>`url(${n})`};
  background-size: contain;
  background-repeat: no-repeat;
  width: ${n=>n.size}px;
  height: ${n=>n.size}px;
  border-radius: ${n=>n.borderRadius};
`;Ye.div`
  display: flex;
  position: absolute;
  bottom: -14px;
  left: -5px;
  width: auto;
  justify-content: center;
  align-items: center;
`;Ye.div`
  display: flex;
  justify-content: center;
  align-items: center;
  background: ${Oe.transparentBlack};
  border: 2px solid ${n=>n.color};
  color: #fff;
  padding: 0 4px;
  min-width: 30px;
  height: 26px;
  font-size: 12px;
  font-weight: 500;
  border-radius: 6px;
  margin-right: 5px;
`;Ye.div`
  display: flex;
  justify-content: center;
  align-items: center;
  border: 2px solid ${n=>n.color}44;
  background: ${Oe.transparentBlack};
  padding: 0 4px;
  color: ${n=>n.color};
  min-width: 30px;
  height: 26px;
  font-size: 12px;
  font-weight: 500;
  border-radius: 6px;
  margin-right: 5px;
`;const Sk=new le,bk=({position:n,userData:e,color:t})=>{const s=D.useRef(null),{selectedNode:i,setSelectedNode:r,showSelectionGraph:o,hoveredNode:a,setHoveredNode:c}=ht(lc(f=>f)),l=((e==null?void 0:e.node_type)||"")==="Topic"||!!e.name,u=((e==null?void 0:e.node_type)||"")==="Guest"||((e==null?void 0:e.node_type)||"")==="Person";Bt(()=>{if(o&&s.current){const f=Sk.set((e==null?void 0:e.x)||0,(e==null?void 0:e.y)||0,(e==null?void 0:e.z)||0);s.current.position.copy(f)}}),D.useEffect(()=>function(){s.current&&s.current.clear()},[s]);const h=D.useMemo(()=>(a==null?void 0:a.ref_id)===(e==null?void 0:e.ref_id),[a==null?void 0:a.ref_id,e==null?void 0:e.ref_id]),d=(i==null?void 0:i.ref_id)===(e==null?void 0:e.ref_id);return l||d&&o||!d?U.jsx("group",{ref:s,position:n,children:U.jsx(yr,{center:!0,sprite:!0,zIndexRange:[0,0],children:l?U.jsxs(wk,{direction:"column",onClick:f=>{f.stopPropagation(),e&&r(e)},onPointerOut:f=>{f.stopPropagation()},onPointerOver:f=>{f.stopPropagation()},children:[U.jsx("div",{className:"badge-wrapper",children:U.jsx(pl,{type:(e==null?void 0:e.node_type)||""})}),Cu(e==null?void 0:e.name,20)]}):U.jsxs(kk,{className:Su(e==null?void 0:e.node_type,{selected:d}),color:t,fontColor:Oe.white,fontSize:l?64:20,onClick:f=>{f.stopPropagation(),e&&r(e)},onPointerOut:f=>{f.stopPropagation()},onPointerOver:f=>{f.stopPropagation()},scale:h?1.05:1,selected:!1,size:d?68:40,type:(e==null?void 0:e.node_type)||"",children:[!u&&!l?U.jsx("div",{className:"badge-wrapper",children:U.jsx(pl,{type:(e==null?void 0:e.node_type)||""})}):null,e!=null&&e.name?e==null?void 0:e.name:U.jsx(pp,{rounded:u,size:d?60:52,src:(e==null?void 0:e.image_url)||"audio_default.svg",type:e==null?void 0:e.node_type})]})})}):null},cf=D.memo(()=>{const{simulation:n,showSelectionGraph:e,selectedNode:t,selectionGraphData:s}=ht(lc(o=>o)),i=Uo(),r=D.useMemo(()=>{const o=(n==null?void 0:n.nodes())||[];return(e?s.nodes:o).filter(u=>i.includes((u==null?void 0:u.ref_id)||"")||(t==null?void 0:t.ref_id)===(u==null?void 0:u.ref_id)).slice(0,Xx).map(u=>{const h=bu(u.node_type||"",!0),d=new le((u==null?void 0:u.x)||0,(u==null?void 0:u.y)||0,(u==null?void 0:u.z)||0),f=o.filter(m=>m.ref_id&&Qx(m,u)).map(m=>(m==null?void 0:m.ref_id)||"")||[];return U.jsx(bk,{color:h,position:d,relativeIds:f,userData:u},`node-badge-${u.ref_id}`)})},[n,e,s.nodes,i,t==null?void 0:t.ref_id]);return U.jsx(D.Fragment,{children:r.length?r:null},"node-badges")});cf.displayName="RelevanceBadges";const xu=mf().stop(),wt={numDimensions:3,velocityDecay:.9,forceChargeStrength:-20,forceChargeMinDistance:10,forceChargeMaxDistance:8e3,forceLinkStrength:.04,forceCenterStrength:.85,disableCollide:!1,disableCenter:!1,disableLink:!1,disableCharge:!1,forceCollideRadiusMethod:n=>(n.edge_count||1)*6+200,forceLinkDistanceMethod:n=>{const e=n.source.node_type;let t=50;switch(e){case"topic":t=30;break;case"guest":t=30;break;case"clip":t=10;break;case"episode":t=15;break}return t*2/50}},Ck=(n,e,{numDimensions:t=wt.numDimensions,velocityDecay:s=wt.velocityDecay,forceChargeStrength:i=wt.forceChargeStrength,forceChargeMinDistance:r=wt.forceChargeMinDistance,forceChargeMaxDistance:o=wt.forceChargeMaxDistance,forceLinkStrength:a=wt.forceLinkStrength,forceCenterStrength:c=wt.forceCenterStrength,forceLinkDistanceMethod:l=wt.forceLinkDistanceMethod,forceCollideRadiusMethod:u=wt.forceCollideRadiusMethod,disableCollide:h=wt.disableCollide,disableCenter:d=wt.disableCenter,disableLink:f=wt.disableLink,disableCharge:m=wt.disableCharge})=>(xu.alpha(1).stop().numDimensions(t).velocityDecay(s).force("collide",h?null:_f().radius(u).iterations(1)).force("center",d?null:gf().strength(c)).force("charge",m?null:vf().strength(i).distanceMin(r).distanceMax(o)).nodes(n).force("link",f?null:yf(e).id(p=>p.ref_id).distance(l).strength(a)).alpha(1).restart(),xu),Ek=({link:n,animated:e})=>{const t=D.useRef(null),s=as(),[i,r]=D.useState(new le(0,0,0)),[o,a]=D.useState(new le(0,0,0)),[c,l]=D.useState(8947848),u=ht(h=>h.selectionGraphData);return D.useEffect(()=>{var f,m,p,_,y,k;const h=(s==null?void 0:s.ref_id)||"",d=s&&(h===n.target||h===n.source);!n.onlyVisibleOnSelect||d?(r(new le(((f=n.sourcePosition)==null?void 0:f.x)||0,((m=n.sourcePosition)==null?void 0:m.y)||0,((p=n.sourcePosition)==null?void 0:p.z)||0)),a(new le(((_=n.targetPosition)==null?void 0:_.x)||0,((y=n.targetPosition)==null?void 0:y.y)||0,((k=n.targetPosition)==null?void 0:k.z)||0))):(r(new le(0,0,0)),a(new le(0,0,0))),l(d?n.color||xf.children.segmentColor:s?5592405:8947848)},[s,n]),Bt(()=>{if(e&&t.current){const h=u.nodes.find(f=>f.ref_id===n.source),d=u.nodes.find(f=>f.ref_id===n.target);t.current.start.set((h==null?void 0:h.x)||0,(h==null?void 0:h.y)||0,(h==null?void 0:h.z)||0),t.current.end.set((d==null?void 0:d.x)||0,(d==null?void 0:d.y)||0,(d==null?void 0:d.z)||0)}}),U.jsx(U.Fragment,{children:U.jsx(Zp,{ref:t,color:"0xFFFFFF",end:o,start:i})})},Ok=({links:n,simulation:e})=>{const t=D.useRef(null);return D.useEffect(()=>function(){t.current&&t.current.clear()},[t]),Bt(()=>{if(t.current){const s=e.nodes();t.current.children.forEach((r,o)=>{var u;const a=n[o],c=s.find(h=>a.source===h.ref_id),l=s.find(h=>a.target===h.ref_id);(u=r.position)==null||u.set((c.x+l.x)/2,(c.y+l.y)/2,(c.z+l.z)/2)})}}),n.length?U.jsx("group",{ref:t,children:n.map(s=>U.jsx("mesh",{children:U.jsx(yr,{center:!0,sprite:!0,children:U.jsxs(Ak,{direction:"row",justify:"center",onClick:i=>{i.stopPropagation()},onPointerOut:i=>{i.stopPropagation()},onPointerOver:i=>{i.stopPropagation()},children:[U.jsx("span",{children:s.edge_type}),U.jsx(Os,{className:"icon",children:U.jsx(xp,{})})]})})},s.ref_id))}):null},Ak=Ye(Os)`
  text-align: center;

  outline-offset: 0px;
  background: rgba(0, 0, 0, 0.75);
  color: #eee;
  cursor: pointer;
  transition: font-size 0.4s, outline 0.4s;
  align-items: center;
  justify-content: center;
  font-family: Barlow;
  font-size: 12px;
  font-style: normal;
  font-weight: 700;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);

  &:hover {
    outline-offset: 4px;
    span {
      opacity: 0.1;
    }

    .icon {
      display: flex;
    }
  }

  .icon {
    position: absolute;
    width: 24px;
    height: 24px;
    /* bottom: 100%; */
    display: none;
    color: #000;
    border-radius: 40px;
    justify-content: center;
    align-items: center;
    background: #ffffff;
    color: #000;
    border-radius: 100%;
    font-size: 16px;
    cursor: pointer;
    transition: opacity 0.4s;
    box-shadow: 0px 2px 12px rgba(0, 0, 0, 0.5);
  }

  .badge-wrapper {
    position: absolute;
    top: -7px;
    left: -14px;
  }
`,Mk=n=>{const e=/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|\ud83c[\ude32-\ude3a]|\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/g;return n.replace(e,t=>/^[\d*#]$/.test(t)?t:"")},Pk=["#fff","#9747FF","#00887A","#0098A6","#0288D1","#33691E","#465A65","#512DA7","#5C6BC0","#5D4038","#662C00","#689F39","#6B1B00","#750000","#78909C","#7E57C2","#8C6E63","#AA47BC","#BF360C","#C2175B","#EC407A","#EF6C00","#F5511E","#FF9696","#FFC064","#FFCD29","#FFEA60"];function Dk(n){const e=Cu(n,30),t=e.split(" ");if(n.split(" ").length<=5)return e;const s=Math.ceil(t.length/3),i=s*2,r=t.slice(0,s).join(" "),o=t.slice(s,i).join(" "),a=t.slice(i).join(" ");return`${r}
${o}
${a}`}const al=D.memo(({node:n,hide:e})=>{var g,S;const t=D.useRef(null),s=D.useRef(null),i=as(),r=Tf(),a=Uo().includes((n==null?void 0:n.ref_id)||""),c=!!i&&(i==null?void 0:i.ref_id)===n.ref_id,l=!!r&&(r==null?void 0:r.ref_id)===n.ref_id,u=ht(T=>T.showSelectionGraph),{normalizedSchemasByType:h}=mp(T=>T),d=kf();Bt(({camera:T})=>{t!=null&&t.current&&t.current.quaternion.copy(T.quaternion),s!=null&&s.current&&s.current.quaternion.copy(T.quaternion)});const f=D.useMemo(()=>{let T=(n.edge_count||1)*20;u&&c?T=40:!c&&a&&(T=0);const x=T/Math.sqrt(n.name.length);return T=Math.max(x,20),Math.min(T,30)},[n.edge_count,n.name,c,a,u]),m=D.useMemo(()=>i&&!c||r&&!l?.2:1,[c,i,l,r]),p=(g=h[n.node_type])==null?void 0:g.primary_color,_=(S=h[n.node_type])==null?void 0:S.icon,y=p??(Pk[d.indexOf(n.node_type)]||Oe.white),k=_?Bf[_]:null,w=k?_:"AddCircleIcon",v=Mk(String(n.name));return U.jsx(U.Fragment,{children:k?U.jsx(Lu,{enabled:!!c,children:U.jsxs("mesh",{name:n.id,userData:n,visible:!e,children:[U.jsx("sphereGeometry",{args:[30,32,32],userData:n}),U.jsx("meshStandardMaterial",{...Dr,color:y}),U.jsx(zp,{ref:s,position:[20,20,20],scale:2,src:`svg-icons/${w}.svg`})]})}):U.jsx(Uf,{ref:t,anchorX:"center",anchorY:"middle",color:y,fillOpacity:m,scale:f,userData:n,visible:!e,...Lf,children:Dk(v)})})});al.displayName="TextNode";const lf=D.memo(()=>{const[n,e]=D.useState(null),{dataInitial:t}=On(l=>l),s=as(),i=D.useRef(null),r=Uo(),o=zf(t==null?void 0:t.nodes.length),{selectionGraphData:a,setSelectionData:c}=ht(lc(l=>l));return D.useEffect(()=>{const l=structuredClone((t==null?void 0:t.nodes)||[]),u=structuredClone((t==null?void 0:t.links)||[]);if(o===l.length)return;const h=l.filter(d=>d.ref_id===(s==null?void 0:s.ref_id)||r.includes((d==null?void 0:d.ref_id)||"")).map(d=>{const f=d.ref_id===(s==null?void 0:s.ref_id)?{fx:0,fy:0,fz:0}:{};return{...d,x:0,y:0,z:0,...f}});if(h){const d=u.filter(f=>h.some(m=>m.ref_id===f.target)&&h.some(m=>m.ref_id===f.source));c({nodes:h,links:d})}},[t,s,r,c,o]),D.useEffect(()=>{if(n||!a.nodes.length)return;const l=structuredClone(a.links),u=Ck(a.nodes,l,{numDimensions:2,forceLinkStrength:.01,forceCenterStrength:.85,forceChargeStrength:-20,velocityDecay:.9});e(u)},[a,n]),D.useEffect(()=>()=>{c({nodes:[],links:[]})},[c]),D.useEffect(()=>{n&&n.on("tick",()=>{i.current&&i.current.children.forEach((u,h)=>{const d=n.nodes()[h];d&&u.position.set(d.x,d.y,d.z)})})},[n]),console.log(a.nodes),U.jsxs(U.Fragment,{children:[U.jsx("group",{ref:i,name:"simulation-2d-group",children:a==null?void 0:a.nodes.map(l=>U.jsx("mesh",{children:l.name?U.jsx(al,{hide:!0,node:l},l.ref_id||l.id):U.jsx(ol,{hide:!0,node:l},l.ref_id||l.id)},l.ref_id))}),U.jsx(Wp,{fog:!0,lineWidth:.9,children:(a==null?void 0:a.links).map((l,u)=>U.jsx(Ek,{animated:!0,link:l},u.toString()))},`selection-links-${a==null?void 0:a.links.length}`),n&&U.jsx(Ok,{links:a.links,simulation:n})]})});lf.displayName="SelectionDataNodes";const Rk=200,uf=D.memo(()=>{const n=as(),e=Uo(),{selectionGraphData:t,showSelectionGraph:s,setHoveredNode:i,setIsHovering:r}=ht(m=>m),o=On(m=>m.dataInitial),a=vr(m=>m.setTranscriptOpen),c=D.useCallback(m=>!!(s&&!t.nodes.find(p=>p.ref_id===m.ref_id)),[s,t]),l=D.useCallback(m=>{const p=m==null?void 0:m[0];p&&(a(!1),p.userData&&(c(p.userData)||ht.getState().setSelectedNode((p==null?void 0:p.userData)||null)))},[a,c]),u=D.useRef(null),h=D.useCallback(m=>{m.stopPropagation(),r(!1),i(null),u.current&&(clearTimeout(u.current),u.current=null)},[r,i]),d=D.useCallback(m=>{var y;const _=m.intersections.map(k=>k.object)[0];if((y=_==null?void 0:_.userData)!=null&&y.ref_id){const k=_.userData;c(k)||(m.stopPropagation(),r(!0),u.current=setTimeout(()=>{i(k)},Rk))}},[i,c,r]),f=s&&!!n;return U.jsxs(Bp,{filter:m=>m.filter(p=>{var _;return!!((_=p.userData)!=null&&_.ref_id)}),onChange:l,onPointerOut:h,onPointerOver:d,children:[!1,U.jsx(cf,{}),U.jsx("group",{name:"simulation-3d-group__nodes",children:o==null?void 0:o.nodes.map(m=>{const p=!!n&&(e.includes(m.ref_id)||n.ref_id===m.ref_id);return U.jsx("mesh",{children:m.name?U.jsx(al,{hide:f||p,node:m},m.ref_id||m.id):U.jsx(ol,{hide:f,node:m},m.ref_id||m.id)},m.ref_id)})}),f&&U.jsx(lf,{})]})});uf.displayName="Cubes";const Ik={earthRef:null},Nk=ku(n=>({...Ik,setEarthRef:e=>n({earthRef:e})})),Fk=new le(0,0,0),Uk=()=>{const n=D.useRef(null),e=D.useRef(null),{graphStyle:t,showSelectionGraph:s}=ht(a=>a),i=Nk(a=>a.setEarthRef),r=pn("textures/earth/galaxy.png"),o=pn("textures/earth/clouds.png");return Bt(({camera:a})=>{e.current&&e.current.position.copy(a.getWorldPosition(Fk))}),D.useLayoutEffect(()=>{n.current&&i(n)},[i]),t!=="earth"||s?null:U.jsxs(U.Fragment,{children:[U.jsxs("mesh",{ref:n,userData:{type:"earth"},children:[U.jsx("sphereGeometry",{args:[$r,200,200]}),U.jsx(Lk,{})]}),U.jsxs("mesh",{children:[U.jsx("sphereGeometry",{args:[$r+2,200,200]}),U.jsx("meshStandardMaterial",{alphaMap:o,map:o,transparent:!0})]}),U.jsxs("mesh",{children:[U.jsx("sphereGeometry",{args:[$r*4,200,200]}),U.jsx("meshStandardMaterial",{map:r,opacity:.4,side:hn,transparent:!0})]}),U.jsx("directionalLight",{ref:e,intensity:.9,position:[0,0,$r*3]})]})},Lk=()=>{const n=pn("textures/earth/earth.jpeg"),e=pn("textures/earth/bump.jpeg"),t=pn("textures/earth/water.png"),s=D.useMemo(()=>new xr({map:n,bumpMap:e,aoMap:e,roughnessMap:e,metalnessMap:t,toneMapped:!0,roughness:35,metalness:0}),[n,e,t]);return U.jsx("meshStandardMaterial",{...s})},Bk="C",zk=256,Vk=256,jk={g:"LottieFiles AE 0.1.20"},Hk=[{ty:0,nm:"I",sr:1,st:0,op:26,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[128,128,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[128,128,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],w:256,h:256,refId:"comp_0",ind:1},{ty:0,nm:"I",sr:1,st:26,op:52,ip:26,hasMask:!1,ao:0,ks:{a:{a:0,k:[128,128,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[128,128,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],w:256,h:256,refId:"comp_1",ind:2},{ty:0,nm:"I",sr:1,st:52,op:78,ip:52,hasMask:!1,ao:0,ks:{a:{a:0,k:[128,128,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[128,128,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],w:256,h:256,refId:"comp_2",ind:3},{ty:0,nm:"I",sr:1,st:78,op:108,ip:78,hasMask:!1,ao:0,ks:{a:{a:0,k:[128,128,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[128,128,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],w:256,h:256,refId:"comp_3",ind:4}],qk="5.5.7",Gk=60,Wk=104,Yk=0,Zk=[{nm:"",id:"comp_0",layers:[{ty:4,nm:"I",sr:1,st:0,op:30,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[128,128,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"T",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[0,20],[-34.641,0],[0,-20],[34.641,0]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[34.656,.016],[0,20],[-34.641,0],[.016,-19.984]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[44.641,30]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]},{ty:"gr",nm:"S",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.32,30],[-17.32,10],[-17.32,-30],[17.32,-10]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[51.962,10],[17.321,30],[17.321,-10],[51.962,-30]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[27.32,60]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]},{ty:"gr",nm:"F",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.321,10],[-17.321,30],[-17.321,-10],[17.321,-30]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-17.32,-9.984],[17.32,10],[17.32,-30],[-17.32,-50.016]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[61.962,60]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]},{ty:"gr",nm:"F",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.32,10],[-17.32,30],[-17.32,-10],[17.32,-30]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-17.32,30],[17.32,50],[17.305,10],[-17.32,-10]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[27.32,40]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]},{ty:"gr",nm:"S",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.321,30],[-17.321,10],[-17.321,-30],[17.321,-10]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-17.321,10],[-51.962,30],[-51.962,-10],[-17.321,-30]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[61.962,40]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]},{ty:"gr",nm:"T",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[0,20],[-34.641,0],[0,-20],[34.641,0]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[34.641,0],[0,20],[-34.641,0],[0,-20]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[44.641,70]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:1}]},{nm:"",id:"comp_1",layers:[{ty:4,nm:"R",sr:1,st:0,op:30,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[0,0,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[128,128,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:0}},ef:[],shapes:[],ind:1},{ty:4,nm:"S",sr:1,st:-20,op:32,ip:13,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"S",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.32,30],[-17.32,10],[-17.32,-30],[17.32,-10]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.32,-10.016],[-17.32,-30],[17.32,-50],[51.961,-30]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[27.32,60]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:2,parent:1},{ty:4,nm:"T",sr:1,st:-20,op:13,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"T",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[0,20],[-34.641,0],[0,-20],[34.641,0]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[34.641,0],[.015,-20],[0,20],[34.641,40]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[44.641,30]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:3,parent:1},{ty:4,nm:"S",sr:1,st:-20,op:13,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"S",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.32,30],[-17.32,10],[-17.32,-30],[17.32,-10]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.32,-10.016],[-17.32,-30],[17.32,-50],[51.961,-30]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[27.32,60]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:4,parent:1},{ty:4,nm:"F",sr:1,st:-20,op:33,ip:13,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"F",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.321,10],[-17.321,30],[-17.321,-10],[17.321,-30]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-17.324,30],[-17.34,-9.984],[17.336,-30.016],[17.336,10]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[61.962,60]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:5,parent:1},{ty:4,nm:"T",sr:1,st:-20,op:35,ip:13,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"T",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[0,20],[-34.641,0],[0,-20],[34.641,0]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[34.641,0],[.015,-20],[0,20],[34.641,40]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[44.641,30]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:6,parent:1},{ty:4,nm:"F",sr:1,st:-20,op:13,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"F",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.321,10],[-17.321,30],[-17.321,-10],[17.321,-30]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-17.324,30],[-17.34,-9.984],[17.336,-30.016],[17.336,10]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[61.962,60]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:7,parent:1},{ty:4,nm:"F",sr:1,st:-20,op:13,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"F",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.32,10],[-17.32,30],[-17.32,-10],[17.32,-30]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-17.305,30],[-17.336,-9.984],[17.336,-30.016],[17.32,10]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[27.32,40]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:8,parent:1},{ty:4,nm:"T",sr:1,st:-20,op:32,ip:13,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"T",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[0,20],[-34.641,0],[0,-20],[34.641,0]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[.016,-20.016],[-34.643,-40],[-34.641,.016],[0,20]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[44.641,70]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:9,parent:1},{ty:4,nm:"S",sr:1,st:-20,op:31,ip:13,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"S",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.321,-10],[17.321,30],[-17.321,10],[-17.321,-30]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.321,30],[-17.305,50],[-51.961,30],[-17.321,10]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[61.962,40]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:10,parent:1},{ty:4,nm:"F",sr:1,st:-20,op:34,ip:13,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"F",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.32,10],[-17.32,30],[-17.32,-10],[17.32,-30]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-17.305,30],[-17.336,-9.984],[17.336,-30.016],[17.32,10]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[27.32,40]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:11,parent:1},{ty:4,nm:"S",sr:1,st:-20,op:13,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"S",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.321,-10],[17.321,30],[-17.321,10],[-17.321,-30]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.321,30],[-17.305,50],[-51.961,30],[-17.321,10]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[61.962,40]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:12,parent:1},{ty:4,nm:"T",sr:1,st:-20,op:13,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"T",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[0,20],[-34.641,0],[0,-20],[34.641,0]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[.016,-20.016],[-34.643,-40],[-34.641,.016],[0,20]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[44.641,70]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:13,parent:1}]},{nm:"",id:"comp_2",layers:[{ty:4,nm:"R",sr:1,st:0,op:30,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[0,0,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[128,128,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:0}},ef:[],shapes:[],ind:1},{ty:4,nm:"T",sr:1,st:0,op:30,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"T",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[0,20],[-34.641,0],[0,-20],[34.641,0]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-34.656,.031],[.047,-19.969],[34.652,.031],[0,20]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[44.641,30]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:2,parent:1},{ty:4,nm:"S",sr:1,st:0,op:13,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"S",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.32,30],[-17.32,10],[-17.32,-30],[17.32,-10]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-17.32,10],[17.32,-9.984],[17.32,-50],[-17.32,-30]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[27.32,60]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:3,parent:1},{ty:4,nm:"F",sr:1,st:0,op:30,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"F",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.321,10],[-17.321,30],[-17.321,-10],[17.321,-30]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-17.321,30],[-51.962,10],[-51.962,-30],[-17.321,-10]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[61.962,60]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:4,parent:1},{ty:4,nm:"S",sr:1,st:0,op:30,ip:13,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"S",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.32,30],[-17.32,10],[-17.32,-30],[17.32,-10]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-17.32,10],[17.32,-9.984],[17.32,-50],[-17.32,-30]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[27.32,60]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:5,parent:1},{ty:4,nm:"F",sr:1,st:0,op:13,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"F",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.32,10],[-17.32,30],[-17.32,-10],[17.32,-30]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[51.962,30],[17.321,10],[17.321,-30],[51.962,-10]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[27.32,40]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:6,parent:1},{ty:4,nm:"S",sr:1,st:0,op:30,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"S",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.321,30],[-17.321,10],[-17.321,-30],[17.321,-10]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-17.32,50],[17.32,30],[17.336,-10],[-17.336,10]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[61.962,40]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:7,parent:1},{ty:4,nm:"F",sr:1,st:0,op:30,ip:13,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"F",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.32,10],[-17.32,30],[-17.32,-10],[17.32,-30]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[51.962,30],[17.321,10],[17.321,-30],[51.962,-10]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[27.32,40]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:8,parent:1},{ty:4,nm:"T",sr:1,st:0,op:30,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"T",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[0,20],[-34.641,0],[0,-20],[34.641,0]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-34.656,0],[.015,-20],[34.656,0],[.012,20.062]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[44.641,70]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:9,parent:1}]},{nm:"",id:"comp_3",layers:[{ty:4,nm:"R",sr:1,st:0,op:30,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[0,0,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[128,128,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:0}},ef:[],shapes:[],ind:1},{ty:4,nm:"S",sr:1,st:0,op:32,ip:13,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"S",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.321,30],[-17.321,10],[-17.321,-30],[17.321,-10]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.336,-10],[-17.32,-30.016],[-51.961,-10],[-17.305,10]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[61.962,40]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:2,parent:1},{ty:4,nm:"T",sr:1,st:0,op:32,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"T",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[0,20],[-34.641,0],[0,-20],[34.641,0]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[.015,60.016],[-34.642,40],[-34.641,0],[0,20]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[44.641,30]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:3,parent:1},{ty:4,nm:"S",sr:1,st:0,op:13,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"S",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-17.32,10],[-17.32,-30],[17.32,-10],[17.32,30]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.312,-10],[-17.313,10],[17.332,30],[51.977,10]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[27.32,60]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:4,parent:1},{ty:4,nm:"F",sr:1,st:0,op:32,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"F",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.321,10],[-17.321,30],[-17.321,-10],[17.321,-30]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.336,-29.984],[17.348,10],[-17.305,30],[-17.305,-9.984]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[61.962,60]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:5,parent:1},{ty:4,nm:"F",sr:1,st:0,op:13,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"F",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.32,10],[-17.32,30],[-17.32,-10],[17.32,-30]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.336,-30],[17.32,10],[-17.32,30],[-17.336,-10]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[27.32,40]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:6,parent:1},{ty:4,nm:"S",sr:1,st:0,op:13,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"S",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.321,30],[-17.321,10],[-17.321,-30],[17.321,-10]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.336,-10],[-17.32,-30.016],[-51.961,-10],[-17.305,10]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[61.962,40]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:7,parent:1},{ty:4,nm:"T",sr:1,st:0,op:32,ip:0,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"T",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[0,20],[-34.641,0],[0,-20],[34.641,0]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[34.641,0],[0,-20],[0,-60.016],[34.641,-40]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[44.641,70]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:8,parent:1},{ty:4,nm:"S",sr:1,st:0,op:32,ip:13,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"S",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-17.32,10],[-17.32,-30],[17.32,-10],[17.32,30]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.312,-10],[-17.313,10],[17.332,30],[51.977,10]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[27.32,60]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:9,parent:1},{ty:4,nm:"F",sr:1,st:0,op:32,ip:13,hasMask:!1,ao:0,ks:{a:{a:0,k:[44.641,50,0]},s:{a:0,k:[100,100,100]},sk:{a:0,k:0},p:{a:0,k:[0,0,0]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}},ef:[],shapes:[{ty:"gr",nm:"F",it:[{ty:"sh",nm:"P",d:1,ks:{a:1,k:[{o:{x:.8,y:0},i:{x:.2,y:1},s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.32,10],[-17.32,30],[-17.32,-10],[17.32,-30]]}],t:0},{s:[{c:!0,i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[17.336,-30],[17.32,10],[-17.32,30],[-17.336,-10]]}],t:26}]}},{ty:"st",nm:"S",lc:1,lj:2,ml:1,o:{a:0,k:100},w:{a:0,k:4},c:{a:0,k:[1,1,1]}},{ty:"tr",a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},sk:{a:0,k:0},p:{a:0,k:[27.32,40]},r:{a:0,k:0},sa:{a:0,k:0},o:{a:0,k:100}}]}],ind:10,parent:1}]}],$k={nm:Bk,h:zk,w:Vk,meta:jk,layers:Hk,v:qk,fr:Gk,op:Wk,ip:Yk,assets:Zk},Xk=({meshId:n})=>{const e=D.useRef(null);return D.useEffect(()=>{const t=document.getElementById(`lottie-animation-${n}`);return t&&(e.current=wf.loadAnimation({container:t,animationData:$k,loop:!0,autoplay:!0})),()=>{e.current&&e.current.destroy()}},[n]),U.jsx("div",{id:`lottie-animation-${n}`,style:{width:"2em",height:"2em"}})},Ma=()=>Math.floor(Math.random()*2001)-1e3,Qk=()=>U.jsx(U.Fragment,{children:["a","b","c"].map(n=>{const e=Ma(),t=Ma(),s=Ma();return U.jsx("mesh",{position:[e,t,s],children:U.jsx(yr,{center:!0,sprite:!0,children:U.jsx(Kk,{children:U.jsx(Xk,{meshId:n})})})},n)})}),Kk=Ye.div`
  border: 2px solid white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 20px;
`;Object.values(Vf).map(n=>n);const Fi=n=>({close:{backgroundColor:"rgba(48, 51, 66, 1)",borderColor:"#fff",fontColor:"rgba(255, 255, 255, 1)"},focus:{backgroundColor:n?"rgba(255, 255, 255, 0.90);":"rgba(255, 255, 255, 0.90)",borderColor:n?"#FFDB58bb":"#fff",fontColor:"rgba(48, 51, 66, 1)"},menu:{backgroundColor:"#00000066",borderColor:n?"#ffffff66":"#5078f2",fontColor:n?"#ffffff66":"#fff"}}),Jk=new le,hf=D.memo(()=>{var T;const n=D.useRef(null),e=vr(x=>x.setSidebarOpen),[t,s]=ro.useState(null),{open:i}=Ir("editNodeName"),{open:r}=Ir("addEdgeToNode"),{open:o}=Ir("mergeToNode"),{open:a}=Ir("createBounty"),[c]=wu(x=>[x.isAdmin]),[l]=On(x=>[x.addNewNode]),u=as(),{showSelectionGraph:h,selectionGraphData:d,setSelectedNode:f,setShowSelectionGraph:m}=ht(x=>x),p=Cp(),_=D.useCallback(async()=>{try{if(u!=null&&u.ref_id){const x=await Sf(u==null?void 0:u.ref_id,d.nodes.length||0);x&&l(x)}}catch(x){console.log(x)}},[l,u==null?void 0:u.ref_id,d.nodes.length]);Bt(()=>{y()});const y=D.useCallback(()=>{const x=h?d:p;if(n.current){const b=x==null?void 0:x.nodes.find(A=>A.ref_id===(u==null?void 0:u.ref_id));if(b){const A=Jk.set(b==null?void 0:b.x,b==null?void 0:b.y,b==null?void 0:b.z);n.current.position.copy(A)}}},[u,h,d,p]),k=D.useMemo(()=>{const x=c?[{key:"control-key-1",colors:Fi(h).focus,icon:U.jsx(Ep,{}),left:-80,className:"add",onClick:A=>{s(A.currentTarget)}},{key:"control-key-2",colors:Fi(h).focus,icon:U.jsx(wp,{}),left:-40,className:"edit",onClick:()=>{i()}}]:[],b=[{key:"control-key-4",colors:Fi(h).focus,icon:U.jsx(Sp,{}),left:0,className:"expand",onClick:()=>{const A=!h;m(A),A&&e(!0)}},{key:"control-key-5",colors:Fi(!0).close,icon:U.jsx(bf,{}),left:40,className:"exit",onClick:()=>{_()}},{key:"control-key-6",colors:Fi(!0).close,icon:U.jsx(bp,{}),left:40,className:"exit",onClick:()=>{m(!1),f(null)}}];return[...x,...b].map((A,R)=>({...A,left:-80+R*40}))},[c,h,i,m,e,_,f]);if(!u)return null;const w=()=>{s(null)},v=!!t,g=v?"simple-popover":void 0,S=!!(u&&((T=u==null?void 0:u.node_type)==null?void 0:T.toLowerCase())==="function");return U.jsx("group",{ref:n,children:U.jsxs(yr,{center:!0,className:"control-panel",onClick:x=>x.stopPropagation(),onKeyDown:x=>x.stopPropagation(),onPointerDown:x=>x.stopPropagation(),onPointerOut:x=>x.stopPropagation(),onPointerOver:x=>x.stopPropagation(),onPointerUp:x=>x.stopPropagation(),sprite:!0,zIndexRange:[16777271,16777272],children:[k.map(x=>U.jsx(ew,{backgroundColor:x.colors.backgroundColor,borderColor:x.colors.borderColor,className:x.className,fontColor:x.colors.fontColor,left:x.left,onClick:b=>{b.stopPropagation(),x.onClick(b)},children:x.icon},x.key)),S&&U.jsx(sw,{left:2,onClick:()=>{a()},children:"Create Test"}),U.jsxs(tw,{anchorEl:t,anchorOrigin:{vertical:"bottom",horizontal:"right"},id:g,onClose:w,open:v,transformOrigin:{vertical:"top",horizontal:"right"},children:[U.jsxs(Tu,{"data-testid":"merge",onClick:()=>{o(),w()},children:[U.jsx(Tp,{"data-testid":"MergeIcon"})," Merge"]}),U.jsxs(Tu,{"data-testid":"add_edge",onClick:()=>{r(),w()},children:[U.jsx(kp,{"data-testid":"AddCircleIcon"})," Add edge"]})]})]})})});hf.displayName="NodeControls";const ew=Ye.div`
  position: fixed;
  top: -60px;
  left: ${n=>-7+n.left}px;
  width: 24px;
  height: 24px;

  border-radius: 40px;
  display: flex;
  justify-content: center;
  align-items: center;
  background: ${n=>n.backgroundColor?n.backgroundColor:"#000000bb"};
  color: ${n=>n.fontColor?n.fontColor:"#ffffff"};
  border-radius: 100%;
  font-size: 16px;
  cursor: pointer;
  transition: opacity 0.4s;
  box-shadow: 0px 2px 12px rgba(0, 0, 0, 0.5);
`,Tu=Ye(Os).attrs({direction:"row",px:12,py:8})`
  display: flex;
  align-items: center;
  justify-content: start;
  gap: 12px;
  cursor: pointer;
  background: ${Oe.BUTTON1};
  color: ${Oe.white};

  &:hover {
    background: ${Oe.BUTTON1_HOVER};
    color: ${Oe.GRAY3};
  }
`,tw=Ye(_p)`
  && {
    z-index: 9999;
  }
  .MuiPaper-root {
    min-width: 149px;
    color: ${Oe.GRAY3};
    box-shadow: 0px 1px 6px 0px rgba(0, 0, 0, 0.2);
    border-radius: 6px;
    z-index: 1;
    font-family: Barlow;
    font-size: 14px;
    font-weight: 500;
  }
`,sw=Ye.div`
  position: fixed;
  top: 40px;
  left: ${n=>-53+n.left}px;
  width: 100px;
  padding: 6px;
  border-radius: 4px;
  display: flex;
  justify-content: center;
  align-items: center;
  background: ${Oe.createTestButton};
  color: ${Oe.black};
  font-size: 14px;
  font-family: Barlow;
  font-weight: 600;
  cursor: pointer;
  &:hover {
    transform: scale(1.05);
  }
`,df=D.memo(()=>U.jsx(U.Fragment,{children:U.jsx(hf,{})}));df.displayName="NodeDetailsPanel";const nw=()=>{const{dataInitial:n,isLoadingNew:e,isFetching:t,dataNew:s,resetDataNew:i}=On(m=>m),r=D.useRef(null),o=D.useRef(!1),a=D.useRef([]),{setData:c,simulation:l,simulationCreate:u,simulationHelpers:h,graphStyle:d,setGraphRadius:f}=ht(m=>m);return D.useEffect(()=>{if(!s)return;const m=s.nodes||[],p=s.links||[],_=structuredClone(m),y=structuredClone(p);if(l){const k=Cf.isEqual(s,n);h.addNodesAndLinks(_,y,k)}l||u(_,y),i()},[c,s,l,u,i,h,n]),D.useEffect(()=>{l&&h.setForces()},[d,h,l]),D.useEffect(()=>{l&&(l.on("tick",()=>{if(!o.current&&l.alpha()<.1){const m=l.nodes().map(k=>new le(k.x,k.y,k.z)),p=new dl().setFromPoints(m),_=new fl;p.getBoundingSphere(_);const y=Math.min(5e3,_.radius);f(y),o.current=!0}if(r.current){const m=r.current.getObjectByName("simulation-3d-group__nodes"),p=r.current.getObjectByName("simulation-3d-group__connections");m.children.forEach((_,y)=>{const k=l.nodes()[y];k&&_.position.set(k.x,k.y,k.z)}),p.children.forEach((_,y)=>{const k=n==null?void 0:n.links[y],w=_;if(k){const v=l.nodes().find(L=>L.ref_id===k.source),g=l.nodes().find(L=>L.ref_id===k.target),{x:S,y:T,z:x}=v,{x:b,y:A,z:R}=g;a.current[y]={sx:S,sy:T,sz:x,tx:b,ty:A,tz:R},w.geometry.setPositions([S,T,x,b,A,R]);const{material:M}=w;M.color=new ys("white"),M.transparent=!0,M.opacity=.1}})}}),l.on("end",()=>{const m=l.nodes().map(k=>new le(k.x,k.y,k.z)),p=new dl().setFromPoints(m),_=new fl;p.getBoundingSphere(_);const y=_.radius;f(y),o.current=!1}))},[n,l,f]),l?U.jsxs("group",{ref:r,children:[U.jsx(uf,{}),U.jsx(Uk,{}),!1,(e||t)&&U.jsx(Qk,{}),d!=="earth"&&U.jsx(rf,{linksPositions:a.current}),U.jsx(df,{})]}):null},iw=({fullSize:n=!0})=>{const e=vr(t=>t.sidebarIsOpen);return U.jsx(rw,{align:"center",className:Su({"sidebar-is-open":e&&!n}),justify:"center",children:U.jsx(Op,{color:Oe.SECONDARY_BLUE,size:64})})},rw=Ye(Os)`
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  top: 0;
  background-color: ${Oe.black};
  z-index: 1;
`,ow=()=>U.jsx(yr,{children:U.jsx(Ip,{})}),aw=()=>{const{universeColor:n}=vp("universe",{universeColor:Oe.black}),e=as(),t=D.useMemo(()=>e!=null&&e.node_type?bu(e.node_type):$x,[e]);return U.jsxs(U.Fragment,{children:[U.jsx("color",{args:[n],attach:"background"}),U.jsx(qf,{}),U.jsx(iT,{}),U.jsxs(Kp,{children:[U.jsxs(Pm,{autoClear:!1,multisampling:8,children:[U.jsx(Nm,{darkness:.7,eskil:!1,offset:.05}),U.jsx(Rm,{luminanceThreshold:1,mipmapBlur:!0,resolutionX:Be.AUTO_SIZE,resolutionY:Be.AUTO_SIZE}),U.jsx(Im,{blendFunction:pe.SCREEN,blur:!0,edgeStrength:4,hiddenEdgeColor:t,visibleEdgeColor:t})]}),U.jsx(nw,{})]})]})};let Pa=null;const cw={aspect:window.innerWidth/window.innerHeight,far:3e4,near:1,position:[zi.x,zi.y,zi.z]},lw=()=>{const[n,e,t]=[Hs(a=>a.setIsUserScrollingOnHtmlPanel),Hs(a=>a.setIsUserScrolling),Hs(a=>a.setUserMovedCamera)],s=On(a=>a.isFetching),i=vr(a=>a.universeQuestionIsOpen),r=D.useCallback(a=>{var u;const{target:c}=a,{offsetParent:l}=c;Pa&&clearTimeout(Pa),(u=l==null?void 0:l.classList)!=null&&u.contains("html-panel")&&l.clientHeight<l.scrollHeight&&n(!0),e(!0),t(!0),Pa=setTimeout(()=>{e(!1),n(!1)},200)},[e,n,t]),o=D.useCallback(a=>Ef(a,"threeState"),[]);return U.jsxs(uw,{children:[U.jsx(D.Suspense,{fallback:null,children:U.jsxs(jf,{camera:cw,id:"universe-canvas",onCreated:o,onWheel:r,children:[Of&&U.jsx(Hf,{position:"bottom-right"}),U.jsxs(D.Suspense,{fallback:U.jsx(ow,{}),children:[U.jsx($p,{}),U.jsx(Xp,{}),U.jsx(Qp,{}),U.jsx(aw,{})]})]})}),i&&U.jsx(Um,{}),s&&U.jsx(iw,{fullSize:!1}),U.jsx(gp,{})]})},uw=Ye(Os)`
  flex: 1 1 100%;
  position: relative;
`,iS=D.memo(lw);export{iS as Universe};
