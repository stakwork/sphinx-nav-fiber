import{r as J,bt as Go,bu as rm,V as tt,bv as Xe,_ as Ga,bw as om,bx as gd,by as da,bz as am,bA as cm,ao as Wa,bB as vd,ak as Cn,aw as Pl,bC as zi,bD as lm,bm as um,bE as hm,bF as Pr,aN as Ai,bG as dm,bH as fa,bI as fm,bJ as pm,am as mm,bK as Ul,bL as yd,aA as _m,bM as gm,bN as vm,bO as ym,bP as Il,bQ as rn,bR as Vi,bS as Tm,bT as tr,bU as ss,bV as xm,bW as wm,bX as Sm,bY as bm,bZ as Cm,b_ as Wn,b$ as me,c0 as Em,c1 as ls,c2 as Td,c3 as Fl,at as th,al as xd,c4 as wd,c5 as Sd,c6 as Om,aO as Wo,G as tl,j as Qs,c7 as Am,Z as km}from"./index-b648bda2.js";import{u as Qe,e as Nl,b as Ll,i as Dm,j as Mm,k as Rm,m as Pm,l as Um,s as Im}from"./Selection-9c06badb.js";import{_ as ht,s as Mn}from"./react-toastify.esm-97ee9838.js";function Fm(r){let e;const t=new Set,n=(l,u)=>{const h=typeof l=="function"?l(e):l;if(h!==e){const d=e;e=u?h:Object.assign({},e,h),t.forEach(f=>f(e,d))}},s=()=>e,i=(l,u=s,h=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let d=u(e);function f(){const m=u(e);if(!h(d,m)){const p=d;l(d=m,p)}}return t.add(f),()=>t.delete(f)},c={setState:n,getState:s,subscribe:(l,u,h)=>u||h?i(l,u,h):(t.add(l),()=>t.delete(l)),destroy:()=>t.clear()};return e=r(n,s,c),c}const Nm=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),nh=Nm?J.useEffect:J.useLayoutEffect;function Lm(r){const e=typeof r=="function"?Fm(r):r,t=(n=e.getState,s=Object.is)=>{const[,i]=J.useReducer(_=>_+1,0),o=e.getState(),a=J.useRef(o),c=J.useRef(n),l=J.useRef(s),u=J.useRef(!1),h=J.useRef();h.current===void 0&&(h.current=n(o));let d,f=!1;(a.current!==o||c.current!==n||l.current!==s||u.current)&&(d=n(o),f=!s(h.current,d)),nh(()=>{f&&(h.current=d),a.current=o,c.current=n,l.current=s,u.current=!1});const m=J.useRef(o);nh(()=>{const _=()=>{try{const y=e.getState(),b=c.current(y);l.current(h.current,b)||(a.current=y,h.current=b,i())}catch{u.current=!0,i()}},T=e.subscribe(_);return e.getState()!==m.current&&_(),T},[]);const p=f?d:h.current;return J.useDebugValue(p),p};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const n=[t,e];return{next(){const s=n.length<=0;return{value:n.shift(),done:s}}}},t}let vr=0;const Bm=Lm(r=>(Go.onStart=(e,t,n)=>{r({active:!0,item:e,loaded:t,total:n,progress:(t-vr)/(n-vr)*100})},Go.onLoad=()=>{r({active:!1})},Go.onError=e=>r(t=>({errors:[...t.errors,e]})),Go.onProgress=(e,t,n)=>{t===n&&(vr=n),r({active:!0,item:e,loaded:t,total:n,progress:(t-vr)/(n-vr)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0})),zm=r=>`Loading ${r.toFixed(2)}%`;function zS({containerStyles:r,innerStyles:e,barStyles:t,dataStyles:n,dataInterpolation:s=zm,initialState:i=o=>o}){const{active:o,progress:a}=Bm(),c=J.useRef(0),l=J.useRef(0),u=J.useRef(null),[h,d]=J.useState(i(o));J.useEffect(()=>{let m;return o!==h&&(m=setTimeout(()=>d(o),300)),()=>clearTimeout(m)},[h,o]);const f=J.useCallback(()=>{u.current&&(c.current+=(a-c.current)/2,(c.current>.95*a||a===100)&&(c.current=a),u.current.innerText=s(c.current),c.current<a&&(l.current=requestAnimationFrame(f)))},[s,a]);return J.useEffect(()=>(f(),()=>cancelAnimationFrame(l.current)),[f]),h?J.createElement("div",{style:{...Ho.container,opacity:o?1:0,...r}},J.createElement("div",null,J.createElement("div",{style:{...Ho.inner,...e}},J.createElement("div",{style:{...Ho.bar,transform:`scaleX(${a/100})`,...t}}),J.createElement("span",{ref:u,style:{...Ho.data,...n}})))):null}const Ho={container:{position:"absolute",top:0,left:0,width:"100%",height:"100%",background:"#171717",display:"flex",alignItems:"center",justifyContent:"center",transition:"opacity 300ms ease",zIndex:1e3},inner:{width:100,height:3,background:"#272727",textAlign:"center"},bar:{height:3,width:"100%",background:"white",transition:"transform 200ms",transformOrigin:"left center"},data:{display:"inline-block",position:"relative",fontVariantNumeric:"tabular-nums",marginTop:"0.8em",color:"#f0f0f0",fontSize:"0.6em",fontFamily:'-apple-system, BlinkMacSystemFont, "Inter", "Segoe UI", "Helvetica Neue", Helvetica, Arial, Roboto, Ubuntu, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',whiteSpace:"nowrap"}};let yr;function Vm(){var r;if(yr!==void 0)return yr;try{let e;const t=document.createElement("canvas");return yr=!!(window.WebGL2RenderingContext&&(e=t.getContext("webgl2"))),e&&((r=e.getExtension("WEBGL_lose_context"))==null||r.loseContext()),yr}catch{return yr=!1}}const kc=new rm,Dc=new tt,yi=new tt,wn=new tt,Xn=new tt,In=new tt,Zn=new tt,Qn=new tt,Tr=new tt,xr=new tt,wr=new tt,qo=new tt,Sr=new tt,br=new tt,Cr=new tt;class Gm{constructor(e,t,n){this.camera=e,this.scene=t,this.startPoint=new tt,this.endPoint=new tt,this.collection=[],this.deep=n||Number.MAX_VALUE}select(e,t){return this.startPoint=e||this.startPoint,this.endPoint=t||this.endPoint,this.collection=[],this.updateFrustum(this.startPoint,this.endPoint),this.searchChildInFrustum(kc,this.scene),this.collection}updateFrustum(e,t){if(e=e||this.startPoint,t=t||this.endPoint,e.x===t.x&&(t.x+=Number.EPSILON),e.y===t.y&&(t.y+=Number.EPSILON),this.camera.updateProjectionMatrix(),this.camera.updateMatrixWorld(),this.camera.isPerspectiveCamera){yi.copy(e),yi.x=Math.min(e.x,t.x),yi.y=Math.max(e.y,t.y),t.x=Math.max(e.x,t.x),t.y=Math.min(e.y,t.y),wn.setFromMatrixPosition(this.camera.matrixWorld),Xn.copy(yi),In.set(t.x,yi.y,0),Zn.copy(t),Qn.set(yi.x,t.y,0),Xn.unproject(this.camera),In.unproject(this.camera),Zn.unproject(this.camera),Qn.unproject(this.camera),Sr.copy(Xn).sub(wn),br.copy(In).sub(wn),Cr.copy(Zn).sub(wn),Sr.normalize(),br.normalize(),Cr.normalize(),Sr.multiplyScalar(this.deep),br.multiplyScalar(this.deep),Cr.multiplyScalar(this.deep),Sr.add(wn),br.add(wn),Cr.add(wn);var n=kc.planes;n[0].setFromCoplanarPoints(wn,Xn,In),n[1].setFromCoplanarPoints(wn,In,Zn),n[2].setFromCoplanarPoints(Zn,Qn,wn),n[3].setFromCoplanarPoints(Qn,Xn,wn),n[4].setFromCoplanarPoints(In,Zn,Qn),n[5].setFromCoplanarPoints(Cr,br,Sr),n[5].normal.multiplyScalar(-1)}else if(this.camera.isOrthographicCamera){const s=Math.min(e.x,t.x),i=Math.max(e.y,t.y),o=Math.max(e.x,t.x),a=Math.min(e.y,t.y);Xn.set(s,i,-1),In.set(o,i,-1),Zn.set(o,a,-1),Qn.set(s,a,-1),Tr.set(s,i,1),xr.set(o,i,1),wr.set(o,a,1),qo.set(s,a,1),Xn.unproject(this.camera),In.unproject(this.camera),Zn.unproject(this.camera),Qn.unproject(this.camera),Tr.unproject(this.camera),xr.unproject(this.camera),wr.unproject(this.camera),qo.unproject(this.camera);var n=kc.planes;n[0].setFromCoplanarPoints(Xn,Tr,xr),n[1].setFromCoplanarPoints(In,xr,wr),n[2].setFromCoplanarPoints(wr,qo,Qn),n[3].setFromCoplanarPoints(qo,Tr,Xn),n[4].setFromCoplanarPoints(In,Zn,Qn),n[5].setFromCoplanarPoints(wr,xr,Tr),n[5].normal.multiplyScalar(-1)}else console.error("THREE.SelectionBox: Unsupported camera type.")}searchChildInFrustum(e,t){if((t.isMesh||t.isLine||t.isPoints)&&t.material!==void 0&&(t.geometry.boundingSphere===null&&t.geometry.computeBoundingSphere(),Dc.copy(t.geometry.boundingSphere.center),Dc.applyMatrix4(t.matrixWorld),e.containsPoint(Dc)&&this.collection.push(t)),t.children.length>0)for(let n=0;n<t.children.length;n++)this.searchChildInFrustum(e,t.children[n])}}function Wm(r,e){if(Object.is(r,e))return!0;if(typeof r!="object"||r===null||typeof e!="object"||e===null)return!1;const t=Object.keys(r);if(t.length!==Object.keys(e).length)return!1;for(let n=0;n<t.length;n++)if(!Object.prototype.hasOwnProperty.call(e,t[n])||!Object.is(r[t[n]],e[t[n]]))return!1;return!0}const Hm=J.createContext([]);function VS({box:r,multiple:e,children:t,onChange:n,border:s="1px solid #55aaff",backgroundColor:i="rgba(75, 160, 255, 0.1)",filter:o=c=>c,...a}){const{setEvents:c,camera:l,raycaster:u,gl:h,controls:d,size:f,get:m}=Qe(),[p,_]=J.useState(!1),[T,y]=J.useReducer((x,{object:w,shift:S})=>w===void 0?[]:Array.isArray(w)?w:S?x.includes(w)?x.filter(C=>C!==w):[w,...x]:x[0]===w?[]:[w],[]);J.useEffect(()=>void(n==null?void 0:n(T)),[T]);const b=J.useCallback(x=>{x.stopPropagation(),y({object:o([x.object])[0],shift:e&&x.shiftKey})},[]),v=J.useCallback(x=>!p&&y({}),[p]),g=J.useRef(null);return J.useEffect(()=>{if(!r||!e)return;const x=new Gm(l,g.current),w=document.createElement("div");w.style.pointerEvents="none",w.style.border=s,w.style.backgroundColor=i,w.style.position="fixed";const S=new Xe,C=new Xe,O=new Xe,k=m().events.enabled,E=d==null?void 0:d.enabled;let D=!1;function M(R,H){const{offsetX:W,offsetY:F}=R,{width:q,height:G}=f;H.set(W/q*2-1,-(F/G)*2+1)}function U(R){var H;d&&(d.enabled=!1),c({enabled:!1}),D=!0,(H=h.domElement.parentElement)==null||H.appendChild(w),w.style.left=`${R.clientX}px`,w.style.top=`${R.clientY}px`,w.style.width="0px",w.style.height="0px",S.x=R.clientX,S.y=R.clientY}function P(R){O.x=Math.max(S.x,R.clientX),O.y=Math.max(S.y,R.clientY),C.x=Math.min(S.x,R.clientX),C.y=Math.min(S.y,R.clientY),w.style.left=`${C.x}px`,w.style.top=`${C.y}px`,w.style.width=`${O.x-C.x}px`,w.style.height=`${O.y-C.y}px`}function V(){if(D){var R;d&&(d.enabled=E),c({enabled:k}),D=!1,(R=w.parentElement)==null||R.removeChild(w)}}function Q(R){R.shiftKey&&(U(R),M(R,x.startPoint))}let I=[];function B(R){if(D){P(R),M(R,x.endPoint);const H=x.select().sort(W=>W.uuid).filter(W=>W.isMesh);Wm(H,I)||(I=H,y({object:o(H)}))}}function A(R){D&&V()}return document.addEventListener("pointerdown",Q,{passive:!0}),document.addEventListener("pointermove",B,{passive:!0,capture:!0}),document.addEventListener("pointerup",A,{passive:!0}),()=>{document.removeEventListener("pointerdown",Q),document.removeEventListener("pointermove",B),document.removeEventListener("pointerup",A)}},[f.width,f.height,u,l,d,h]),J.createElement("group",Ga({ref:g,onClick:b,onPointerOver:()=>_(!0),onPointerOut:()=>_(!1),onPointerMissed:v},a),J.createElement(Hm.Provider,{value:T},t))}function qm(){var r=Object.create(null);function e(s,i){var o=s.id,a=s.name,c=s.dependencies;c===void 0&&(c=[]);var l=s.init;l===void 0&&(l=function(){});var u=s.getTransferables;if(u===void 0&&(u=null),!r[o])try{c=c.map(function(d){return d&&d.isWorkerModule&&(e(d,function(f){if(f instanceof Error)throw f}),d=r[d.id].value),d}),l=n("<"+a+">.init",l),u&&(u=n("<"+a+">.getTransferables",u));var h=null;typeof l=="function"?h=l.apply(void 0,c):console.error("worker module init function failed to rehydrate"),r[o]={id:o,value:h,getTransferables:u},i(h)}catch(d){d&&d.noLog||console.error(d),i(d)}}function t(s,i){var o,a=s.id,c=s.args;(!r[a]||typeof r[a].value!="function")&&i(new Error("Worker module "+a+": not found or its 'init' did not return a function"));try{var l=(o=r[a]).value.apply(o,c);l&&typeof l.then=="function"?l.then(u,function(h){return i(h instanceof Error?h:new Error(""+h))}):u(l)}catch(h){i(h)}function u(h){try{var d=r[a].getTransferables&&r[a].getTransferables(h);(!d||!Array.isArray(d)||!d.length)&&(d=void 0),i(h,d)}catch(f){console.error(f),i(f)}}}function n(s,i){var o=void 0;self.troikaDefine=function(c){return o=c};var a=URL.createObjectURL(new Blob(["/** "+s.replace(/\*/g,"")+` **/

troikaDefine(
`+i+`
)`],{type:"application/javascript"}));try{importScripts(a)}catch(c){console.error(c)}return URL.revokeObjectURL(a),delete self.troikaDefine,o}self.addEventListener("message",function(s){var i=s.data,o=i.messageId,a=i.action,c=i.data;try{a==="registerModule"&&e(c,function(l){l instanceof Error?postMessage({messageId:o,success:!1,error:l.message}):postMessage({messageId:o,success:!0,result:{isCallable:typeof l=="function"}})}),a==="callModule"&&t(c,function(l,u){l instanceof Error?postMessage({messageId:o,success:!1,error:l.message}):postMessage({messageId:o,success:!0,result:l},u||void 0)})}catch(l){postMessage({messageId:o,success:!1,error:l.stack})}})}function jm(r){var e=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return e._getInitResult().then(function(s){if(typeof s=="function")return s.apply(void 0,t);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var t=r.dependencies,n=r.init;t=Array.isArray(t)?t.map(function(i){return i&&i._getInitResult?i._getInitResult():i}):[];var s=Promise.all(t).then(function(i){return n.apply(null,i)});return e._getInitResult=function(){return s},s},e}var bd=function(){var r=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),r=!0}catch(t){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+t.message+"]")}return bd=function(){return r},r},Ym=0,Xm=0,Mc=!1,Fr=Object.create(null),Nr=Object.create(null),nl=Object.create(null);function _o(r){if((!r||typeof r.init!="function")&&!Mc)throw new Error("requires `options.init` function");var e=r.dependencies,t=r.init,n=r.getTransferables,s=r.workerId;if(!bd())return jm(r);s==null&&(s="#default");var i="workerModule"+ ++Ym,o=r.name||i,a=null;e=e&&e.map(function(l){return typeof l=="function"&&!l.workerModuleData&&(Mc=!0,l=_o({workerId:s,name:"<"+o+"> function dependency: "+l.name,init:`function(){return (
`+ra(l)+`
)}`}),Mc=!1),l&&l.workerModuleData&&(l=l.workerModuleData),l});function c(){for(var l=[],u=arguments.length;u--;)l[u]=arguments[u];if(!a){a=sh(s,"registerModule",c.workerModuleData);var h=function(){a=null,Nr[s].delete(h)};(Nr[s]||(Nr[s]=new Set)).add(h)}return a.then(function(d){var f=d.isCallable;if(f)return sh(s,"callModule",{id:i,args:l});throw new Error("Worker module function was called but `init` did not return a callable function")})}return c.workerModuleData={isWorkerModule:!0,id:i,name:o,dependencies:e,init:ra(t),getTransferables:n&&ra(n)},c}function Zm(r){Nr[r]&&Nr[r].forEach(function(e){e()}),Fr[r]&&(Fr[r].terminate(),delete Fr[r])}function ra(r){var e=r.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function Qm(r){var e=Fr[r];if(!e){var t=ra(qm);e=Fr[r]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+r.replace(/\*/g,"")+` **/

;(`+t+")()"],{type:"application/javascript"}))),e.onmessage=function(n){var s=n.data,i=s.messageId,o=nl[i];if(!o)throw new Error("WorkerModule response with empty or unknown messageId");delete nl[i],o(s)}}return e}function sh(r,e,t){return new Promise(function(n,s){var i=++Xm;nl[i]=function(o){o.success?n(o.result):s(new Error("Error in worker "+e+" call: "+o.error))},Qm(r).postMessage({messageId:i,action:e,data:t})})}function Cd(){var r=function(e){function t(I,B,A,R,H,W,F,q){var G=1-F;q.x=G*G*I+2*G*F*A+F*F*H,q.y=G*G*B+2*G*F*R+F*F*W}function n(I,B,A,R,H,W,F,q,G,N){var te=1-G;N.x=te*te*te*I+3*te*te*G*A+3*te*G*G*H+G*G*G*F,N.y=te*te*te*B+3*te*te*G*R+3*te*G*G*W+G*G*G*q}function s(I,B){for(var A=/([MLQCZ])([^MLQCZ]*)/g,R,H,W,F,q;R=A.exec(I);){var G=R[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(N){return parseFloat(N)});switch(R[1]){case"M":F=H=G[0],q=W=G[1];break;case"L":(G[0]!==F||G[1]!==q)&&B("L",F,q,F=G[0],q=G[1]);break;case"Q":{B("Q",F,q,F=G[2],q=G[3],G[0],G[1]);break}case"C":{B("C",F,q,F=G[4],q=G[5],G[0],G[1],G[2],G[3]);break}case"Z":(F!==H||q!==W)&&B("L",F,q,H,W);break}}}function i(I,B,A){A===void 0&&(A=16);var R={x:0,y:0};s(I,function(H,W,F,q,G,N,te,re,ne){switch(H){case"L":B(W,F,q,G);break;case"Q":{for(var Z=W,Te=F,ve=1;ve<A;ve++)t(W,F,N,te,q,G,ve/(A-1),R),B(Z,Te,R.x,R.y),Z=R.x,Te=R.y;break}case"C":{for(var L=W,X=F,oe=1;oe<A;oe++)n(W,F,N,te,re,ne,q,G,oe/(A-1),R),B(L,X,R.x,R.y),L=R.x,X=R.y;break}}})}var o="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",a="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",c=new WeakMap,l={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function u(I,B){var A=I.getContext?I.getContext("webgl",l):I,R=c.get(A);if(!R){let te=function(L){var X=W[L];if(!X&&(X=W[L]=A.getExtension(L),!X))throw new Error(L+" not supported");return X},re=function(L,X){var oe=A.createShader(X);return A.shaderSource(oe,L),A.compileShader(oe),oe},ne=function(L,X,oe,j){if(!F[L]){var $={},ee={},Y=A.createProgram();A.attachShader(Y,re(X,A.VERTEX_SHADER)),A.attachShader(Y,re(oe,A.FRAGMENT_SHADER)),A.linkProgram(Y),F[L]={program:Y,transaction:function(se){A.useProgram(Y),se({setUniform:function(ie,ke){for(var De=[],ue=arguments.length-2;ue-- >0;)De[ue]=arguments[ue+2];var xe=ee[ke]||(ee[ke]=A.getUniformLocation(Y,ke));A["uniform"+ie].apply(A,[xe].concat(De))},setAttribute:function(ie,ke,De,ue,xe){var Me=$[ie];Me||(Me=$[ie]={buf:A.createBuffer(),loc:A.getAttribLocation(Y,ie),data:null}),A.bindBuffer(A.ARRAY_BUFFER,Me.buf),A.vertexAttribPointer(Me.loc,ke,A.FLOAT,!1,0,0),A.enableVertexAttribArray(Me.loc),H?A.vertexAttribDivisor(Me.loc,ue):te("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(Me.loc,ue),xe!==Me.data&&(A.bufferData(A.ARRAY_BUFFER,xe,De),Me.data=xe)}})}}}F[L].transaction(j)},Z=function(L,X){G++;try{A.activeTexture(A.TEXTURE0+G);var oe=q[L];oe||(oe=q[L]=A.createTexture(),A.bindTexture(A.TEXTURE_2D,oe),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,A.NEAREST),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,A.NEAREST)),A.bindTexture(A.TEXTURE_2D,oe),X(oe,G)}finally{G--}},Te=function(L,X,oe){var j=A.createFramebuffer();N.push(j),A.bindFramebuffer(A.FRAMEBUFFER,j),A.activeTexture(A.TEXTURE0+X),A.bindTexture(A.TEXTURE_2D,L),A.framebufferTexture2D(A.FRAMEBUFFER,A.COLOR_ATTACHMENT0,A.TEXTURE_2D,L,0);try{oe(j)}finally{A.deleteFramebuffer(j),A.bindFramebuffer(A.FRAMEBUFFER,N[--N.length-1]||null)}},ve=function(){W={},F={},q={},G=-1,N.length=0};var H=typeof WebGL2RenderingContext<"u"&&A instanceof WebGL2RenderingContext,W={},F={},q={},G=-1,N=[];A.canvas.addEventListener("webglcontextlost",function(L){ve(),L.preventDefault()},!1),c.set(A,R={gl:A,isWebGL2:H,getExtension:te,withProgram:ne,withTexture:Z,withTextureFramebuffer:Te,handleContextLoss:ve})}B(R)}function h(I,B,A,R,H,W,F,q){F===void 0&&(F=15),q===void 0&&(q=null),u(I,function(G){var N=G.gl,te=G.withProgram,re=G.withTexture;re("copy",function(ne,Z){N.texImage2D(N.TEXTURE_2D,0,N.RGBA,H,W,0,N.RGBA,N.UNSIGNED_BYTE,B),te("copy",o,a,function(Te){var ve=Te.setUniform,L=Te.setAttribute;L("aUV",2,N.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),ve("1i","image",Z),N.bindFramebuffer(N.FRAMEBUFFER,q||null),N.disable(N.BLEND),N.colorMask(F&8,F&4,F&2,F&1),N.viewport(A,R,H,W),N.scissor(A,R,H,W),N.drawArrays(N.TRIANGLES,0,3)})})})}function d(I,B,A){var R=I.width,H=I.height;u(I,function(W){var F=W.gl,q=new Uint8Array(R*H*4);F.readPixels(0,0,R,H,F.RGBA,F.UNSIGNED_BYTE,q),I.width=B,I.height=A,h(F,q,0,0,R,H)})}var f=Object.freeze({__proto__:null,withWebGLContext:u,renderImageData:h,resizeWebGLCanvasWithoutClearing:d});function m(I,B,A,R,H,W){W===void 0&&(W=1);var F=new Uint8Array(I*B),q=R[2]-R[0],G=R[3]-R[1],N=[];i(A,function(L,X,oe,j){N.push({x1:L,y1:X,x2:oe,y2:j,minX:Math.min(L,oe),minY:Math.min(X,j),maxX:Math.max(L,oe),maxY:Math.max(X,j)})}),N.sort(function(L,X){return L.maxX-X.maxX});for(var te=0;te<I;te++)for(var re=0;re<B;re++){var ne=Te(R[0]+q*(te+.5)/I,R[1]+G*(re+.5)/B),Z=Math.pow(1-Math.abs(ne)/H,W)/2;ne<0&&(Z=1-Z),Z=Math.max(0,Math.min(255,Math.round(Z*255))),F[re*I+te]=Z}return F;function Te(L,X){for(var oe=1/0,j=1/0,$=N.length;$--;){var ee=N[$];if(ee.maxX+j<=L)break;if(L+j>ee.minX&&X-j<ee.maxY&&X+j>ee.minY){var Y=T(L,X,ee.x1,ee.y1,ee.x2,ee.y2);Y<oe&&(oe=Y,j=Math.sqrt(oe))}}return ve(L,X)&&(j=-j),j}function ve(L,X){for(var oe=0,j=N.length;j--;){var $=N[j];if($.maxX<=L)break;var ee=$.y1>X!=$.y2>X&&L<($.x2-$.x1)*(X-$.y1)/($.y2-$.y1)+$.x1;ee&&(oe+=$.y1<$.y2?1:-1)}return oe!==0}}function p(I,B,A,R,H,W,F,q,G,N){W===void 0&&(W=1),q===void 0&&(q=0),G===void 0&&(G=0),N===void 0&&(N=0),_(I,B,A,R,H,W,F,null,q,G,N)}function _(I,B,A,R,H,W,F,q,G,N,te){W===void 0&&(W=1),G===void 0&&(G=0),N===void 0&&(N=0),te===void 0&&(te=0);for(var re=m(I,B,A,R,H,W),ne=new Uint8Array(re.length*4),Z=0;Z<re.length;Z++)ne[Z*4+te]=re[Z];h(F,ne,G,N,I,B,1<<3-te,q)}function T(I,B,A,R,H,W){var F=H-A,q=W-R,G=F*F+q*q,N=G?Math.max(0,Math.min(1,((I-A)*F+(B-R)*q)/G)):0,te=I-(A+N*F),re=B-(R+N*q);return te*te+re*re}var y=Object.freeze({__proto__:null,generate:m,generateIntoCanvas:p,generateIntoFramebuffer:_}),b="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",v="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",g="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",x=new Float32Array([0,0,2,0,0,2]),w=null,S=!1,C={},O=new WeakMap;function k(I){if(!S&&!U(I))throw new Error("WebGL generation not supported")}function E(I,B,A,R,H,W,F){if(W===void 0&&(W=1),F===void 0&&(F=null),!F&&(F=w,!F)){var q=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!q)throw new Error("OffscreenCanvas or DOM canvas not supported");F=w=q.getContext("webgl",{depth:!1})}k(F);var G=new Uint8Array(I*B*4);u(F,function(ne){var Z=ne.gl,Te=ne.withTexture,ve=ne.withTextureFramebuffer;Te("readable",function(L,X){Z.texImage2D(Z.TEXTURE_2D,0,Z.RGBA,I,B,0,Z.RGBA,Z.UNSIGNED_BYTE,null),ve(L,X,function(oe){M(I,B,A,R,H,W,Z,oe,0,0,0),Z.readPixels(0,0,I,B,Z.RGBA,Z.UNSIGNED_BYTE,G)})})});for(var N=new Uint8Array(I*B),te=0,re=0;te<G.length;te+=4)N[re++]=G[te];return N}function D(I,B,A,R,H,W,F,q,G,N){W===void 0&&(W=1),q===void 0&&(q=0),G===void 0&&(G=0),N===void 0&&(N=0),M(I,B,A,R,H,W,F,null,q,G,N)}function M(I,B,A,R,H,W,F,q,G,N,te){W===void 0&&(W=1),G===void 0&&(G=0),N===void 0&&(N=0),te===void 0&&(te=0),k(F);var re=[];i(A,function(ne,Z,Te,ve){re.push(ne,Z,Te,ve)}),re=new Float32Array(re),u(F,function(ne){var Z=ne.gl,Te=ne.isWebGL2,ve=ne.getExtension,L=ne.withProgram,X=ne.withTexture,oe=ne.withTextureFramebuffer,j=ne.handleContextLoss;if(X("rawDistances",function($,ee){(I!==$._lastWidth||B!==$._lastHeight)&&Z.texImage2D(Z.TEXTURE_2D,0,Z.RGBA,$._lastWidth=I,$._lastHeight=B,0,Z.RGBA,Z.UNSIGNED_BYTE,null),L("main",b,v,function(Y){var ae=Y.setAttribute,se=Y.setUniform,ce=!Te&&ve("ANGLE_instanced_arrays"),ie=!Te&&ve("EXT_blend_minmax");ae("aUV",2,Z.STATIC_DRAW,0,x),ae("aLineSegment",4,Z.DYNAMIC_DRAW,1,re),se.apply(void 0,["4f","uGlyphBounds"].concat(R)),se("1f","uMaxDistance",H),se("1f","uExponent",W),oe($,ee,function(ke){Z.enable(Z.BLEND),Z.colorMask(!0,!0,!0,!0),Z.viewport(0,0,I,B),Z.scissor(0,0,I,B),Z.blendFunc(Z.ONE,Z.ONE),Z.blendEquationSeparate(Z.FUNC_ADD,Te?Z.MAX:ie.MAX_EXT),Z.clear(Z.COLOR_BUFFER_BIT),Te?Z.drawArraysInstanced(Z.TRIANGLES,0,3,re.length/4):ce.drawArraysInstancedANGLE(Z.TRIANGLES,0,3,re.length/4)})}),L("post",o,g,function(Y){Y.setAttribute("aUV",2,Z.STATIC_DRAW,0,x),Y.setUniform("1i","tex",ee),Z.bindFramebuffer(Z.FRAMEBUFFER,q),Z.disable(Z.BLEND),Z.colorMask(te===0,te===1,te===2,te===3),Z.viewport(G,N,I,B),Z.scissor(G,N,I,B),Z.drawArrays(Z.TRIANGLES,0,3)})}),Z.isContextLost())throw j(),new Error("webgl context lost")})}function U(I){var B=!I||I===w?C:I.canvas||I,A=O.get(B);if(A===void 0){S=!0;var R=null;try{var H=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],W=E(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,I);A=W&&H.length===W.length&&W.every(function(F,q){return F===H[q]}),A||(R="bad trial run results",console.info(H,W))}catch(F){A=!1,R=F.message}R&&console.warn("WebGL SDF generation not supported:",R),S=!1,O.set(B,A)}return A}var P=Object.freeze({__proto__:null,generate:E,generateIntoCanvas:D,generateIntoFramebuffer:M,isSupported:U});function V(I,B,A,R,H,W){H===void 0&&(H=Math.max(R[2]-R[0],R[3]-R[1])/2),W===void 0&&(W=1);try{return E.apply(P,arguments)}catch(F){return console.info("WebGL SDF generation failed, falling back to JS",F),m.apply(y,arguments)}}function Q(I,B,A,R,H,W,F,q,G,N){H===void 0&&(H=Math.max(R[2]-R[0],R[3]-R[1])/2),W===void 0&&(W=1),q===void 0&&(q=0),G===void 0&&(G=0),N===void 0&&(N=0);try{return D.apply(P,arguments)}catch(te){return console.info("WebGL SDF generation failed, falling back to JS",te),p.apply(y,arguments)}}return e.forEachPathCommand=s,e.generate=V,e.generateIntoCanvas=Q,e.javascript=y,e.pathToLineSegments=i,e.webgl=P,e.webglUtils=f,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return r}function Km(){var r=function(e){var t={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},n={},s={};n.L=1,s[1]="L",Object.keys(t).forEach(function(j,$){n[j]=1<<$+1,s[n[j]]=j}),Object.freeze(n);var i=n.LRI|n.RLI|n.FSI,o=n.L|n.R|n.AL,a=n.B|n.S|n.WS|n.ON|n.FSI|n.LRI|n.RLI|n.PDI,c=n.BN|n.RLE|n.LRE|n.RLO|n.LRO|n.PDF,l=n.S|n.WS|n.B|i|n.PDI|c,u=null;function h(){if(!u){u=new Map;var j=function(ee){if(t.hasOwnProperty(ee)){var Y=0;t[ee].split(",").forEach(function(ae){var se=ae.split("+"),ce=se[0],ie=se[1];ce=parseInt(ce,36),ie=ie?parseInt(ie,36):0,u.set(Y+=ce,n[ee]);for(var ke=0;ke<ie;ke++)u.set(++Y,n[ee])})}};for(var $ in t)j($)}}function d(j){return h(),u.get(j.codePointAt(0))||n.L}function f(j){return s[d(j)]}var m={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function p(j,$){var ee=36,Y=0,ae=new Map,se=$&&new Map,ce;return j.split(",").forEach(function ie(ke){if(ke.indexOf("+")!==-1)for(var De=+ke;De--;)ie(ce);else{ce=ke;var ue=ke.split(">"),xe=ue[0],Me=ue[1];xe=String.fromCodePoint(Y+=parseInt(xe,ee)),Me=String.fromCodePoint(Y+=parseInt(Me,ee)),ae.set(xe,Me),$&&se.set(Me,xe)}}),{map:ae,reverseMap:se}}var _,T,y;function b(){if(!_){var j=p(m.pairs,!0),$=j.map,ee=j.reverseMap;_=$,T=ee,y=p(m.canonical,!1).map}}function v(j){return b(),_.get(j)||null}function g(j){return b(),T.get(j)||null}function x(j){return b(),y.get(j)||null}var w=n.L,S=n.R,C=n.EN,O=n.ES,k=n.ET,E=n.AN,D=n.CS,M=n.B,U=n.S,P=n.ON,V=n.BN,Q=n.NSM,I=n.AL,B=n.LRO,A=n.RLO,R=n.LRE,H=n.RLE,W=n.PDF,F=n.LRI,q=n.RLI,G=n.FSI,N=n.PDI;function te(j,$){for(var ee=125,Y=new Uint32Array(j.length),ae=0;ae<j.length;ae++)Y[ae]=d(j[ae]);var se=new Map;function ce(Bt,xn){var zt=Y[Bt];Y[Bt]=xn,se.set(zt,se.get(zt)-1),zt&a&&se.set(a,se.get(a)-1),se.set(xn,(se.get(xn)||0)+1),xn&a&&se.set(a,(se.get(a)||0)+1)}for(var ie=new Uint8Array(j.length),ke=new Map,De=[],ue=null,xe=0;xe<j.length;xe++)ue||De.push(ue={start:xe,end:j.length-1,level:$==="rtl"?1:$==="ltr"?0:$u(xe,!1)}),Y[xe]&M&&(ue.end=xe,ue=null);for(var Me=H|R|A|B|i|N|W|M,pt=function(Bt){return Bt+(Bt&1?1:2)},ye=function(Bt){return Bt+(Bt&1?2:1)},Ye=0;Ye<De.length;Ye++){ue=De[Ye];var be=[{_level:ue.level,_override:0,_isolate:0}],pe=void 0,Pe=0,Ge=0,mt=0;se.clear();for(var Se=ue.start;Se<=ue.end;Se++){var Je=Y[Se];if(pe=be[be.length-1],se.set(Je,(se.get(Je)||0)+1),Je&a&&se.set(a,(se.get(a)||0)+1),Je&Me)if(Je&(H|R)){ie[Se]=pe._level;var Rt=(Je===H?ye:pt)(pe._level);Rt<=ee&&!Pe&&!Ge?be.push({_level:Rt,_override:0,_isolate:0}):Pe||Ge++}else if(Je&(A|B)){ie[Se]=pe._level;var Yn=(Je===A?ye:pt)(pe._level);Yn<=ee&&!Pe&&!Ge?be.push({_level:Yn,_override:Je&A?S:w,_isolate:0}):Pe||Ge++}else if(Je&i){Je&G&&(Je=$u(Se+1,!0)===1?q:F),ie[Se]=pe._level,pe._override&&ce(Se,pe._override);var Bs=(Je===q?ye:pt)(pe._level);Bs<=ee&&Pe===0&&Ge===0?(mt++,be.push({_level:Bs,_override:0,_isolate:1,_isolInitIndex:Se})):Pe++}else if(Je&N){if(Pe>0)Pe--;else if(mt>0){for(Ge=0;!be[be.length-1]._isolate;)be.pop();var fs=be[be.length-1]._isolInitIndex;fs!=null&&(ke.set(fs,Se),ke.set(Se,fs)),be.pop(),mt--}pe=be[be.length-1],ie[Se]=pe._level,pe._override&&ce(Se,pe._override)}else Je&W?(Pe===0&&(Ge>0?Ge--:!pe._isolate&&be.length>1&&(be.pop(),pe=be[be.length-1])),ie[Se]=pe._level):Je&M&&(ie[Se]=ue.level);else ie[Se]=pe._level,pe._override&&Je!==V&&ce(Se,pe._override)}for(var an=[],Qt=null,nt=ue.start;nt<=ue.end;nt++){var ar=Y[nt];if(!(ar&c)){var at=ie[nt],st=ar&i,vn=ar===N;Qt&&at===Qt._level?(Qt._end=nt,Qt._endsWithIsolInit=st):an.push(Qt={_start:nt,_end:nt,_level:at,_startsWithPDI:vn,_endsWithIsolInit:st})}}for(var Kt=[],Le=0;Le<an.length;Le++){var St=an[Le];if(!St._startsWithPDI||St._startsWithPDI&&!ke.has(St._start)){for(var cn=[Qt=St],Et=void 0;Qt&&Qt._endsWithIsolInit&&(Et=ke.get(Qt._end))!=null;)for(var vt=Le+1;vt<an.length;vt++)if(an[vt]._start===Et){cn.push(Qt=an[vt]);break}for(var Pt=[],ps=0;ps<cn.length;ps++)for(var yn=cn[ps],zs=yn._start;zs<=yn._end;zs++)Pt.push(zs);for(var $p=ie[Pt[0]],Uu=ue.level,ko=Pt[0]-1;ko>=0;ko--)if(!(Y[ko]&c)){Uu=ie[ko];break}var uc=Pt[Pt.length-1],em=ie[uc],Iu=ue.level;if(!(Y[uc]&i)){for(var Do=uc+1;Do<=ue.end;Do++)if(!(Y[Do]&c)){Iu=ie[Do];break}}Kt.push({_seqIndices:Pt,_sosType:Math.max(Uu,$p)%2?S:w,_eosType:Math.max(Iu,em)%2?S:w})}}for(var hc=0;hc<Kt.length;hc++){var dc=Kt[hc],le=dc._seqIndices,cr=dc._sosType,tm=dc._eosType,mi=ie[le[0]]&1?S:w;if(se.get(Q))for(var Mo=0;Mo<le.length;Mo++){var Fu=le[Mo];if(Y[Fu]&Q){for(var fc=cr,Ro=Mo-1;Ro>=0;Ro--)if(!(Y[le[Ro]]&c)){fc=Y[le[Ro]];break}ce(Fu,fc&(i|N)?P:fc)}}if(se.get(C))for(var Po=0;Po<le.length;Po++){var Nu=le[Po];if(Y[Nu]&C)for(var Uo=Po-1;Uo>=-1;Uo--){var Lu=Uo===-1?cr:Y[le[Uo]];if(Lu&o){Lu===I&&ce(Nu,E);break}}}if(se.get(I))for(var pc=0;pc<le.length;pc++){var Bu=le[pc];Y[Bu]&I&&ce(Bu,S)}if(se.get(O)||se.get(D))for(var lr=1;lr<le.length-1;lr++){var mc=le[lr];if(Y[mc]&(O|D)){for(var _i=0,_c=0,gc=lr-1;gc>=0&&(_i=Y[le[gc]],!!(_i&c));gc--);for(var vc=lr+1;vc<le.length&&(_c=Y[le[vc]],!!(_c&c));vc++);_i===_c&&(Y[mc]===O?_i===C:_i&(C|E))&&ce(mc,_i)}}if(se.get(C))for(var Un=0;Un<le.length;Un++){var nm=le[Un];if(Y[nm]&C){for(var Io=Un-1;Io>=0&&Y[le[Io]]&(k|c);Io--)ce(le[Io],C);for(Un++;Un<le.length&&Y[le[Un]]&(k|c|C);Un++)Y[le[Un]]!==C&&ce(le[Un],C)}}if(se.get(k)||se.get(O)||se.get(D))for(var ur=0;ur<le.length;ur++){var zu=le[ur];if(Y[zu]&(k|O|D)){ce(zu,P);for(var Fo=ur-1;Fo>=0&&Y[le[Fo]]&c;Fo--)ce(le[Fo],P);for(var No=ur+1;No<le.length&&Y[le[No]]&c;No++)ce(le[No],P)}}if(se.get(C))for(var yc=0,Vu=cr;yc<le.length;yc++){var Gu=le[yc],Tc=Y[Gu];Tc&C?Vu===w&&ce(Gu,w):Tc&o&&(Vu=Tc)}if(se.get(a)){var hr=S|C|E,Wu=hr|w,Lo=[];{for(var gi=[],vi=0;vi<le.length;vi++)if(Y[le[vi]]&a){var dr=j[le[vi]],Hu=void 0;if(v(dr)!==null)if(gi.length<63)gi.push({char:dr,seqIndex:vi});else break;else if((Hu=g(dr))!==null)for(var fr=gi.length-1;fr>=0;fr--){var xc=gi[fr].char;if(xc===Hu||xc===g(x(dr))||v(x(xc))===dr){Lo.push([gi[fr].seqIndex,vi]),gi.length=fr;break}}}Lo.sort(function(Bt,xn){return Bt[0]-xn[0]})}for(var wc=0;wc<Lo.length;wc++){for(var qu=Lo[wc],Bo=qu[0],Sc=qu[1],ju=!1,Tn=0,bc=Bo+1;bc<Sc;bc++){var Yu=le[bc];if(Y[Yu]&Wu){ju=!0;var Xu=Y[Yu]&hr?S:w;if(Xu===mi){Tn=Xu;break}}}if(ju&&!Tn){Tn=cr;for(var Cc=Bo-1;Cc>=0;Cc--){var Zu=le[Cc];if(Y[Zu]&Wu){var Qu=Y[Zu]&hr?S:w;Qu!==mi?Tn=Qu:Tn=mi;break}}}if(Tn){if(Y[le[Bo]]=Y[le[Sc]]=Tn,Tn!==mi){for(var pr=Bo+1;pr<le.length;pr++)if(!(Y[le[pr]]&c)){d(j[le[pr]])&Q&&(Y[le[pr]]=Tn);break}}if(Tn!==mi){for(var mr=Sc+1;mr<le.length;mr++)if(!(Y[le[mr]]&c)){d(j[le[mr]])&Q&&(Y[le[mr]]=Tn);break}}}}for(var ms=0;ms<le.length;ms++)if(Y[le[ms]]&a){for(var Ku=ms,Ec=ms,Oc=cr,_r=ms-1;_r>=0;_r--)if(Y[le[_r]]&c)Ku=_r;else{Oc=Y[le[_r]]&hr?S:w;break}for(var Ju=tm,gr=ms+1;gr<le.length;gr++)if(Y[le[gr]]&(a|c))Ec=gr;else{Ju=Y[le[gr]]&hr?S:w;break}for(var Ac=Ku;Ac<=Ec;Ac++)Y[le[Ac]]=Oc===Ju?Oc:mi;ms=Ec}}}for(var Jt=ue.start;Jt<=ue.end;Jt++){var sm=ie[Jt],zo=Y[Jt];if(sm&1?zo&(w|C|E)&&ie[Jt]++:zo&S?ie[Jt]++:zo&(E|C)&&(ie[Jt]+=2),zo&c&&(ie[Jt]=Jt===0?ue.level:ie[Jt-1]),Jt===ue.end||d(j[Jt])&(U|M))for(var Vo=Jt;Vo>=0&&d(j[Vo])&l;Vo--)ie[Vo]=ue.level}}return{levels:ie,paragraphs:De};function $u(Bt,xn){for(var zt=Bt;zt<j.length;zt++){var _s=Y[zt];if(_s&(S|I))return 1;if(_s&(M|w)||xn&&_s===N)return 0;if(_s&i){var eh=im(zt);zt=eh===-1?j.length:eh}}return 0}function im(Bt){for(var xn=1,zt=Bt+1;zt<j.length;zt++){var _s=Y[zt];if(_s&M)break;if(_s&N){if(--xn===0)return zt}else _s&i&&xn++}return-1}}var re="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",ne;function Z(){if(!ne){var j=p(re,!0),$=j.map,ee=j.reverseMap;ee.forEach(function(Y,ae){$.set(ae,Y)}),ne=$}}function Te(j){return Z(),ne.get(j)||null}function ve(j,$,ee,Y){var ae=j.length;ee=Math.max(0,ee==null?0:+ee),Y=Math.min(ae-1,Y==null?ae-1:+Y);for(var se=new Map,ce=ee;ce<=Y;ce++)if($[ce]&1){var ie=Te(j[ce]);ie!==null&&se.set(ce,ie)}return se}function L(j,$,ee,Y){var ae=j.length;ee=Math.max(0,ee==null?0:+ee),Y=Math.min(ae-1,Y==null?ae-1:+Y);var se=[];return $.paragraphs.forEach(function(ce){var ie=Math.max(ee,ce.start),ke=Math.min(Y,ce.end);if(ie<ke){for(var De=$.levels.slice(ie,ke+1),ue=ke;ue>=ie&&d(j[ue])&l;ue--)De[ue]=ce.level;for(var xe=ce.level,Me=1/0,pt=0;pt<De.length;pt++){var ye=De[pt];ye>xe&&(xe=ye),ye<Me&&(Me=ye|1)}for(var Ye=xe;Ye>=Me;Ye--)for(var be=0;be<De.length;be++)if(De[be]>=Ye){for(var pe=be;be+1<De.length&&De[be+1]>=Ye;)be++;be>pe&&se.push([pe+ie,be+ie])}}}),se}function X(j,$,ee,Y){var ae=oe(j,$,ee,Y),se=[].concat(j);return ae.forEach(function(ce,ie){se[ie]=($.levels[ce]&1?Te(j[ce]):null)||j[ce]}),se.join("")}function oe(j,$,ee,Y){for(var ae=L(j,$,ee,Y),se=[],ce=0;ce<j.length;ce++)se[ce]=ce;return ae.forEach(function(ie){for(var ke=ie[0],De=ie[1],ue=se.slice(ke,De+1),xe=ue.length;xe--;)se[De-xe]=ue[xe]}),se}return e.closingToOpeningBracket=g,e.getBidiCharType=d,e.getBidiCharTypeName=f,e.getCanonicalBracket=x,e.getEmbeddingLevels=te,e.getMirroredCharacter=Te,e.getMirroredCharactersMap=ve,e.getReorderSegments=L,e.getReorderedIndices=oe,e.getReorderedString=X,e.openingToClosingBracket=v,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return r}const Ed=/\bvoid\s+main\s*\(\s*\)\s*{/g;function sl(r){const e=/^[ \t]*#include +<([\w\d./]+)>/gm;function t(n,s){let i=cm[s];return i?sl(i):n}return r.replace(e,t)}const bt=[];for(let r=0;r<256;r++)bt[r]=(r<16?"0":"")+r.toString(16);function Jm(){const r=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(bt[r&255]+bt[r>>8&255]+bt[r>>16&255]+bt[r>>24&255]+"-"+bt[e&255]+bt[e>>8&255]+"-"+bt[e>>16&15|64]+bt[e>>24&255]+"-"+bt[t&63|128]+bt[t>>8&255]+"-"+bt[t>>16&255]+bt[t>>24&255]+bt[n&255]+bt[n>>8&255]+bt[n>>16&255]+bt[n>>24&255]).toUpperCase()}const Vs=Object.assign||function(){let r=arguments[0];for(let e=1,t=arguments.length;e<t;e++){let n=arguments[e];if(n)for(let s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])}return r},$m=Date.now(),ih=new WeakMap,rh=new Map;let e_=1e10;function il(r,e){const t=i_(e);let n=ih.get(r);if(n||ih.set(r,n=Object.create(null)),n[t])return new n[t];const s=`_onBeforeCompile${t}`,i=function(l,u){r.onBeforeCompile.call(this,l,u);const h=this.customProgramCacheKey()+"|"+l.vertexShader+"|"+l.fragmentShader;let d=rh[h];if(!d){const f=t_(this,l,e,t);d=rh[h]=f}l.vertexShader=d.vertexShader,l.fragmentShader=d.fragmentShader,Vs(l.uniforms,this.uniforms),e.timeUniform&&(l.uniforms[e.timeUniform]={get value(){return Date.now()-$m}}),this[s]&&this[s](l)},o=function(){return a(e.chained?r:r.clone())},a=function(l){const u=Object.create(l,c);return Object.defineProperty(u,"baseMaterial",{value:r}),Object.defineProperty(u,"id",{value:e_++}),u.uuid=Jm(),u.uniforms=Vs({},l.uniforms,e.uniforms),u.defines=Vs({},l.defines,e.defines),u.defines[`TROIKA_DERIVED_MATERIAL_${t}`]="",u.extensions=Vs({},l.extensions,e.extensions),u._listeners=void 0,u},c={constructor:{value:o},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return r.customProgramCacheKey()+"|"+t}},onBeforeCompile:{get(){return i},set(l){this[s]=l}},copy:{writable:!0,configurable:!0,value:function(l){return r.copy.call(this,l),!r.isShaderMaterial&&!r.isDerivedMaterial&&(Vs(this.extensions,l.extensions),Vs(this.defines,l.defines),Vs(this.uniforms,om.clone(l.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const l=new r.constructor;return a(l).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let l=this._depthMaterial;return l||(l=this._depthMaterial=il(r.isDerivedMaterial?r.getDepthMaterial():new gd({depthPacking:da}),e),l.defines.IS_DEPTH_MATERIAL="",l.uniforms=this.uniforms),l}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let l=this._distanceMaterial;return l||(l=this._distanceMaterial=il(r.isDerivedMaterial?r.getDistanceMaterial():new am,e),l.defines.IS_DISTANCE_MATERIAL="",l.uniforms=this.uniforms),l}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:l,_distanceMaterial:u}=this;l&&l.dispose(),u&&u.dispose(),r.dispose.call(this)}}};return n[t]=o,new o}function t_(r,{vertexShader:e,fragmentShader:t},n,s){let{vertexDefs:i,vertexMainIntro:o,vertexMainOutro:a,vertexTransform:c,fragmentDefs:l,fragmentMainIntro:u,fragmentMainOutro:h,fragmentColorTransform:d,customRewriter:f,timeUniform:m}=n;if(i=i||"",o=o||"",a=a||"",l=l||"",u=u||"",h=h||"",(c||f)&&(e=sl(e)),(d||f)&&(t=t.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),t=sl(t)),f){let p=f({vertexShader:e,fragmentShader:t});e=p.vertexShader,t=p.fragmentShader}if(d){let p=[];t=t.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,_=>(p.push(_),"")),h=`${d}
${p.join(`
`)}
${h}`}if(m){const p=`
uniform float ${m};
`;i=p+i,l=p+l}return c&&(e=`vec3 troika_position_${s};
vec3 troika_normal_${s};
vec2 troika_uv_${s};
${e}
`,i=`${i}
void troikaVertexTransform${s}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${c}
}
`,o=`
troika_position_${s} = vec3(position);
troika_normal_${s} = vec3(normal);
troika_uv_${s} = vec2(uv);
troikaVertexTransform${s}(troika_position_${s}, troika_normal_${s}, troika_uv_${s});
${o}
`,e=e.replace(/\b(position|normal|uv)\b/g,(p,_,T,y)=>/\battribute\s+vec[23]\s+$/.test(y.substr(0,T))?_:`troika_${_}_${s}`),r.map&&r.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${s}`))),e=oh(e,s,i,o,a),t=oh(t,s,l,u,h),{vertexShader:e,fragmentShader:t}}function oh(r,e,t,n,s){return(n||s||t)&&(r=r.replace(Ed,`
${t}
void troikaOrigMain${e}() {`),r+=`
void main() {
  ${n}
  troikaOrigMain${e}();
  ${s}
}`),r}function n_(r,e){return r==="uniforms"?void 0:typeof e=="function"?e.toString():e}let s_=0;const ah=new Map;function i_(r){const e=JSON.stringify(r,n_);let t=ah.get(e);return t==null&&ah.set(e,t=++s_),t}function r_(r,e,t){const{defaultFontURL:n}=t,s=Object.create(null),i=1/0,o=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,a="[^\\S\\u00A0]",c=new RegExp(`${a}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function l(y,b){function v(){const g=x=>{console.error(`Failure loading font ${y}${y===n?"":"; trying fallback"}`,x),y!==n&&(y=n,v())};try{const x=new XMLHttpRequest;x.open("get",y,!0),x.responseType="arraybuffer",x.onload=function(){if(x.status>=400)g(new Error(x.statusText));else if(x.status>0)try{const w=r(x.response);b(w)}catch(w){g(w)}},x.onerror=g,x.send()}catch(x){g(x)}}v()}function u(y,b){y||(y=n);let v=s[y];v?v.pending?v.pending.push(b):b(v):(s[y]={pending:[b]},l(y,g=>{let x=s[y].pending;s[y]=g,x.forEach(w=>w(g))}))}function h({text:y="",font:b=n,sdfGlyphSize:v=64,fontSize:g=1,letterSpacing:x=0,lineHeight:w="normal",maxWidth:S=i,direction:C,textAlign:O="left",textIndent:k=0,whiteSpace:E="normal",overflowWrap:D="normal",anchorX:M=0,anchorY:U=0,includeCaretPositions:P=!1,chunkedBoundsSize:V=8192,colorRanges:Q=null},I,B=!1){const A=p(),R={fontLoad:0,typesetting:0};y.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),y=y.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),g=+g,x=+x,S=+S,w=w||"normal",k=+k,u(b,H=>{const W=isFinite(S);let F=null,q=null,G=null,N=null,te=null,re=null,ne=null,Z=0,Te=0,ve=E!=="nowrap";const{ascender:L,descender:X,unitsPerEm:oe,lineGap:j,capHeight:$,xHeight:ee}=H;R.fontLoad=p()-A;const Y=p(),ae=g/oe;w==="normal"&&(w=(L-X+j)/oe),w=w*g;const se=(w-(L-X)*ae)/2,ce=-(L*ae+se),ie=Math.min(w,(L-X)*ae),ke=(L+X)/2*ae-ie/2;let De=k,ue=new _;const xe=[ue];H.forEachGlyph(y,g,x,(ye,Ye,be)=>{const pe=y.charAt(be),Pe=ye.advanceWidth*ae,Ge=ue.count;let mt;if("isEmpty"in ye||(ye.isWhitespace=!!pe&&new RegExp(a).test(pe),ye.canBreakAfter=!!pe&&c.test(pe),ye.isEmpty=ye.xMin===ye.xMax||ye.yMin===ye.yMax||o.test(pe)),!ye.isWhitespace&&!ye.isEmpty&&Te++,ve&&W&&!ye.isWhitespace&&Ye+Pe+De>S&&Ge){if(ue.glyphAt(Ge-1).glyphObj.canBreakAfter)mt=new _,De=-Ye;else for(let Je=Ge;Je--;)if(Je===0&&D==="break-word"){mt=new _,De=-Ye;break}else if(ue.glyphAt(Je).glyphObj.canBreakAfter){mt=ue.splitAt(Je+1);const Rt=mt.glyphAt(0).x;De-=Rt;for(let Yn=mt.count;Yn--;)mt.glyphAt(Yn).x-=Rt;break}mt&&(ue.isSoftWrapped=!0,ue=mt,xe.push(ue),Z=S)}let Se=ue.glyphAt(ue.count);Se.glyphObj=ye,Se.x=Ye+De,Se.width=Pe,Se.charIndex=be,pe===`
`&&(ue=new _,xe.push(ue),De=-(Ye+Pe+x*g)+k)}),xe.forEach(ye=>{for(let Ye=ye.count;Ye--;){let{glyphObj:be,x:pe,width:Pe}=ye.glyphAt(Ye);if(!be.isWhitespace){ye.width=pe+Pe,ye.width>Z&&(Z=ye.width);return}}});let Me=0,pt=0;if(M&&(typeof M=="number"?Me=-M:typeof M=="string"&&(Me=-Z*(M==="left"?0:M==="center"?.5:M==="right"?1:f(M)))),U){if(typeof U=="number")pt=-U;else if(typeof U=="string"){let ye=xe.length*w;pt=U==="top"?0:U==="top-baseline"?-ce:U==="top-cap"?-ce-$*ae:U==="top-ex"?-ce-ee*ae:U==="middle"?ye/2:U==="bottom"?ye:U==="bottom-baseline"?ye-se+X*ae:f(U)*ye}}if(!B){const ye=e.getEmbeddingLevels(y,C);F=new Uint16Array(Te),q=new Float32Array(Te*2),G={},re=[i,i,-i,-i],ne=[];let Ye=ce;P&&(te=new Float32Array(y.length*3)),Q&&(N=new Uint8Array(Te*3));let be=0,pe=-1,Pe=-1,Ge,mt;if(xe.forEach((Se,Je)=>{let{count:Rt,width:Yn}=Se;if(Rt>0){let Bs=0;for(let at=Rt;at--&&Se.glyphAt(at).glyphObj.isWhitespace;)Bs++;let fs=0,an=0;if(O==="center")fs=(Z-Yn)/2;else if(O==="right")fs=Z-Yn;else if(O==="justify"&&Se.isSoftWrapped){let at=0;for(let st=Rt-Bs;st--;)Se.glyphAt(st).glyphObj.isWhitespace&&at++;an=(Z-Yn)/at}if(an||fs){let at=0;for(let st=0;st<Rt;st++){let vn=Se.glyphAt(st);const Kt=vn.glyphObj;vn.x+=fs+at,an!==0&&Kt.isWhitespace&&st<Rt-Bs&&(at+=an,vn.width+=an)}}const Qt=e.getReorderSegments(y,ye,Se.glyphAt(0).charIndex,Se.glyphAt(Se.count-1).charIndex);for(let at=0;at<Qt.length;at++){const[st,vn]=Qt[at];let Kt=1/0,Le=-1/0;for(let St=0;St<Rt;St++)if(Se.glyphAt(St).charIndex>=st){let cn=St,Et=St;for(;Et<Rt;Et++){let vt=Se.glyphAt(Et);if(vt.charIndex>vn)break;Et<Rt-Bs&&(Kt=Math.min(Kt,vt.x),Le=Math.max(Le,vt.x+vt.width))}for(let vt=cn;vt<Et;vt++){const Pt=Se.glyphAt(vt);Pt.x=Le-(Pt.x+Pt.width-Kt)}break}}let nt;const ar=at=>nt=at;for(let at=0;at<Rt;at++){let st=Se.glyphAt(at);nt=st.glyphObj;const vn=nt.index,Kt=ye.levels[st.charIndex]&1;if(Kt){const Le=e.getMirroredCharacter(y[st.charIndex]);Le&&H.forEachGlyph(Le,0,0,ar)}if(P){const{charIndex:Le}=st,St=st.x+Me,cn=st.x+st.width+Me;te[Le*3]=Kt?cn:St,te[Le*3+1]=Kt?St:cn,te[Le*3+2]=Ye+ke+pt;const Et=Le-pe;Et>1&&m(te,pe,Et),pe=Le}if(Q){const{charIndex:Le}=st;for(;Le>Pe;)Pe++,Q.hasOwnProperty(Pe)&&(mt=Q[Pe])}if(!nt.isWhitespace&&!nt.isEmpty){const Le=be++;G[vn]||(G[vn]={path:nt.path,pathBounds:[nt.xMin,nt.yMin,nt.xMax,nt.yMax]});const St=st.x+Me,cn=Ye+pt;q[Le*2]=St,q[Le*2+1]=cn;const Et=St+nt.xMin*ae,vt=cn+nt.yMin*ae,Pt=St+nt.xMax*ae,ps=cn+nt.yMax*ae;Et<re[0]&&(re[0]=Et),vt<re[1]&&(re[1]=vt),Pt>re[2]&&(re[2]=Pt),ps>re[3]&&(re[3]=ps),Le%V===0&&(Ge={start:Le,end:Le,rect:[i,i,-i,-i]},ne.push(Ge)),Ge.end++;const yn=Ge.rect;if(Et<yn[0]&&(yn[0]=Et),vt<yn[1]&&(yn[1]=vt),Pt>yn[2]&&(yn[2]=Pt),ps>yn[3]&&(yn[3]=ps),F[Le]=vn,Q){const zs=Le*3;N[zs]=mt>>16&255,N[zs+1]=mt>>8&255,N[zs+2]=mt&255}}}}Ye-=w}),te){const Se=y.length-pe;Se>1&&m(te,pe,Se)}}R.typesetting=p()-Y,I({glyphIds:F,glyphPositions:q,glyphData:G,caretPositions:te,caretHeight:ie,glyphColors:N,chunkedBounds:ne,fontSize:g,unitsPerEm:oe,ascender:L*ae,descender:X*ae,capHeight:$*ae,xHeight:ee*ae,lineHeight:w,topBaseline:ce,blockBounds:[Me,pt-xe.length*w,Me+Z,pt],visibleBounds:re,timings:R})})}function d(y,b){h(y,v=>{const[g,x,w,S]=v.blockBounds;b({width:w-g,height:S-x})},{metricsOnly:!0})}function f(y){let b=y.match(/^([\d.]+)%$/),v=b?parseFloat(b[1]):NaN;return isNaN(v)?0:v/100}function m(y,b,v){const g=y[b*3],x=y[b*3+1],w=y[b*3+2],S=(x-g)/v;for(let C=0;C<v;C++){const O=(b+C)*3;y[O]=g+S*C,y[O+1]=g+S*(C+1),y[O+2]=w}}function p(){return(self.performance||Date).now()}function _(){this.data=[]}const T=["glyphObj","x","width","charIndex"];return _.prototype={width:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/T.length)},glyphAt(y){let b=_.flyweight;return b.data=this.data,b.index=y,b},splitAt(y){let b=new _;return b.data=this.data.splice(y*T.length),b}},_.flyweight=T.reduce((y,b,v,g)=>(Object.defineProperty(y,b,{get(){return this.data[this.index*T.length+v]},set(x){this.data[this.index*T.length+v]=x}}),y),{data:null,index:0}),{typeset:h,measure:d,loadFont:u}}const Ks=()=>(self.performance||Date).now(),Ha=Cd();let ch;function o_(r,e,t,n,s,i,o,a,c,l,u=!0){return u?c_(r,e,t,n,s,i,o,a,c,l).then(null,h=>(ch||(console.warn("WebGL SDF generation failed, falling back to JS",h),ch=!0),uh(r,e,t,n,s,i,o,a,c,l))):uh(r,e,t,n,s,i,o,a,c,l)}const oa=[],a_=5;let rl=0;function Od(){const r=Ks();for(;oa.length&&Ks()-r<a_;)oa.shift()();rl=oa.length?setTimeout(Od,0):0}const c_=(...r)=>new Promise((e,t)=>{oa.push(()=>{const n=Ks();try{Ha.webgl.generateIntoCanvas(...r),e({timing:Ks()-n})}catch(s){t(s)}}),rl||(rl=setTimeout(Od,0))}),l_=4,u_=2e3,lh={};let h_=0;function uh(r,e,t,n,s,i,o,a,c,l){const u="TroikaTextSDFGenerator_JS_"+h_++%l_;let h=lh[u];return h||(h=lh[u]={workerModule:_o({name:u,workerId:u,dependencies:[Cd,Ks],init(d,f){const m=d().javascript.generate;return function(...p){const _=f();return{textureData:m(...p),timing:f()-_}}},getTransferables(d){return[d.textureData.buffer]}}),requests:0,idleTimer:null}),h.requests++,clearTimeout(h.idleTimer),h.workerModule(r,e,t,n,s,i).then(({textureData:d,timing:f})=>{const m=Ks(),p=new Uint8Array(d.length*4);for(let _=0;_<d.length;_++)p[_*4+l]=d[_];return Ha.webglUtils.renderImageData(o,p,a,c,r,e,1<<3-l),f+=Ks()-m,--h.requests===0&&(h.idleTimer=setTimeout(()=>{Zm(u)},u_)),{timing:f}})}function d_(r){r._warm||(Ha.webgl.isSupported(r),r._warm=!0)}const f_=Ha.webglUtils.resizeWebGLCanvasWithoutClearing;/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function p_(){return typeof window>"u"&&(self.window=self),function(r){var e={parse:function(s){var i=e._bin,o=new Uint8Array(s);if(i.readASCII(o,0,4)=="ttcf"){var a=4;i.readUshort(o,a),a+=2,i.readUshort(o,a),a+=2;var c=i.readUint(o,a);a+=4;for(var l=[],u=0;u<c;u++){var h=i.readUint(o,a);a+=4,l.push(e._readFont(o,h))}return l}return[e._readFont(o,0)]},_readFont:function(s,i){var o=e._bin,a=i;o.readFixed(s,i),i+=4;var c=o.readUshort(s,i);i+=2,o.readUshort(s,i),i+=2,o.readUshort(s,i),i+=2,o.readUshort(s,i),i+=2;for(var l=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG "],u={_data:s,_offset:a},h={},d=0;d<c;d++){var f=o.readASCII(s,i,4);i+=4,o.readUint(s,i),i+=4;var m=o.readUint(s,i);i+=4;var p=o.readUint(s,i);i+=4,h[f]={offset:m,length:p}}for(d=0;d<l.length;d++){var _=l[d];h[_]&&(u[_.trim()]=e[_.trim()].parse(s,h[_].offset,h[_].length,u))}return u},_tabOffset:function(s,i,o){for(var a=e._bin,c=a.readUshort(s,o+4),l=o+12,u=0;u<c;u++){var h=a.readASCII(s,l,4);l+=4,a.readUint(s,l),l+=4;var d=a.readUint(s,l);if(l+=4,a.readUint(s,l),l+=4,h==i)return d}return 0}};e._bin={readFixed:function(s,i){return(s[i]<<8|s[i+1])+(s[i+2]<<8|s[i+3])/65540},readF2dot14:function(s,i){return e._bin.readShort(s,i)/16384},readInt:function(s,i){return e._bin._view(s).getInt32(i)},readInt8:function(s,i){return e._bin._view(s).getInt8(i)},readShort:function(s,i){return e._bin._view(s).getInt16(i)},readUshort:function(s,i){return e._bin._view(s).getUint16(i)},readUshorts:function(s,i,o){for(var a=[],c=0;c<o;c++)a.push(e._bin.readUshort(s,i+2*c));return a},readUint:function(s,i){return e._bin._view(s).getUint32(i)},readUint64:function(s,i){return 4294967296*e._bin.readUint(s,i)+e._bin.readUint(s,i+4)},readASCII:function(s,i,o){for(var a="",c=0;c<o;c++)a+=String.fromCharCode(s[i+c]);return a},readUnicode:function(s,i,o){for(var a="",c=0;c<o;c++){var l=s[i++]<<8|s[i++];a+=String.fromCharCode(l)}return a},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(s,i,o){var a=e._bin._tdec;return a&&i==0&&o==s.length?a.decode(s):e._bin.readASCII(s,i,o)},readBytes:function(s,i,o){for(var a=[],c=0;c<o;c++)a.push(s[i+c]);return a},readASCIIArray:function(s,i,o){for(var a=[],c=0;c<o;c++)a.push(String.fromCharCode(s[i+c]));return a},_view:function(s){return s._dataView||(s._dataView=s.buffer?new DataView(s.buffer,s.byteOffset,s.byteLength):new DataView(new Uint8Array(s).buffer))}},e._lctf={},e._lctf.parse=function(s,i,o,a,c){var l=e._bin,u={},h=i;l.readFixed(s,i),i+=4;var d=l.readUshort(s,i);i+=2;var f=l.readUshort(s,i);i+=2;var m=l.readUshort(s,i);return i+=2,u.scriptList=e._lctf.readScriptList(s,h+d),u.featureList=e._lctf.readFeatureList(s,h+f),u.lookupList=e._lctf.readLookupList(s,h+m,c),u},e._lctf.readLookupList=function(s,i,o){var a=e._bin,c=i,l=[],u=a.readUshort(s,i);i+=2;for(var h=0;h<u;h++){var d=a.readUshort(s,i);i+=2;var f=e._lctf.readLookupTable(s,c+d,o);l.push(f)}return l},e._lctf.readLookupTable=function(s,i,o){var a=e._bin,c=i,l={tabs:[]};l.ltype=a.readUshort(s,i),i+=2,l.flag=a.readUshort(s,i),i+=2;var u=a.readUshort(s,i);i+=2;for(var h=l.ltype,d=0;d<u;d++){var f=a.readUshort(s,i);i+=2;var m=o(s,h,c+f,l);l.tabs.push(m)}return l},e._lctf.numOfOnes=function(s){for(var i=0,o=0;o<32;o++)s>>>o&1&&i++;return i},e._lctf.readClassDef=function(s,i){var o=e._bin,a=[],c=o.readUshort(s,i);if(i+=2,c==1){var l=o.readUshort(s,i);i+=2;var u=o.readUshort(s,i);i+=2;for(var h=0;h<u;h++)a.push(l+h),a.push(l+h),a.push(o.readUshort(s,i)),i+=2}if(c==2){var d=o.readUshort(s,i);for(i+=2,h=0;h<d;h++)a.push(o.readUshort(s,i)),i+=2,a.push(o.readUshort(s,i)),i+=2,a.push(o.readUshort(s,i)),i+=2}return a},e._lctf.getInterval=function(s,i){for(var o=0;o<s.length;o+=3){var a=s[o],c=s[o+1];if(s[o+2],a<=i&&i<=c)return o}return-1},e._lctf.readCoverage=function(s,i){var o=e._bin,a={};a.fmt=o.readUshort(s,i),i+=2;var c=o.readUshort(s,i);return i+=2,a.fmt==1&&(a.tab=o.readUshorts(s,i,c)),a.fmt==2&&(a.tab=o.readUshorts(s,i,3*c)),a},e._lctf.coverageIndex=function(s,i){var o=s.tab;if(s.fmt==1)return o.indexOf(i);if(s.fmt==2){var a=e._lctf.getInterval(o,i);if(a!=-1)return o[a+2]+(i-o[a])}return-1},e._lctf.readFeatureList=function(s,i){var o=e._bin,a=i,c=[],l=o.readUshort(s,i);i+=2;for(var u=0;u<l;u++){var h=o.readASCII(s,i,4);i+=4;var d=o.readUshort(s,i);i+=2;var f=e._lctf.readFeatureTable(s,a+d);f.tag=h.trim(),c.push(f)}return c},e._lctf.readFeatureTable=function(s,i){var o=e._bin,a=i,c={},l=o.readUshort(s,i);i+=2,l>0&&(c.featureParams=a+l);var u=o.readUshort(s,i);i+=2,c.tab=[];for(var h=0;h<u;h++)c.tab.push(o.readUshort(s,i+2*h));return c},e._lctf.readScriptList=function(s,i){var o=e._bin,a=i,c={},l=o.readUshort(s,i);i+=2;for(var u=0;u<l;u++){var h=o.readASCII(s,i,4);i+=4;var d=o.readUshort(s,i);i+=2,c[h.trim()]=e._lctf.readScriptTable(s,a+d)}return c},e._lctf.readScriptTable=function(s,i){var o=e._bin,a=i,c={},l=o.readUshort(s,i);i+=2,c.default=e._lctf.readLangSysTable(s,a+l);var u=o.readUshort(s,i);i+=2;for(var h=0;h<u;h++){var d=o.readASCII(s,i,4);i+=4;var f=o.readUshort(s,i);i+=2,c[d.trim()]=e._lctf.readLangSysTable(s,a+f)}return c},e._lctf.readLangSysTable=function(s,i){var o=e._bin,a={};o.readUshort(s,i),i+=2,a.reqFeature=o.readUshort(s,i),i+=2;var c=o.readUshort(s,i);return i+=2,a.features=o.readUshorts(s,i,c),a},e.CFF={},e.CFF.parse=function(s,i,o){var a=e._bin;(s=new Uint8Array(s.buffer,i,o))[i=0],s[++i],s[++i],s[++i],i++;var c=[];i=e.CFF.readIndex(s,i,c);for(var l=[],u=0;u<c.length-1;u++)l.push(a.readASCII(s,i+c[u],c[u+1]-c[u]));i+=c[c.length-1];var h=[];i=e.CFF.readIndex(s,i,h);var d=[];for(u=0;u<h.length-1;u++)d.push(e.CFF.readDict(s,i+h[u],i+h[u+1]));i+=h[h.length-1];var f=d[0],m=[];i=e.CFF.readIndex(s,i,m);var p=[];for(u=0;u<m.length-1;u++)p.push(a.readASCII(s,i+m[u],m[u+1]-m[u]));if(i+=m[m.length-1],e.CFF.readSubrs(s,i,f),f.CharStrings){i=f.CharStrings,m=[],i=e.CFF.readIndex(s,i,m);var _=[];for(u=0;u<m.length-1;u++)_.push(a.readBytes(s,i+m[u],m[u+1]-m[u]));f.CharStrings=_}if(f.ROS){i=f.FDArray;var T=[];for(i=e.CFF.readIndex(s,i,T),f.FDArray=[],u=0;u<T.length-1;u++){var y=e.CFF.readDict(s,i+T[u],i+T[u+1]);e.CFF._readFDict(s,y,p),f.FDArray.push(y)}i+=T[T.length-1],i=f.FDSelect,f.FDSelect=[];var b=s[i];if(i++,b!=3)throw b;var v=a.readUshort(s,i);for(i+=2,u=0;u<v+1;u++)f.FDSelect.push(a.readUshort(s,i),s[i+2]),i+=3}return f.Encoding&&(f.Encoding=e.CFF.readEncoding(s,f.Encoding,f.CharStrings.length)),f.charset&&(f.charset=e.CFF.readCharset(s,f.charset,f.CharStrings.length)),e.CFF._readFDict(s,f,p),f},e.CFF._readFDict=function(s,i,o){var a;for(var c in i.Private&&(a=i.Private[1],i.Private=e.CFF.readDict(s,a,a+i.Private[0]),i.Private.Subrs&&e.CFF.readSubrs(s,a+i.Private.Subrs,i.Private)),i)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(c)!=-1&&(i[c]=o[i[c]-426+35])},e.CFF.readSubrs=function(s,i,o){var a=e._bin,c=[];i=e.CFF.readIndex(s,i,c);var l,u=c.length;l=u<1240?107:u<33900?1131:32768,o.Bias=l,o.Subrs=[];for(var h=0;h<c.length-1;h++)o.Subrs.push(a.readBytes(s,i+c[h],c[h+1]-c[h]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(s,i){for(var o=0;o<s.charset.length;o++)if(s.charset[o]==i)return o;return-1},e.CFF.glyphBySE=function(s,i){return i<0||i>255?-1:e.CFF.glyphByUnicode(s,e.CFF.tableSE[i])},e.CFF.readEncoding=function(s,i,o){e._bin;var a=[".notdef"],c=s[i];if(i++,c!=0)throw"error: unknown encoding format: "+c;var l=s[i];i++;for(var u=0;u<l;u++)a.push(s[i+u]);return a},e.CFF.readCharset=function(s,i,o){var a=e._bin,c=[".notdef"],l=s[i];if(i++,l==0)for(var u=0;u<o;u++){var h=a.readUshort(s,i);i+=2,c.push(h)}else{if(l!=1&&l!=2)throw"error: format: "+l;for(;c.length<o;){h=a.readUshort(s,i),i+=2;var d=0;for(l==1?(d=s[i],i++):(d=a.readUshort(s,i),i+=2),u=0;u<=d;u++)c.push(h),h++}}return c},e.CFF.readIndex=function(s,i,o){var a=e._bin,c=a.readUshort(s,i)+1,l=s[i+=2];if(i++,l==1)for(var u=0;u<c;u++)o.push(s[i+u]);else if(l==2)for(u=0;u<c;u++)o.push(a.readUshort(s,i+2*u));else if(l==3)for(u=0;u<c;u++)o.push(16777215&a.readUint(s,i+3*u-1));else if(c!=1)throw"unsupported offset size: "+l+", count: "+c;return(i+=c*l)-1},e.CFF.getCharString=function(s,i,o){var a=e._bin,c=s[i],l=s[i+1];s[i+2],s[i+3],s[i+4];var u=1,h=null,d=null;c<=20&&(h=c,u=1),c==12&&(h=100*c+l,u=2),21<=c&&c<=27&&(h=c,u=1),c==28&&(d=a.readShort(s,i+1),u=3),29<=c&&c<=31&&(h=c,u=1),32<=c&&c<=246&&(d=c-139,u=1),247<=c&&c<=250&&(d=256*(c-247)+l+108,u=2),251<=c&&c<=254&&(d=256*-(c-251)-l-108,u=2),c==255&&(d=a.readInt(s,i+1)/65535,u=5),o.val=d??"o"+h,o.size=u},e.CFF.readCharString=function(s,i,o){for(var a=i+o,c=e._bin,l=[];i<a;){var u=s[i],h=s[i+1];s[i+2],s[i+3],s[i+4];var d=1,f=null,m=null;u<=20&&(f=u,d=1),u==12&&(f=100*u+h,d=2),u!=19&&u!=20||(f=u,d=2),21<=u&&u<=27&&(f=u,d=1),u==28&&(m=c.readShort(s,i+1),d=3),29<=u&&u<=31&&(f=u,d=1),32<=u&&u<=246&&(m=u-139,d=1),247<=u&&u<=250&&(m=256*(u-247)+h+108,d=2),251<=u&&u<=254&&(m=256*-(u-251)-h-108,d=2),u==255&&(m=c.readInt(s,i+1)/65535,d=5),l.push(m??"o"+f),i+=d}return l},e.CFF.readDict=function(s,i,o){for(var a=e._bin,c={},l=[];i<o;){var u=s[i],h=s[i+1];s[i+2],s[i+3],s[i+4];var d=1,f=null,m=null;if(u==28&&(m=a.readShort(s,i+1),d=3),u==29&&(m=a.readInt(s,i+1),d=5),32<=u&&u<=246&&(m=u-139,d=1),247<=u&&u<=250&&(m=256*(u-247)+h+108,d=2),251<=u&&u<=254&&(m=256*-(u-251)-h-108,d=2),u==255)throw m=a.readInt(s,i+1)/65535,d=5,"unknown number";if(u==30){var p=[];for(d=1;;){var _=s[i+d];d++;var T=_>>4,y=15&_;if(T!=15&&p.push(T),y!=15&&p.push(y),y==15)break}for(var b="",v=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],g=0;g<p.length;g++)b+=v[p[g]];m=parseFloat(b)}u<=21&&(f=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][u],d=1,u==12&&(f=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][h],d=2)),f!=null?(c[f]=l.length==1?l[0]:l,l=[]):l.push(m),i+=d}return c},e.cmap={},e.cmap.parse=function(s,i,o){s=new Uint8Array(s.buffer,i,o),i=0;var a=e._bin,c={};a.readUshort(s,i),i+=2;var l=a.readUshort(s,i);i+=2;var u=[];c.tables=[];for(var h=0;h<l;h++){var d=a.readUshort(s,i);i+=2;var f=a.readUshort(s,i);i+=2;var m=a.readUint(s,i);i+=4;var p="p"+d+"e"+f,_=u.indexOf(m);if(_==-1){var T;_=c.tables.length,u.push(m);var y=a.readUshort(s,m);y==0?T=e.cmap.parse0(s,m):y==4?T=e.cmap.parse4(s,m):y==6?T=e.cmap.parse6(s,m):y==12?T=e.cmap.parse12(s,m):console.debug("unknown format: "+y,d,f,m),c.tables.push(T)}if(c[p]!=null)throw"multiple tables for one platform+encoding";c[p]=_}return c},e.cmap.parse0=function(s,i){var o=e._bin,a={};a.format=o.readUshort(s,i),i+=2;var c=o.readUshort(s,i);i+=2,o.readUshort(s,i),i+=2,a.map=[];for(var l=0;l<c-6;l++)a.map.push(s[i+l]);return a},e.cmap.parse4=function(s,i){var o=e._bin,a=i,c={};c.format=o.readUshort(s,i),i+=2;var l=o.readUshort(s,i);i+=2,o.readUshort(s,i),i+=2;var u=o.readUshort(s,i);i+=2;var h=u/2;c.searchRange=o.readUshort(s,i),i+=2,c.entrySelector=o.readUshort(s,i),i+=2,c.rangeShift=o.readUshort(s,i),i+=2,c.endCount=o.readUshorts(s,i,h),i+=2*h,i+=2,c.startCount=o.readUshorts(s,i,h),i+=2*h,c.idDelta=[];for(var d=0;d<h;d++)c.idDelta.push(o.readShort(s,i)),i+=2;for(c.idRangeOffset=o.readUshorts(s,i,h),i+=2*h,c.glyphIdArray=[];i<a+l;)c.glyphIdArray.push(o.readUshort(s,i)),i+=2;return c},e.cmap.parse6=function(s,i){var o=e._bin,a={};a.format=o.readUshort(s,i),i+=2,o.readUshort(s,i),i+=2,o.readUshort(s,i),i+=2,a.firstCode=o.readUshort(s,i),i+=2;var c=o.readUshort(s,i);i+=2,a.glyphIdArray=[];for(var l=0;l<c;l++)a.glyphIdArray.push(o.readUshort(s,i)),i+=2;return a},e.cmap.parse12=function(s,i){var o=e._bin,a={};a.format=o.readUshort(s,i),i+=2,i+=2,o.readUint(s,i),i+=4,o.readUint(s,i),i+=4;var c=o.readUint(s,i);i+=4,a.groups=[];for(var l=0;l<c;l++){var u=i+12*l,h=o.readUint(s,u+0),d=o.readUint(s,u+4),f=o.readUint(s,u+8);a.groups.push([h,d,f])}return a},e.glyf={},e.glyf.parse=function(s,i,o,a){for(var c=[],l=0;l<a.maxp.numGlyphs;l++)c.push(null);return c},e.glyf._parseGlyf=function(s,i){var o=e._bin,a=s._data,c=e._tabOffset(a,"glyf",s._offset)+s.loca[i];if(s.loca[i]==s.loca[i+1])return null;var l={};if(l.noc=o.readShort(a,c),c+=2,l.xMin=o.readShort(a,c),c+=2,l.yMin=o.readShort(a,c),c+=2,l.xMax=o.readShort(a,c),c+=2,l.yMax=o.readShort(a,c),c+=2,l.xMin>=l.xMax||l.yMin>=l.yMax)return null;if(l.noc>0){l.endPts=[];for(var u=0;u<l.noc;u++)l.endPts.push(o.readUshort(a,c)),c+=2;var h=o.readUshort(a,c);if(c+=2,a.length-c<h)return null;l.instructions=o.readBytes(a,c,h),c+=h;var d=l.endPts[l.noc-1]+1;for(l.flags=[],u=0;u<d;u++){var f=a[c];if(c++,l.flags.push(f),(8&f)!=0){var m=a[c];c++;for(var p=0;p<m;p++)l.flags.push(f),u++}}for(l.xs=[],u=0;u<d;u++){var _=(2&l.flags[u])!=0,T=(16&l.flags[u])!=0;_?(l.xs.push(T?a[c]:-a[c]),c++):T?l.xs.push(0):(l.xs.push(o.readShort(a,c)),c+=2)}for(l.ys=[],u=0;u<d;u++)_=(4&l.flags[u])!=0,T=(32&l.flags[u])!=0,_?(l.ys.push(T?a[c]:-a[c]),c++):T?l.ys.push(0):(l.ys.push(o.readShort(a,c)),c+=2);var y=0,b=0;for(u=0;u<d;u++)y+=l.xs[u],b+=l.ys[u],l.xs[u]=y,l.ys[u]=b}else{var v;l.parts=[];do{v=o.readUshort(a,c),c+=2;var g={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(l.parts.push(g),g.glyphIndex=o.readUshort(a,c),c+=2,1&v){var x=o.readShort(a,c);c+=2;var w=o.readShort(a,c);c+=2}else x=o.readInt8(a,c),c++,w=o.readInt8(a,c),c++;2&v?(g.m.tx=x,g.m.ty=w):(g.p1=x,g.p2=w),8&v?(g.m.a=g.m.d=o.readF2dot14(a,c),c+=2):64&v?(g.m.a=o.readF2dot14(a,c),c+=2,g.m.d=o.readF2dot14(a,c),c+=2):128&v&&(g.m.a=o.readF2dot14(a,c),c+=2,g.m.b=o.readF2dot14(a,c),c+=2,g.m.c=o.readF2dot14(a,c),c+=2,g.m.d=o.readF2dot14(a,c),c+=2)}while(32&v);if(256&v){var S=o.readUshort(a,c);for(c+=2,l.instr=[],u=0;u<S;u++)l.instr.push(a[c]),c++}}return l},e.GPOS={},e.GPOS.parse=function(s,i,o,a){return e._lctf.parse(s,i,o,a,e.GPOS.subt)},e.GPOS.subt=function(s,i,o,a){var c=e._bin,l=o,u={};if(u.fmt=c.readUshort(s,o),o+=2,i==1||i==2||i==3||i==7||i==8&&u.fmt<=2){var h=c.readUshort(s,o);o+=2,u.coverage=e._lctf.readCoverage(s,h+l)}if(i==1&&u.fmt==1){var d=c.readUshort(s,o);o+=2;var f=e._lctf.numOfOnes(d);d!=0&&(u.pos=e.GPOS.readValueRecord(s,o,d))}else if(i==2&&u.fmt>=1&&u.fmt<=2){d=c.readUshort(s,o),o+=2;var m=c.readUshort(s,o);o+=2,f=e._lctf.numOfOnes(d);var p=e._lctf.numOfOnes(m);if(u.fmt==1){u.pairsets=[];var _=c.readUshort(s,o);o+=2;for(var T=0;T<_;T++){var y=l+c.readUshort(s,o);o+=2;var b=c.readUshort(s,y);y+=2;for(var v=[],g=0;g<b;g++){var x=c.readUshort(s,y);y+=2,d!=0&&(E=e.GPOS.readValueRecord(s,y,d),y+=2*f),m!=0&&(D=e.GPOS.readValueRecord(s,y,m),y+=2*p),v.push({gid2:x,val1:E,val2:D})}u.pairsets.push(v)}}if(u.fmt==2){var w=c.readUshort(s,o);o+=2;var S=c.readUshort(s,o);o+=2;var C=c.readUshort(s,o);o+=2;var O=c.readUshort(s,o);for(o+=2,u.classDef1=e._lctf.readClassDef(s,l+w),u.classDef2=e._lctf.readClassDef(s,l+S),u.matrix=[],T=0;T<C;T++){var k=[];for(g=0;g<O;g++){var E=null,D=null;d!=0&&(E=e.GPOS.readValueRecord(s,o,d),o+=2*f),m!=0&&(D=e.GPOS.readValueRecord(s,o,m),o+=2*p),k.push({val1:E,val2:D})}u.matrix.push(k)}}}else{if(i==9&&u.fmt==1){var M=c.readUshort(s,o);o+=2;var U=c.readUint(s,o);if(o+=4,a.ltype==9)a.ltype=M;else if(a.ltype!=M)throw"invalid extension substitution";return e.GPOS.subt(s,a.ltype,l+U)}console.debug("unsupported GPOS table LookupType",i,"format",u.fmt)}return u},e.GPOS.readValueRecord=function(s,i,o){var a=e._bin,c=[];return c.push(1&o?a.readShort(s,i):0),i+=1&o?2:0,c.push(2&o?a.readShort(s,i):0),i+=2&o?2:0,c.push(4&o?a.readShort(s,i):0),i+=4&o?2:0,c.push(8&o?a.readShort(s,i):0),i+=8&o?2:0,c},e.GSUB={},e.GSUB.parse=function(s,i,o,a){return e._lctf.parse(s,i,o,a,e.GSUB.subt)},e.GSUB.subt=function(s,i,o,a){var c=e._bin,l=o,u={};if(u.fmt=c.readUshort(s,o),o+=2,i!=1&&i!=4&&i!=5&&i!=6)return null;if(i==1||i==4||i==5&&u.fmt<=2||i==6&&u.fmt<=2){var h=c.readUshort(s,o);o+=2,u.coverage=e._lctf.readCoverage(s,l+h)}if(i==1&&u.fmt>=1&&u.fmt<=2){if(u.fmt==1)u.delta=c.readShort(s,o),o+=2;else if(u.fmt==2){var d=c.readUshort(s,o);o+=2,u.newg=c.readUshorts(s,o,d),o+=2*u.newg.length}}else if(i==4){u.vals=[],d=c.readUshort(s,o),o+=2;for(var f=0;f<d;f++){var m=c.readUshort(s,o);o+=2,u.vals.push(e.GSUB.readLigatureSet(s,l+m))}}else if(i==5&&u.fmt==2){if(u.fmt==2){var p=c.readUshort(s,o);o+=2,u.cDef=e._lctf.readClassDef(s,l+p),u.scset=[];var _=c.readUshort(s,o);for(o+=2,f=0;f<_;f++){var T=c.readUshort(s,o);o+=2,u.scset.push(T==0?null:e.GSUB.readSubClassSet(s,l+T))}}}else if(i==6&&u.fmt==3){if(u.fmt==3){for(f=0;f<3;f++){d=c.readUshort(s,o),o+=2;for(var y=[],b=0;b<d;b++)y.push(e._lctf.readCoverage(s,l+c.readUshort(s,o+2*b)));o+=2*d,f==0&&(u.backCvg=y),f==1&&(u.inptCvg=y),f==2&&(u.ahedCvg=y)}d=c.readUshort(s,o),o+=2,u.lookupRec=e.GSUB.readSubstLookupRecords(s,o,d)}}else{if(i==7&&u.fmt==1){var v=c.readUshort(s,o);o+=2;var g=c.readUint(s,o);if(o+=4,a.ltype==9)a.ltype=v;else if(a.ltype!=v)throw"invalid extension substitution";return e.GSUB.subt(s,a.ltype,l+g)}console.debug("unsupported GSUB table LookupType",i,"format",u.fmt)}return u},e.GSUB.readSubClassSet=function(s,i){var o=e._bin.readUshort,a=i,c=[],l=o(s,i);i+=2;for(var u=0;u<l;u++){var h=o(s,i);i+=2,c.push(e.GSUB.readSubClassRule(s,a+h))}return c},e.GSUB.readSubClassRule=function(s,i){var o=e._bin.readUshort,a={},c=o(s,i),l=o(s,i+=2);i+=2,a.input=[];for(var u=0;u<c-1;u++)a.input.push(o(s,i)),i+=2;return a.substLookupRecords=e.GSUB.readSubstLookupRecords(s,i,l),a},e.GSUB.readSubstLookupRecords=function(s,i,o){for(var a=e._bin.readUshort,c=[],l=0;l<o;l++)c.push(a(s,i),a(s,i+2)),i+=4;return c},e.GSUB.readChainSubClassSet=function(s,i){var o=e._bin,a=i,c=[],l=o.readUshort(s,i);i+=2;for(var u=0;u<l;u++){var h=o.readUshort(s,i);i+=2,c.push(e.GSUB.readChainSubClassRule(s,a+h))}return c},e.GSUB.readChainSubClassRule=function(s,i){for(var o=e._bin,a={},c=["backtrack","input","lookahead"],l=0;l<c.length;l++){var u=o.readUshort(s,i);i+=2,l==1&&u--,a[c[l]]=o.readUshorts(s,i,u),i+=2*a[c[l]].length}return u=o.readUshort(s,i),i+=2,a.subst=o.readUshorts(s,i,2*u),i+=2*a.subst.length,a},e.GSUB.readLigatureSet=function(s,i){var o=e._bin,a=i,c=[],l=o.readUshort(s,i);i+=2;for(var u=0;u<l;u++){var h=o.readUshort(s,i);i+=2,c.push(e.GSUB.readLigature(s,a+h))}return c},e.GSUB.readLigature=function(s,i){var o=e._bin,a={chain:[]};a.nglyph=o.readUshort(s,i),i+=2;var c=o.readUshort(s,i);i+=2;for(var l=0;l<c-1;l++)a.chain.push(o.readUshort(s,i)),i+=2;return a},e.head={},e.head.parse=function(s,i,o){var a=e._bin,c={};return a.readFixed(s,i),i+=4,c.fontRevision=a.readFixed(s,i),i+=4,a.readUint(s,i),i+=4,a.readUint(s,i),i+=4,c.flags=a.readUshort(s,i),i+=2,c.unitsPerEm=a.readUshort(s,i),i+=2,c.created=a.readUint64(s,i),i+=8,c.modified=a.readUint64(s,i),i+=8,c.xMin=a.readShort(s,i),i+=2,c.yMin=a.readShort(s,i),i+=2,c.xMax=a.readShort(s,i),i+=2,c.yMax=a.readShort(s,i),i+=2,c.macStyle=a.readUshort(s,i),i+=2,c.lowestRecPPEM=a.readUshort(s,i),i+=2,c.fontDirectionHint=a.readShort(s,i),i+=2,c.indexToLocFormat=a.readShort(s,i),i+=2,c.glyphDataFormat=a.readShort(s,i),i+=2,c},e.hhea={},e.hhea.parse=function(s,i,o){var a=e._bin,c={};return a.readFixed(s,i),i+=4,c.ascender=a.readShort(s,i),i+=2,c.descender=a.readShort(s,i),i+=2,c.lineGap=a.readShort(s,i),i+=2,c.advanceWidthMax=a.readUshort(s,i),i+=2,c.minLeftSideBearing=a.readShort(s,i),i+=2,c.minRightSideBearing=a.readShort(s,i),i+=2,c.xMaxExtent=a.readShort(s,i),i+=2,c.caretSlopeRise=a.readShort(s,i),i+=2,c.caretSlopeRun=a.readShort(s,i),i+=2,c.caretOffset=a.readShort(s,i),i+=2,i+=8,c.metricDataFormat=a.readShort(s,i),i+=2,c.numberOfHMetrics=a.readUshort(s,i),i+=2,c},e.hmtx={},e.hmtx.parse=function(s,i,o,a){for(var c=e._bin,l={aWidth:[],lsBearing:[]},u=0,h=0,d=0;d<a.maxp.numGlyphs;d++)d<a.hhea.numberOfHMetrics&&(u=c.readUshort(s,i),i+=2,h=c.readShort(s,i),i+=2),l.aWidth.push(u),l.lsBearing.push(h);return l},e.kern={},e.kern.parse=function(s,i,o,a){var c=e._bin,l=c.readUshort(s,i);if(i+=2,l==1)return e.kern.parseV1(s,i-2,o,a);var u=c.readUshort(s,i);i+=2;for(var h={glyph1:[],rval:[]},d=0;d<u;d++){i+=2,o=c.readUshort(s,i),i+=2;var f=c.readUshort(s,i);i+=2;var m=f>>>8;if((m&=15)!=0)throw"unknown kern table format: "+m;i=e.kern.readFormat0(s,i,h)}return h},e.kern.parseV1=function(s,i,o,a){var c=e._bin;c.readFixed(s,i),i+=4;var l=c.readUint(s,i);i+=4;for(var u={glyph1:[],rval:[]},h=0;h<l;h++){c.readUint(s,i),i+=4;var d=c.readUshort(s,i);i+=2,c.readUshort(s,i),i+=2;var f=d>>>8;if((f&=15)!=0)throw"unknown kern table format: "+f;i=e.kern.readFormat0(s,i,u)}return u},e.kern.readFormat0=function(s,i,o){var a=e._bin,c=-1,l=a.readUshort(s,i);i+=2,a.readUshort(s,i),i+=2,a.readUshort(s,i),i+=2,a.readUshort(s,i),i+=2;for(var u=0;u<l;u++){var h=a.readUshort(s,i);i+=2;var d=a.readUshort(s,i);i+=2;var f=a.readShort(s,i);i+=2,h!=c&&(o.glyph1.push(h),o.rval.push({glyph2:[],vals:[]}));var m=o.rval[o.rval.length-1];m.glyph2.push(d),m.vals.push(f),c=h}return i},e.loca={},e.loca.parse=function(s,i,o,a){var c=e._bin,l=[],u=a.head.indexToLocFormat,h=a.maxp.numGlyphs+1;if(u==0)for(var d=0;d<h;d++)l.push(c.readUshort(s,i+(d<<1))<<1);if(u==1)for(d=0;d<h;d++)l.push(c.readUint(s,i+(d<<2)));return l},e.maxp={},e.maxp.parse=function(s,i,o){var a=e._bin,c={},l=a.readUint(s,i);return i+=4,c.numGlyphs=a.readUshort(s,i),i+=2,l==65536&&(c.maxPoints=a.readUshort(s,i),i+=2,c.maxContours=a.readUshort(s,i),i+=2,c.maxCompositePoints=a.readUshort(s,i),i+=2,c.maxCompositeContours=a.readUshort(s,i),i+=2,c.maxZones=a.readUshort(s,i),i+=2,c.maxTwilightPoints=a.readUshort(s,i),i+=2,c.maxStorage=a.readUshort(s,i),i+=2,c.maxFunctionDefs=a.readUshort(s,i),i+=2,c.maxInstructionDefs=a.readUshort(s,i),i+=2,c.maxStackElements=a.readUshort(s,i),i+=2,c.maxSizeOfInstructions=a.readUshort(s,i),i+=2,c.maxComponentElements=a.readUshort(s,i),i+=2,c.maxComponentDepth=a.readUshort(s,i),i+=2),c},e.name={},e.name.parse=function(s,i,o){var a=e._bin,c={};a.readUshort(s,i),i+=2;var l=a.readUshort(s,i);i+=2,a.readUshort(s,i);for(var u,h=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],d=i+=2,f=0;f<l;f++){var m=a.readUshort(s,i);i+=2;var p=a.readUshort(s,i);i+=2;var _=a.readUshort(s,i);i+=2;var T=a.readUshort(s,i);i+=2;var y=a.readUshort(s,i);i+=2;var b=a.readUshort(s,i);i+=2;var v,g=h[T],x=d+12*l+b;if(m==0)v=a.readUnicode(s,x,y/2);else if(m==3&&p==0)v=a.readUnicode(s,x,y/2);else if(p==0)v=a.readASCII(s,x,y);else if(p==1)v=a.readUnicode(s,x,y/2);else if(p==3)v=a.readUnicode(s,x,y/2);else{if(m!=1)throw"unknown encoding "+p+", platformID: "+m;v=a.readASCII(s,x,y),console.debug("reading unknown MAC encoding "+p+" as ASCII")}var w="p"+m+","+_.toString(16);c[w]==null&&(c[w]={}),c[w][g!==void 0?g:T]=v,c[w]._lang=_}for(var S in c)if(c[S].postScriptName!=null&&c[S]._lang==1033)return c[S];for(var S in c)if(c[S].postScriptName!=null&&c[S]._lang==0)return c[S];for(var S in c)if(c[S].postScriptName!=null&&c[S]._lang==3084)return c[S];for(var S in c)if(c[S].postScriptName!=null)return c[S];for(var S in c){u=S;break}return console.debug("returning name table with languageID "+c[u]._lang),c[u]},e["OS/2"]={},e["OS/2"].parse=function(s,i,o){var a=e._bin.readUshort(s,i);i+=2;var c={};if(a==0)e["OS/2"].version0(s,i,c);else if(a==1)e["OS/2"].version1(s,i,c);else if(a==2||a==3||a==4)e["OS/2"].version2(s,i,c);else{if(a!=5)throw"unknown OS/2 table version: "+a;e["OS/2"].version5(s,i,c)}return c},e["OS/2"].version0=function(s,i,o){var a=e._bin;return o.xAvgCharWidth=a.readShort(s,i),i+=2,o.usWeightClass=a.readUshort(s,i),i+=2,o.usWidthClass=a.readUshort(s,i),i+=2,o.fsType=a.readUshort(s,i),i+=2,o.ySubscriptXSize=a.readShort(s,i),i+=2,o.ySubscriptYSize=a.readShort(s,i),i+=2,o.ySubscriptXOffset=a.readShort(s,i),i+=2,o.ySubscriptYOffset=a.readShort(s,i),i+=2,o.ySuperscriptXSize=a.readShort(s,i),i+=2,o.ySuperscriptYSize=a.readShort(s,i),i+=2,o.ySuperscriptXOffset=a.readShort(s,i),i+=2,o.ySuperscriptYOffset=a.readShort(s,i),i+=2,o.yStrikeoutSize=a.readShort(s,i),i+=2,o.yStrikeoutPosition=a.readShort(s,i),i+=2,o.sFamilyClass=a.readShort(s,i),i+=2,o.panose=a.readBytes(s,i,10),i+=10,o.ulUnicodeRange1=a.readUint(s,i),i+=4,o.ulUnicodeRange2=a.readUint(s,i),i+=4,o.ulUnicodeRange3=a.readUint(s,i),i+=4,o.ulUnicodeRange4=a.readUint(s,i),i+=4,o.achVendID=[a.readInt8(s,i),a.readInt8(s,i+1),a.readInt8(s,i+2),a.readInt8(s,i+3)],i+=4,o.fsSelection=a.readUshort(s,i),i+=2,o.usFirstCharIndex=a.readUshort(s,i),i+=2,o.usLastCharIndex=a.readUshort(s,i),i+=2,o.sTypoAscender=a.readShort(s,i),i+=2,o.sTypoDescender=a.readShort(s,i),i+=2,o.sTypoLineGap=a.readShort(s,i),i+=2,o.usWinAscent=a.readUshort(s,i),i+=2,o.usWinDescent=a.readUshort(s,i),i+=2},e["OS/2"].version1=function(s,i,o){var a=e._bin;return i=e["OS/2"].version0(s,i,o),o.ulCodePageRange1=a.readUint(s,i),i+=4,o.ulCodePageRange2=a.readUint(s,i),i+=4},e["OS/2"].version2=function(s,i,o){var a=e._bin;return i=e["OS/2"].version1(s,i,o),o.sxHeight=a.readShort(s,i),i+=2,o.sCapHeight=a.readShort(s,i),i+=2,o.usDefault=a.readUshort(s,i),i+=2,o.usBreak=a.readUshort(s,i),i+=2,o.usMaxContext=a.readUshort(s,i),i+=2},e["OS/2"].version5=function(s,i,o){var a=e._bin;return i=e["OS/2"].version2(s,i,o),o.usLowerOpticalPointSize=a.readUshort(s,i),i+=2,o.usUpperOpticalPointSize=a.readUshort(s,i),i+=2},e.post={},e.post.parse=function(s,i,o){var a=e._bin,c={};return c.version=a.readFixed(s,i),i+=4,c.italicAngle=a.readFixed(s,i),i+=4,c.underlinePosition=a.readShort(s,i),i+=2,c.underlineThickness=a.readShort(s,i),i+=2,c},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(s,i){var o=s.cmap,a=-1;if(o.p0e4!=null?a=o.p0e4:o.p3e1!=null?a=o.p3e1:o.p1e0!=null?a=o.p1e0:o.p0e3!=null&&(a=o.p0e3),a==-1)throw"no familiar platform and encoding!";var c=o.tables[a];if(c.format==0)return i>=c.map.length?0:c.map[i];if(c.format==4){for(var l=-1,u=0;u<c.endCount.length;u++)if(i<=c.endCount[u]){l=u;break}return l==-1||c.startCount[l]>i?0:65535&(c.idRangeOffset[l]!=0?c.glyphIdArray[i-c.startCount[l]+(c.idRangeOffset[l]>>1)-(c.idRangeOffset.length-l)]:i+c.idDelta[l])}if(c.format==12){if(i>c.groups[c.groups.length-1][1])return 0;for(u=0;u<c.groups.length;u++){var h=c.groups[u];if(h[0]<=i&&i<=h[1])return h[2]+(i-h[0])}return 0}throw"unknown cmap table format "+c.format},e.U.glyphToPath=function(s,i){var o={cmds:[],crds:[]};if(s.SVG&&s.SVG.entries[i]){var a=s.SVG.entries[i];return a==null?o:(typeof a=="string"&&(a=e.SVG.toPath(a),s.SVG.entries[i]=a),a)}if(s.CFF){var c={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:s.CFF.Private?s.CFF.Private.defaultWidthX:0,open:!1},l=s.CFF,u=s.CFF.Private;if(l.ROS){for(var h=0;l.FDSelect[h+2]<=i;)h+=2;u=l.FDArray[l.FDSelect[h+1]].Private}e.U._drawCFF(s.CFF.CharStrings[i],c,l,u,o)}else s.glyf&&e.U._drawGlyf(i,s,o);return o},e.U._drawGlyf=function(s,i,o){var a=i.glyf[s];a==null&&(a=i.glyf[s]=e.glyf._parseGlyf(i,s)),a!=null&&(a.noc>-1?e.U._simpleGlyph(a,o):e.U._compoGlyph(a,i,o))},e.U._simpleGlyph=function(s,i){for(var o=0;o<s.noc;o++){for(var a=o==0?0:s.endPts[o-1]+1,c=s.endPts[o],l=a;l<=c;l++){var u=l==a?c:l-1,h=l==c?a:l+1,d=1&s.flags[l],f=1&s.flags[u],m=1&s.flags[h],p=s.xs[l],_=s.ys[l];if(l==a)if(d){if(!f){e.U.P.moveTo(i,p,_);continue}e.U.P.moveTo(i,s.xs[u],s.ys[u])}else f?e.U.P.moveTo(i,s.xs[u],s.ys[u]):e.U.P.moveTo(i,(s.xs[u]+p)/2,(s.ys[u]+_)/2);d?f&&e.U.P.lineTo(i,p,_):m?e.U.P.qcurveTo(i,p,_,s.xs[h],s.ys[h]):e.U.P.qcurveTo(i,p,_,(p+s.xs[h])/2,(_+s.ys[h])/2)}e.U.P.closePath(i)}},e.U._compoGlyph=function(s,i,o){for(var a=0;a<s.parts.length;a++){var c={cmds:[],crds:[]},l=s.parts[a];e.U._drawGlyf(l.glyphIndex,i,c);for(var u=l.m,h=0;h<c.crds.length;h+=2){var d=c.crds[h],f=c.crds[h+1];o.crds.push(d*u.a+f*u.b+u.tx),o.crds.push(d*u.c+f*u.d+u.ty)}for(h=0;h<c.cmds.length;h++)o.cmds.push(c.cmds[h])}},e.U._getGlyphClass=function(s,i){var o=e._lctf.getInterval(i,s);return o==-1?0:i[o+2]},e.U.getPairAdjustment=function(s,i,o){var a=!1;if(s.GPOS)for(var c=s.GPOS,l=c.lookupList,u=c.featureList,h=[],d=0;d<u.length;d++){var f=u[d];if(f.tag=="kern"){a=!0;for(var m=0;m<f.tab.length;m++)if(!h[f.tab[m]]){h[f.tab[m]]=!0;for(var p=l[f.tab[m]],_=0;_<p.tabs.length;_++)if(p.tabs[_]!=null){var T,y=p.tabs[_];if((!y.coverage||(T=e._lctf.coverageIndex(y.coverage,i))!=-1)&&p.ltype!=1){if(p.ltype==2){var b=null;if(y.fmt==1){var v=y.pairsets[T];for(d=0;d<v.length;d++)v[d].gid2==o&&(b=v[d])}else if(y.fmt==2){var g=e.U._getGlyphClass(i,y.classDef1),x=e.U._getGlyphClass(o,y.classDef2);b=y.matrix[g][x]}if(b){var w=0;return b.val1&&b.val1[2]&&(w+=b.val1[2]),b.val2&&b.val2[0]&&(w+=b.val2[0]),w}}}}}}}if(s.kern&&!a){var S=s.kern.glyph1.indexOf(i);if(S!=-1){var C=s.kern.rval[S].glyph2.indexOf(o);if(C!=-1)return s.kern.rval[S].vals[C]}}return 0},e.U._applySubs=function(s,i,o,a){for(var c=s.length-i-1,l=0;l<o.tabs.length;l++)if(o.tabs[l]!=null){var u,h=o.tabs[l];if(!h.coverage||(u=e._lctf.coverageIndex(h.coverage,s[i]))!=-1){if(o.ltype==1)s[i],h.fmt==1?s[i]=s[i]+h.delta:s[i]=h.newg[u];else if(o.ltype==4)for(var d=h.vals[u],f=0;f<d.length;f++){var m=d[f],p=m.chain.length;if(!(p>c)){for(var _=!0,T=0,y=0;y<p;y++){for(;s[i+T+(1+y)]==-1;)T++;m.chain[y]!=s[i+T+(1+y)]&&(_=!1)}if(_){for(s[i]=m.nglyph,y=0;y<p+T;y++)s[i+y+1]=-1;break}}}else if(o.ltype==5&&h.fmt==2)for(var b=e._lctf.getInterval(h.cDef,s[i]),v=h.cDef[b+2],g=h.scset[v],x=0;x<g.length;x++){var w=g[x],S=w.input;if(!(S.length>c)){for(_=!0,y=0;y<S.length;y++){var C=e._lctf.getInterval(h.cDef,s[i+1+y]);if(b==-1&&h.cDef[C+2]!=S[y]){_=!1;break}}if(_){var O=w.substLookupRecords;for(f=0;f<O.length;f+=2)O[f],O[f+1]}}}else if(o.ltype==6&&h.fmt==3){if(!e.U._glsCovered(s,h.backCvg,i-h.backCvg.length)||!e.U._glsCovered(s,h.inptCvg,i)||!e.U._glsCovered(s,h.ahedCvg,i+h.inptCvg.length))continue;var k=h.lookupRec;for(x=0;x<k.length;x+=2){b=k[x];var E=a[k[x+1]];e.U._applySubs(s,i+b,E,a)}}}}},e.U._glsCovered=function(s,i,o){for(var a=0;a<i.length;a++)if(e._lctf.coverageIndex(i[a],s[o+a])==-1)return!1;return!0},e.U.glyphsToPath=function(s,i,o){for(var a={cmds:[],crds:[]},c=0,l=0;l<i.length;l++){var u=i[l];if(u!=-1){for(var h=l<i.length-1&&i[l+1]!=-1?i[l+1]:0,d=e.U.glyphToPath(s,u),f=0;f<d.crds.length;f+=2)a.crds.push(d.crds[f]+c),a.crds.push(d.crds[f+1]);for(o&&a.cmds.push(o),f=0;f<d.cmds.length;f++)a.cmds.push(d.cmds[f]);o&&a.cmds.push("X"),c+=s.hmtx.aWidth[u],l<i.length-1&&(c+=e.U.getPairAdjustment(s,u,h))}}return a},e.U.P={},e.U.P.moveTo=function(s,i,o){s.cmds.push("M"),s.crds.push(i,o)},e.U.P.lineTo=function(s,i,o){s.cmds.push("L"),s.crds.push(i,o)},e.U.P.curveTo=function(s,i,o,a,c,l,u){s.cmds.push("C"),s.crds.push(i,o,a,c,l,u)},e.U.P.qcurveTo=function(s,i,o,a,c){s.cmds.push("Q"),s.crds.push(i,o,a,c)},e.U.P.closePath=function(s){s.cmds.push("Z")},e.U._drawCFF=function(s,i,o,a,c){for(var l=i.stack,u=i.nStems,h=i.haveWidth,d=i.width,f=i.open,m=0,p=i.x,_=i.y,T=0,y=0,b=0,v=0,g=0,x=0,w=0,S=0,C=0,O=0,k={val:0,size:0};m<s.length;){e.CFF.getCharString(s,m,k);var E=k.val;if(m+=k.size,E=="o1"||E=="o18")l.length%2!=0&&!h&&(d=l.shift()+a.nominalWidthX),u+=l.length>>1,l.length=0,h=!0;else if(E=="o3"||E=="o23")l.length%2!=0&&!h&&(d=l.shift()+a.nominalWidthX),u+=l.length>>1,l.length=0,h=!0;else if(E=="o4")l.length>1&&!h&&(d=l.shift()+a.nominalWidthX,h=!0),f&&e.U.P.closePath(c),_+=l.pop(),e.U.P.moveTo(c,p,_),f=!0;else if(E=="o5")for(;l.length>0;)p+=l.shift(),_+=l.shift(),e.U.P.lineTo(c,p,_);else if(E=="o6"||E=="o7")for(var D=l.length,M=E=="o6",U=0;U<D;U++){var P=l.shift();M?p+=P:_+=P,M=!M,e.U.P.lineTo(c,p,_)}else if(E=="o8"||E=="o24"){D=l.length;for(var V=0;V+6<=D;)T=p+l.shift(),y=_+l.shift(),b=T+l.shift(),v=y+l.shift(),p=b+l.shift(),_=v+l.shift(),e.U.P.curveTo(c,T,y,b,v,p,_),V+=6;E=="o24"&&(p+=l.shift(),_+=l.shift(),e.U.P.lineTo(c,p,_))}else{if(E=="o11")break;if(E=="o1234"||E=="o1235"||E=="o1236"||E=="o1237")E=="o1234"&&(y=_,b=(T=p+l.shift())+l.shift(),O=v=y+l.shift(),x=v,S=_,p=(w=(g=(C=b+l.shift())+l.shift())+l.shift())+l.shift(),e.U.P.curveTo(c,T,y,b,v,C,O),e.U.P.curveTo(c,g,x,w,S,p,_)),E=="o1235"&&(T=p+l.shift(),y=_+l.shift(),b=T+l.shift(),v=y+l.shift(),C=b+l.shift(),O=v+l.shift(),g=C+l.shift(),x=O+l.shift(),w=g+l.shift(),S=x+l.shift(),p=w+l.shift(),_=S+l.shift(),l.shift(),e.U.P.curveTo(c,T,y,b,v,C,O),e.U.P.curveTo(c,g,x,w,S,p,_)),E=="o1236"&&(T=p+l.shift(),y=_+l.shift(),b=T+l.shift(),O=v=y+l.shift(),x=v,w=(g=(C=b+l.shift())+l.shift())+l.shift(),S=x+l.shift(),p=w+l.shift(),e.U.P.curveTo(c,T,y,b,v,C,O),e.U.P.curveTo(c,g,x,w,S,p,_)),E=="o1237"&&(T=p+l.shift(),y=_+l.shift(),b=T+l.shift(),v=y+l.shift(),C=b+l.shift(),O=v+l.shift(),g=C+l.shift(),x=O+l.shift(),w=g+l.shift(),S=x+l.shift(),Math.abs(w-p)>Math.abs(S-_)?p=w+l.shift():_=S+l.shift(),e.U.P.curveTo(c,T,y,b,v,C,O),e.U.P.curveTo(c,g,x,w,S,p,_));else if(E=="o14"){if(l.length>0&&!h&&(d=l.shift()+o.nominalWidthX,h=!0),l.length==4){var Q=l.shift(),I=l.shift(),B=l.shift(),A=l.shift(),R=e.CFF.glyphBySE(o,B),H=e.CFF.glyphBySE(o,A);e.U._drawCFF(o.CharStrings[R],i,o,a,c),i.x=Q,i.y=I,e.U._drawCFF(o.CharStrings[H],i,o,a,c)}f&&(e.U.P.closePath(c),f=!1)}else if(E=="o19"||E=="o20")l.length%2!=0&&!h&&(d=l.shift()+a.nominalWidthX),u+=l.length>>1,l.length=0,h=!0,m+=u+7>>3;else if(E=="o21")l.length>2&&!h&&(d=l.shift()+a.nominalWidthX,h=!0),_+=l.pop(),p+=l.pop(),f&&e.U.P.closePath(c),e.U.P.moveTo(c,p,_),f=!0;else if(E=="o22")l.length>1&&!h&&(d=l.shift()+a.nominalWidthX,h=!0),p+=l.pop(),f&&e.U.P.closePath(c),e.U.P.moveTo(c,p,_),f=!0;else if(E=="o25"){for(;l.length>6;)p+=l.shift(),_+=l.shift(),e.U.P.lineTo(c,p,_);T=p+l.shift(),y=_+l.shift(),b=T+l.shift(),v=y+l.shift(),p=b+l.shift(),_=v+l.shift(),e.U.P.curveTo(c,T,y,b,v,p,_)}else if(E=="o26")for(l.length%2&&(p+=l.shift());l.length>0;)T=p,y=_+l.shift(),p=b=T+l.shift(),_=(v=y+l.shift())+l.shift(),e.U.P.curveTo(c,T,y,b,v,p,_);else if(E=="o27")for(l.length%2&&(_+=l.shift());l.length>0;)y=_,b=(T=p+l.shift())+l.shift(),v=y+l.shift(),p=b+l.shift(),_=v,e.U.P.curveTo(c,T,y,b,v,p,_);else if(E=="o10"||E=="o29"){var W=E=="o10"?a:o;if(l.length==0)console.debug("error: empty stack");else{var F=l.pop(),q=W.Subrs[F+W.Bias];i.x=p,i.y=_,i.nStems=u,i.haveWidth=h,i.width=d,i.open=f,e.U._drawCFF(q,i,o,a,c),p=i.x,_=i.y,u=i.nStems,h=i.haveWidth,d=i.width,f=i.open}}else if(E=="o30"||E=="o31"){var G=l.length,N=(V=0,E=="o31");for(V+=G-(D=-3&G);V<D;)N?(y=_,b=(T=p+l.shift())+l.shift(),_=(v=y+l.shift())+l.shift(),D-V==5?(p=b+l.shift(),V++):p=b,N=!1):(T=p,y=_+l.shift(),b=T+l.shift(),v=y+l.shift(),p=b+l.shift(),D-V==5?(_=v+l.shift(),V++):_=v,N=!0),e.U.P.curveTo(c,T,y,b,v,p,_),V+=4}else{if((E+"").charAt(0)=="o")throw console.debug("Unknown operation: "+E,s),E;l.push(E)}}}i.x=p,i.y=_,i.nStems=u,i.haveWidth=h,i.width=d,i.open=f};var t=e,n={Typr:t};return r.Typr=t,r.default=n,Object.defineProperty(r,"__esModule",{value:!0}),r}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function m_(){return function(r){var e=Uint8Array,t=Uint16Array,n=Uint32Array,s=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),i=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),o=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),a=function(E,D){for(var M=new t(31),U=0;U<31;++U)M[U]=D+=1<<E[U-1];var P=new n(M[30]);for(U=1;U<30;++U)for(var V=M[U];V<M[U+1];++V)P[V]=V-M[U]<<5|U;return[M,P]},c=a(s,2),l=c[0],u=c[1];l[28]=258,u[258]=28;for(var h=a(i,0)[0],d=new t(32768),f=0;f<32768;++f){var m=(43690&f)>>>1|(21845&f)<<1;m=(61680&(m=(52428&m)>>>2|(13107&m)<<2))>>>4|(3855&m)<<4,d[f]=((65280&m)>>>8|(255&m)<<8)>>>1}var p=function(E,D,M){for(var U=E.length,P=0,V=new t(D);P<U;++P)++V[E[P]-1];var Q,I=new t(D);for(P=0;P<D;++P)I[P]=I[P-1]+V[P-1]<<1;if(M){Q=new t(1<<D);var B=15-D;for(P=0;P<U;++P)if(E[P])for(var A=P<<4|E[P],R=D-E[P],H=I[E[P]-1]++<<R,W=H|(1<<R)-1;H<=W;++H)Q[d[H]>>>B]=A}else for(Q=new t(U),P=0;P<U;++P)E[P]&&(Q[P]=d[I[E[P]-1]++]>>>15-E[P]);return Q},_=new e(288);for(f=0;f<144;++f)_[f]=8;for(f=144;f<256;++f)_[f]=9;for(f=256;f<280;++f)_[f]=7;for(f=280;f<288;++f)_[f]=8;var T=new e(32);for(f=0;f<32;++f)T[f]=5;var y=p(_,9,1),b=p(T,5,1),v=function(E){for(var D=E[0],M=1;M<E.length;++M)E[M]>D&&(D=E[M]);return D},g=function(E,D,M){var U=D/8|0;return(E[U]|E[U+1]<<8)>>(7&D)&M},x=function(E,D){var M=D/8|0;return(E[M]|E[M+1]<<8|E[M+2]<<16)>>(7&D)},w=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],S=function(E,D,M){var U=new Error(D||w[E]);if(U.code=E,Error.captureStackTrace&&Error.captureStackTrace(U,S),!M)throw U;return U},C=function(E,D,M){var U=E.length;if(!U||M&&!M.l&&U<5)return D||new e(0);var P=!D||M,V=!M||M.i;M||(M={}),D||(D=new e(3*U));var Q,I=function(pe){var Pe=D.length;if(pe>Pe){var Ge=new e(Math.max(2*Pe,pe));Ge.set(D),D=Ge}},B=M.f||0,A=M.p||0,R=M.b||0,H=M.l,W=M.d,F=M.m,q=M.n,G=8*U;do{if(!H){M.f=B=g(E,A,1);var N=g(E,A+1,3);if(A+=3,!N){var te=E[(ee=((Q=A)/8|0)+(7&Q&&1)+4)-4]|E[ee-3]<<8,re=ee+te;if(re>U){V&&S(0);break}P&&I(R+te),D.set(E.subarray(ee,re),R),M.b=R+=te,M.p=A=8*re;continue}if(N==1)H=y,W=b,F=9,q=5;else if(N==2){var ne=g(E,A,31)+257,Z=g(E,A+10,15)+4,Te=ne+g(E,A+5,31)+1;A+=14;for(var ve=new e(Te),L=new e(19),X=0;X<Z;++X)L[o[X]]=g(E,A+3*X,7);A+=3*Z;var oe=v(L),j=(1<<oe)-1,$=p(L,oe,1);for(X=0;X<Te;){var ee,Y=$[g(E,A,j)];if(A+=15&Y,(ee=Y>>>4)<16)ve[X++]=ee;else{var ae=0,se=0;for(ee==16?(se=3+g(E,A,3),A+=2,ae=ve[X-1]):ee==17?(se=3+g(E,A,7),A+=3):ee==18&&(se=11+g(E,A,127),A+=7);se--;)ve[X++]=ae}}var ce=ve.subarray(0,ne),ie=ve.subarray(ne);F=v(ce),q=v(ie),H=p(ce,F,1),W=p(ie,q,1)}else S(1);if(A>G){V&&S(0);break}}P&&I(R+131072);for(var ke=(1<<F)-1,De=(1<<q)-1,ue=A;;ue=A){var xe=(ae=H[x(E,A)&ke])>>>4;if((A+=15&ae)>G){V&&S(0);break}if(ae||S(2),xe<256)D[R++]=xe;else{if(xe==256){ue=A,H=null;break}var Me=xe-254;if(xe>264){var pt=s[X=xe-257];Me=g(E,A,(1<<pt)-1)+l[X],A+=pt}var ye=W[x(E,A)&De],Ye=ye>>>4;if(ye||S(3),A+=15&ye,ie=h[Ye],Ye>3&&(pt=i[Ye],ie+=x(E,A)&(1<<pt)-1,A+=pt),A>G){V&&S(0);break}P&&I(R+131072);for(var be=R+Me;R<be;R+=4)D[R]=D[R-ie],D[R+1]=D[R+1-ie],D[R+2]=D[R+2-ie],D[R+3]=D[R+3-ie];R=be}}M.l=H,M.p=ue,M.b=R,H&&(B=1,M.m=F,M.d=W,M.n=q)}while(!B);return R==D.length?D:function(pe,Pe,Ge){(Pe==null||Pe<0)&&(Pe=0),(Ge==null||Ge>pe.length)&&(Ge=pe.length);var mt=new(pe instanceof t?t:pe instanceof n?n:e)(Ge-Pe);return mt.set(pe.subarray(Pe,Ge)),mt}(D,0,R)},O=new e(0),k=typeof TextDecoder<"u"&&new TextDecoder;try{k.decode(O,{stream:!0})}catch{}return r.convert_streams=function(E){var D=new DataView(E),M=0;function U(){var ne=D.getUint16(M);return M+=2,ne}function P(){var ne=D.getUint32(M);return M+=4,ne}function V(ne){te.setUint16(re,ne),re+=2}function Q(ne){te.setUint32(re,ne),re+=4}for(var I={signature:P(),flavor:P(),length:P(),numTables:U(),reserved:U(),totalSfntSize:P(),majorVersion:U(),minorVersion:U(),metaOffset:P(),metaLength:P(),metaOrigLength:P(),privOffset:P(),privLength:P()},B=0;Math.pow(2,B)<=I.numTables;)B++;B--;for(var A=16*Math.pow(2,B),R=16*I.numTables-A,H=12,W=[],F=0;F<I.numTables;F++)W.push({tag:P(),offset:P(),compLength:P(),origLength:P(),origChecksum:P()}),H+=16;var q,G=new Uint8Array(12+16*W.length+W.reduce(function(ne,Z){return ne+Z.origLength+4},0)),N=G.buffer,te=new DataView(N),re=0;return Q(I.flavor),V(I.numTables),V(A),V(B),V(R),W.forEach(function(ne){Q(ne.tag),Q(ne.origChecksum),Q(H),Q(ne.origLength),ne.outOffset=H,(H+=ne.origLength)%4!=0&&(H+=4-H%4)}),W.forEach(function(ne){var Z,Te=E.slice(ne.offset,ne.offset+ne.compLength);if(ne.compLength!=ne.origLength){var ve=new Uint8Array(ne.origLength);Z=new Uint8Array(Te,2),C(Z,ve)}else ve=new Uint8Array(Te);G.set(ve,ne.outOffset);var L=0;(H=ne.outOffset+ne.origLength)%4!=0&&(L=4-H%4),G.set(new Uint8Array(L).buffer,ne.outOffset+ne.origLength),q=H+L}),N.slice(0,q)},Object.defineProperty(r,"__esModule",{value:!0}),r}({}).convert_streams}function __(r,e){const t={M:2,L:2,Q:4,C:6,Z:0},n={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},s=1,i=2,o=4,a=8,c=16,l=32;let u;function h(g){if(!u){const x={R:i,L:s,D:o,C:c,U:l,T:a};u=new Map;for(let w in n){let S=0;n[w].split(",").forEach(C=>{let[O,k]=C.split("+");O=parseInt(O,36),k=k?parseInt(k,36):0,u.set(S+=O,x[w]);for(let E=k;E--;)u.set(++S,x[w])})}}return u.get(g)||l}const d=1,f=2,m=3,p=4,_=[null,"isol","init","fina","medi"];function T(g){const x=new Uint8Array(g.length);let w=l,S=d,C=-1;for(let O=0;O<g.length;O++){const k=g.codePointAt(O);let E=h(k)|0,D=d;E&a||(w&(s|o|c)?E&(i|o|c)?(D=m,(S===d||S===m)&&x[C]++):E&(s|l)&&(S===f||S===p)&&x[C]--:w&(i|l)&&(S===f||S===p)&&x[C]--,S=x[O]=D,w=E,C=O,k>65535&&O++)}return x}function y(g,x){const w=[];for(let C=0;C<x.length;C++){const O=x.codePointAt(C);O>65535&&C++,w.push(r.U.codeToGlyph(g,O))}const S=g.GSUB;if(S){const{lookupList:C,featureList:O}=S;let k;const E=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws)$/,D=[];O.forEach(M=>{if(E.test(M.tag))for(let U=0;U<M.tab.length;U++){if(D[M.tab[U]])continue;D[M.tab[U]]=!0;const P=C[M.tab[U]],V=/^(isol|init|fina|medi)$/.test(M.tag);V&&!k&&(k=T(x));for(let Q=0;Q<w.length;Q++)(!k||!V||_[k[Q]]===M.tag)&&r.U._applySubs(w,Q,P,C)}})}return w}function b(...g){for(let x=0;x<g.length;x++)if(typeof g[x]=="number")return g[x]}function v(g){const x=Object.create(null),w=g["OS/2"],S=g.hhea,C=g.head.unitsPerEm,O=b(w&&w.sTypoAscender,S&&S.ascender,C),k={unitsPerEm:C,ascender:O,descender:b(w&&w.sTypoDescender,S&&S.descender,0),capHeight:b(w&&w.sCapHeight,O),xHeight:b(w&&w.sxHeight,O),lineGap:b(w&&w.sTypoLineGap,S&&S.lineGap),forEachGlyph(E,D,M,U){let P=0;const V=1/k.unitsPerEm*D,Q=y(g,E);let I=0,B=-1;return Q.forEach((A,R)=>{if(A!==-1){let H=x[A];if(!H){const{cmds:W,crds:F}=r.U.glyphToPath(g,A);let q="",G=0;for(let Z=0,Te=W.length;Z<Te;Z++){const ve=t[W[Z]];q+=W[Z];for(let L=1;L<=ve;L++)q+=(L>1?",":"")+F[G++]}let N,te,re,ne;if(F.length){N=te=1/0,re=ne=-1/0;for(let Z=0,Te=F.length;Z<Te;Z+=2){let ve=F[Z],L=F[Z+1];ve<N&&(N=ve),L<te&&(te=L),ve>re&&(re=ve),L>ne&&(ne=L)}}else N=re=te=ne=0;H=x[A]={index:A,advanceWidth:g.hmtx.aWidth[A],xMin:N,yMin:te,xMax:re,yMax:ne,path:q,pathCommandCount:W.length}}B!==-1&&(P+=r.U.getPairAdjustment(g,B,A)*V),U.call(null,H,P,I),H.advanceWidth&&(P+=H.advanceWidth*V),M&&(P+=M*D),B=A}I+=E.codePointAt(I)>65535?2:1}),P}};return k}return function(x){const w=new Uint8Array(x,0,4),S=r._bin.readASCII(w,0,4);if(S==="wOFF")x=e(x);else if(S==="wOF2")throw new Error("woff2 fonts not supported");return v(r.parse(x)[0])}}const g_=_o({name:"Typr Font Parser",dependencies:[p_,m_,__],init(r,e,t){const n=r(),s=e();return t(n,s)}}),ki={defaultFontURL:"https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxM.woff",sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},v_=new Cn;function Ti(){return(self.performance||Date).now()}const hh=Object.create(null);function Ad(r,e){r=x_({},r);const t=Ti();if(r.font=w_(r.font||ki.defaultFontURL),r.text=""+r.text,r.sdfGlyphSize=r.sdfGlyphSize||ki.sdfGlyphSize,r.colorRanges!=null){let h={};for(let d in r.colorRanges)if(r.colorRanges.hasOwnProperty(d)){let f=r.colorRanges[d];typeof f!="number"&&(f=v_.set(f).getHex()),h[d]=f}r.colorRanges=h}Object.freeze(r);const{textureWidth:n,sdfExponent:s}=ki,{sdfGlyphSize:i}=r,o=n/i*4;let a=hh[i];if(!a){const h=document.createElement("canvas");h.width=n,h.height=i*256/o,a=hh[i]={glyphCount:0,sdfGlyphSize:i,sdfCanvas:h,sdfTexture:new Pl(h,void 0,void 0,void 0,zi,zi),contextLost:!1,glyphsByFont:new Map},a.sdfTexture.generateMipmaps=!1,y_(a)}const{sdfTexture:c,sdfCanvas:l}=a;let u=a.glyphsByFont.get(r.font);u||a.glyphsByFont.set(r.font,u=new Map),b_(r).then(h=>{const{glyphIds:d,glyphPositions:f,fontSize:m,unitsPerEm:p,timings:_}=h,T=[],y=new Float32Array(d.length*4),b=m/p;let v=0,g=0;const x=Ti();d.forEach((k,E)=>{let D=u.get(k);if(!D){const{path:V,pathBounds:Q}=h.glyphData[k],I=Math.max(Q[2]-Q[0],Q[3]-Q[1])/i*(ki.sdfMargin*i+.5),B=a.glyphCount++,A=[Q[0]-I,Q[1]-I,Q[2]+I,Q[3]+I];u.set(k,D={path:V,atlasIndex:B,sdfViewBox:A}),T.push(D)}const{sdfViewBox:M}=D,U=f[g++],P=f[g++];y[v++]=U+M[0]*b,y[v++]=P+M[1]*b,y[v++]=U+M[2]*b,y[v++]=P+M[3]*b,d[E]=D.atlasIndex}),_.quads=(_.quads||0)+(Ti()-x);const w=Ti();_.sdf={};const S=l.height,C=Math.ceil(a.glyphCount/o),O=Math.pow(2,Math.ceil(Math.log2(C*i)));O>S&&(console.info(`Increasing SDF texture size ${S}->${O}`),f_(l,n,O),c.dispose()),Promise.all(T.map(k=>kd(k,a,r.gpuAccelerateSDF).then(({timing:E})=>{_.sdf[k.atlasIndex]=E}))).then(()=>{T.length&&!a.contextLost&&(Dd(a),c.needsUpdate=!0),_.sdfTotal=Ti()-w,_.total=Ti()-t,e(Object.freeze({parameters:r,sdfTexture:c,sdfGlyphSize:i,sdfExponent:s,glyphBounds:y,glyphAtlasIndices:d,glyphColors:h.glyphColors,caretPositions:h.caretPositions,caretHeight:h.caretHeight,chunkedBounds:h.chunkedBounds,ascender:h.ascender,descender:h.descender,lineHeight:h.lineHeight,capHeight:h.capHeight,xHeight:h.xHeight,topBaseline:h.topBaseline,blockBounds:h.blockBounds,visibleBounds:h.visibleBounds,timings:h.timings}))})}),Promise.resolve().then(()=>{a.contextLost||d_(l)})}function kd({path:r,atlasIndex:e,sdfViewBox:t},{sdfGlyphSize:n,sdfCanvas:s,contextLost:i},o){if(i)return Promise.resolve({timing:-1});const{textureWidth:a,sdfExponent:c}=ki,l=Math.max(t[2]-t[0],t[3]-t[1]),u=Math.floor(e/4),h=u%(a/n)*n,d=Math.floor(u/(a/n))*n,f=e%4;return o_(n,n,r,t,l,c,s,h,d,f,o)}function y_(r){const e=r.sdfCanvas;e.addEventListener("webglcontextlost",t=>{console.log("Context Lost",t),t.preventDefault(),r.contextLost=!0}),e.addEventListener("webglcontextrestored",t=>{console.log("Context Restored",t),r.contextLost=!1;const n=[];r.glyphsByFont.forEach(s=>{s.forEach(i=>{n.push(kd(i,r,!0))})}),Promise.all(n).then(()=>{Dd(r),r.sdfTexture.needsUpdate=!0})})}function T_({font:r,characters:e,sdfGlyphSize:t},n){let s=Array.isArray(e)?e.join(`
`):""+e;Ad({font:r,sdfGlyphSize:t,text:s},n)}function x_(r,e){for(let t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);return r}let jo;function w_(r){return jo||(jo=typeof document>"u"?{}:document.createElement("a")),jo.href=r,jo.href}function Dd(r){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:e,sdfTexture:t}=r,{width:n,height:s}=e,i=r.sdfCanvas.getContext("webgl");let o=t.image.data;(!o||o.length!==n*s*4)&&(o=new Uint8Array(n*s*4),t.image={width:n,height:s,data:o},t.flipY=!1,t.isDataTexture=!0),i.readPixels(0,0,n,s,i.RGBA,i.UNSIGNED_BYTE,o)}}const S_=_o({name:"Typesetter",dependencies:[ki,g_,r_,Km],init(r,e,t,n){const{defaultFontURL:s}=r;return t(e,n(),{defaultFontURL:s})}}),b_=_o({name:"Typesetter",dependencies:[S_],init(r){return function(e){return new Promise(t=>{r.typeset(e,t)})}},getTransferables(r){const e=[r.glyphPositions.buffer,r.glyphIds.buffer];return r.caretPositions&&e.push(r.caretPositions.buffer),r.glyphColors&&e.push(r.glyphColors.buffer),e}}),dh={};function C_(r){let e=dh[r];if(!e){const t=new Ul(1,1,r,r),n=t.clone(),s=t.attributes,i=n.attributes,o=new yd,a=s.uv.count;for(let c=0;c<a;c++)i.position.array[c*3]*=-1,i.normal.array[c*3+2]*=-1;["position","normal","uv"].forEach(c=>{o.setAttribute(c,new _m([...s[c].array,...i[c].array],s[c].itemSize))}),o.setIndex([...t.index.array,...n.index.array.map(c=>c+a)]),o.translate(.5,.5,0),e=dh[r]=o}return e}const E_="aTroikaGlyphBounds",fh="aTroikaGlyphIndex",O_="aTroikaGlyphColor";class A_ extends lm{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new um,this.boundingBox=new hm}computeBoundingSphere(){}computeBoundingBox(){}setSide(e){const t=this.getIndex().count;this.setDrawRange(e===Pr?t/2:0,e===Ai?t:t/2)}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let t=C_(e);["position","normal","uv"].forEach(n=>{this.attributes[n]=t.attributes[n].clone()}),this.setIndex(t.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,t,n,s,i){Rc(this,E_,e,4),Rc(this,fh,t,1),Rc(this,O_,i,3),this._blockBounds=n,this._chunkedBounds=s,this.instanceCount=t.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:t,boundingBox:n}=this;if(t){const{PI:s,floor:i,min:o,max:a,sin:c,cos:l}=Math,u=s/2,h=s*2,d=Math.abs(t),f=e[0]/d,m=e[2]/d,p=i((f+u)/h)!==i((m+u)/h)?-d:o(c(f)*d,c(m)*d),_=i((f-u)/h)!==i((m-u)/h)?d:a(c(f)*d,c(m)*d),T=i((f+s)/h)!==i((m+s)/h)?d*2:a(d-l(f)*d,d-l(m)*d);n.min.set(p,e[1],t<0?-T:0),n.max.set(_,e[3],t<0?0:T)}else n.min.set(e[0],e[1],0),n.max.set(e[2],e[3],0);n.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let t=this.getAttribute(fh).count,n=this._chunkedBounds;if(n)for(let s=n.length;s--;){t=n[s].end;let i=n[s].rect;if(i[1]<e.w&&i[3]>e.y&&i[0]<e.z&&i[2]>e.x)break}this.instanceCount=t}}function Rc(r,e,t,n){const s=r.getAttribute(e);t?s&&s.array.length===t.length?(s.array.set(t),s.needsUpdate=!0):(r.setAttribute(e,new dm(t,n)),delete r._maxInstanceCount,r.dispose()):s&&r.deleteAttribute(e)}const k_=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaDistanceOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,D_=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,M_=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaDistanceOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaOutlineOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,R_=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function P_(r){const e=il(r,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new Xe},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new fa(0,0,0,0)},uTroikaClipRect:{value:new fa(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new Xe},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Cn},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new fm},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:k_,vertexTransform:D_,fragmentDefs:M_,fragmentColorTransform:R_,customRewriter({vertexShader:t,fragmentShader:n}){let s=/\buniform\s+vec3\s+diffuse\b/;return s.test(n)&&(n=n.replace(s,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),s.test(t)||(t=t.replace(Ed,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:t,fragmentShader:n}}});return e.transparent=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}const Bl=new pm({color:16777215,side:Ai,transparent:!0}),ph=8421504,mh=new mm,Yo=new tt,Pc=new tt,Er=[],U_=new tt,Uc="+x+y";function _h(r){return Array.isArray(r)?r[0]:r}let Md=()=>{const r=new Wa(new Ul(1,1),Bl);return Md=()=>r,r},Rd=()=>{const r=new Wa(new Ul(1,1,32,1),Bl);return Rd=()=>r,r};const I_={type:"syncstart"},F_={type:"synccomplete"},Pd=["font","fontSize","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],N_=Pd.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let Ud=class extends Wa{constructor(){const e=new A_;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.fontSize=.1,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=ph,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=Uc,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(I_),Ad({text:this.text,font:this.font,fontSize:this.fontSize||.1,letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF},t=>{this._isSyncing=!1,this._textRenderInfo=t,this.geometry.updateGlyphs(t.glyphBounds,t.glyphAtlasIndices,t.blockBounds,t.chunkedBounds,t.glyphColors);const n=this._queuedSyncs;n&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{n.forEach(s=>s&&s())})),this.dispatchEvent(F_),e&&e()})))}onBeforeRender(e,t,n,s,i,o){this.sync(),i.isTroikaTextMaterial&&this._prepareForRender(i),i._hadOwnSide=i.hasOwnProperty("side"),this.geometry.setSide(i._actualSide=i.side),i.side=vd}onAfterRender(e,t,n,s,i,o){i._hadOwnSide?i.side=i._actualSide:delete i.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let e=this._derivedMaterial;const t=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=Bl.clone());if((!e||e.baseMaterial!==t)&&(e=this._derivedMaterial=P_(t),t.addEventListener("dispose",function n(){t.removeEventListener("dispose",n),e.dispose()})),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let n=e._outlineMtl;return n||(n=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),n.isTextOutlineMaterial=!0,n.depthWrite=!1,n.map=null,e.addEventListener("dispose",function s(){e.removeEventListener("dispose",s),n.dispose()})),[n,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return _h(this.material).getDepthMaterial()}get customDistanceMaterial(){return _h(this.material).getDistanceMaterial()}_prepareForRender(e){const t=e.isTextOutlineMaterial,n=e.uniforms,s=this.textRenderInfo;if(s){const{sdfTexture:a,blockBounds:c}=s;n.uTroikaSDFTexture.value=a,n.uTroikaSDFTextureSize.value.set(a.image.width,a.image.height),n.uTroikaSDFGlyphSize.value=s.sdfGlyphSize,n.uTroikaSDFExponent.value=s.sdfExponent,n.uTroikaTotalBounds.value.fromArray(c),n.uTroikaUseGlyphColors.value=!t&&!!s.glyphColors;let l=0,u=0,h=0,d,f,m,p=0,_=0;if(t){let{outlineWidth:y,outlineOffsetX:b,outlineOffsetY:v,outlineBlur:g,outlineOpacity:x}=this;l=this._parsePercent(y)||0,u=Math.max(0,this._parsePercent(g)||0),d=x,p=this._parsePercent(b)||0,_=this._parsePercent(v)||0}else h=Math.max(0,this._parsePercent(this.strokeWidth)||0),h&&(m=this.strokeColor,n.uTroikaStrokeColor.value.set(m??ph),f=this.strokeOpacity,f==null&&(f=1)),d=this.fillOpacity;n.uTroikaDistanceOffset.value=l,n.uTroikaPositionOffset.value.set(p,_),n.uTroikaBlurRadius.value=u,n.uTroikaStrokeWidth.value=h,n.uTroikaStrokeOpacity.value=f,n.uTroikaFillOpacity.value=d??1,n.uTroikaCurveRadius.value=this.curveRadius||0;let T=this.clipRect;if(T&&Array.isArray(T)&&T.length===4)n.uTroikaClipRect.value.fromArray(T);else{const y=(this.fontSize||.1)*100;n.uTroikaClipRect.value.set(c[0]-y,c[1]-y,c[2]+y,c[3]+y)}this.geometry.applyClipRect(n.uTroikaClipRect.value)}n.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const i=t?this.outlineColor||0:this.color;if(i==null)delete e.color;else{const a=e.hasOwnProperty("color")?e.color:e.color=new Cn;(i!==a._input||typeof i=="object")&&a.set(a._input=i)}let o=this.orientation||Uc;if(o!==e._orientation){let a=n.uTroikaOrient.value;o=o.replace(/[^-+xyz]/g,"");let c=o!==Uc&&o.match(/^([-+])([xyz])([-+])([xyz])$/);if(c){let[,l,u,h,d]=c;Yo.set(0,0,0)[u]=l==="-"?1:-1,Pc.set(0,0,0)[d]=h==="-"?-1:1,mh.lookAt(U_,Yo.cross(Pc),Pc),a.setFromMatrix4(mh)}else a.identity();e._orientation=o}}_parsePercent(e){if(typeof e=="string"){let t=e.match(/^(-?[\d.]+)%$/),n=t?parseFloat(t[1]):NaN;e=(isNaN(n)?0:n/100)*this.fontSize}return e}localPositionToTextCoords(e,t=new Xe){t.copy(e);const n=this.curveRadius;return n&&(t.x=Math.atan2(e.x,Math.abs(n)-Math.abs(e.z))*Math.abs(n)),t}worldPositionToTextCoords(e,t=new Xe){return Yo.copy(e),this.localPositionToTextCoords(this.worldToLocal(Yo),t)}raycast(e,t){const{textRenderInfo:n,curveRadius:s}=this;if(n){const i=n.blockBounds,o=s?Rd():Md(),a=o.geometry,{position:c,uv:l}=a.attributes;for(let u=0;u<l.count;u++){let h=i[0]+l.getX(u)*(i[2]-i[0]);const d=i[1]+l.getY(u)*(i[3]-i[1]);let f=0;s&&(f=s-Math.cos(h/s)*s,h=Math.sin(h/s)*s),c.setXYZ(u,h,d,f)}a.boundingSphere=this.geometry.boundingSphere,a.boundingBox=this.geometry.boundingBox,o.matrixWorld=this.matrixWorld,o.material.side=this.material.side,Er.length=0,o.raycast(e,Er);for(let u=0;u<Er.length;u++)Er[u].object=this,t.push(Er[u])}}copy(e){const t=this.geometry;return super.copy(e),this.geometry=t,N_.forEach(n=>{this[n]=e[n]}),this}clone(){return new this.constructor().copy(this)}};Pd.forEach(r=>{const e="_private_"+r;Object.defineProperty(Ud.prototype,r,{get(){return this[e]},set(t){t!==this[e]&&(this[e]=t,this._needsSync=!0)}})});function L_(r,e,t=(n,s)=>n===s){if(r===e)return!0;if(!r||!e)return!1;const n=r.length;if(e.length!==n)return!1;for(let s=0;s<n;s++)if(!t(r[s],e[s]))return!1;return!0}const Xo=[];function B_(r,e,t=!1,n={}){for(const i of Xo)if(L_(e,i.keys,i.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(i,"error"))throw i.error;if(Object.prototype.hasOwnProperty.call(i,"response"))return i.response;if(!t)throw i.promise}const s={keys:e,equal:n.equal,promise:r(...e).then(i=>s.response=i).then(()=>{n.lifespan&&n.lifespan>0&&setTimeout(()=>{const i=Xo.indexOf(s);i!==-1&&Xo.splice(i,1)},n.lifespan)}).catch(i=>s.error=i)};if(Xo.push(s),!t)throw s.promise}const z_=(r,e,t)=>B_(r,e,!1,t),WS=J.forwardRef(({anchorX:r="center",anchorY:e="middle",font:t,fontSize:n=1,children:s,characters:i,onSync:o,...a},c)=>{const l=Qe(({invalidate:f})=>f),[u]=J.useState(()=>new Ud),[h,d]=J.useMemo(()=>{const f=[];let m="";return J.Children.forEach(s,p=>{typeof p=="string"||typeof p=="number"?m+=p:f.push(p)}),[f,m]},[s]);return z_(()=>new Promise(f=>T_({font:t,characters:i},f)),["troika-text",t,i]),J.useLayoutEffect(()=>void u.sync(()=>{l(),o&&o(u)})),J.useEffect(()=>()=>u.dispose(),[u]),J.createElement("primitive",Ga({object:u,ref:c,font:t,text:d,anchorX:r,anchorY:e,fontSize:n},a),h)});/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */const fe={LEFT:1,RIGHT:2,MIDDLE:4},z=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768}),xi={NONE:0,IN:1,OUT:-1};function Gs(r){return r.isPerspectiveCamera}function Ts(r){return r.isOrthographicCamera}const wi=Math.PI*2,gh=Math.PI/2,Id=1e-5,Or=Math.PI/180;function Sn(r,e,t){return Math.max(e,Math.min(t,r))}function We(r,e=Id){return Math.abs(r)<e}function Re(r,e,t=Id){return We(r-e,t)}function vh(r,e){return Math.round(r/e)*e}function Ar(r){return isFinite(r)?r:r<0?-Number.MAX_VALUE:Number.MAX_VALUE}function kr(r){return Math.abs(r)<Number.MAX_VALUE?r:r*(1/0)}function Zo(r,e,t,n,s=1/0,i){n=Math.max(1e-4,n);const o=2/n,a=o*i,c=1/(1+a+.48*a*a+.235*a*a*a);let l=r-e;const u=e,h=s*n;l=Sn(l,-h,h),e=r-l;const d=(t.value+o*l)*i;t.value=(t.value-o*d)*c;let f=e+(l+d)*c;return u-r>0==f>u&&(f=u,t.value=(f-u)/i),f}function yh(r,e,t,n,s=1/0,i,o){n=Math.max(1e-4,n);const a=2/n,c=a*i,l=1/(1+c+.48*c*c+.235*c*c*c);let u=e.x,h=e.y,d=e.z,f=r.x-u,m=r.y-h,p=r.z-d;const _=u,T=h,y=d,b=s*n,v=b*b,g=f*f+m*m+p*p;if(g>v){const U=Math.sqrt(g);f=f/U*b,m=m/U*b,p=p/U*b}u=r.x-f,h=r.y-m,d=r.z-p;const x=(t.x+a*f)*i,w=(t.y+a*m)*i,S=(t.z+a*p)*i;t.x=(t.x-a*x)*l,t.y=(t.y-a*w)*l,t.z=(t.z-a*S)*l,o.x=u+(f+x)*l,o.y=h+(m+w)*l,o.z=d+(p+S)*l;const C=_-r.x,O=T-r.y,k=y-r.z,E=o.x-_,D=o.y-T,M=o.z-y;return C*E+O*D+k*M>0&&(o.x=_,o.y=T,o.z=y,t.x=(o.x-_)/i,t.y=(o.y-T)/i,t.z=(o.z-y)/i),o}function Ic(r,e){e.set(0,0),r.forEach(t=>{e.x+=t.clientX,e.y+=t.clientY}),e.x/=r.length,e.y/=r.length}function Fc(r,e){return Ts(r)?(console.warn(`${e} is not supported in OrthographicCamera`),!0):!1}class V_{constructor(){this._listeners={}}addEventListener(e,t){const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const s=this._listeners[e];if(s!==void 0){const i=s.indexOf(t);i!==-1&&s.splice(i,1)}}removeAllEventListeners(e){if(!e){this._listeners={};return}Array.isArray(this._listeners[e])&&(this._listeners[e].length=0)}dispatchEvent(e){const n=this._listeners[e.type];if(n!==void 0){e.target=this;const s=n.slice(0);for(let i=0,o=s.length;i<o;i++)s[i].call(this,e)}}}const G_="2.7.3",Qo=1/8,Fd=typeof window<"u",W_=Fd&&/Mac/.test(navigator.platform),H_=!(Fd&&"PointerEvent"in window);let de,Th,Ko,Nc,Vt,ge,Oe,Si,Dr,Fn,Nn,Ws,xh,wh,ln,Mr,bi,Sh,Lc,bh,Bc,zc,Jo,Vc=class ol extends V_{static install(e){de=e.THREE,Th=Object.freeze(new de.Vector3(0,0,0)),Ko=Object.freeze(new de.Vector3(0,1,0)),Nc=Object.freeze(new de.Vector3(0,0,1)),Vt=new de.Vector2,ge=new de.Vector3,Oe=new de.Vector3,Si=new de.Vector3,Dr=new de.Vector3,Fn=new de.Vector3,Nn=new de.Vector3,Ws=new de.Vector3,xh=new de.Vector3,wh=new de.Vector3,ln=new de.Spherical,Mr=new de.Spherical,bi=new de.Box3,Sh=new de.Box3,Lc=new de.Sphere,bh=new de.Quaternion,Bc=new de.Quaternion,zc=new de.Matrix4,Jo=new de.Raycaster}static get ACTION(){return z}constructor(e,t){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=z.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=xi.NONE,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new de.Vector3,this._focalOffsetVelocity=new de.Vector3,this._zoomVelocity={value:0},this._truckInternal=(v,g,x)=>{let w,S;if(Gs(this._camera)){const C=ge.copy(this._camera.position).sub(this._target),O=this._camera.getEffectiveFOV()*Or,k=C.length()*Math.tan(O*.5);w=this.truckSpeed*v*k/this._elementRect.height,S=this.truckSpeed*g*k/this._elementRect.height}else if(Ts(this._camera)){const C=this._camera;w=v*(C.right-C.left)/C.zoom/this._elementRect.width,S=g*(C.top-C.bottom)/C.zoom/this._elementRect.height}else return;this.verticalDragToForward?(x?this.setFocalOffset(this._focalOffsetEnd.x+w,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(w,0,!0),this.forward(-S,!0)):x?this.setFocalOffset(this._focalOffsetEnd.x+w,this._focalOffsetEnd.y+S,this._focalOffsetEnd.z,!0):this.truck(w,S,!0)},this._rotateInternal=(v,g)=>{const x=wi*this.azimuthRotateSpeed*v/this._elementRect.height,w=wi*this.polarRotateSpeed*g/this._elementRect.height;this.rotate(x,w,!0)},this._dollyInternal=(v,g,x)=>{const w=Math.pow(.95,-v*this.dollySpeed),S=this._sphericalEnd.radius,C=this._sphericalEnd.radius*w,O=Sn(C,this.minDistance,this.maxDistance),k=O-C;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(C,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(k,!0),this._dollyToNoClamp(O,!0)):this._dollyToNoClamp(O,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?C:O)-S,this._dollyControlCoord.set(g,x)),this._lastDollyDirection=Math.sign(-v)},this._zoomInternal=(v,g,x)=>{const w=Math.pow(.95,v*this.dollySpeed),S=this._zoom,C=this._zoom*w;this.zoomTo(C,!0),this.dollyToCursor&&(this._changedZoom+=C-S,this._dollyControlCoord.set(g,x))},typeof de>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=new de.Quaternion().setFromUnitVectors(this._camera.up,Ko),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=z.NONE,this._target=new de.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new de.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=new de.Spherical().setFromVector3(ge.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new de.Vector3,new de.Vector3,new de.Vector3,new de.Vector3],this._updateNearPlaneCorners(),this._boundary=new de.Box3(new de.Vector3(-1/0,-1/0,-1/0),new de.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new de.Vector2,this.mouseButtons={left:z.ROTATE,middle:z.DOLLY,right:z.TRUCK,wheel:Gs(this._camera)?z.DOLLY:Ts(this._camera)?z.ZOOM:z.NONE},this.touches={one:z.TOUCH_ROTATE,two:Gs(this._camera)?z.TOUCH_DOLLY_TRUCK:Ts(this._camera)?z.TOUCH_ZOOM_TRUCK:z.NONE,three:z.TOUCH_TRUCK};const n=new de.Vector2,s=new de.Vector2,i=new de.Vector2,o=v=>{if(!this._enabled||!this._domElement)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const w=this._domElement.getBoundingClientRect(),S=v.clientX/w.width,C=v.clientY/w.height;if(S<this._interactiveArea.left||S>this._interactiveArea.right||C<this._interactiveArea.top||C>this._interactiveArea.bottom)return}const g=v.pointerType!=="mouse"?null:(v.buttons&fe.LEFT)===fe.LEFT?fe.LEFT:(v.buttons&fe.MIDDLE)===fe.MIDDLE?fe.MIDDLE:(v.buttons&fe.RIGHT)===fe.RIGHT?fe.RIGHT:null;if(g!==null){const w=this._findPointerByMouseButton(g);w&&this._disposePointer(w)}if((v.buttons&fe.LEFT)===fe.LEFT&&this._lockedPointer)return;const x={pointerId:v.pointerId,clientX:v.clientX,clientY:v.clientY,deltaX:0,deltaY:0,mouseButton:g};this._activePointers.push(x),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",u),this._domElement.ownerDocument.addEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",u),this._isDragging=!0,p(v)},a=v=>{if(!this._enabled||!this._domElement||this._lockedPointer)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const w=this._domElement.getBoundingClientRect(),S=v.clientX/w.width,C=v.clientY/w.height;if(S<this._interactiveArea.left||S>this._interactiveArea.right||C<this._interactiveArea.top||C>this._interactiveArea.bottom)return}const g=(v.buttons&fe.LEFT)===fe.LEFT?fe.LEFT:(v.buttons&fe.MIDDLE)===fe.MIDDLE?fe.MIDDLE:(v.buttons&fe.RIGHT)===fe.RIGHT?fe.RIGHT:null;if(g!==null){const w=this._findPointerByMouseButton(g);w&&this._disposePointer(w)}const x={pointerId:1,clientX:v.clientX,clientY:v.clientY,deltaX:0,deltaY:0,mouseButton:(v.buttons&fe.LEFT)===fe.LEFT?fe.LEFT:(v.buttons&fe.MIDDLE)===fe.LEFT?fe.MIDDLE:(v.buttons&fe.RIGHT)===fe.LEFT?fe.RIGHT:null};this._activePointers.push(x),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("mouseup",h),this._domElement.ownerDocument.addEventListener("mousemove",l),this._domElement.ownerDocument.addEventListener("mouseup",h),this._isDragging=!0,p(v)},c=v=>{v.cancelable&&v.preventDefault();const g=v.pointerId,x=this._lockedPointer||this._findPointerById(g);if(x){if(x.clientX=v.clientX,x.clientY=v.clientY,x.deltaX=v.movementX,x.deltaY=v.movementY,this._state=0,v.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(v.buttons&fe.LEFT)===fe.LEFT)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(v.buttons&fe.MIDDLE)===fe.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(v.buttons&fe.RIGHT)===fe.RIGHT&&(this._state=this._state|this.mouseButtons.right);_()}},l=v=>{const g=this._lockedPointer||this._findPointerById(1);g&&(g.clientX=v.clientX,g.clientY=v.clientY,g.deltaX=v.movementX,g.deltaY=v.movementY,this._state=0,(this._lockedPointer||(v.buttons&fe.LEFT)===fe.LEFT)&&(this._state=this._state|this.mouseButtons.left),(v.buttons&fe.MIDDLE)===fe.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(v.buttons&fe.RIGHT)===fe.RIGHT&&(this._state=this._state|this.mouseButtons.right),_())},u=v=>{const g=this._findPointerById(v.pointerId);if(!(g&&g===this._lockedPointer)){if(g&&this._disposePointer(g),v.pointerType==="touch")switch(this._activePointers.length){case 0:this._state=z.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else this._state=z.NONE;T()}},h=()=>{const v=this._findPointerById(1);v&&v===this._lockedPointer||(v&&this._disposePointer(v),this._state=z.NONE,T())};let d=-1;const f=v=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===z.NONE)return;if(this._interactiveArea.left!==0||this._interactiveArea.top!==0||this._interactiveArea.width!==1||this._interactiveArea.height!==1){const C=this._domElement.getBoundingClientRect(),O=v.clientX/C.width,k=v.clientY/C.height;if(O<this._interactiveArea.left||O>this._interactiveArea.right||k<this._interactiveArea.top||k>this._interactiveArea.bottom)return}if(v.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===z.ROTATE||this.mouseButtons.wheel===z.TRUCK){const C=performance.now();d-C<1e3&&this._getClientRect(this._elementRect),d=C}const g=W_?-1:-3,x=v.deltaMode===1?v.deltaY/g:v.deltaY/(g*10),w=this.dollyToCursor?(v.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,S=this.dollyToCursor?(v.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case z.ROTATE:{this._rotateInternal(v.deltaX,v.deltaY),this._isUserControllingRotate=!0;break}case z.TRUCK:{this._truckInternal(v.deltaX,v.deltaY,!1),this._isUserControllingTruck=!0;break}case z.OFFSET:{this._truckInternal(v.deltaX,v.deltaY,!0),this._isUserControllingOffset=!0;break}case z.DOLLY:{this._dollyInternal(-x,w,S),this._isUserControllingDolly=!0;break}case z.ZOOM:{this._zoomInternal(-x,w,S),this._isUserControllingZoom=!0;break}}this.dispatchEvent({type:"control"})},m=v=>{if(!(!this._domElement||!this._enabled)){if(this.mouseButtons.right===ol.ACTION.NONE){const g=v instanceof PointerEvent?v.pointerId:(v instanceof MouseEvent,0),x=this._findPointerById(g);x&&this._disposePointer(x),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",u),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("mouseup",h);return}v.preventDefault()}},p=v=>{if(!this._enabled)return;if(Ic(this._activePointers,Vt),this._getClientRect(this._elementRect),n.copy(Vt),s.copy(Vt),this._activePointers.length>=2){const x=Vt.x-this._activePointers[1].clientX,w=Vt.y-this._activePointers[1].clientY,S=Math.sqrt(x*x+w*w);i.set(0,S);const C=(this._activePointers[0].clientX+this._activePointers[1].clientX)*.5,O=(this._activePointers[0].clientY+this._activePointers[1].clientY)*.5;s.set(C,O)}if(this._state=0,!v)this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);else if("pointerType"in v&&v.pointerType==="touch")switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three;break}else!this._lockedPointer&&(v.buttons&fe.LEFT)===fe.LEFT&&(this._state=this._state|this.mouseButtons.left),(v.buttons&fe.MIDDLE)===fe.MIDDLE&&(this._state=this._state|this.mouseButtons.middle),(v.buttons&fe.RIGHT)===fe.RIGHT&&(this._state=this._state|this.mouseButtons.right);((this._state&z.ROTATE)===z.ROTATE||(this._state&z.TOUCH_ROTATE)===z.TOUCH_ROTATE||(this._state&z.TOUCH_DOLLY_ROTATE)===z.TOUCH_DOLLY_ROTATE||(this._state&z.TOUCH_ZOOM_ROTATE)===z.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&z.TRUCK)===z.TRUCK||(this._state&z.TOUCH_TRUCK)===z.TOUCH_TRUCK||(this._state&z.TOUCH_DOLLY_TRUCK)===z.TOUCH_DOLLY_TRUCK||(this._state&z.TOUCH_ZOOM_TRUCK)===z.TOUCH_ZOOM_TRUCK)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&z.DOLLY)===z.DOLLY||(this._state&z.TOUCH_DOLLY)===z.TOUCH_DOLLY||(this._state&z.TOUCH_DOLLY_TRUCK)===z.TOUCH_DOLLY_TRUCK||(this._state&z.TOUCH_DOLLY_OFFSET)===z.TOUCH_DOLLY_OFFSET||(this._state&z.TOUCH_DOLLY_ROTATE)===z.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&z.ZOOM)===z.ZOOM||(this._state&z.TOUCH_ZOOM)===z.TOUCH_ZOOM||(this._state&z.TOUCH_ZOOM_TRUCK)===z.TOUCH_ZOOM_TRUCK||(this._state&z.TOUCH_ZOOM_OFFSET)===z.TOUCH_ZOOM_OFFSET||(this._state&z.TOUCH_ZOOM_ROTATE)===z.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&z.OFFSET)===z.OFFSET||(this._state&z.TOUCH_OFFSET)===z.TOUCH_OFFSET||(this._state&z.TOUCH_DOLLY_OFFSET)===z.TOUCH_DOLLY_OFFSET||(this._state&z.TOUCH_ZOOM_OFFSET)===z.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})},_=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,Ic(this._activePointers,Vt);const g=this._domElement&&document.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,x=g?-g.deltaX:s.x-Vt.x,w=g?-g.deltaY:s.y-Vt.y;if(s.copy(Vt),((this._state&z.ROTATE)===z.ROTATE||(this._state&z.TOUCH_ROTATE)===z.TOUCH_ROTATE||(this._state&z.TOUCH_DOLLY_ROTATE)===z.TOUCH_DOLLY_ROTATE||(this._state&z.TOUCH_ZOOM_ROTATE)===z.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(x,w),this._isUserControllingRotate=!0),(this._state&z.DOLLY)===z.DOLLY||(this._state&z.ZOOM)===z.ZOOM){const S=this.dollyToCursor?(n.x-this._elementRect.x)/this._elementRect.width*2-1:0,C=this.dollyToCursor?(n.y-this._elementRect.y)/this._elementRect.height*-2+1:0,O=this.dollyDragInverted?-1:1;(this._state&z.DOLLY)===z.DOLLY?(this._dollyInternal(O*w*Qo,S,C),this._isUserControllingDolly=!0):(this._zoomInternal(O*w*Qo,S,C),this._isUserControllingZoom=!0)}if((this._state&z.TOUCH_DOLLY)===z.TOUCH_DOLLY||(this._state&z.TOUCH_ZOOM)===z.TOUCH_ZOOM||(this._state&z.TOUCH_DOLLY_TRUCK)===z.TOUCH_DOLLY_TRUCK||(this._state&z.TOUCH_ZOOM_TRUCK)===z.TOUCH_ZOOM_TRUCK||(this._state&z.TOUCH_DOLLY_OFFSET)===z.TOUCH_DOLLY_OFFSET||(this._state&z.TOUCH_ZOOM_OFFSET)===z.TOUCH_ZOOM_OFFSET||(this._state&z.TOUCH_DOLLY_ROTATE)===z.TOUCH_DOLLY_ROTATE||(this._state&z.TOUCH_ZOOM_ROTATE)===z.TOUCH_ZOOM_ROTATE){const S=Vt.x-this._activePointers[1].clientX,C=Vt.y-this._activePointers[1].clientY,O=Math.sqrt(S*S+C*C),k=i.y-O;i.set(0,O);const E=this.dollyToCursor?(s.x-this._elementRect.x)/this._elementRect.width*2-1:0,D=this.dollyToCursor?(s.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&z.TOUCH_DOLLY)===z.TOUCH_DOLLY||(this._state&z.TOUCH_DOLLY_ROTATE)===z.TOUCH_DOLLY_ROTATE||(this._state&z.TOUCH_DOLLY_TRUCK)===z.TOUCH_DOLLY_TRUCK||(this._state&z.TOUCH_DOLLY_OFFSET)===z.TOUCH_DOLLY_OFFSET?(this._dollyInternal(k*Qo,E,D),this._isUserControllingDolly=!0):(this._zoomInternal(k*Qo,E,D),this._isUserControllingZoom=!0)}((this._state&z.TRUCK)===z.TRUCK||(this._state&z.TOUCH_TRUCK)===z.TOUCH_TRUCK||(this._state&z.TOUCH_DOLLY_TRUCK)===z.TOUCH_DOLLY_TRUCK||(this._state&z.TOUCH_ZOOM_TRUCK)===z.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(x,w,!1),this._isUserControllingTruck=!0),((this._state&z.OFFSET)===z.OFFSET||(this._state&z.TOUCH_OFFSET)===z.TOUCH_OFFSET||(this._state&z.TOUCH_DOLLY_OFFSET)===z.TOUCH_DOLLY_OFFSET||(this._state&z.TOUCH_ZOOM_OFFSET)===z.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(x,w,!0),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},T=()=>{Ic(this._activePointers,Vt),s.copy(Vt),this._dragNeedsUpdate=!1,(this._activePointers.length===0||this._activePointers.length===1&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),this._activePointers.length===0&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("pointerup",u),this._domElement.ownerDocument.removeEventListener("mouseup",h),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{!this._enabled||!this._domElement||(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",u),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",y),this._domElement.ownerDocument.addEventListener("pointerlockerror",b),this._domElement.ownerDocument.addEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",u),p())},this.unlockPointer=()=>{this._lockedPointer!==null&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),document.exitPointerLock(),this.cancel(),this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointerlockchange",y),this._domElement.ownerDocument.removeEventListener("pointerlockerror",b))};const y=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},b=()=>{this.unlockPointer()};this._addAllEventListeners=v=>{this._domElement=v,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",o),H_&&this._domElement.addEventListener("mousedown",a),this._domElement.addEventListener("pointercancel",u),this._domElement.addEventListener("wheel",f,{passive:!1}),this._domElement.addEventListener("contextmenu",m)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",o),this._domElement.removeEventListener("mousedown",a),this._domElement.removeEventListener("pointercancel",u),this._domElement.removeEventListener("wheel",f,{passive:!1}),this._domElement.removeEventListener("contextmenu",m),this._domElement.ownerDocument.removeEventListener("pointermove",c,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("pointerup",u),this._domElement.ownerDocument.removeEventListener("mouseup",h),this._domElement.ownerDocument.removeEventListener("pointerlockchange",y),this._domElement.ownerDocument.removeEventListener("pointerlockerror",b))},this.cancel=()=>{this._state!==z.NONE&&(this._state=z.NONE,this._activePointers.length=0,T())},t&&this.connect(t),this.update(0)}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){this._spherical.radius===e&&this._sphericalEnd.radius===e||(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){this._spherical.theta===e&&this._sphericalEnd.theta===e||(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){this._spherical.phi===e&&this._sphericalEnd.phi===e||(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=Sn(e.width,0,1),this._interactiveArea.height=Sn(e.height,0,1),this._interactiveArea.x=Sn(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=Sn(e.y,0,1-this._interactiveArea.height)}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t,n=!1){return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,n)}rotateAzimuthTo(e,t=!1){return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e,t=!1){return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t,n=!1){this._isUserControllingRotate=!1;const s=Sn(e,this.minAzimuthAngle,this.maxAzimuthAngle),i=Sn(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=s,this._sphericalEnd.phi=i,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,n||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const o=!n||Re(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Re(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(o)}dolly(e,t=!1){return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e,t=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=xi.NONE,this._changedDolly=0,this._dollyToNoClamp(Sn(e,this.minDistance,this.maxDistance),t)}_dollyToNoClamp(e,t=!1){const n=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const o=this._collisionTest(),a=Re(o,this._spherical.radius);if(!(n>e)&&a)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,o)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);const i=!t||Re(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(i)}dollyInFixed(e,t=!1){this._targetEnd.add(this._getCameraDirection(Dr).multiplyScalar(e)),t||this._target.copy(this._targetEnd);const n=!t||Re(this._target.x,this._targetEnd.x,this.restThreshold)&&Re(this._target.y,this._targetEnd.y,this.restThreshold)&&Re(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(n)}zoom(e,t=!1){return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e,t=!1){this._isUserControllingZoom=!1,this._zoomEnd=Sn(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);const n=!t||Re(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(n)}pan(e,t,n=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,n)}truck(e,t,n=!1){this._camera.updateMatrix(),Fn.setFromMatrixColumn(this._camera.matrix,0),Nn.setFromMatrixColumn(this._camera.matrix,1),Fn.multiplyScalar(e),Nn.multiplyScalar(-t);const s=ge.copy(Fn).add(Nn),i=Oe.copy(this._targetEnd).add(s);return this.moveTo(i.x,i.y,i.z,n)}forward(e,t=!1){ge.setFromMatrixColumn(this._camera.matrix,0),ge.crossVectors(this._camera.up,ge),ge.multiplyScalar(e);const n=Oe.copy(this._targetEnd).add(ge);return this.moveTo(n.x,n.y,n.z,t)}elevate(e,t=!1){return ge.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+ge.x,this._targetEnd.y+ge.y,this._targetEnd.z+ge.z,t)}moveTo(e,t,n,s=!1){this._isUserControllingTruck=!1;const i=ge.set(e,t,n).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,i,this.boundaryFriction),this._needsUpdate=!0,s||this._target.copy(this._targetEnd);const o=!s||Re(this._target.x,this._targetEnd.x,this.restThreshold)&&Re(this._target.y,this._targetEnd.y,this.restThreshold)&&Re(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(o)}lookInDirectionOf(e,t,n,s=!1){const a=ge.set(e,t,n).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius);return this.setPosition(a.x,a.y,a.z,s)}fitToBox(e,t,{cover:n=!1,paddingLeft:s=0,paddingRight:i=0,paddingBottom:o=0,paddingTop:a=0}={}){const c=[],l=e.isBox3?bi.copy(e):bi.setFromObject(e);l.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const u=vh(this._sphericalEnd.theta,gh),h=vh(this._sphericalEnd.phi,gh);c.push(this.rotateTo(u,h,t));const d=ge.setFromSpherical(this._sphericalEnd).normalize(),f=bh.setFromUnitVectors(d,Nc),m=Re(Math.abs(d.y),1);m&&f.multiply(Bc.setFromAxisAngle(Ko,u)),f.multiply(this._yAxisUpSpaceInverse);const p=Sh.makeEmpty();Oe.copy(l.min).applyQuaternion(f),p.expandByPoint(Oe),Oe.copy(l.min).setX(l.max.x).applyQuaternion(f),p.expandByPoint(Oe),Oe.copy(l.min).setY(l.max.y).applyQuaternion(f),p.expandByPoint(Oe),Oe.copy(l.max).setZ(l.min.z).applyQuaternion(f),p.expandByPoint(Oe),Oe.copy(l.min).setZ(l.max.z).applyQuaternion(f),p.expandByPoint(Oe),Oe.copy(l.max).setY(l.min.y).applyQuaternion(f),p.expandByPoint(Oe),Oe.copy(l.max).setX(l.min.x).applyQuaternion(f),p.expandByPoint(Oe),Oe.copy(l.max).applyQuaternion(f),p.expandByPoint(Oe),p.min.x-=s,p.min.y-=o,p.max.x+=i,p.max.y+=a,f.setFromUnitVectors(Nc,d),m&&f.premultiply(Bc.invert()),f.premultiply(this._yAxisUpSpace);const _=p.getSize(ge),T=p.getCenter(Oe).applyQuaternion(f);if(Gs(this._camera)){const y=this.getDistanceToFitBox(_.x,_.y,_.z,n);c.push(this.moveTo(T.x,T.y,T.z,t)),c.push(this.dollyTo(y,t)),c.push(this.setFocalOffset(0,0,0,t))}else if(Ts(this._camera)){const y=this._camera,b=y.right-y.left,v=y.top-y.bottom,g=n?Math.max(b/_.x,v/_.y):Math.min(b/_.x,v/_.y);c.push(this.moveTo(T.x,T.y,T.z,t)),c.push(this.zoomTo(g,t)),c.push(this.setFocalOffset(0,0,0,t))}return Promise.all(c)}fitToSphere(e,t){const n=[],i=e instanceof de.Sphere?Lc.copy(e):ol.createBoundingSphere(e,Lc);if(n.push(this.moveTo(i.center.x,i.center.y,i.center.z,t)),Gs(this._camera)){const o=this.getDistanceToFitSphere(i.radius);n.push(this.dollyTo(o,t))}else if(Ts(this._camera)){const o=this._camera.right-this._camera.left,a=this._camera.top-this._camera.bottom,c=2*i.radius,l=Math.min(o/c,a/c);n.push(this.zoomTo(l,t))}return n.push(this.setFocalOffset(0,0,0,t)),Promise.all(n)}setLookAt(e,t,n,s,i,o,a=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=xi.NONE,this._changedDolly=0;const c=Oe.set(s,i,o),l=ge.set(e,t,n);this._targetEnd.copy(c),this._sphericalEnd.setFromVector3(l.sub(c).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,a||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const u=!a||Re(this._target.x,this._targetEnd.x,this.restThreshold)&&Re(this._target.y,this._targetEnd.y,this.restThreshold)&&Re(this._target.z,this._targetEnd.z,this.restThreshold)&&Re(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Re(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&Re(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(u)}lerpLookAt(e,t,n,s,i,o,a,c,l,u,h,d,f,m=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=xi.NONE,this._changedDolly=0;const p=ge.set(s,i,o),_=Oe.set(e,t,n);ln.setFromVector3(_.sub(p).applyQuaternion(this._yAxisUpSpace));const T=Si.set(u,h,d),y=Oe.set(a,c,l);Mr.setFromVector3(y.sub(T).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(p.lerp(T,f));const b=Mr.theta-ln.theta,v=Mr.phi-ln.phi,g=Mr.radius-ln.radius;this._sphericalEnd.set(ln.radius+g*f,ln.phi+v*f,ln.theta+b*f),this.normalizeRotations(),this._needsUpdate=!0,m||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const x=!m||Re(this._target.x,this._targetEnd.x,this.restThreshold)&&Re(this._target.y,this._targetEnd.y,this.restThreshold)&&Re(this._target.z,this._targetEnd.z,this.restThreshold)&&Re(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Re(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&Re(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(x)}setPosition(e,t,n,s=!1){return this.setLookAt(e,t,n,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,s)}setTarget(e,t,n,s=!1){const i=this.getPosition(ge),o=this.setLookAt(i.x,i.y,i.z,e,t,n,s);return this._sphericalEnd.phi=Sn(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),o}setFocalOffset(e,t,n,s=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,t,n),this._needsUpdate=!0,s||this._focalOffset.copy(this._focalOffsetEnd);const i=!s||Re(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&Re(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&Re(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(i)}setOrbitPoint(e,t,n){this._camera.updateMatrixWorld(),Fn.setFromMatrixColumn(this._camera.matrixWorldInverse,0),Nn.setFromMatrixColumn(this._camera.matrixWorldInverse,1),Ws.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const s=ge.set(e,t,n),i=s.distanceTo(this._camera.position),o=s.sub(this._camera.position);Fn.multiplyScalar(o.x),Nn.multiplyScalar(o.y),Ws.multiplyScalar(o.z),ge.copy(Fn).add(Nn).add(Ws),ge.z=ge.z+i,this.dollyTo(i,!1),this.setFocalOffset(-ge.x,ge.y,-ge.z,!1),this.moveTo(e,t,n,!1)}setBoundary(e){if(!e){this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),this._needsUpdate=!0;return}this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,n,s){if(e===null){this._viewport=null;return}this._viewport=this._viewport||new de.Vector4,typeof e=="number"?this._viewport.set(e,t,n,s):this._viewport.copy(e)}getDistanceToFitBox(e,t,n,s=!1){if(Fc(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const i=e/t,o=this._camera.getEffectiveFOV()*Or,a=this._camera.aspect;return((s?i>a:i<a)?t:e/a)*.5/Math.tan(o*.5)+n*.5}getDistanceToFitSphere(e){if(Fc(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const t=this._camera.getEffectiveFOV()*Or,n=Math.atan(Math.tan(t*.5)*this._camera.aspect)*2,s=1<this._camera.aspect?t:n;return e/Math.sin(s*.5)}getTarget(e,t=!0){return(e&&e.isVector3?e:new de.Vector3).copy(t?this._targetEnd:this._target)}getPosition(e,t=!0){return(e&&e.isVector3?e:new de.Vector3).setFromSpherical(t?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(t?this._targetEnd:this._target)}getSpherical(e,t=!0){return(e&&e instanceof de.Spherical?e:new de.Spherical).copy(t?this._sphericalEnd:this._spherical)}getFocalOffset(e,t=!0){return(e&&e.isVector3?e:new de.Vector3).copy(t?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%wi,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=wi),this._spherical.theta+=wi*Math.round((this._sphericalEnd.theta-this._spherical.theta)/wi)}reset(e=!1){if(!Re(this._camera.up.x,this._cameraUp0.x)||!Re(this._camera.up.y,this._cameraUp0.y)||!Re(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const n=this.getPosition(ge);this.updateCameraUp(),this.setPosition(n.x,n.y,n.z)}const t=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)];return Promise.all(t)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,Ko),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const e=ge.subVectors(this._target,this._camera.position).normalize(),t=Oe.crossVectors(e,this._camera.up);this._camera.up.crossVectors(t,e).normalize(),this._camera.updateMatrixWorld();const n=this.getPosition(ge);this.updateCameraUp(),this.setPosition(n.x,n.y,n.z)}update(e){const t=this._sphericalEnd.theta-this._spherical.theta,n=this._sphericalEnd.phi-this._spherical.phi,s=this._sphericalEnd.radius-this._spherical.radius,i=xh.subVectors(this._targetEnd,this._target),o=wh.subVectors(this._focalOffsetEnd,this._focalOffset),a=this._zoomEnd-this._zoom;if(We(t))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const h=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=Zo(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,h,1/0,e),this._needsUpdate=!0}if(We(n))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const h=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=Zo(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,h,1/0,e),this._needsUpdate=!0}if(We(s))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const h=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=Zo(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,h,this.maxSpeed,e),this._needsUpdate=!0}if(We(i.x)&&We(i.y)&&We(i.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const h=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;yh(this._target,this._targetEnd,this._targetVelocity,h,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(We(o.x)&&We(o.y)&&We(o.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const h=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;yh(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,h,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(We(a))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const h=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=Zo(this._zoom,this._zoomEnd,this._zoomVelocity,h,1/0,e)}if(this.dollyToCursor){if(Gs(this._camera)&&this._changedDolly!==0){const h=this._spherical.radius-this._lastDistance,d=this._camera,f=this._getCameraDirection(Dr),m=ge.copy(f).cross(d.up).normalize();m.lengthSq()===0&&(m.x=1);const p=Oe.crossVectors(m,f),_=this._sphericalEnd.radius*Math.tan(d.getEffectiveFOV()*Or*.5),y=(this._sphericalEnd.radius-h-this._sphericalEnd.radius)/this._sphericalEnd.radius,b=Si.copy(this._targetEnd).add(m.multiplyScalar(this._dollyControlCoord.x*_*d.aspect)).add(p.multiplyScalar(this._dollyControlCoord.y*_)),v=ge.copy(this._targetEnd).lerp(b,y),g=this._lastDollyDirection===xi.IN&&this._spherical.radius<=this.minDistance,x=this._lastDollyDirection===xi.OUT&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(g||x)){this._sphericalEnd.radius-=h,this._spherical.radius-=h;const S=Oe.copy(f).multiplyScalar(-h);v.add(S)}this._boundary.clampPoint(v,v);const w=Oe.subVectors(v,this._targetEnd);this._targetEnd.copy(v),this._target.add(w),this._changedDolly-=h,We(this._changedDolly)&&(this._changedDolly=0)}else if(Ts(this._camera)&&this._changedZoom!==0){const h=this._zoom-this._lastZoom,d=this._camera,f=ge.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(d.near+d.far)/(d.near-d.far)).unproject(d),m=Oe.set(0,0,-1).applyQuaternion(d.quaternion),p=Si.copy(f).add(m.multiplyScalar(-f.dot(d.up))),T=-(this._zoom-h-this._zoom)/this._zoom,y=this._getCameraDirection(Dr),b=this._targetEnd.dot(y),v=ge.copy(this._targetEnd).lerp(p,T),g=v.dot(y),x=y.multiplyScalar(g-b);v.sub(x),this._boundary.clampPoint(v,v);const w=Oe.subVectors(v,this._targetEnd);this._targetEnd.copy(v),this._target.add(w),this._changedZoom-=h,We(this._changedZoom)&&(this._changedZoom=0)}}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const c=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,c),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!We(this._focalOffset.x)||!We(this._focalOffset.y)||!We(this._focalOffset.z))&&(this._camera.updateMatrixWorld(),Fn.setFromMatrixColumn(this._camera.matrix,0),Nn.setFromMatrixColumn(this._camera.matrix,1),Ws.setFromMatrixColumn(this._camera.matrix,2),Fn.multiplyScalar(this._focalOffset.x),Nn.multiplyScalar(-this._focalOffset.y),Ws.multiplyScalar(this._focalOffset.z),ge.copy(Fn).add(Nn).add(Ws),this._camera.position.add(ge)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),ge.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const u=this._needsUpdate;return u&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):u?(this.dispatchEvent({type:"update"}),We(t,this.restThreshold)&&We(n,this.restThreshold)&&We(s,this.restThreshold)&&We(i.x,this.restThreshold)&&We(i.y,this.restThreshold)&&We(i.z,this.restThreshold)&&We(o.x,this.restThreshold)&&We(o.y,this.restThreshold)&&We(o.z,this.restThreshold)&&We(a,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!u&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=u,this._needsUpdate=!1,u}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:Ar(this.maxDistance),minZoom:this.minZoom,maxZoom:Ar(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:Ar(this.maxPolarAngle),minAzimuthAngle:Ar(this.minAzimuthAngle),maxAzimuthAngle:Ar(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:ge.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e,t=!1){const n=JSON.parse(e);this.enabled=n.enabled,this.minDistance=n.minDistance,this.maxDistance=kr(n.maxDistance),this.minZoom=n.minZoom,this.maxZoom=kr(n.maxZoom),this.minPolarAngle=n.minPolarAngle,this.maxPolarAngle=kr(n.maxPolarAngle),this.minAzimuthAngle=kr(n.minAzimuthAngle),this.maxAzimuthAngle=kr(n.maxAzimuthAngle),this.smoothTime=n.smoothTime,this.draggingSmoothTime=n.draggingSmoothTime,this.dollySpeed=n.dollySpeed,this.truckSpeed=n.truckSpeed,this.dollyToCursor=n.dollyToCursor,this.verticalDragToForward=n.verticalDragToForward,this._target0.fromArray(n.target0),this._position0.fromArray(n.position0),this._zoom0=n.zoom0,this._focalOffset0.fromArray(n.focalOffset0),this.moveTo(n.target[0],n.target[1],n.target[2],t),ln.setFromVector3(ge.fromArray(n.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(ln.theta,ln.phi,t),this.dollyTo(ln.radius,t),this.zoomTo(n.zoom,t),this.setFocalOffset(n.focalOffset[0],n.focalOffset[1],n.focalOffset[2],t),this._needsUpdate=!0}connect(e){if(this._domElement){console.warn("camera-controls is already connected.");return}e.setAttribute("data-camera-controls-version",G_),this._addAllEventListeners(e),this._getClientRect(this._elementRect)}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find(t=>t.pointerId===e)}_findPointerByMouseButton(e){return this._activePointers.find(t=>t.mouseButton===e)}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,t,n){const s=t.lengthSq();if(s===0)return e;const i=Oe.copy(t).add(e),a=this._boundary.clampPoint(i,Si).sub(i),c=a.lengthSq();if(c===0)return e.add(t);if(c===s)return e;if(n===0)return e.add(t).add(a);{const l=1+n*c/t.dot(a);return e.add(Oe.copy(t).multiplyScalar(l)).add(a.multiplyScalar(1-n))}}_updateNearPlaneCorners(){if(Gs(this._camera)){const e=this._camera,t=e.near,n=e.getEffectiveFOV()*Or,s=Math.tan(n*.5)*t,i=s*e.aspect;this._nearPlaneCorners[0].set(-i,-s,0),this._nearPlaneCorners[1].set(i,-s,0),this._nearPlaneCorners[2].set(i,s,0),this._nearPlaneCorners[3].set(-i,s,0)}else if(Ts(this._camera)){const e=this._camera,t=1/e.zoom,n=e.left*t,s=e.right*t,i=e.top*t,o=e.bottom*t;this._nearPlaneCorners[0].set(n,i,0),this._nearPlaneCorners[1].set(s,i,0),this._nearPlaneCorners[2].set(s,o,0),this._nearPlaneCorners[3].set(n,o,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||Fc(this._camera,"_collisionTest"))return e;const n=this._getTargetDirection(Dr);zc.lookAt(Th,n,this._camera.up);for(let s=0;s<4;s++){const i=Oe.copy(this._nearPlaneCorners[s]);i.applyMatrix4(zc);const o=Si.addVectors(this._target,i);Jo.set(o,n),Jo.far=this._spherical.radius+1;const a=Jo.intersectObjects(this.colliderMeshes);a.length!==0&&a[0].distance<e&&(e=a[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;const t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise(t=>{const n=()=>{this.removeEventListener("rest",n),t()};this.addEventListener("rest",n)}))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e,t=new de.Sphere){const n=t,s=n.center;bi.makeEmpty(),e.traverseVisible(o=>{o.isMesh&&bi.expandByObject(o)}),bi.getCenter(s);let i=0;return e.traverseVisible(o=>{if(!o.isMesh)return;const a=o,c=a.geometry.clone();c.applyMatrix4(a.matrixWorld);const u=c.attributes.position;for(let h=0,d=u.count;h<d;h++)ge.fromBufferAttribute(u,h),i=Math.max(i,s.distanceToSquared(ge))}),n.radius=Math.sqrt(i),n}};const HS=J.forwardRef((r,e)=>{J.useMemo(()=>{Vc.install({THREE:gm}),Nl({CameraControlsImpl:Vc})},[]);const{camera:t,domElement:n,makeDefault:s,onStart:i,onEnd:o,onChange:a,regress:c,...l}=r,u=Qe(g=>g.camera),h=Qe(g=>g.gl),d=Qe(g=>g.invalidate),f=Qe(g=>g.events),m=Qe(g=>g.setEvents),p=Qe(g=>g.set),_=Qe(g=>g.get),T=Qe(g=>g.performance),y=t||u,b=n||f.connected||h.domElement,v=J.useMemo(()=>new Vc(y),[y]);return Ll((g,x)=>{v.enabled&&v.update(x)},-1),J.useEffect(()=>(v.connect(b),()=>void v.disconnect()),[b,v]),J.useEffect(()=>{const g=S=>{d(),c&&T.regress(),a&&a(S)},x=S=>{i&&i(S)},w=S=>{o&&o(S)};return v.addEventListener("update",g),v.addEventListener("controlstart",x),v.addEventListener("controlend",w),()=>{v.removeEventListener("update",g),v.removeEventListener("controlstart",x),v.removeEventListener("controlend",w)}},[v,i,o,d,m,c,a]),J.useEffect(()=>{if(s){const g=_().controls;return p({controls:v}),()=>p({controls:g})}},[s,v]),J.createElement("primitive",Ga({ref:e,object:v},l))}),Nd=J.createContext(null),qS=J.forwardRef((r,e)=>{J.useMemo(()=>Nl({SegmentObject:q_}),[]);const{limit:t=1e3,lineWidth:n=1,children:s,...i}=r,[o,a]=J.useState([]),[c]=J.useState(()=>new Dm),[l]=J.useState(()=>new Mm),[u]=J.useState(()=>new Rm),[h]=J.useState(()=>new Xe(512,512)),[d]=J.useState(()=>Array(t*6).fill(0)),[f]=J.useState(()=>Array(t*6).fill(0)),m=J.useMemo(()=>({subscribe:p=>(a(_=>[..._,p]),()=>a(_=>_.filter(T=>T.current!==p.current)))}),[]);return Ll(()=>{for(let _=0;_<t;_++){var p;const T=(p=o[_])==null?void 0:p.current;T&&(d[_*6+0]=T.start.x,d[_*6+1]=T.start.y,d[_*6+2]=T.start.z,d[_*6+3]=T.end.x,d[_*6+4]=T.end.y,d[_*6+5]=T.end.z,f[_*6+0]=T.color.r,f[_*6+1]=T.color.g,f[_*6+2]=T.color.b,f[_*6+3]=T.color.r,f[_*6+4]=T.color.g,f[_*6+5]=T.color.b)}u.setColors(f),u.setPositions(d),c.computeLineDistances()}),J.createElement("primitive",{object:c,ref:e},J.createElement("primitive",{object:u,attach:"geometry"}),J.createElement("primitive",Ga({object:l,attach:"material",vertexColors:!0,resolution:h,linewidth:n},i)),J.createElement(Nd.Provider,{value:m},s))});class q_{constructor(){this.color=new Cn("white"),this.start=new tt(0,0,0),this.end=new tt(0,0,0)}}const Ch=r=>r instanceof tt?r:new tt(...typeof r=="number"?[r,r,r]:r),jS=J.forwardRef(({color:r,start:e,end:t},n)=>{const s=J.useContext(Nd);if(!s)throw"Segment must used inside Segments component.";const i=J.useRef(null);return J.useLayoutEffect(()=>s.subscribe(i),[]),J.createElement("segmentObject",{ref:Pm([i,n]),color:r,start:Ch(e),end:Ch(t)})});function YS({all:r,scene:e,camera:t}){const n=Qe(({gl:o})=>o),s=Qe(({camera:o})=>o),i=Qe(({scene:o})=>o);return J.useLayoutEffect(()=>{const o=[];r&&(e||i).traverse(l=>{l.visible===!1&&(o.push(l),l.visible=!0)}),n.compile(e||i,t||s);const a=new vm(128);new ym(.01,1e5,a).update(n,e||i),a.dispose(),o.forEach(l=>l.visible=!1)},[]),null}function XS({pixelated:r}){const e=Qe(o=>o.gl),t=Qe(o=>o.internal.active),n=Qe(o=>o.performance.current),s=Qe(o=>o.viewport.initialDpr),i=Qe(o=>o.setDpr);return J.useEffect(()=>{const o=e.domElement;return()=>{t&&i(s),r&&o&&(o.style.imageRendering="auto")}},[]),J.useEffect(()=>{i(n*s),r&&e.domElement&&(e.domElement.style.imageRendering=n===1?"auto":"pixelated")},[n]),null}function ZS(){const r=Qe(n=>n.get),e=Qe(n=>n.setEvents),t=Qe(n=>n.performance.current);return J.useEffect(()=>{const n=r().events.enabled;return()=>e({enabled:n})},[]),J.useEffect(()=>e({enabled:t===1}),[t]),null}/**
 * postprocessing v6.33.4 build Sat Dec 02 2023
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2023 Raoul van Rüschen
 * @license Zlib
 */var Ld="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",we={SKIP:9,SET:30,ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},Bd="",Tt="srgb",qa="srgb-linear",ts={NONE:0,DEPTH:1,CONVOLUTION:2},Ae={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},ja={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},$o={DEFAULT:0,ESKIL:1},zd=Number(Fl.replace(/\D+/g,"")),Vd=zd>=152,j_=new Map([[wd,qa],[Sd,Tt]]),Y_=new Map([[qa,wd],[Tt,Sd]]);function Gi(r){return r===null?null:Vd?r.outputColorSpace:j_.get(r.outputEncoding)}function Cs(r,e){r!==null&&(Vd?r.colorSpace=e:r.encoding=Y_.get(e))}function go(r){return zd<154?r.replace("colorspace_fragment","encodings_fragment"):r}var X_=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,Z_="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",Q_=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],K_=class extends Wn{constructor(r=new fa){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new me(null),texelSize:new me(new fa),scale:new me(1),kernel:new me(0)},blending:ls,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:X_,vertexShader:Z_}),this.fragmentShader=go(this.fragmentShader),this.setTexelSize(r.x,r.y),this.kernelSize=ja.MEDIUM}set inputBuffer(r){this.uniforms.inputBuffer.value=r}setInputBuffer(r){this.inputBuffer=r}get kernelSequence(){return Q_[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(r){this.uniforms.scale.value=r}getScale(){return this.uniforms.scale.value}setScale(r){this.uniforms.scale.value=r}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(r){this.uniforms.kernel.value=r}setKernel(r){this.kernel=r}setTexelSize(r,e){this.uniforms.texelSize.value.set(r,e,r*.5,e*.5)}setSize(r,e){const t=1/r,n=1/e;this.uniforms.texelSize.value.set(t,n,t*.5,n*.5)}},J_=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <colorspace_fragment>
#include <dithering_fragment>
}`,Gd=class extends Wn{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new me(null),opacity:new me(1)},blending:ls,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:J_,vertexShader:Ld}),this.fragmentShader=go(this.fragmentShader)}set inputBuffer(r){this.uniforms.inputBuffer.value=r}setInputBuffer(r){this.uniforms.inputBuffer.value=r}getOpacity(r){return this.uniforms.opacity.value}setOpacity(r){this.uniforms.opacity.value=r}},$_=`#include <packing>
#include <clipping_planes_pars_fragment>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float cameraNear;uniform float cameraFar;centroid varying float vViewZ;centroid varying vec4 vProjTexCoord;void main(){
#include <clipping_planes_fragment>
vec2 projTexCoord=(vProjTexCoord.xy/vProjTexCoord.w)*0.5+0.5;projTexCoord=clamp(projTexCoord,0.002,0.998);
#if DEPTH_PACKING == 3201
float fragCoordZ=unpackRGBAToDepth(texture2D(depthBuffer,projTexCoord));
#else
float fragCoordZ=texture2D(depthBuffer,projTexCoord).r;
#endif
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(fragCoordZ,cameraNear,cameraFar);
#else
float viewZ=orthographicDepthToViewZ(fragCoordZ,cameraNear,cameraFar);
#endif
float depthTest=(-vViewZ>-viewZ)?1.0:0.0;gl_FragColor.rg=vec2(0.0,depthTest);}`,eg=`#include <common>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
varying float vViewZ;varying vec4 vProjTexCoord;void main(){
#include <skinbase_vertex>
#include <begin_vertex>
#include <morphtarget_vertex>
#include <skinning_vertex>
#include <project_vertex>
vViewZ=mvPosition.z;vProjTexCoord=gl_Position;
#include <clipping_planes_vertex>
}`,tg=class extends Wn{constructor(r=null,e){super({name:"DepthComparisonMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new me(null),cameraNear:new me(.3),cameraFar:new me(1e3)},blending:ls,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:$_,vertexShader:eg}),this.depthBuffer=r,this.depthPacking=da,this.copyCameraSettings(e)}set depthBuffer(r){this.uniforms.depthBuffer.value=r}set depthPacking(r){this.defines.DEPTH_PACKING=r.toFixed(0),this.needsUpdate=!0}setDepthBuffer(r,e=da){this.depthBuffer=r,this.depthPacking=e}adoptCameraSettings(r){this.copyCameraSettings(r)}copyCameraSettings(r){r&&(this.uniforms.cameraNear.value=r.near,this.uniforms.cameraFar.value=r.far,r instanceof Td?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},ng=`#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
#ifdef DOWNSAMPLE_NORMALS
uniform lowp sampler2D normalBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])*0.25;float distances[4];distances[0]=abs(c-samples[0]);distances[1]=abs(c-samples[1]);distances[2]=abs(c-samples[2]);distances[3]=abs(c-samples[3]);float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[4];d[0]=readDepth(vUv0);d[1]=readDepth(vUv1);d[2]=readDepth(vUv2);d[3]=readDepth(vUv3);int index=findBestDepth(d);
#ifdef DOWNSAMPLE_NORMALS
vec3 n[4];n[0]=texture2D(normalBuffer,vUv0).rgb;n[1]=texture2D(normalBuffer,vUv1).rgb;n[2]=texture2D(normalBuffer,vUv2).rgb;n[3]=texture2D(normalBuffer,vUv3).rgb;
#else
vec3 n[4];n[0]=vec3(0.0);n[1]=vec3(0.0);n[2]=vec3(0.0);n[3]=vec3(0.0);
#endif
gl_FragColor=vec4(n[index],d[index]);}`,sg="uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}",ig=class extends Wn{constructor(){super({name:"DepthDownsamplingMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new me(null),normalBuffer:new me(null),texelSize:new me(new Xe)},blending:ls,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:ng,vertexShader:sg})}set depthBuffer(r){this.uniforms.depthBuffer.value=r}set depthPacking(r){this.defines.DEPTH_PACKING=r.toFixed(0),this.needsUpdate=!0}setDepthBuffer(r,e=tr){this.depthBuffer=r,this.depthPacking=e}set normalBuffer(r){this.uniforms.normalBuffer.value=r,r!==null?this.defines.DOWNSAMPLE_NORMALS="1":delete this.defines.DOWNSAMPLE_NORMALS,this.needsUpdate=!0}setNormalBuffer(r){this.normalBuffer=r}setTexelSize(r,e){this.uniforms.texelSize.value.set(r,e)}setSize(r,e){this.uniforms.texelSize.value.set(1/r,1/e)}},rg=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#define WEIGHT_INNER 0.125
#define WEIGHT_OUTER 0.0555555
varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;
#include <colorspace_fragment>
}`,og="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",ag=class extends Wn{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new me(null),texelSize:new me(new Xe)},blending:ls,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:rg,vertexShader:og}),this.fragmentShader=go(this.fragmentShader)}set inputBuffer(r){this.uniforms.inputBuffer.value=r}setSize(r,e){this.uniforms.texelSize.value.set(1/r,1/e)}},cg=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,lg="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",ug=class extends Wn{constructor(r,e,t,n,s=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:Fl.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new me(null),depthBuffer:new me(null),resolution:new me(new Xe),texelSize:new me(new Xe),cameraNear:new me(.3),cameraFar:new me(1e3),aspect:new me(1),time:new me(0)},blending:ls,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:s}),r&&this.setShaderParts(r),e&&this.setDefines(e),t&&this.setUniforms(t),this.copyCameraSettings(n)}set inputBuffer(r){this.uniforms.inputBuffer.value=r}setInputBuffer(r){this.uniforms.inputBuffer.value=r}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(r){this.uniforms.depthBuffer.value=r}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(r){this.defines.DEPTH_PACKING=r.toFixed(0),this.needsUpdate=!0}setDepthBuffer(r,e=tr){this.depthBuffer=r,this.depthPacking=e}setShaderData(r){this.setShaderParts(r.shaderParts),this.setDefines(r.defines),this.setUniforms(r.uniforms),this.setExtensions(r.extensions)}setShaderParts(r){return this.fragmentShader=cg.replace(Ae.FRAGMENT_HEAD,r.get(Ae.FRAGMENT_HEAD)||"").replace(Ae.FRAGMENT_MAIN_UV,r.get(Ae.FRAGMENT_MAIN_UV)||"").replace(Ae.FRAGMENT_MAIN_IMAGE,r.get(Ae.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=lg.replace(Ae.VERTEX_HEAD,r.get(Ae.VERTEX_HEAD)||"").replace(Ae.VERTEX_MAIN_SUPPORT,r.get(Ae.VERTEX_MAIN_SUPPORT)||""),this.fragmentShader=go(this.fragmentShader),this.needsUpdate=!0,this}setDefines(r){for(const e of r.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(r){for(const e of r.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(r){this.extensions={};for(const e of r)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(r){this.encodeOutput!==r&&(r?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(r){return this.encodeOutput}setOutputEncodingEnabled(r){this.encodeOutput=r}get time(){return this.uniforms.time.value}set time(r){this.uniforms.time.value=r}setDeltaTime(r){this.uniforms.time.value+=r}adoptCameraSettings(r){this.copyCameraSettings(r)}copyCameraSettings(r){r&&(this.uniforms.cameraNear.value=r.near,this.uniforms.cameraFar.value=r.far,r instanceof Td?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(r,e){const t=this.uniforms;t.resolution.value.set(r,e),t.texelSize.value.set(1/r,1/e),t.aspect.value=r/e}static get Section(){return Ae}},hg=`#include <common>
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,dg=class extends Wn{constructor(r=!1,e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:Fl.replace(/\D+/g,"")},uniforms:{inputBuffer:new me(null),threshold:new me(0),smoothing:new me(1),range:new me(null)},blending:ls,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:hg,vertexShader:Ld}),this.colorOutput=r,this.luminanceRange=e}set inputBuffer(r){this.uniforms.inputBuffer.value=r}setInputBuffer(r){this.uniforms.inputBuffer.value=r}get threshold(){return this.uniforms.threshold.value}set threshold(r){this.smoothing>0||r>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=r}getThreshold(){return this.threshold}setThreshold(r){this.threshold=r}get smoothing(){return this.uniforms.smoothing.value}set smoothing(r){this.threshold>0||r>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=r}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(r){this.smoothing=r}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(r){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(r){r?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(r){return this.colorOutput}setColorOutputEnabled(r){this.colorOutput=r}get useRange(){return this.luminanceRange!==null}set useRange(r){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(r){r!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=r,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(r){this.luminanceRange=r}},fg="uniform lowp sampler2D inputBuffer;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 c0=texture2D(inputBuffer,vUv0).rg;vec2 c1=texture2D(inputBuffer,vUv1).rg;vec2 c2=texture2D(inputBuffer,vUv2).rg;vec2 c3=texture2D(inputBuffer,vUv3).rg;float d0=(c0.x-c1.x)*0.5;float d1=(c2.x-c3.x)*0.5;float d=length(vec2(d0,d1));float a0=min(c0.y,c1.y);float a1=min(c2.y,c3.y);float visibilityFactor=min(a0,a1);gl_FragColor.rg=(1.0-visibilityFactor>0.001)?vec2(d,0.0):vec2(0.0,d);}",pg="uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=vec2(uv.x+texelSize.x,uv.y);vUv1=vec2(uv.x-texelSize.x,uv.y);vUv2=vec2(uv.x,uv.y+texelSize.y);vUv3=vec2(uv.x,uv.y-texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}",mg=class extends Wn{constructor(r=new Xe){super({name:"OutlineMaterial",uniforms:{inputBuffer:new me(null),texelSize:new me(new Xe)},blending:ls,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:fg,vertexShader:pg}),this.uniforms.texelSize.value.set(r.x,r.y),this.uniforms.maskTexture=this.uniforms.inputBuffer}set inputBuffer(r){this.uniforms.inputBuffer.value=r}setInputBuffer(r){this.uniforms.inputBuffer.value=r}setTexelSize(r,e){this.uniforms.texelSize.value.set(r,e)}setSize(r,e){this.uniforms.texelSize.value.set(1/r,1/e)}},_g=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;
#else
uniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;
#endif
uniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);
#include <colorspace_fragment>
}`,gg="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}",vg=class extends Wn{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new me(null),supportBuffer:new me(null),texelSize:new me(new Xe),radius:new me(.85)},blending:ls,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:_g,vertexShader:gg}),this.fragmentShader=go(this.fragmentShader)}set inputBuffer(r){this.uniforms.inputBuffer.value=r}set supportBuffer(r){this.uniforms.supportBuffer.value=r}get radius(){return this.uniforms.radius.value}set radius(r){this.uniforms.radius.value=r}setSize(r,e){this.uniforms.texelSize.value.set(1/r,1/e)}},yg=new Om,gs=null;function Tg(){if(gs===null){const r=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]);gs=new yd,gs.setAttribute!==void 0?(gs.setAttribute("position",new Wo(r,3)),gs.setAttribute("uv",new Wo(e,2))):(gs.addAttribute("position",new Wo(r,3)),gs.addAttribute("uv",new Wo(e,2)))}return gs}var Nt=class Wd{constructor(e="Pass",t=new th,n=yg){this.name=e,this.renderer=null,this.scene=t,this.camera=n,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const t=this.fullscreenMaterial;t!==null&&(t.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new Wa(Tg(),e),t.frustumCulled=!1,this.scene===null&&(this.scene=new th),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=tr){}render(e,t,n,s,i){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,n){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof rn||t instanceof xd||t instanceof Pl||t instanceof Wd)&&this[e].dispose()}}},xg=class extends Nt{constructor(r,e=!0){super("CopyPass"),this.fullscreenMaterial=new Gd,this.needsSwap=!1,this.renderTarget=r,r===void 0&&(this.renderTarget=new rn(1,1,{minFilter:zi,magFilter:zi,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(r){this.autoResize=r}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(r){this.autoResize=r}render(r,e,t,n,s){this.fullscreenMaterial.inputBuffer=e.texture,r.setRenderTarget(this.renderToScreen?null:this.renderTarget),r.render(this.scene,this.camera)}setSize(r,e){this.autoResize&&this.renderTarget.setSize(r,e)}initialize(r,e,t){t!==void 0&&(this.renderTarget.texture.type=t,t!==ss?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":Gi(r)===Tt&&Cs(this.renderTarget.texture,Tt))}},wg=class extends Nt{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(r,e,t,n,s){const i=r.state.buffers.stencil;i.setLocked(!1),i.setTest(!1)}},Eh=new Cn,zl=class extends Nt{constructor(r=!0,e=!0,t=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=r,this.depth=e,this.stencil=t,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(r,e,t){this.color=r,this.depth=e,this.stencil=t}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(r){this.overrideClearColor=r}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(r){this.overrideClearAlpha=r}render(r,e,t,n,s){const i=this.overrideClearColor,o=this.overrideClearAlpha,a=r.getClearAlpha(),c=i!==null,l=o>=0;c?(r.getClearColor(Eh),r.setClearColor(i,l?o:a)):l&&r.setClearAlpha(o),r.setRenderTarget(this.renderToScreen?null:e),r.clear(this.color,this.depth,this.stencil),c?r.setClearColor(Eh,a):l&&r.setClearAlpha(a)}},Ya=class extends Nt{constructor(r,e,t=null){super("RenderPass",r,e),this.needsSwap=!1,this.clearPass=new zl,this.overrideMaterialManager=t===null?null:new Ah(t),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(r){this.scene=r}set mainCamera(r){this.camera=r}get renderToScreen(){return super.renderToScreen}set renderToScreen(r){super.renderToScreen=r,this.clearPass.renderToScreen=r}get overrideMaterial(){const r=this.overrideMaterialManager;return r!==null?r.material:null}set overrideMaterial(r){const e=this.overrideMaterialManager;r!==null?e!==null?e.setMaterial(r):this.overrideMaterialManager=new Ah(r):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(r){this.overrideMaterial=r}get clear(){return this.clearPass.enabled}set clear(r){this.clearPass.enabled=r}getSelection(){return this.selection}setSelection(r){this.selection=r}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(r){this.ignoreBackground=r}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(r){this.skipShadowMapUpdate=r}getClearPass(){return this.clearPass}render(r,e,t,n,s){const i=this.scene,o=this.camera,a=this.selection,c=o.layers.mask,l=i.background,u=r.shadowMap.autoUpdate,h=this.renderToScreen?null:e;a!==null&&o.layers.set(a.getLayer()),this.skipShadowMapUpdate&&(r.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(i.background=null),this.clearPass.enabled&&this.clearPass.render(r,e),r.setRenderTarget(h),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(r,i,o):r.render(i,o),o.layers.mask=c,i.background=l,r.shadowMap.autoUpdate=u}},Sg=class extends Nt{constructor(r,e,{renderTarget:t,resolutionScale:n=1,width:s=dt.AUTO_SIZE,height:i=dt.AUTO_SIZE,resolutionX:o=s,resolutionY:a=i}={}){super("DepthPass"),this.needsSwap=!1,this.renderPass=new Ya(r,e,new gd({depthPacking:da}));const c=this.renderPass;c.skipShadowMapUpdate=!0,c.ignoreBackground=!0;const l=c.clearPass;l.overrideClearColor=new Cn(16777215),l.overrideClearAlpha=1,this.renderTarget=t,this.renderTarget===void 0&&(this.renderTarget=new rn(1,1,{minFilter:Vi,magFilter:Vi}),this.renderTarget.texture.name="DepthPass.Target");const u=this.resolution=new dt(this,o,a,n);u.addEventListener("change",h=>this.setSize(u.baseWidth,u.baseHeight))}set mainScene(r){this.renderPass.mainScene=r}set mainCamera(r){this.renderPass.mainCamera=r}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(r){this.resolution.scale=r}render(r,e,t,n,s){const i=this.renderToScreen?null:this.renderTarget;this.renderPass.render(r,i)}setSize(r,e){const t=this.resolution;t.setBaseSize(r,e),this.renderTarget.setSize(t.width,t.height)}},bg=class extends Nt{constructor({normalBuffer:r=null,resolutionScale:e=.5,width:t=dt.AUTO_SIZE,height:n=dt.AUTO_SIZE,resolutionX:s=t,resolutionY:i=n}={}){super("DepthDownsamplingPass");const o=new ig;o.normalBuffer=r,this.fullscreenMaterial=o,this.needsDepthTexture=!0,this.needsSwap=!1,this.renderTarget=new rn(1,1,{minFilter:Vi,magFilter:Vi,depthBuffer:!1,type:Tm}),this.renderTarget.texture.name="DepthDownsamplingPass.Target",this.renderTarget.texture.generateMipmaps=!1;const a=this.resolution=new dt(this,s,i,e);a.addEventListener("change",c=>this.setSize(a.baseWidth,a.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}setDepthTexture(r,e=tr){this.fullscreenMaterial.depthBuffer=r,this.fullscreenMaterial.depthPacking=e}render(r,e,t,n,s){r.setRenderTarget(this.renderToScreen?null:this.renderTarget),r.render(this.scene,this.camera)}setSize(r,e){const t=this.resolution;t.setBaseSize(r,e),this.renderTarget.setSize(t.width,t.height),this.fullscreenMaterial.setSize(r,e)}initialize(r,e,t){const n=r.getContext();if(!(n.getExtension("EXT_color_buffer_float")||n.getExtension("EXT_color_buffer_half_float")))throw new Error("Rendering to float texture is not supported.")}};function Oh(r,e,t){for(const n of e){const s="$1"+r+n.charAt(0).toUpperCase()+n.slice(1),i=new RegExp("([^\\.])(\\b"+n+"\\b)","g");for(const o of t.entries())o[1]!==null&&t.set(o[0],o[1].replace(i,s))}}function Cg(r,e,t){let n=e.getFragmentShader(),s=e.getVertexShader();const i=n!==void 0&&/mainImage/.test(n),o=n!==void 0&&/mainUv/.test(n);if(t.attributes|=e.getAttributes(),n===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(o&&t.attributes&ts.CONVOLUTION)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!i&&!o)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const a=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,c=t.shaderParts;let l=c.get(Ae.FRAGMENT_HEAD)||"",u=c.get(Ae.FRAGMENT_MAIN_UV)||"",h=c.get(Ae.FRAGMENT_MAIN_IMAGE)||"",d=c.get(Ae.VERTEX_HEAD)||"",f=c.get(Ae.VERTEX_MAIN_SUPPORT)||"";const m=new Set,p=new Set;if(o&&(u+=`	${r}MainUv(UV);
`,t.uvTransformation=!0),s!==null&&/mainSupport/.test(s)){const y=/mainSupport *\([\w\s]*?uv\s*?\)/.test(s);f+=`	${r}MainSupport(`,f+=y?`vUv);
`:`);
`;for(const b of s.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const v of b[1].split(/\s*,\s*/))t.varyings.add(v),m.add(v),p.add(v);for(const b of s.matchAll(a))p.add(b[1])}for(const y of n.matchAll(a))p.add(y[1]);for(const y of e.defines.keys())p.add(y.replace(/\([\w\s,]*\)/g,""));for(const y of e.uniforms.keys())p.add(y);p.delete("while"),p.delete("for"),p.delete("if"),e.uniforms.forEach((y,b)=>t.uniforms.set(r+b.charAt(0).toUpperCase()+b.slice(1),y)),e.defines.forEach((y,b)=>t.defines.set(r+b.charAt(0).toUpperCase()+b.slice(1),y));const _=new Map([["fragment",n],["vertex",s]]);Oh(r,p,t.defines),Oh(r,p,_),n=_.get("fragment"),s=_.get("vertex");const T=e.blendMode;if(t.blendModes.set(T.blendFunction,T),i){e.inputColorSpace!==null&&e.inputColorSpace!==t.colorSpace&&(h+=e.inputColorSpace===Tt?`color0 = LinearTosRGB(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==Bd?t.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(t.colorSpace=e.inputColorSpace);const y=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;h+=`${r}MainImage(color0, UV, `,t.attributes&ts.DEPTH&&y.test(n)&&(h+="depth, ",t.readDepth=!0),h+=`color1);
	`;const b=r+"BlendOpacity";t.uniforms.set(b,T.opacity),h+=`color0 = blend${T.blendFunction}(color0, color1, ${b});

	`,l+=`uniform float ${b};

`}if(l+=n+`
`,s!==null&&(d+=s+`
`),c.set(Ae.FRAGMENT_HEAD,l),c.set(Ae.FRAGMENT_MAIN_UV,u),c.set(Ae.FRAGMENT_MAIN_IMAGE,h),c.set(Ae.VERTEX_HEAD,d),c.set(Ae.VERTEX_MAIN_SUPPORT,f),e.extensions!==null)for(const y of e.extensions)t.extensions.add(y)}}var Eg=class extends Nt{constructor(r,...e){super("EffectPass"),this.fullscreenMaterial=new ug(null,null,null,r),this.listener=t=>this.handleEvent(t),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(r){for(const e of this.effects)e.mainScene=r}set mainCamera(r){this.fullscreenMaterial.copyCameraSettings(r);for(const e of this.effects)e.mainCamera=r}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(r){this.fullscreenMaterial.encodeOutput=r}get dithering(){return this.fullscreenMaterial.dithering}set dithering(r){const e=this.fullscreenMaterial;e.dithering=r,e.needsUpdate=!0}setEffects(r){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=r.sort((e,t)=>t.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const r=new Ig;let e=0;for(const o of this.effects)if(o.blendMode.blendFunction===we.DST)r.attributes|=o.getAttributes()&ts.DEPTH;else{if(r.attributes&o.getAttributes()&ts.CONVOLUTION)throw new Error(`Convolution effects cannot be merged (${o.name})`);Cg("e"+e++,o,r)}let t=r.shaderParts.get(Ae.FRAGMENT_HEAD),n=r.shaderParts.get(Ae.FRAGMENT_MAIN_IMAGE),s=r.shaderParts.get(Ae.FRAGMENT_MAIN_UV);const i=/\bblend\b/g;for(const o of r.blendModes.values())t+=o.getShaderCode().replace(i,`blend${o.blendFunction}`)+`
`;r.attributes&ts.DEPTH?(r.readDepth&&(n=`float depth = readDepth(UV);

	`+n),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,r.colorSpace===Tt&&(n+=`color0 = sRGBToLinear(color0);
	`),r.uvTransformation?(s=`vec2 transformedUv = vUv;
`+s,r.defines.set("UV","transformedUv")):r.defines.set("UV","vUv"),r.shaderParts.set(Ae.FRAGMENT_HEAD,t),r.shaderParts.set(Ae.FRAGMENT_MAIN_IMAGE,n),r.shaderParts.set(Ae.FRAGMENT_MAIN_UV,s);for(const[o,a]of r.shaderParts)a!==null&&r.shaderParts.set(o,a.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(r)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(r,e=tr){this.fullscreenMaterial.depthBuffer=r,this.fullscreenMaterial.depthPacking=e;for(const t of this.effects)t.setDepthTexture(r,e)}render(r,e,t,n,s){for(const i of this.effects)i.update(r,e,n);if(!this.skipRendering||this.renderToScreen){const i=this.fullscreenMaterial;i.inputBuffer=e.texture,i.time+=n*this.timeScale,r.setRenderTarget(this.renderToScreen?null:t),r.render(this.scene,this.camera)}}setSize(r,e){this.fullscreenMaterial.setSize(r,e);for(const t of this.effects)t.setSize(r,e)}initialize(r,e,t){this.renderer=r;for(const n of this.effects)n.initialize(r,e,t);this.updateMaterial(),t!==void 0&&t!==ss&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const r of this.effects)r.removeEventListener("change",this.listener),r.dispose()}handleEvent(r){switch(r.type){case"change":this.recompile();break}}},Hd=class extends Nt{constructor({kernelSize:r=ja.MEDIUM,resolutionScale:e=.5,width:t=dt.AUTO_SIZE,height:n=dt.AUTO_SIZE,resolutionX:s=t,resolutionY:i=n}={}){super("KawaseBlurPass"),this.renderTargetA=new rn(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const o=this.resolution=new dt(this,s,i,e);o.addEventListener("change",a=>this.setSize(o.baseWidth,o.baseHeight)),this._blurMaterial=new K_,this._blurMaterial.kernelSize=r,this.copyMaterial=new Gd}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(r){this._blurMaterial=r}get dithering(){return this.copyMaterial.dithering}set dithering(r){this.copyMaterial.dithering=r}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(r){this.blurMaterial.kernelSize=r}get width(){return this.resolution.width}set width(r){this.resolution.preferredWidth=r}get height(){return this.resolution.height}set height(r){this.resolution.preferredHeight=r}get scale(){return this.blurMaterial.scale}set scale(r){this.blurMaterial.scale=r}getScale(){return this.blurMaterial.scale}setScale(r){this.blurMaterial.scale=r}getKernelSize(){return this.kernelSize}setKernelSize(r){this.kernelSize=r}getResolutionScale(){return this.resolution.scale}setResolutionScale(r){this.resolution.scale=r}render(r,e,t,n,s){const i=this.scene,o=this.camera,a=this.renderTargetA,c=this.renderTargetB,l=this.blurMaterial,u=l.kernelSequence;let h=e;this.fullscreenMaterial=l;for(let d=0,f=u.length;d<f;++d){const m=d&1?c:a;l.kernel=u[d],l.inputBuffer=h.texture,r.setRenderTarget(m),r.render(i,o),h=m}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=h.texture,r.setRenderTarget(this.renderToScreen?null:t),r.render(i,o)}setSize(r,e){const t=this.resolution;t.setBaseSize(r,e);const n=t.width,s=t.height;this.renderTargetA.setSize(n,s),this.renderTargetB.setSize(n,s),this.blurMaterial.setSize(r,e)}initialize(r,e,t){t!==void 0&&(this.renderTargetA.texture.type=t,this.renderTargetB.texture.type=t,t!==ss?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):Gi(r)===Tt&&(Cs(this.renderTargetA.texture,Tt),Cs(this.renderTargetB.texture,Tt)))}static get AUTO_SIZE(){return dt.AUTO_SIZE}},Og=class extends Nt{constructor({renderTarget:r,luminanceRange:e,colorOutput:t,resolutionScale:n=1,width:s=dt.AUTO_SIZE,height:i=dt.AUTO_SIZE,resolutionX:o=s,resolutionY:a=i}={}){super("LuminancePass"),this.fullscreenMaterial=new dg(t,e),this.needsSwap=!1,this.renderTarget=r,this.renderTarget===void 0&&(this.renderTarget=new rn(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const c=this.resolution=new dt(this,o,a,n);c.addEventListener("change",l=>this.setSize(c.baseWidth,c.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(r,e,t,n,s){const i=this.fullscreenMaterial;i.inputBuffer=e.texture,r.setRenderTarget(this.renderToScreen?null:this.renderTarget),r.render(this.scene,this.camera)}setSize(r,e){const t=this.resolution;t.setBaseSize(r,e),this.renderTarget.setSize(t.width,t.height)}initialize(r,e,t){t!==void 0&&t!==ss&&(this.renderTarget.texture.type=t,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},Ag=class extends Nt{constructor(r,e){super("MaskPass",r,e),this.needsSwap=!1,this.clearPass=new zl(!1,!1,!0),this.inverse=!1}set mainScene(r){this.scene=r}set mainCamera(r){this.camera=r}get inverted(){return this.inverse}set inverted(r){this.inverse=r}get clear(){return this.clearPass.enabled}set clear(r){this.clearPass.enabled=r}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(r){this.inverted=r}render(r,e,t,n,s){const i=r.getContext(),o=r.state.buffers,a=this.scene,c=this.camera,l=this.clearPass,u=this.inverted?0:1,h=1-u;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(i.REPLACE,i.REPLACE,i.REPLACE),o.stencil.setFunc(i.ALWAYS,u,4294967295),o.stencil.setClear(h),o.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?l.render(r,null):(l.render(r,e),l.render(r,t))),this.renderToScreen?(r.setRenderTarget(null),r.render(a,c)):(r.setRenderTarget(e),r.render(a,c),r.setRenderTarget(t),r.render(a,c)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(i.EQUAL,1,4294967295),o.stencil.setOp(i.KEEP,i.KEEP,i.KEEP),o.stencil.setLocked(!0)}},kg=class extends Nt{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new rn(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new ag,this.upsamplingMaterial=new vg,this.resolution=new Xe}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(r){if(this.levels!==r){const e=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let t=0;t<r;++t){const n=e.clone();n.texture.name="Downsampling.Mipmap"+t,this.downsamplingMipmaps.push(n)}this.upsamplingMipmaps.push(e);for(let t=1,n=r-1;t<n;++t){const s=e.clone();s.texture.name="Upsampling.Mipmap"+t,this.upsamplingMipmaps.push(s)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(r){this.upsamplingMaterial.radius=r}render(r,e,t,n,s){const{scene:i,camera:o}=this,{downsamplingMaterial:a,upsamplingMaterial:c}=this,{downsamplingMipmaps:l,upsamplingMipmaps:u}=this;let h=e;this.fullscreenMaterial=a;for(let d=0,f=l.length;d<f;++d){const m=l[d];a.setSize(h.width,h.height),a.inputBuffer=h.texture,r.setRenderTarget(m),r.render(i,o),h=m}this.fullscreenMaterial=c;for(let d=u.length-1;d>=0;--d){const f=u[d];c.setSize(h.width,h.height),c.inputBuffer=h.texture,c.supportBuffer=l[d].texture,r.setRenderTarget(f),r.render(i,o),h=f}}setSize(r,e){const t=this.resolution;t.set(r,e);let n=t.width,s=t.height;for(let i=0,o=this.downsamplingMipmaps.length;i<o;++i)n=Math.round(n*.5),s=Math.round(s*.5),this.downsamplingMipmaps[i].setSize(n,s),i<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[i].setSize(n,s)}initialize(r,e,t){if(t!==void 0){const n=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const s of n)s.texture.type=t;if(t!==ss)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(Gi(r)===Tt)for(const s of n)Cs(s.texture,Tt)}}dispose(){super.dispose();for(const r of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))r.dispose()}},Dg=class extends Nt{constructor(r,e,{renderTarget:t,resolutionScale:n=1,width:s=dt.AUTO_SIZE,height:i=dt.AUTO_SIZE,resolutionX:o=s,resolutionY:a=i}={}){super("NormalPass"),this.needsSwap=!1,this.renderPass=new Ya(r,e,new xm);const c=this.renderPass;c.ignoreBackground=!0,c.skipShadowMapUpdate=!0;const l=c.getClearPass();l.overrideClearColor=new Cn(7829503),l.overrideClearAlpha=1,this.renderTarget=t,this.renderTarget===void 0&&(this.renderTarget=new rn(1,1,{minFilter:Vi,magFilter:Vi}),this.renderTarget.texture.name="NormalPass.Target");const u=this.resolution=new dt(this,o,a,n);u.addEventListener("change",h=>this.setSize(u.baseWidth,u.baseHeight))}set mainScene(r){this.renderPass.mainScene=r}set mainCamera(r){this.renderPass.mainCamera=r}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(r){this.resolution.scale=r}render(r,e,t,n,s){const i=this.renderToScreen?null:this.renderTarget;this.renderPass.render(r,i,i)}setSize(r,e){const t=this.resolution;t.setBaseSize(r,e),this.renderTarget.setSize(t.width,t.height)}},Mg=class extends Nt{constructor(r,e="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=r,this.input=e}setInput(r){this.input=r}render(r,e,t,n,s){const i=this.fullscreenMaterial.uniforms;e!==null&&i!==void 0&&i[this.input]!==void 0&&(i[this.input].value=e.texture),r.setRenderTarget(this.renderToScreen?null:t),r.render(this.scene,this.camera)}initialize(r,e,t){t!==void 0&&t!==ss&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},Gc=1/1e3,Rg=1e3,Pg=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(r){typeof document<"u"&&document.hidden!==void 0&&(r?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=r)}get delta(){return this._delta*Gc}get fixedDelta(){return this._fixedDelta*Gc}set fixedDelta(r){this._fixedDelta=r*Rg}get elapsed(){return this._elapsed*Gc}update(r){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(r!==void 0?r:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}handleEvent(r){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},Ug=class{constructor(e=null,{depthBuffer:t=!0,stencilBuffer:n=!1,multisampling:s=0,frameBufferType:i}={}){this.renderer=null,this.inputBuffer=this.createBuffer(t,n,i,s),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new xg,this.depthTexture=null,this.passes=[],this.timer=new Pg,this.autoRenderToScreen=!0,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){const t=this.inputBuffer,n=this.multisampling;n>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):n!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){if(this.renderer=e,e!==null){const t=e.getSize(new Xe),n=e.getContext().getContextAttributes().alpha,s=this.inputBuffer.texture.type;s===ss&&Gi(e)===Tt&&(Cs(this.inputBuffer.texture,Tt),Cs(this.outputBuffer.texture,Tt),this.inputBuffer.dispose(),this.outputBuffer.dispose()),e.autoClear=!1,this.setSize(t.width,t.height);for(const i of this.passes)i.initialize(e,n,s)}}replaceRenderer(e,t=!0){const n=this.renderer,s=n.domElement.parentNode;return this.setRenderer(e),t&&s!==null&&(s.removeChild(n.domElement),s.appendChild(e.domElement)),n}createDepthTexture(){const e=this.depthTexture=new wm;return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=Sm,e.type=bm):e.type=Cm,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,n,s){const i=this.renderer,o=i===null?new Xe:i.getDrawingBufferSize(new Xe),a={minFilter:zi,magFilter:zi,stencilBuffer:t,depthBuffer:e,type:n},c=new rn(o.width,o.height,a);return s>0&&(c.ignoreDepthForMultisampleCopy=!1,c.samples=s),n===ss&&Gi(i)===Tt&&Cs(c.texture,Tt),c.texture.name="EffectComposer.Buffer",c.texture.generateMipmaps=!1,c}setMainScene(e){for(const t of this.passes)t.mainScene=e}setMainCamera(e){for(const t of this.passes)t.mainCamera=e}addPass(e,t){const n=this.passes,s=this.renderer,i=s.getDrawingBufferSize(new Xe),o=s.getContext().getContextAttributes().alpha,a=this.inputBuffer.texture.type;if(e.setRenderer(s),e.setSize(i.width,i.height),e.initialize(s,o,a),this.autoRenderToScreen&&(n.length>0&&(n[n.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?n.splice(t,0,e):n.push(e),this.autoRenderToScreen&&(n[n.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const c=this.createDepthTexture();for(e of n)e.setDepthTexture(c)}else e.setDepthTexture(this.depthTexture)}removePass(e){const t=this.passes,n=t.indexOf(e);if(n!==-1&&t.splice(n,1).length>0){if(this.depthTexture!==null){const o=(c,l)=>c||l.needsDepthTexture;t.reduce(o,!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&n===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){const e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){const t=this.renderer,n=this.copyPass;let s=this.inputBuffer,i=this.outputBuffer,o=!1,a,c,l;e===void 0&&(this.timer.update(),e=this.timer.delta);for(const u of this.passes)u.enabled&&(u.render(t,s,i,e,o),u.needsSwap&&(o&&(n.renderToScreen=u.renderToScreen,a=t.getContext(),c=t.state.buffers.stencil,c.setFunc(a.NOTEQUAL,1,4294967295),n.render(t,s,i,e,o),c.setFunc(a.EQUAL,1,4294967295)),l=s,s=i,i=l),u instanceof Ag?o=!0:u instanceof wg&&(o=!1))}setSize(e,t,n){const s=this.renderer,i=s.getSize(new Xe);(e===void 0||t===void 0)&&(e=i.width,t=i.height),(i.width!==e||i.height!==t)&&s.setSize(e,t,n);const o=s.getDrawingBufferSize(new Xe);this.inputBuffer.setSize(o.width,o.height),this.outputBuffer.setSize(o.width,o.height);for(const a of this.passes)a.setSize(o.width,o.height)}reset(){const e=this.timer.autoReset;this.dispose(),this.autoRenderToScreen=!0,this.timer.autoReset=e}dispose(){for(const e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},Ig=class{constructor(){this.shaderParts=new Map([[Ae.FRAGMENT_HEAD,null],[Ae.FRAGMENT_MAIN_UV,null],[Ae.FRAGMENT_MAIN_IMAGE,null],[Ae.VERTEX_HEAD,null],[Ae.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=ts.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=qa}},Wc=!1,Ah=class{constructor(r=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(r),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let t;if(e.material.flatShading)switch(e.material.side){case Ai:t=this.materialsFlatShadedDoubleSide;break;case Pr:t=this.materialsFlatShadedBackSide;break;default:t=this.materialsFlatShaded;break}else switch(e.material.side){case Ai:t=this.materialsDoubleSide;break;case Pr:t=this.materialsBackSide;break;default:t=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=t[2]:e.isInstancedMesh?e.material=t[1]:e.material=t[0],++this.meshCount}}}cloneMaterial(r){if(!(r instanceof Wn))return r.clone();const e=r.uniforms,t=new Map;for(const s in e){const i=e[s].value;i.isRenderTargetTexture&&(e[s].value=null,t.set(s,i))}const n=r.clone();for(const s of t)e[s[0]].value=s[1],n.uniforms[s[0]].value=s[1];return n}setMaterial(r){if(this.disposeMaterials(),this.material=r,r!==null){const e=this.materials=[this.cloneMaterial(r),this.cloneMaterial(r),this.cloneMaterial(r)];for(const t of e)t.uniforms=Object.assign({},r.uniforms),t.side=vd;e[2].skinning=!0,this.materialsBackSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},r.uniforms),n.side=Pr,n}),this.materialsDoubleSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},r.uniforms),n.side=Ai,n}),this.materialsFlatShaded=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},r.uniforms),n.flatShading=!0,n}),this.materialsFlatShadedBackSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},r.uniforms),n.flatShading=!0,n.side=Pr,n}),this.materialsFlatShadedDoubleSide=e.map(t=>{const n=this.cloneMaterial(t);return n.uniforms=Object.assign({},r.uniforms),n.flatShading=!0,n.side=Ai,n})}}render(r,e,t){const n=r.shadowMap.enabled;if(r.shadowMap.enabled=!1,Wc){const s=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),r.render(e,t);for(const i of s)i[0].material=i[1];this.meshCount!==s.size&&s.clear()}else{const s=e.overrideMaterial;e.overrideMaterial=this.material,r.render(e,t),e.overrideMaterial=s}r.shadowMap.enabled=n}disposeMaterials(){if(this.material!==null){const r=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of r)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return Wc}static set workaroundEnabled(r){Wc=r}},vs=-1,dt=class extends Il{constructor(r,e=vs,t=vs,n=1){super(),this.resizable=r,this.baseSize=new Xe(1,1),this.preferredSize=new Xe(e,t),this.target=this.preferredSize,this.s=n,this.effectiveSize=new Xe,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const r=this.baseSize,e=this.preferredSize,t=this.effectiveSize,n=this.scale;e.width!==vs?t.width=e.width:e.height!==vs?t.width=Math.round(e.height*(r.width/Math.max(r.height,1))):t.width=Math.round(r.width*n),e.height!==vs?t.height=e.height:e.width!==vs?t.height=Math.round(e.width/Math.max(r.width/Math.max(r.height,1),1)):t.height=Math.round(r.height*n)}get width(){return this.effectiveSize.width}set width(r){this.preferredWidth=r}get height(){return this.effectiveSize.height}set height(r){this.preferredHeight=r}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(r){this.s!==r&&(this.s=r,this.preferredSize.setScalar(vs),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(r){this.scale=r}get baseWidth(){return this.baseSize.width}set baseWidth(r){this.baseSize.width!==r&&(this.baseSize.width=r,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(r){this.baseWidth=r}get baseHeight(){return this.baseSize.height}set baseHeight(r){this.baseSize.height!==r&&(this.baseSize.height=r,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(r){this.baseHeight=r}setBaseSize(r,e){(this.baseSize.width!==r||this.baseSize.height!==e)&&(this.baseSize.set(r,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(r){this.preferredSize.width!==r&&(this.preferredSize.width=r,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(r){this.preferredWidth=r}get preferredHeight(){return this.preferredSize.height}set preferredHeight(r){this.preferredSize.height!==r&&(this.preferredSize.height=r,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(r){this.preferredHeight=r}setPreferredSize(r,e){(this.preferredSize.width!==r||this.preferredSize.height!==e)&&(this.preferredSize.set(r,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(r){this.s=r.scale,this.baseSize.set(r.baseWidth,r.baseHeight),this.preferredSize.set(r.preferredWidth,r.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return vs}},Fg=class extends Set{constructor(r,e=10){super(),this.l=e,this.exclusive=!1,r!==void 0&&this.set(r)}get layer(){return this.l}set layer(r){const e=this.l;for(const t of this)t.layers.disable(e),t.layers.enable(r);this.l=r}getLayer(){return this.layer}setLayer(r){this.layer=r}isExclusive(){return this.exclusive}setExclusive(r){this.exclusive=r}clear(){const r=this.layer;for(const e of this)e.layers.disable(r);return super.clear()}set(r){this.clear();for(const e of r)this.add(e);return this}indexOf(r){return this.has(r)?0:-1}add(r){return this.exclusive?r.layers.set(this.layer):r.layers.enable(this.layer),super.add(r)}delete(r){return this.has(r)&&r.layers.disable(this.layer),super.delete(r)}toggle(r){let e;return this.has(r)?(this.delete(r),e=!1):(this.add(r),e=!0),e}setVisible(r){for(const e of this)r?e.layers.enable(0):e.layers.disable(0);return this}},Ng="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y,opacity);}",Lg="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,min(y.a,opacity));}",Bg="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y)*0.5,opacity);}",zg="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.rg,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",Vg="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(step(0.0,y)*(1.0-min(vec4(1.0),(1.0-x)/y)),vec4(1.0),step(1.0,x));return mix(x,z,opacity);}",Gg="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=step(0.0,x)*mix(min(vec4(1.0),x/max(1.0-y,1e-9)),vec4(1.0),step(1.0,y));return mix(x,z,opacity);}",Wg="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x,y),opacity);}",Hg="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,abs(x-y),opacity);}",qg="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x/max(y,1e-12),opacity);}",jg="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y-2.0*x*y),opacity);}",Yg="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 a=min(x,1.0),b=min(y,1.0);vec4 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,y));return mix(x,z,opacity);}",Xg="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,step(1.0,x+y),opacity);}",Zg="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.r,xHSL.gb));return vec4(mix(x.rgb,z,opacity),y.a);}",Qg="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-y,opacity);}",Kg="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y*(1.0-x),opacity);}",Jg="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x,y),opacity);}",$g="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(y+x-1.0,0.0,1.0),opacity);}",ev="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x+y,1.0),opacity);}",tv="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(2.0*y+x-1.0,0.0,1.0),opacity);}",nv="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.rg,yHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",sv="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x*y,opacity);}",iv="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-abs(1.0-x-y),opacity);}",rv="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,opacity);}",ov="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(2.0*y*x,1.0-2.0*(1.0-y)*(1.0-x),step(0.5,x));return mix(x,z,opacity);}",av="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 z=mix(mix(y2,x,step(0.5*x,y)),max(vec4(0.0),y2-1.0),step(x,(y2-1.0)));return mix(x,z,opacity);}",cv="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(min(x*x/max(1.0-y,1e-12),1.0),y,step(1.0,y));return mix(x,z,opacity);}",lv="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.r,yHSL.g,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",uv="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y-min(x*y,1.0),opacity);}",hv="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 w=step(0.5,y);vec4 z=mix(x-(1.0-y2)*x*(1.0-x),mix(x+(y2-1.0)*(sqrt(x)-x),x+(y2-1.0)*x*((16.0*x-12.0)*x+3.0),w*(1.0-step(0.25,x))),w);return mix(x,z,opacity);}",dv="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",fv="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x+y-1.0,0.0),opacity);}",pv="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(max(1.0-min((1.0-x)/(2.0*y),1.0),0.0),min(x/(2.0*(1.0-y)),1.0),step(0.5,y));return mix(x,z,opacity);}",mv=new Map([[we.ADD,Ng],[we.ALPHA,Lg],[we.AVERAGE,Bg],[we.COLOR,zg],[we.COLOR_BURN,Vg],[we.COLOR_DODGE,Gg],[we.DARKEN,Wg],[we.DIFFERENCE,Hg],[we.DIVIDE,qg],[we.DST,null],[we.EXCLUSION,jg],[we.HARD_LIGHT,Yg],[we.HARD_MIX,Xg],[we.HUE,Zg],[we.INVERT,Qg],[we.INVERT_RGB,Kg],[we.LIGHTEN,Jg],[we.LINEAR_BURN,$g],[we.LINEAR_DODGE,ev],[we.LINEAR_LIGHT,tv],[we.LUMINOSITY,nv],[we.MULTIPLY,sv],[we.NEGATION,iv],[we.NORMAL,rv],[we.OVERLAY,ov],[we.PIN_LIGHT,av],[we.REFLECT,cv],[we.SATURATION,lv],[we.SCREEN,uv],[we.SOFT_LIGHT,hv],[we.SRC,dv],[we.SUBTRACT,fv],[we.VIVID_LIGHT,pv]]),_v=class extends Il{constructor(r,e=1){super(),this._blendFunction=r,this.opacity=new me(e)}getOpacity(){return this.opacity.value}setOpacity(r){this.opacity.value=r}get blendFunction(){return this._blendFunction}set blendFunction(r){this._blendFunction=r,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(r){this.blendFunction=r}getShaderCode(){return mv.get(this.blendFunction)}},Gr=class extends Il{constructor(e,t,{attributes:n=ts.NONE,blendFunction:s=we.NORMAL,defines:i=new Map,uniforms:o=new Map,extensions:a=null,vertexShader:c=null}={}){super(),this.name=e,this.renderer=null,this.attributes=n,this.fragmentShader=t,this.vertexShader=c,this.defines=i,this.uniforms=o,this.extensions=a,this.blendMode=new _v(s),this.blendMode.addEventListener("change",l=>this.setChanged()),this._inputColorSpace=qa,this._outputColorSpace=Bd}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(e){this._inputColorSpace=e,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e,this.setChanged()}set mainScene(e){}set mainCamera(e){}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e,t=tr){}update(e,t,n){}setSize(e,t){}initialize(e,t,n){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof rn||t instanceof xd||t instanceof Pl||t instanceof Nt)&&this[e].dispose()}}},gv=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 texel=texture2D(map,uv);outputColor=vec4(texel.rgb*intensity,texel.a);}`,vv=class extends Gr{constructor({blendFunction:r=we.SCREEN,luminanceThreshold:e=.9,luminanceSmoothing:t=.025,mipmapBlur:n=!1,intensity:s=1,radius:i=.85,levels:o=8,kernelSize:a=ja.LARGE,resolutionScale:c=.5,width:l=dt.AUTO_SIZE,height:u=dt.AUTO_SIZE,resolutionX:h=l,resolutionY:d=u}={}){super("BloomEffect",gv,{blendFunction:r,uniforms:new Map([["map",new me(null)],["intensity",new me(s)]])}),this.renderTarget=new rn(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new Hd({kernelSize:a}),this.luminancePass=new Og({colorOutput:!0}),this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothing=t,this.mipmapBlurPass=new kg,this.mipmapBlurPass.enabled=n,this.mipmapBlurPass.radius=i,this.mipmapBlurPass.levels=o,this.uniforms.get("map").value=n?this.mipmapBlurPass.texture:this.renderTarget.texture;const f=this.resolution=new dt(this,h,d,c);f.addEventListener("change",m=>this.setSize(f.baseWidth,f.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(r){this.resolution.preferredWidth=r}get height(){return this.resolution.height}set height(r){this.resolution.preferredHeight=r}get dithering(){return this.blurPass.dithering}set dithering(r){this.blurPass.dithering=r}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(r){this.blurPass.kernelSize=r}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(r){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(r){this.uniforms.get("intensity").value=r}getIntensity(){return this.intensity}setIntensity(r){this.intensity=r}getResolutionScale(){return this.resolution.scale}setResolutionScale(r){this.resolution.scale=r}update(r,e,t){const n=this.renderTarget,s=this.luminancePass;s.enabled?(s.render(r,e),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(r,s.renderTarget):this.blurPass.render(r,s.renderTarget,n)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(r,e):this.blurPass.render(r,e,n)}setSize(r,e){const t=this.resolution;t.setBaseSize(r,e),this.renderTarget.setSize(t.width,t.height),this.blurPass.resolution.copy(t),this.luminancePass.setSize(r,e),this.mipmapBlurPass.setSize(r,e)}initialize(r,e,t){this.blurPass.initialize(r,e,t),this.luminancePass.initialize(r,e,t),this.mipmapBlurPass.initialize(r,e,t),t!==void 0&&(this.renderTarget.texture.type=t,Gi(r)===Tt&&Cs(this.renderTarget.texture,Tt))}},yv=`uniform lowp sampler2D edgeTexture;uniform lowp sampler2D maskTexture;uniform vec3 visibleEdgeColor;uniform vec3 hiddenEdgeColor;uniform float pulse;uniform float edgeStrength;
#ifdef USE_PATTERN
uniform lowp sampler2D patternTexture;varying vec2 vUvPattern;
#endif
void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 edge=texture2D(edgeTexture,uv).rg;vec2 mask=texture2D(maskTexture,uv).rg;
#ifndef X_RAY
edge.y=0.0;
#endif
edge*=(edgeStrength*mask.x*pulse);vec3 color=edge.x*visibleEdgeColor+edge.y*hiddenEdgeColor;float visibilityFactor=0.0;
#ifdef USE_PATTERN
vec4 patternColor=texture2D(patternTexture,vUvPattern);
#ifdef X_RAY
float hiddenFactor=0.5;
#else
float hiddenFactor=0.0;
#endif
visibilityFactor=(1.0-mask.y>0.0)?1.0:hiddenFactor;visibilityFactor*=(1.0-mask.x)*patternColor.a;color+=visibilityFactor*patternColor.rgb;
#endif
float alpha=max(max(edge.x,edge.y),visibilityFactor);
#ifdef ALPHA
outputColor=vec4(color,alpha);
#else
outputColor=vec4(color,max(alpha,inputColor.a));
#endif
}`,Tv="uniform float patternScale;varying vec2 vUvPattern;void mainSupport(const in vec2 uv){vUvPattern=uv*vec2(aspect,1.0)*patternScale;}",xv=class extends Gr{constructor(r,e,{blendFunction:t=we.SCREEN,patternTexture:n=null,patternScale:s=1,edgeStrength:i=1,pulseSpeed:o=0,visibleEdgeColor:a=16777215,hiddenEdgeColor:c=2230538,kernelSize:l=ja.VERY_SMALL,blur:u=!1,xRay:h=!0,multisampling:d=0,resolutionScale:f=.5,width:m=dt.AUTO_SIZE,height:p=dt.AUTO_SIZE,resolutionX:_=m,resolutionY:T=p}={}){super("OutlineEffect",yv,{uniforms:new Map([["maskTexture",new me(null)],["edgeTexture",new me(null)],["edgeStrength",new me(i)],["visibleEdgeColor",new me(new Cn(a))],["hiddenEdgeColor",new me(new Cn(c))],["pulse",new me(1)],["patternScale",new me(s)],["patternTexture",new me(null)]])}),this.blendMode.addEventListener("change",g=>{this.blendMode.blendFunction===we.ALPHA?this.defines.set("ALPHA","1"):this.defines.delete("ALPHA"),this.setChanged()}),this.blendMode.blendFunction=t,this.patternTexture=n,this.xRay=h,this.scene=r,this.camera=e,this.renderTargetMask=new rn(1,1),this.renderTargetMask.samples=d,this.renderTargetMask.texture.name="Outline.Mask",this.uniforms.get("maskTexture").value=this.renderTargetMask.texture,this.renderTargetOutline=new rn(1,1,{depthBuffer:!1}),this.renderTargetOutline.texture.name="Outline.Edges",this.uniforms.get("edgeTexture").value=this.renderTargetOutline.texture,this.clearPass=new zl,this.clearPass.overrideClearColor=new Cn(0),this.clearPass.overrideClearAlpha=1,this.depthPass=new Sg(r,e),this.maskPass=new Ya(r,e,new tg(this.depthPass.texture,e));const y=this.maskPass.clearPass;y.overrideClearColor=new Cn(16777215),y.overrideClearAlpha=1,this.blurPass=new Hd({resolutionScale:f,resolutionX:_,resolutionY:T,kernelSize:l}),this.blurPass.enabled=u;const b=this.blurPass.resolution;b.addEventListener("change",g=>this.setSize(b.baseWidth,b.baseHeight)),this.outlinePass=new Mg(new mg);const v=this.outlinePass.fullscreenMaterial;v.inputBuffer=this.renderTargetMask.texture,this.time=0,this.forceUpdate=!0,this.selection=new Fg,this.selection.layer=10,this.pulseSpeed=o}set mainScene(r){this.scene=r,this.depthPass.mainScene=r,this.maskPass.mainScene=r}set mainCamera(r){this.camera=r,this.depthPass.mainCamera=r,this.maskPass.mainCamera=r,this.maskPass.overrideMaterial.copyCameraSettings(r)}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.getResolution()}get multisampling(){return this.renderTargetMask.samples}set multisampling(r){this.renderTargetMask.samples=r,this.renderTargetMask.dispose()}get patternScale(){return this.uniforms.get("patternScale").value}set patternScale(r){this.uniforms.get("patternScale").value=r}get edgeStrength(){return this.uniforms.get("edgeStrength").value}set edgeStrength(r){this.uniforms.get("edgeStrength").value=r}get visibleEdgeColor(){return this.uniforms.get("visibleEdgeColor").value}set visibleEdgeColor(r){this.uniforms.get("visibleEdgeColor").value=r}get hiddenEdgeColor(){return this.uniforms.get("hiddenEdgeColor").value}set hiddenEdgeColor(r){this.uniforms.get("hiddenEdgeColor").value=r}getBlurPass(){return this.blurPass}getSelection(){return this.selection}getPulseSpeed(){return this.pulseSpeed}setPulseSpeed(r){this.pulseSpeed=r}get width(){return this.resolution.width}set width(r){this.resolution.preferredWidth=r}get height(){return this.resolution.height}set height(r){this.resolution.preferredHeight=r}get selectionLayer(){return this.selection.layer}set selectionLayer(r){this.selection.layer=r}get dithering(){return this.blurPass.dithering}set dithering(r){this.blurPass.dithering=r}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(r){this.blurPass.kernelSize=r}get blur(){return this.blurPass.enabled}set blur(r){this.blurPass.enabled=r}get xRay(){return this.defines.has("X_RAY")}set xRay(r){this.xRay!==r&&(r?this.defines.set("X_RAY","1"):this.defines.delete("X_RAY"),this.setChanged())}isXRayEnabled(){return this.xRay}setXRayEnabled(r){this.xRay=r}get patternTexture(){return this.uniforms.get("patternTexture").value}set patternTexture(r){r!==null?(r.wrapS=r.wrapT=Em,this.defines.set("USE_PATTERN","1"),this.setVertexShader(Tv)):(this.defines.delete("USE_PATTERN"),this.setVertexShader(null)),this.uniforms.get("patternTexture").value=r,this.setChanged()}setPatternTexture(r){this.patternTexture=r}getResolutionScale(){return this.resolution.scale}setResolutionScale(r){this.resolution.scale=r}setSelection(r){return this.selection.set(r),this}clearSelection(){return this.selection.clear(),this}selectObject(r){return this.selection.add(r),this}deselectObject(r){return this.selection.delete(r),this}update(r,e,t){const n=this.scene,s=this.camera,i=this.selection,a=this.uniforms.get("pulse"),c=n.background,l=s.layers.mask;(this.forceUpdate||i.size>0)&&(n.background=null,a.value=1,this.pulseSpeed>0&&(a.value=Math.cos(this.time*this.pulseSpeed*10)*.375+.625),this.time+=t,i.setVisible(!1),this.depthPass.render(r),i.setVisible(!0),s.layers.set(i.layer),this.maskPass.render(r,this.renderTargetMask),s.layers.mask=l,n.background=c,this.outlinePass.render(r,null,this.renderTargetOutline),this.blurPass.enabled&&this.blurPass.render(r,this.renderTargetOutline,this.renderTargetOutline)),this.forceUpdate=i.size>0}setSize(r,e){this.blurPass.setSize(r,e),this.renderTargetMask.setSize(r,e);const t=this.resolution;t.setBaseSize(r,e);const n=t.width,s=t.height;this.depthPass.setSize(n,s),this.renderTargetOutline.setSize(n,s),this.outlinePass.fullscreenMaterial.setSize(n,s)}initialize(r,e,t){this.blurPass.initialize(r,e,ss),t!==void 0&&(this.depthPass.initialize(r,e,t),this.maskPass.initialize(r,e,t),this.outlinePass.initialize(r,e,t))}},wv=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,Sv=class extends Gr{constructor({blendFunction:r,technique:e=$o.DEFAULT,eskil:t=!1,offset:n=.5,darkness:s=.5}={}){super("VignetteEffect",wv,{blendFunction:r,defines:new Map([["VIGNETTE_TECHNIQUE",e.toFixed(0)]]),uniforms:new Map([["offset",new me(n)],["darkness",new me(s)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(r){this.technique!==r&&(this.defines.set("VIGNETTE_TECHNIQUE",r.toFixed(0)),this.setChanged())}get eskil(){return this.technique===$o.ESKIL}set eskil(r){this.technique=r?$o.ESKIL:$o.DEFAULT}getTechnique(){return this.technique}setTechnique(r){this.technique=r}get offset(){return this.uniforms.get("offset").value}set offset(r){this.uniforms.get("offset").value=r}getOffset(){return this.offset}setOffset(r){this.offset=r}get darkness(){return this.uniforms.get("darkness").value}set darkness(r){this.uniforms.get("darkness").value=r}getDarkness(){return this.darkness}setDarkness(r){this.darkness=r}};const qd=J.createContext(null),kh=r=>(r.getAttributes()&ts.CONVOLUTION)===ts.CONVOLUTION,JS=tl.memo(J.forwardRef(({children:r,camera:e,scene:t,resolutionScale:n,enabled:s=!0,renderPriority:i=1,autoClear:o=!0,depthBuffer:a,disableNormalPass:c,stencilBuffer:l,multisampling:u=8,frameBufferType:h=Am},d)=>{const{gl:f,scene:m,camera:p,size:_}=Qe(),T=t||m,y=e||p,[b,v,g]=J.useMemo(()=>{const C=Vm(),O=new Ug(f,{depthBuffer:a,stencilBuffer:l,multisampling:u>0&&C?u:0,frameBufferType:h});O.addPass(new Ya(T,y));let k=null,E=null;return c||(E=new Dg(T,y),E.enabled=!1,O.addPass(E),n!==void 0&&C&&(k=new bg({normalBuffer:E.texture,resolutionScale:n}),k.enabled=!1,O.addPass(k))),[O,E,k]},[y,f,a,l,u,h,T,c,n]);J.useEffect(()=>b==null?void 0:b.setSize(_.width,_.height),[b,_]),Ll((C,O)=>{if(s){const k=f.autoClear;f.autoClear=o,l&&!o&&f.clearStencil(),b.render(O),f.autoClear=k}},s?i:0);const x=J.useRef(null),w=Um(x);J.useLayoutEffect(()=>{const C=[];if(x.current&&w.current&&b){const O=w.current.objects;for(let k=0;k<O.length;k++){const E=O[k];if(E instanceof Gr){const D=[E];if(!kh(E)){let U=null;for(;(U=O[k+1])instanceof Gr&&!kh(U);)D.push(U),k++}const M=new Eg(y,...D);C.push(M)}else E instanceof Nt&&C.push(E)}for(const k of C)b==null||b.addPass(k);v&&(v.enabled=!0),g&&(g.enabled=!0)}return()=>{for(const O of C)b==null||b.removePass(O);v&&(v.enabled=!1),g&&(g.enabled=!1)}},[b,r,y,v,g,w]);const S=J.useMemo(()=>({composer:b,normalPass:v,downSamplingPass:g,resolutionScale:n,camera:y,scene:T}),[b,v,g,n,y,T]);return J.useImperativeHandle(d,()=>b,[b]),Qs.jsx(qd.Provider,{value:S,children:Qs.jsx("group",{ref:x,children:r})})})),Dh=r=>typeof r=="object"&&r!=null&&"current"in r?r.current:r;let bv=0;const Mh=new WeakMap,jd=(r,e)=>tl.forwardRef(function({blendFunction:n=e==null?void 0:e.blendFunction,opacity:s=e==null?void 0:e.opacity,...i},o){let a=Mh.get(r);if(!a){const u=`@react-three/postprocessing/${r.name}-${bv++}`;Nl({[u]:r}),Mh.set(r,a=u)}const c=Qe(u=>u.camera),l=tl.useMemo(()=>{var u,h;return[...(u=e==null?void 0:e.args)!=null?u:[],...(h=i.args)!=null?h:[{...e,...i}]]},[JSON.stringify(i)]);return Qs.jsx(a,{camera:c,"blendMode-blendFunction":n,"blendMode-opacity-value":s,...i,ref:o,args:l})}),$S=jd(vv,{blendFunction:we.ADD}),eb=J.forwardRef(function({selection:e=[],selectionLayer:t=10,blendFunction:n,patternTexture:s,edgeStrength:i,pulseSpeed:o,visibleEdgeColor:a,hiddenEdgeColor:c,width:l,height:u,kernelSize:h,blur:d,xRay:f,...m},p){const _=Qe(g=>g.invalidate),{scene:T,camera:y}=J.useContext(qd),b=J.useMemo(()=>new xv(T,y,{blendFunction:n,patternTexture:s,edgeStrength:i,pulseSpeed:o,visibleEdgeColor:a,hiddenEdgeColor:c,width:l,height:u,kernelSize:h,blur:d,xRay:f,...m}),[n,d,y,i,u,c,h,s,o,T,a,l,f]),v=J.useContext(Im);return J.useEffect(()=>{if(!v&&e)return b.selection.set(Array.isArray(e)?e.map(Dh):[Dh(e)]),_(),()=>{b.selection.clear(),_()}},[b,e,v,_]),J.useEffect(()=>{b.selectionLayer=t,_()},[b,_,t]),J.useRef(),J.useEffect(()=>{var g;if(v&&v.enabled&&(g=v.selected)!=null&&g.length)return b.selection.set(v.selected),_(),()=>{b.selection.clear(),_()}},[v,b.selection,_]),J.useEffect(()=>()=>{b.dispose()},[b]),Qs.jsx("primitive",{ref:p,object:b})}),tb=jd(Sv),Cv={isUserDragging:!1,isUserScrolling:!1,userMovedCamera:!1,isUserScrollingOnHtmlPanel:!1},nb=km(r=>({...Cv,setIsUserDragging:e=>r({isUserDragging:e}),setIsUserScrolling:e=>r({isUserScrolling:e}),setUserMovedCamera:e=>r({userMovedCamera:e}),setIsUserScrollingOnHtmlPanel:e=>r({isUserScrollingOnHtmlPanel:e})}));function Jn(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Yd(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.__proto__=e}/*!
 * GSAP 3.12.4
 * https://gsap.com
 *
 * @license Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var nn={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Wi={duration:.5,overwrite:!1,delay:0},Vl,At,it,dn=1e8,ze=1/dn,al=Math.PI*2,Ev=al/4,Ov=0,Xd=Math.sqrt,Av=Math.cos,kv=Math.sin,wt=function(e){return typeof e=="string"},ot=function(e){return typeof e=="function"},is=function(e){return typeof e=="number"},Gl=function(e){return typeof e>"u"},Vn=function(e){return typeof e=="object"},Wt=function(e){return e!==!1},Wl=function(){return typeof window<"u"},ea=function(e){return ot(e)||wt(e)},Zd=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},kt=Array.isArray,cl=/(?:-?\.?\d|\.)+/gi,Qd=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Di=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Hc=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Kd=/[+-]=-?[.\d]+/,Jd=/[^,'"\[\]\s]+/gi,Dv=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,$e,hn,ll,Hl,on={},pa={},$d,ef=function(e){return(pa=ii(e,on))&&Xt},ql=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},Wr=function(e,t){return!t&&console.warn(e)},tf=function(e,t){return e&&(on[e]=t)&&pa&&(pa[e]=t)||on},Hr=function(){return 0},Mv={suppressEvents:!0,isStart:!0,kill:!1},aa={suppressEvents:!0,kill:!1},Rv={suppressEvents:!0},jl={},Es=[],ul={},nf,$t={},qc={},Rh=30,ca=[],Yl="",Xl=function(e){var t=e[0],n,s;if(Vn(t)||ot(t)||(e=[e]),!(n=(t._gsap||{}).harness)){for(s=ca.length;s--&&!ca[s].targetTest(t););n=ca[s]}for(s=e.length;s--;)e[s]&&(e[s]._gsap||(e[s]._gsap=new Of(e[s],n)))||e.splice(s,1);return e},Js=function(e){return e._gsap||Xl(fn(e))[0]._gsap},sf=function(e,t,n){return(n=e[t])&&ot(n)?e[t]():Gl(n)&&e.getAttribute&&e.getAttribute(t)||n},Ht=function(e,t){return(e=e.split(",")).forEach(t)||e},lt=function(e){return Math.round(e*1e5)/1e5||0},yt=function(e){return Math.round(e*1e7)/1e7||0},Ii=function(e,t){var n=t.charAt(0),s=parseFloat(t.substr(2));return e=parseFloat(e),n==="+"?e+s:n==="-"?e-s:n==="*"?e*s:e/s},Pv=function(e,t){for(var n=t.length,s=0;e.indexOf(t[s])<0&&++s<n;);return s<n},ma=function(){var e=Es.length,t=Es.slice(0),n,s;for(ul={},Es.length=0,n=0;n<e;n++)s=t[n],s&&s._lazy&&(s.render(s._lazy[0],s._lazy[1],!0)._lazy=0)},rf=function(e,t,n,s){Es.length&&!At&&ma(),e.render(t,n,s||At&&t<0&&(e._initted||e._startAt)),Es.length&&!At&&ma()},of=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(Jd).length<2?t:wt(e)?e.trim():e},af=function(e){return e},_n=function(e,t){for(var n in t)n in e||(e[n]=t[n]);return e},Uv=function(e){return function(t,n){for(var s in n)s in t||s==="duration"&&e||s==="ease"||(t[s]=n[s])}},ii=function(e,t){for(var n in t)e[n]=t[n];return e},Ph=function r(e,t){for(var n in t)n!=="__proto__"&&n!=="constructor"&&n!=="prototype"&&(e[n]=Vn(t[n])?r(e[n]||(e[n]={}),t[n]):t[n]);return e},_a=function(e,t){var n={},s;for(s in e)s in t||(n[s]=e[s]);return n},Lr=function(e){var t=e.parent||$e,n=e.keyframes?Uv(kt(e.keyframes)):_n;if(Wt(e.inherit))for(;t;)n(e,t.vars.defaults),t=t.parent||t._dp;return e},Iv=function(e,t){for(var n=e.length,s=n===t.length;s&&n--&&e[n]===t[n];);return n<0},cf=function(e,t,n,s,i){n===void 0&&(n="_first"),s===void 0&&(s="_last");var o=e[s],a;if(i)for(a=t[i];o&&o[i]>a;)o=o._prev;return o?(t._next=o._next,o._next=t):(t._next=e[n],e[n]=t),t._next?t._next._prev=t:e[s]=t,t._prev=o,t.parent=t._dp=e,t},Xa=function(e,t,n,s){n===void 0&&(n="_first"),s===void 0&&(s="_last");var i=t._prev,o=t._next;i?i._next=o:e[n]===t&&(e[n]=o),o?o._prev=i:e[s]===t&&(e[s]=i),t._next=t._prev=t.parent=null},ks=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},$s=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var n=e;n;)n._dirty=1,n=n.parent;return e},Fv=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},hl=function(e,t,n,s){return e._startAt&&(At?e._startAt.revert(aa):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,s))},Nv=function r(e){return!e||e._ts&&r(e.parent)},Uh=function(e){return e._repeat?Hi(e._tTime,e=e.duration()+e._rDelay)*e:0},Hi=function(e,t){var n=Math.floor(e/=t);return e&&n===e?n-1:n},ga=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},Za=function(e){return e._end=yt(e._start+(e._tDur/Math.abs(e._ts||e._rts||ze)||0))},Qa=function(e,t){var n=e._dp;return n&&n.smoothChildTiming&&e._ts&&(e._start=yt(n._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),Za(e),n._dirty||$s(n,e)),e},lf=function(e,t){var n;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(n=ga(e.rawTime(),t),(!t._dur||vo(0,t.totalDuration(),n)-t._tTime>ze)&&t.render(n,!0)),$s(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(n=e;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;e._zTime=-ze}},Ln=function(e,t,n,s){return t.parent&&ks(t),t._start=yt((is(n)?n:n||e!==$e?un(e,n,t):e._time)+t._delay),t._end=yt(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),cf(e,t,"_first","_last",e._sort?"_start":0),dl(t)||(e._recent=t),s||lf(e,t),e._ts<0&&Qa(e,e._tTime),e},uf=function(e,t){return(on.ScrollTrigger||ql("scrollTrigger",t))&&on.ScrollTrigger.create(t,e)},hf=function(e,t,n,s,i){if(Ql(e,t,i),!e._initted)return 1;if(!n&&e._pt&&!At&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&nf!==en.frame)return Es.push(e),e._lazy=[i,s],1},Lv=function r(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||r(t))},dl=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},Bv=function(e,t,n,s){var i=e.ratio,o=t<0||!t&&(!e._start&&Lv(e)&&!(!e._initted&&dl(e))||(e._ts<0||e._dp._ts<0)&&!dl(e))?0:1,a=e._rDelay,c=0,l,u,h;if(a&&e._repeat&&(c=vo(0,e._tDur,t),u=Hi(c,a),e._yoyo&&u&1&&(o=1-o),u!==Hi(e._tTime,a)&&(i=1-o,e.vars.repeatRefresh&&e._initted&&e.invalidate())),o!==i||At||s||e._zTime===ze||!t&&e._zTime){if(!e._initted&&hf(e,t,s,n,c))return;for(h=e._zTime,e._zTime=t||(n?ze:0),n||(n=t&&!h),e.ratio=o,e._from&&(o=1-o),e._time=0,e._tTime=c,l=e._pt;l;)l.r(o,l.d),l=l._next;t<0&&hl(e,t,n,!0),e._onUpdate&&!n&&tn(e,"onUpdate"),c&&e._repeat&&!n&&e.parent&&tn(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===o&&(o&&ks(e,1),!n&&!At&&(tn(e,o?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},zv=function(e,t,n){var s;if(n>t)for(s=e._first;s&&s._start<=n;){if(s.data==="isPause"&&s._start>t)return s;s=s._next}else for(s=e._last;s&&s._start>=n;){if(s.data==="isPause"&&s._start<t)return s;s=s._prev}},qi=function(e,t,n,s){var i=e._repeat,o=yt(t)||0,a=e._tTime/e._tDur;return a&&!s&&(e._time*=o/e._dur),e._dur=o,e._tDur=i?i<0?1e10:yt(o*(i+1)+e._rDelay*i):o,a>0&&!s&&Qa(e,e._tTime=e._tDur*a),e.parent&&Za(e),n||$s(e.parent,e),e},Ih=function(e){return e instanceof It?$s(e):qi(e,e._dur)},Vv={_start:0,endTime:Hr,totalDuration:Hr},un=function r(e,t,n){var s=e.labels,i=e._recent||Vv,o=e.duration()>=dn?i.endTime(!1):e._dur,a,c,l;return wt(t)&&(isNaN(t)||t in s)?(c=t.charAt(0),l=t.substr(-1)==="%",a=t.indexOf("="),c==="<"||c===">"?(a>=0&&(t=t.replace(/=/,"")),(c==="<"?i._start:i.endTime(i._repeat>=0))+(parseFloat(t.substr(1))||0)*(l?(a<0?i:n).totalDuration()/100:1)):a<0?(t in s||(s[t]=o),s[t]):(c=parseFloat(t.charAt(a-1)+t.substr(a+1)),l&&n&&(c=c/100*(kt(n)?n[0]:n).totalDuration()),a>1?r(e,t.substr(0,a-1),n)+c:o+c)):t==null?o:+t},Br=function(e,t,n){var s=is(t[1]),i=(s?2:1)+(e<2?0:1),o=t[i],a,c;if(s&&(o.duration=t[1]),o.parent=n,e){for(a=o,c=n;c&&!("immediateRender"in a);)a=c.vars.defaults||{},c=Wt(c.vars.inherit)&&c.parent;o.immediateRender=Wt(a.immediateRender),e<2?o.runBackwards=1:o.startAt=t[i-1]}return new _t(t[0],o,t[i+1])},Fs=function(e,t){return e||e===0?t(e):t},vo=function(e,t,n){return n<e?e:n>t?t:n},Ot=function(e,t){return!wt(e)||!(t=Dv.exec(e))?"":t[1]},Gv=function(e,t,n){return Fs(n,function(s){return vo(e,t,s)})},fl=[].slice,df=function(e,t){return e&&Vn(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&Vn(e[0]))&&!e.nodeType&&e!==hn},Wv=function(e,t,n){return n===void 0&&(n=[]),e.forEach(function(s){var i;return wt(s)&&!t||df(s,1)?(i=n).push.apply(i,fn(s)):n.push(s)})||n},fn=function(e,t,n){return it&&!t&&it.selector?it.selector(e):wt(e)&&!n&&(ll||!ji())?fl.call((t||Hl).querySelectorAll(e),0):kt(e)?Wv(e,n):df(e)?fl.call(e,0):e?[e]:[]},pl=function(e){return e=fn(e)[0]||Wr("Invalid scope")||{},function(t){var n=e.current||e.nativeElement||e;return fn(t,n.querySelectorAll?n:n===e?Wr("Invalid scope")||Hl.createElement("div"):e)}},ff=function(e){return e.sort(function(){return .5-Math.random()})},pf=function(e){if(ot(e))return e;var t=Vn(e)?e:{each:e},n=ei(t.ease),s=t.from||0,i=parseFloat(t.base)||0,o={},a=s>0&&s<1,c=isNaN(s)||a,l=t.axis,u=s,h=s;return wt(s)?u=h={center:.5,edges:.5,end:1}[s]||0:!a&&c&&(u=s[0],h=s[1]),function(d,f,m){var p=(m||t).length,_=o[p],T,y,b,v,g,x,w,S,C;if(!_){if(C=t.grid==="auto"?0:(t.grid||[1,dn])[1],!C){for(w=-dn;w<(w=m[C++].getBoundingClientRect().left)&&C<p;);C<p&&C--}for(_=o[p]=[],T=c?Math.min(C,p)*u-.5:s%C,y=C===dn?0:c?p*h/C-.5:s/C|0,w=0,S=dn,x=0;x<p;x++)b=x%C-T,v=y-(x/C|0),_[x]=g=l?Math.abs(l==="y"?v:b):Xd(b*b+v*v),g>w&&(w=g),g<S&&(S=g);s==="random"&&ff(_),_.max=w-S,_.min=S,_.v=p=(parseFloat(t.amount)||parseFloat(t.each)*(C>p?p-1:l?l==="y"?p/C:C:Math.max(C,p/C))||0)*(s==="edges"?-1:1),_.b=p<0?i-p:i,_.u=Ot(t.amount||t.each)||0,n=n&&p<0?bf(n):n}return p=(_[d]-_.min)/_.max||0,yt(_.b+(n?n(p):p)*_.v)+_.u}},ml=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(n){var s=yt(Math.round(parseFloat(n)/e)*e*t);return(s-s%1)/t+(is(n)?0:Ot(n))}},mf=function(e,t){var n=kt(e),s,i;return!n&&Vn(e)&&(s=n=e.radius||dn,e.values?(e=fn(e.values),(i=!is(e[0]))&&(s*=s)):e=ml(e.increment)),Fs(t,n?ot(e)?function(o){return i=e(o),Math.abs(i-o)<=s?i:o}:function(o){for(var a=parseFloat(i?o.x:o),c=parseFloat(i?o.y:0),l=dn,u=0,h=e.length,d,f;h--;)i?(d=e[h].x-a,f=e[h].y-c,d=d*d+f*f):d=Math.abs(e[h]-a),d<l&&(l=d,u=h);return u=!s||l<=s?e[u]:o,i||u===o||is(o)?u:u+Ot(o)}:ml(e))},_f=function(e,t,n,s){return Fs(kt(e)?!t:n===!0?!!(n=0):!s,function(){return kt(e)?e[~~(Math.random()*e.length)]:(n=n||1e-5)&&(s=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((e-n/2+Math.random()*(t-e+n*.99))/n)*n*s)/s})},Hv=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(s){return t.reduce(function(i,o){return o(i)},s)}},qv=function(e,t){return function(n){return e(parseFloat(n))+(t||Ot(n))}},jv=function(e,t,n){return vf(e,t,0,1,n)},gf=function(e,t,n){return Fs(n,function(s){return e[~~t(s)]})},Yv=function r(e,t,n){var s=t-e;return kt(e)?gf(e,r(0,e.length),t):Fs(n,function(i){return(s+(i-e)%s)%s+e})},Xv=function r(e,t,n){var s=t-e,i=s*2;return kt(e)?gf(e,r(0,e.length-1),t):Fs(n,function(o){return o=(i+(o-e)%i)%i||0,e+(o>s?i-o:o)})},qr=function(e){for(var t=0,n="",s,i,o,a;~(s=e.indexOf("random(",t));)o=e.indexOf(")",s),a=e.charAt(s+7)==="[",i=e.substr(s+7,o-s-7).match(a?Jd:cl),n+=e.substr(t,s-t)+_f(a?i:+i[0],a?0:+i[1],+i[2]||1e-5),t=o+1;return n+e.substr(t,e.length-t)},vf=function(e,t,n,s,i){var o=t-e,a=s-n;return Fs(i,function(c){return n+((c-e)/o*a||0)})},Zv=function r(e,t,n,s){var i=isNaN(e+t)?0:function(f){return(1-f)*e+f*t};if(!i){var o=wt(e),a={},c,l,u,h,d;if(n===!0&&(s=1)&&(n=null),o)e={p:e},t={p:t};else if(kt(e)&&!kt(t)){for(u=[],h=e.length,d=h-2,l=1;l<h;l++)u.push(r(e[l-1],e[l]));h--,i=function(m){m*=h;var p=Math.min(d,~~m);return u[p](m-p)},n=t}else s||(e=ii(kt(e)?[]:{},e));if(!u){for(c in t)Zl.call(a,e,c,"get",t[c]);i=function(m){return $l(m,a)||(o?e.p:e)}}}return Fs(n,i)},Fh=function(e,t,n){var s=e.labels,i=dn,o,a,c;for(o in s)a=s[o]-t,a<0==!!n&&a&&i>(a=Math.abs(a))&&(c=o,i=a);return c},tn=function(e,t,n){var s=e.vars,i=s[t],o=it,a=e._ctx,c,l,u;if(i)return c=s[t+"Params"],l=s.callbackScope||e,n&&Es.length&&ma(),a&&(it=a),u=c?i.apply(l,c):i.call(l),it=o,u},Ur=function(e){return ks(e),e.scrollTrigger&&e.scrollTrigger.kill(!!At),e.progress()<1&&tn(e,"onInterrupt"),e},Mi,yf=[],Tf=function(e){if(Wl()&&e){e=!e.name&&e.default||e;var t=e.name,n=ot(e),s=t&&!n&&e.init?function(){this._props=[]}:e,i={init:Hr,render:$l,add:Zl,kill:h0,modifier:u0,rawVars:0},o={targetTest:0,get:0,getSetter:Jl,aliases:{},register:0};if(ji(),e!==s){if($t[t])return;_n(s,_n(_a(e,i),o)),ii(s.prototype,ii(i,_a(e,o))),$t[s.prop=t]=s,e.targetTest&&(ca.push(s),jl[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}tf(t,s),e.register&&e.register(Xt,s,qt)}else e&&yf.push(e)},Be=255,Ir={aqua:[0,Be,Be],lime:[0,Be,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Be],navy:[0,0,128],white:[Be,Be,Be],olive:[128,128,0],yellow:[Be,Be,0],orange:[Be,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Be,0,0],pink:[Be,192,203],cyan:[0,Be,Be],transparent:[Be,Be,Be,0]},jc=function(e,t,n){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(n-t)*e*6:e<.5?n:e*3<2?t+(n-t)*(2/3-e)*6:t)*Be+.5|0},xf=function(e,t,n){var s=e?is(e)?[e>>16,e>>8&Be,e&Be]:0:Ir.black,i,o,a,c,l,u,h,d,f,m;if(!s){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),Ir[e])s=Ir[e];else if(e.charAt(0)==="#"){if(e.length<6&&(i=e.charAt(1),o=e.charAt(2),a=e.charAt(3),e="#"+i+i+o+o+a+a+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return s=parseInt(e.substr(1,6),16),[s>>16,s>>8&Be,s&Be,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),s=[e>>16,e>>8&Be,e&Be]}else if(e.substr(0,3)==="hsl"){if(s=m=e.match(cl),!t)c=+s[0]%360/360,l=+s[1]/100,u=+s[2]/100,o=u<=.5?u*(l+1):u+l-u*l,i=u*2-o,s.length>3&&(s[3]*=1),s[0]=jc(c+1/3,i,o),s[1]=jc(c,i,o),s[2]=jc(c-1/3,i,o);else if(~e.indexOf("="))return s=e.match(Qd),n&&s.length<4&&(s[3]=1),s}else s=e.match(cl)||Ir.transparent;s=s.map(Number)}return t&&!m&&(i=s[0]/Be,o=s[1]/Be,a=s[2]/Be,h=Math.max(i,o,a),d=Math.min(i,o,a),u=(h+d)/2,h===d?c=l=0:(f=h-d,l=u>.5?f/(2-h-d):f/(h+d),c=h===i?(o-a)/f+(o<a?6:0):h===o?(a-i)/f+2:(i-o)/f+4,c*=60),s[0]=~~(c+.5),s[1]=~~(l*100+.5),s[2]=~~(u*100+.5)),n&&s.length<4&&(s[3]=1),s},wf=function(e){var t=[],n=[],s=-1;return e.split(Os).forEach(function(i){var o=i.match(Di)||[];t.push.apply(t,o),n.push(s+=o.length+1)}),t.c=n,t},Nh=function(e,t,n){var s="",i=(e+s).match(Os),o=t?"hsla(":"rgba(",a=0,c,l,u,h;if(!i)return e;if(i=i.map(function(d){return(d=xf(d,t,1))&&o+(t?d[0]+","+d[1]+"%,"+d[2]+"%,"+d[3]:d.join(","))+")"}),n&&(u=wf(e),c=n.c,c.join(s)!==u.c.join(s)))for(l=e.replace(Os,"1").split(Di),h=l.length-1;a<h;a++)s+=l[a]+(~c.indexOf(a)?i.shift()||o+"0,0,0,0)":(u.length?u:i.length?i:n).shift());if(!l)for(l=e.split(Os),h=l.length-1;a<h;a++)s+=l[a]+i[a];return s+l[h]},Os=function(){var r="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in Ir)r+="|"+e+"\\b";return new RegExp(r+")","gi")}(),Qv=/hsl[a]?\(/,Sf=function(e){var t=e.join(" "),n;if(Os.lastIndex=0,Os.test(t))return n=Qv.test(t),e[1]=Nh(e[1],n),e[0]=Nh(e[0],n,wf(e[1])),!0},jr,en=function(){var r=Date.now,e=500,t=33,n=r(),s=n,i=1e3/240,o=i,a=[],c,l,u,h,d,f,m=function p(_){var T=r()-s,y=_===!0,b,v,g,x;if(T>e&&(n+=T-t),s+=T,g=s-n,b=g-o,(b>0||y)&&(x=++h.frame,d=g-h.time*1e3,h.time=g=g/1e3,o+=b+(b>=i?4:i-b),v=1),y||(c=l(p)),v)for(f=0;f<a.length;f++)a[f](g,d,x,_)};return h={time:0,frame:0,tick:function(){m(!0)},deltaRatio:function(_){return d/(1e3/(_||60))},wake:function(){$d&&(!ll&&Wl()&&(hn=ll=window,Hl=hn.document||{},on.gsap=Xt,(hn.gsapVersions||(hn.gsapVersions=[])).push(Xt.version),ef(pa||hn.GreenSockGlobals||!hn.gsap&&hn||{}),u=hn.requestAnimationFrame,yf.forEach(Tf)),c&&h.sleep(),l=u||function(_){return setTimeout(_,o-h.time*1e3+1|0)},jr=1,m(2))},sleep:function(){(u?hn.cancelAnimationFrame:clearTimeout)(c),jr=0,l=Hr},lagSmoothing:function(_,T){e=_||1/0,t=Math.min(T||33,e)},fps:function(_){i=1e3/(_||240),o=h.time*1e3+i},add:function(_,T,y){var b=T?function(v,g,x,w){_(v,g,x,w),h.remove(b)}:_;return h.remove(_),a[y?"unshift":"push"](b),ji(),b},remove:function(_,T){~(T=a.indexOf(_))&&a.splice(T,1)&&f>=T&&f--},_listeners:a},h}(),ji=function(){return!jr&&en.wake()},Ee={},Kv=/^[\d.\-M][\d.\-,\s]/,Jv=/["']/g,$v=function(e){for(var t={},n=e.substr(1,e.length-3).split(":"),s=n[0],i=1,o=n.length,a,c,l;i<o;i++)c=n[i],a=i!==o-1?c.lastIndexOf(","):c.length,l=c.substr(0,a),t[s]=isNaN(l)?l.replace(Jv,"").trim():+l,s=c.substr(a+1).trim();return t},e0=function(e){var t=e.indexOf("(")+1,n=e.indexOf(")"),s=e.indexOf("(",t);return e.substring(t,~s&&s<n?e.indexOf(")",n+1):n)},t0=function(e){var t=(e+"").split("("),n=Ee[t[0]];return n&&t.length>1&&n.config?n.config.apply(null,~e.indexOf("{")?[$v(t[1])]:e0(e).split(",").map(of)):Ee._CE&&Kv.test(e)?Ee._CE("",e):n},bf=function(e){return function(t){return 1-e(1-t)}},Cf=function r(e,t){for(var n=e._first,s;n;)n instanceof It?r(n,t):n.vars.yoyoEase&&(!n._yoyo||!n._repeat)&&n._yoyo!==t&&(n.timeline?r(n.timeline,t):(s=n._ease,n._ease=n._yEase,n._yEase=s,n._yoyo=t)),n=n._next},ei=function(e,t){return e&&(ot(e)?e:Ee[e]||t0(e))||t},hi=function(e,t,n,s){n===void 0&&(n=function(c){return 1-t(1-c)}),s===void 0&&(s=function(c){return c<.5?t(c*2)/2:1-t((1-c)*2)/2});var i={easeIn:t,easeOut:n,easeInOut:s},o;return Ht(e,function(a){Ee[a]=on[a]=i,Ee[o=a.toLowerCase()]=n;for(var c in i)Ee[o+(c==="easeIn"?".in":c==="easeOut"?".out":".inOut")]=Ee[a+"."+c]=i[c]}),i},Ef=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},Yc=function r(e,t,n){var s=t>=1?t:1,i=(n||(e?.3:.45))/(t<1?t:1),o=i/al*(Math.asin(1/s)||0),a=function(u){return u===1?1:s*Math.pow(2,-10*u)*kv((u-o)*i)+1},c=e==="out"?a:e==="in"?function(l){return 1-a(1-l)}:Ef(a);return i=al/i,c.config=function(l,u){return r(e,l,u)},c},Xc=function r(e,t){t===void 0&&(t=1.70158);var n=function(o){return o?--o*o*((t+1)*o+t)+1:0},s=e==="out"?n:e==="in"?function(i){return 1-n(1-i)}:Ef(n);return s.config=function(i){return r(e,i)},s};Ht("Linear,Quad,Cubic,Quart,Quint,Strong",function(r,e){var t=e<5?e+1:e;hi(r+",Power"+(t-1),e?function(n){return Math.pow(n,t)}:function(n){return n},function(n){return 1-Math.pow(1-n,t)},function(n){return n<.5?Math.pow(n*2,t)/2:1-Math.pow((1-n)*2,t)/2})});Ee.Linear.easeNone=Ee.none=Ee.Linear.easeIn;hi("Elastic",Yc("in"),Yc("out"),Yc());(function(r,e){var t=1/e,n=2*t,s=2.5*t,i=function(a){return a<t?r*a*a:a<n?r*Math.pow(a-1.5/e,2)+.75:a<s?r*(a-=2.25/e)*a+.9375:r*Math.pow(a-2.625/e,2)+.984375};hi("Bounce",function(o){return 1-i(1-o)},i)})(7.5625,2.75);hi("Expo",function(r){return r?Math.pow(2,10*(r-1)):0});hi("Circ",function(r){return-(Xd(1-r*r)-1)});hi("Sine",function(r){return r===1?1:-Av(r*Ev)+1});hi("Back",Xc("in"),Xc("out"),Xc());Ee.SteppedEase=Ee.steps=on.SteppedEase={config:function(e,t){e===void 0&&(e=1);var n=1/e,s=e+(t?0:1),i=t?1:0,o=1-ze;return function(a){return((s*vo(0,o,a)|0)+i)*n}}};Wi.ease=Ee["quad.out"];Ht("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(r){return Yl+=r+","+r+"Params,"});var Of=function(e,t){this.id=Ov++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:sf,this.set=t?t.getSetter:Jl},Yr=function(){function r(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,qi(this,+t.duration,1,1),this.data=t.data,it&&(this._ctx=it,it.data.push(this)),jr||en.wake()}var e=r.prototype;return e.delay=function(n){return n||n===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+n-this._delay),this._delay=n,this):this._delay},e.duration=function(n){return arguments.length?this.totalDuration(this._repeat>0?n+(n+this._rDelay)*this._repeat:n):this.totalDuration()&&this._dur},e.totalDuration=function(n){return arguments.length?(this._dirty=0,qi(this,this._repeat<0?n:(n-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(n,s){if(ji(),!arguments.length)return this._tTime;var i=this._dp;if(i&&i.smoothChildTiming&&this._ts){for(Qa(this,n),!i._dp||i.parent||lf(i,this);i&&i.parent;)i.parent._time!==i._start+(i._ts>=0?i._tTime/i._ts:(i.totalDuration()-i._tTime)/-i._ts)&&i.totalTime(i._tTime,!0),i=i.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&n<this._tDur||this._ts<0&&n>0||!this._tDur&&!n)&&Ln(this._dp,this,this._start-this._delay)}return(this._tTime!==n||!this._dur&&!s||this._initted&&Math.abs(this._zTime)===ze||!n&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=n),rf(this,n,s)),this},e.time=function(n,s){return arguments.length?this.totalTime(Math.min(this.totalDuration(),n+Uh(this))%(this._dur+this._rDelay)||(n?this._dur:0),s):this._time},e.totalProgress=function(n,s){return arguments.length?this.totalTime(this.totalDuration()*n,s):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>0?1:0},e.progress=function(n,s){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-n:n)+Uh(this),s):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(n,s){var i=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(n-1)*i,s):this._repeat?Hi(this._tTime,i)+1:1},e.timeScale=function(n,s){if(!arguments.length)return this._rts===-ze?0:this._rts;if(this._rts===n)return this;var i=this.parent&&this._ts?ga(this.parent._time,this):this._tTime;return this._rts=+n||0,this._ts=this._ps||n===-ze?0:this._rts,this.totalTime(vo(-Math.abs(this._delay),this._tDur,i),s!==!1),Za(this),Fv(this)},e.paused=function(n){return arguments.length?(this._ps!==n&&(this._ps=n,n?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(ji(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==ze&&(this._tTime-=ze)))),this):this._ps},e.startTime=function(n){if(arguments.length){this._start=n;var s=this.parent||this._dp;return s&&(s._sort||!this.parent)&&Ln(s,this,n-this._delay),this}return this._start},e.endTime=function(n){return this._start+(Wt(n)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(n){var s=this.parent||this._dp;return s?n&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?ga(s.rawTime(n),this):this._tTime:this._tTime},e.revert=function(n){n===void 0&&(n=Rv);var s=At;return At=n,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(n),this.totalTime(-.01,n.suppressEvents)),this.data!=="nested"&&n.kill!==!1&&this.kill(),At=s,this},e.globalTime=function(n){for(var s=this,i=arguments.length?n:s.rawTime();s;)i=s._start+i/(Math.abs(s._ts)||1),s=s._dp;return!this.parent&&this._sat?this._sat.globalTime(n):i},e.repeat=function(n){return arguments.length?(this._repeat=n===1/0?-2:n,Ih(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(n){if(arguments.length){var s=this._time;return this._rDelay=n,Ih(this),s?this.time(s):this}return this._rDelay},e.yoyo=function(n){return arguments.length?(this._yoyo=n,this):this._yoyo},e.seek=function(n,s){return this.totalTime(un(this,n),Wt(s))},e.restart=function(n,s){return this.play().totalTime(n?-this._delay:0,Wt(s))},e.play=function(n,s){return n!=null&&this.seek(n,s),this.reversed(!1).paused(!1)},e.reverse=function(n,s){return n!=null&&this.seek(n||this.totalDuration(),s),this.reversed(!0).paused(!1)},e.pause=function(n,s){return n!=null&&this.seek(n,s),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(n){return arguments.length?(!!n!==this.reversed()&&this.timeScale(-this._rts||(n?-ze:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-ze,this},e.isActive=function(){var n=this.parent||this._dp,s=this._start,i;return!!(!n||this._ts&&this._initted&&n.isActive()&&(i=n.rawTime(!0))>=s&&i<this.endTime(!0)-ze)},e.eventCallback=function(n,s,i){var o=this.vars;return arguments.length>1?(s?(o[n]=s,i&&(o[n+"Params"]=i),n==="onUpdate"&&(this._onUpdate=s)):delete o[n],this):o[n]},e.then=function(n){var s=this;return new Promise(function(i){var o=ot(n)?n:af,a=function(){var l=s.then;s.then=null,ot(o)&&(o=o(s))&&(o.then||o===s)&&(s.then=l),i(o),s.then=l};s._initted&&s.totalProgress()===1&&s._ts>=0||!s._tTime&&s._ts<0?a():s._prom=a})},e.kill=function(){Ur(this)},r}();_n(Yr.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-ze,_prom:0,_ps:!1,_rts:1});var It=function(r){Yd(e,r);function e(n,s){var i;return n===void 0&&(n={}),i=r.call(this,n)||this,i.labels={},i.smoothChildTiming=!!n.smoothChildTiming,i.autoRemoveChildren=!!n.autoRemoveChildren,i._sort=Wt(n.sortChildren),$e&&Ln(n.parent||$e,Jn(i),s),n.reversed&&i.reverse(),n.paused&&i.paused(!0),n.scrollTrigger&&uf(Jn(i),n.scrollTrigger),i}var t=e.prototype;return t.to=function(s,i,o){return Br(0,arguments,this),this},t.from=function(s,i,o){return Br(1,arguments,this),this},t.fromTo=function(s,i,o,a){return Br(2,arguments,this),this},t.set=function(s,i,o){return i.duration=0,i.parent=this,Lr(i).repeatDelay||(i.repeat=0),i.immediateRender=!!i.immediateRender,new _t(s,i,un(this,o),1),this},t.call=function(s,i,o){return Ln(this,_t.delayedCall(0,s,i),o)},t.staggerTo=function(s,i,o,a,c,l,u){return o.duration=i,o.stagger=o.stagger||a,o.onComplete=l,o.onCompleteParams=u,o.parent=this,new _t(s,o,un(this,c)),this},t.staggerFrom=function(s,i,o,a,c,l,u){return o.runBackwards=1,Lr(o).immediateRender=Wt(o.immediateRender),this.staggerTo(s,i,o,a,c,l,u)},t.staggerFromTo=function(s,i,o,a,c,l,u,h){return a.startAt=o,Lr(a).immediateRender=Wt(a.immediateRender),this.staggerTo(s,i,a,c,l,u,h)},t.render=function(s,i,o){var a=this._time,c=this._dirty?this.totalDuration():this._tDur,l=this._dur,u=s<=0?0:yt(s),h=this._zTime<0!=s<0&&(this._initted||!l),d,f,m,p,_,T,y,b,v,g,x,w;if(this!==$e&&u>c&&s>=0&&(u=c),u!==this._tTime||o||h){if(a!==this._time&&l&&(u+=this._time-a,s+=this._time-a),d=u,v=this._start,b=this._ts,T=!b,h&&(l||(a=this._zTime),(s||!i)&&(this._zTime=s)),this._repeat){if(x=this._yoyo,_=l+this._rDelay,this._repeat<-1&&s<0)return this.totalTime(_*100+s,i,o);if(d=yt(u%_),u===c?(p=this._repeat,d=l):(p=~~(u/_),p&&p===u/_&&(d=l,p--),d>l&&(d=l)),g=Hi(this._tTime,_),!a&&this._tTime&&g!==p&&this._tTime-g*_-this._dur<=0&&(g=p),x&&p&1&&(d=l-d,w=1),p!==g&&!this._lock){var S=x&&g&1,C=S===(x&&p&1);if(p<g&&(S=!S),a=S?0:u%l?l:u,this._lock=1,this.render(a||(w?0:yt(p*_)),i,!l)._lock=0,this._tTime=u,!i&&this.parent&&tn(this,"onRepeat"),this.vars.repeatRefresh&&!w&&(this.invalidate()._lock=1),a&&a!==this._time||T!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(l=this._dur,c=this._tDur,C&&(this._lock=2,a=S?l:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!w&&this.invalidate()),this._lock=0,!this._ts&&!T)return this;Cf(this,w)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(y=zv(this,yt(a),yt(d)),y&&(u-=d-(d=y._start))),this._tTime=u,this._time=d,this._act=!b,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=s,a=0),!a&&d&&!i&&!p&&(tn(this,"onStart"),this._tTime!==u))return this;if(d>=a&&s>=0)for(f=this._first;f;){if(m=f._next,(f._act||d>=f._start)&&f._ts&&y!==f){if(f.parent!==this)return this.render(s,i,o);if(f.render(f._ts>0?(d-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(d-f._start)*f._ts,i,o),d!==this._time||!this._ts&&!T){y=0,m&&(u+=this._zTime=-ze);break}}f=m}else{f=this._last;for(var O=s<0?s:d;f;){if(m=f._prev,(f._act||O<=f._end)&&f._ts&&y!==f){if(f.parent!==this)return this.render(s,i,o);if(f.render(f._ts>0?(O-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(O-f._start)*f._ts,i,o||At&&(f._initted||f._startAt)),d!==this._time||!this._ts&&!T){y=0,m&&(u+=this._zTime=O?-ze:ze);break}}f=m}}if(y&&!i&&(this.pause(),y.render(d>=a?0:-ze)._zTime=d>=a?1:-1,this._ts))return this._start=v,Za(this),this.render(s,i,o);this._onUpdate&&!i&&tn(this,"onUpdate",!0),(u===c&&this._tTime>=this.totalDuration()||!u&&a)&&(v===this._start||Math.abs(b)!==Math.abs(this._ts))&&(this._lock||((s||!l)&&(u===c&&this._ts>0||!u&&this._ts<0)&&ks(this,1),!i&&!(s<0&&!a)&&(u||a||!c)&&(tn(this,u===c&&s>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(u<c&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(s,i){var o=this;if(is(i)||(i=un(this,i,s)),!(s instanceof Yr)){if(kt(s))return s.forEach(function(a){return o.add(a,i)}),this;if(wt(s))return this.addLabel(s,i);if(ot(s))s=_t.delayedCall(0,s);else return this}return this!==s?Ln(this,s,i):this},t.getChildren=function(s,i,o,a){s===void 0&&(s=!0),i===void 0&&(i=!0),o===void 0&&(o=!0),a===void 0&&(a=-dn);for(var c=[],l=this._first;l;)l._start>=a&&(l instanceof _t?i&&c.push(l):(o&&c.push(l),s&&c.push.apply(c,l.getChildren(!0,i,o)))),l=l._next;return c},t.getById=function(s){for(var i=this.getChildren(1,1,1),o=i.length;o--;)if(i[o].vars.id===s)return i[o]},t.remove=function(s){return wt(s)?this.removeLabel(s):ot(s)?this.killTweensOf(s):(Xa(this,s),s===this._recent&&(this._recent=this._last),$s(this))},t.totalTime=function(s,i){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=yt(en.time-(this._ts>0?s/this._ts:(this.totalDuration()-s)/-this._ts))),r.prototype.totalTime.call(this,s,i),this._forcing=0,this):this._tTime},t.addLabel=function(s,i){return this.labels[s]=un(this,i),this},t.removeLabel=function(s){return delete this.labels[s],this},t.addPause=function(s,i,o){var a=_t.delayedCall(0,i||Hr,o);return a.data="isPause",this._hasPause=1,Ln(this,a,un(this,s))},t.removePause=function(s){var i=this._first;for(s=un(this,s);i;)i._start===s&&i.data==="isPause"&&ks(i),i=i._next},t.killTweensOf=function(s,i,o){for(var a=this.getTweensOf(s,o),c=a.length;c--;)ws!==a[c]&&a[c].kill(s,i);return this},t.getTweensOf=function(s,i){for(var o=[],a=fn(s),c=this._first,l=is(i),u;c;)c instanceof _t?Pv(c._targets,a)&&(l?(!ws||c._initted&&c._ts)&&c.globalTime(0)<=i&&c.globalTime(c.totalDuration())>i:!i||c.isActive())&&o.push(c):(u=c.getTweensOf(a,i)).length&&o.push.apply(o,u),c=c._next;return o},t.tweenTo=function(s,i){i=i||{};var o=this,a=un(o,s),c=i,l=c.startAt,u=c.onStart,h=c.onStartParams,d=c.immediateRender,f,m=_t.to(o,_n({ease:i.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:i.duration||Math.abs((a-(l&&"time"in l?l.time:o._time))/o.timeScale())||ze,onStart:function(){if(o.pause(),!f){var _=i.duration||Math.abs((a-(l&&"time"in l?l.time:o._time))/o.timeScale());m._dur!==_&&qi(m,_,0,1).render(m._time,!0,!0),f=1}u&&u.apply(m,h||[])}},i));return d?m.render(0):m},t.tweenFromTo=function(s,i,o){return this.tweenTo(i,_n({startAt:{time:un(this,s)}},o))},t.recent=function(){return this._recent},t.nextLabel=function(s){return s===void 0&&(s=this._time),Fh(this,un(this,s))},t.previousLabel=function(s){return s===void 0&&(s=this._time),Fh(this,un(this,s),1)},t.currentLabel=function(s){return arguments.length?this.seek(s,!0):this.previousLabel(this._time+ze)},t.shiftChildren=function(s,i,o){o===void 0&&(o=0);for(var a=this._first,c=this.labels,l;a;)a._start>=o&&(a._start+=s,a._end+=s),a=a._next;if(i)for(l in c)c[l]>=o&&(c[l]+=s);return $s(this)},t.invalidate=function(s){var i=this._first;for(this._lock=0;i;)i.invalidate(s),i=i._next;return r.prototype.invalidate.call(this,s)},t.clear=function(s){s===void 0&&(s=!0);for(var i=this._first,o;i;)o=i._next,this.remove(i),i=o;return this._dp&&(this._time=this._tTime=this._pTime=0),s&&(this.labels={}),$s(this)},t.totalDuration=function(s){var i=0,o=this,a=o._last,c=dn,l,u,h;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-s:s));if(o._dirty){for(h=o.parent;a;)l=a._prev,a._dirty&&a.totalDuration(),u=a._start,u>c&&o._sort&&a._ts&&!o._lock?(o._lock=1,Ln(o,a,u-a._delay,1)._lock=0):c=u,u<0&&a._ts&&(i-=u,(!h&&!o._dp||h&&h.smoothChildTiming)&&(o._start+=u/o._ts,o._time-=u,o._tTime-=u),o.shiftChildren(-u,!1,-1/0),c=0),a._end>i&&a._ts&&(i=a._end),a=l;qi(o,o===$e&&o._time>i?o._time:i,1,1),o._dirty=0}return o._tDur},e.updateRoot=function(s){if($e._ts&&(rf($e,ga(s,$e)),nf=en.frame),en.frame>=Rh){Rh+=nn.autoSleep||120;var i=$e._first;if((!i||!i._ts)&&nn.autoSleep&&en._listeners.length<2){for(;i&&!i._ts;)i=i._next;i||en.sleep()}}},e}(Yr);_n(It.prototype,{_lock:0,_hasPause:0,_forcing:0});var n0=function(e,t,n,s,i,o,a){var c=new qt(this._pt,e,t,0,1,Pf,null,i),l=0,u=0,h,d,f,m,p,_,T,y;for(c.b=n,c.e=s,n+="",s+="",(T=~s.indexOf("random("))&&(s=qr(s)),o&&(y=[n,s],o(y,e,t),n=y[0],s=y[1]),d=n.match(Hc)||[];h=Hc.exec(s);)m=h[0],p=s.substring(l,h.index),f?f=(f+1)%5:p.substr(-5)==="rgba("&&(f=1),m!==d[u++]&&(_=parseFloat(d[u-1])||0,c._pt={_next:c._pt,p:p||u===1?p:",",s:_,c:m.charAt(1)==="="?Ii(_,m)-_:parseFloat(m)-_,m:f&&f<4?Math.round:0},l=Hc.lastIndex);return c.c=l<s.length?s.substring(l,s.length):"",c.fp=a,(Kd.test(s)||T)&&(c.e=0),this._pt=c,c},Zl=function(e,t,n,s,i,o,a,c,l,u){ot(s)&&(s=s(i||0,e,o));var h=e[t],d=n!=="get"?n:ot(h)?l?e[t.indexOf("set")||!ot(e["get"+t.substr(3)])?t:"get"+t.substr(3)](l):e[t]():h,f=ot(h)?l?a0:Mf:Kl,m;if(wt(s)&&(~s.indexOf("random(")&&(s=qr(s)),s.charAt(1)==="="&&(m=Ii(d,s)+(Ot(d)||0),(m||m===0)&&(s=m))),!u||d!==s||_l)return!isNaN(d*s)&&s!==""?(m=new qt(this._pt,e,t,+d||0,s-(d||0),typeof h=="boolean"?l0:Rf,0,f),l&&(m.fp=l),a&&m.modifier(a,this,e),this._pt=m):(!h&&!(t in e)&&ql(t,s),n0.call(this,e,t,d,s,f,c||nn.stringFilter,l))},s0=function(e,t,n,s,i){if(ot(e)&&(e=zr(e,i,t,n,s)),!Vn(e)||e.style&&e.nodeType||kt(e)||Zd(e))return wt(e)?zr(e,i,t,n,s):e;var o={},a;for(a in e)o[a]=zr(e[a],i,t,n,s);return o},Af=function(e,t,n,s,i,o){var a,c,l,u;if($t[e]&&(a=new $t[e]).init(i,a.rawVars?t[e]:s0(t[e],s,i,o,n),n,s,o)!==!1&&(n._pt=c=new qt(n._pt,i,e,0,1,a.render,a,0,a.priority),n!==Mi))for(l=n._ptLookup[n._targets.indexOf(i)],u=a._props.length;u--;)l[a._props[u]]=c;return a},ws,_l,Ql=function r(e,t,n){var s=e.vars,i=s.ease,o=s.startAt,a=s.immediateRender,c=s.lazy,l=s.onUpdate,u=s.runBackwards,h=s.yoyoEase,d=s.keyframes,f=s.autoRevert,m=e._dur,p=e._startAt,_=e._targets,T=e.parent,y=T&&T.data==="nested"?T.vars.targets:_,b=e._overwrite==="auto"&&!Vl,v=e.timeline,g,x,w,S,C,O,k,E,D,M,U,P,V;if(v&&(!d||!i)&&(i="none"),e._ease=ei(i,Wi.ease),e._yEase=h?bf(ei(h===!0?i:h,Wi.ease)):0,h&&e._yoyo&&!e._repeat&&(h=e._yEase,e._yEase=e._ease,e._ease=h),e._from=!v&&!!s.runBackwards,!v||d&&!s.stagger){if(E=_[0]?Js(_[0]).harness:0,P=E&&s[E.prop],g=_a(s,jl),p&&(p._zTime<0&&p.progress(1),t<0&&u&&a&&!f?p.render(-1,!0):p.revert(u&&m?aa:Mv),p._lazy=0),o){if(ks(e._startAt=_t.set(_,_n({data:"isStart",overwrite:!1,parent:T,immediateRender:!0,lazy:!p&&Wt(c),startAt:null,delay:0,onUpdate:l&&function(){return tn(e,"onUpdate")},stagger:0},o))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(At||!a&&!f)&&e._startAt.revert(aa),a&&m&&t<=0&&n<=0){t&&(e._zTime=t);return}}else if(u&&m&&!p){if(t&&(a=!1),w=_n({overwrite:!1,data:"isFromStart",lazy:a&&!p&&Wt(c),immediateRender:a,stagger:0,parent:T},g),P&&(w[E.prop]=P),ks(e._startAt=_t.set(_,w)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(At?e._startAt.revert(aa):e._startAt.render(-1,!0)),e._zTime=t,!a)r(e._startAt,ze,ze);else if(!t)return}for(e._pt=e._ptCache=0,c=m&&Wt(c)||c&&!m,x=0;x<_.length;x++){if(C=_[x],k=C._gsap||Xl(_)[x]._gsap,e._ptLookup[x]=M={},ul[k.id]&&Es.length&&ma(),U=y===_?x:y.indexOf(C),E&&(D=new E).init(C,P||g,e,U,y)!==!1&&(e._pt=S=new qt(e._pt,C,D.name,0,1,D.render,D,0,D.priority),D._props.forEach(function(Q){M[Q]=S}),D.priority&&(O=1)),!E||P)for(w in g)$t[w]&&(D=Af(w,g,e,U,C,y))?D.priority&&(O=1):M[w]=S=Zl.call(e,C,w,"get",g[w],U,y,0,s.stringFilter);e._op&&e._op[x]&&e.kill(C,e._op[x]),b&&e._pt&&(ws=e,$e.killTweensOf(C,M,e.globalTime(t)),V=!e.parent,ws=0),e._pt&&c&&(ul[k.id]=1)}O&&Uf(e),e._onInit&&e._onInit(e)}e._onUpdate=l,e._initted=(!e._op||e._pt)&&!V,d&&t<=0&&v.render(dn,!0,!0)},i0=function(e,t,n,s,i,o,a,c){var l=(e._pt&&e._ptCache||(e._ptCache={}))[t],u,h,d,f;if(!l)for(l=e._ptCache[t]=[],d=e._ptLookup,f=e._targets.length;f--;){if(u=d[f][t],u&&u.d&&u.d._pt)for(u=u.d._pt;u&&u.p!==t&&u.fp!==t;)u=u._next;if(!u)return _l=1,e.vars[t]="+=0",Ql(e,a),_l=0,c?Wr(t+" not eligible for reset"):1;l.push(u)}for(f=l.length;f--;)h=l[f],u=h._pt||h,u.s=(s||s===0)&&!i?s:u.s+(s||0)+o*u.c,u.c=n-u.s,h.e&&(h.e=lt(n)+Ot(h.e)),h.b&&(h.b=u.s+Ot(h.b))},r0=function(e,t){var n=e[0]?Js(e[0]).harness:0,s=n&&n.aliases,i,o,a,c;if(!s)return t;i=ii({},t);for(o in s)if(o in i)for(c=s[o].split(","),a=c.length;a--;)i[c[a]]=i[o];return i},o0=function(e,t,n,s){var i=t.ease||s||"power1.inOut",o,a;if(kt(t))a=n[e]||(n[e]=[]),t.forEach(function(c,l){return a.push({t:l/(t.length-1)*100,v:c,e:i})});else for(o in t)a=n[o]||(n[o]=[]),o==="ease"||a.push({t:parseFloat(e),v:t[o],e:i})},zr=function(e,t,n,s,i){return ot(e)?e.call(t,n,s,i):wt(e)&&~e.indexOf("random(")?qr(e):e},kf=Yl+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",Df={};Ht(kf+",id,stagger,delay,duration,paused,scrollTrigger",function(r){return Df[r]=1});var _t=function(r){Yd(e,r);function e(n,s,i,o){var a;typeof s=="number"&&(i.duration=s,s=i,i=null),a=r.call(this,o?s:Lr(s))||this;var c=a.vars,l=c.duration,u=c.delay,h=c.immediateRender,d=c.stagger,f=c.overwrite,m=c.keyframes,p=c.defaults,_=c.scrollTrigger,T=c.yoyoEase,y=s.parent||$e,b=(kt(n)||Zd(n)?is(n[0]):"length"in s)?[n]:fn(n),v,g,x,w,S,C,O,k;if(a._targets=b.length?Xl(b):Wr("GSAP target "+n+" not found. https://gsap.com",!nn.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=f,m||d||ea(l)||ea(u)){if(s=a.vars,v=a.timeline=new It({data:"nested",defaults:p||{},targets:y&&y.data==="nested"?y.vars.targets:b}),v.kill(),v.parent=v._dp=Jn(a),v._start=0,d||ea(l)||ea(u)){if(w=b.length,O=d&&pf(d),Vn(d))for(S in d)~kf.indexOf(S)&&(k||(k={}),k[S]=d[S]);for(g=0;g<w;g++)x=_a(s,Df),x.stagger=0,T&&(x.yoyoEase=T),k&&ii(x,k),C=b[g],x.duration=+zr(l,Jn(a),g,C,b),x.delay=(+zr(u,Jn(a),g,C,b)||0)-a._delay,!d&&w===1&&x.delay&&(a._delay=u=x.delay,a._start+=u,x.delay=0),v.to(C,x,O?O(g,C,b):0),v._ease=Ee.none;v.duration()?l=u=0:a.timeline=0}else if(m){Lr(_n(v.vars.defaults,{ease:"none"})),v._ease=ei(m.ease||s.ease||"none");var E=0,D,M,U;if(kt(m))m.forEach(function(P){return v.to(b,P,">")}),v.duration();else{x={};for(S in m)S==="ease"||S==="easeEach"||o0(S,m[S],x,m.easeEach);for(S in x)for(D=x[S].sort(function(P,V){return P.t-V.t}),E=0,g=0;g<D.length;g++)M=D[g],U={ease:M.e,duration:(M.t-(g?D[g-1].t:0))/100*l},U[S]=M.v,v.to(b,U,E),E+=U.duration;v.duration()<l&&v.to({},{duration:l-v.duration()})}}l||a.duration(l=v.duration())}else a.timeline=0;return f===!0&&!Vl&&(ws=Jn(a),$e.killTweensOf(b),ws=0),Ln(y,Jn(a),i),s.reversed&&a.reverse(),s.paused&&a.paused(!0),(h||!l&&!m&&a._start===yt(y._time)&&Wt(h)&&Nv(Jn(a))&&y.data!=="nested")&&(a._tTime=-ze,a.render(Math.max(0,-u)||0)),_&&uf(Jn(a),_),a}var t=e.prototype;return t.render=function(s,i,o){var a=this._time,c=this._tDur,l=this._dur,u=s<0,h=s>c-ze&&!u?c:s<ze?0:s,d,f,m,p,_,T,y,b,v;if(!l)Bv(this,s,i,o);else if(h!==this._tTime||!s||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==u){if(d=h,b=this.timeline,this._repeat){if(p=l+this._rDelay,this._repeat<-1&&u)return this.totalTime(p*100+s,i,o);if(d=yt(h%p),h===c?(m=this._repeat,d=l):(m=~~(h/p),m&&m===yt(h/p)&&(d=l,m--),d>l&&(d=l)),T=this._yoyo&&m&1,T&&(v=this._yEase,d=l-d),_=Hi(this._tTime,p),d===a&&!o&&this._initted&&m===_)return this._tTime=h,this;m!==_&&(b&&this._yEase&&Cf(b,T),this.vars.repeatRefresh&&!T&&!this._lock&&this._time!==l&&this._initted&&(this._lock=o=1,this.render(yt(p*m),!0).invalidate()._lock=0))}if(!this._initted){if(hf(this,u?s:d,o,i,h))return this._tTime=0,this;if(a!==this._time&&!(o&&this.vars.repeatRefresh&&m!==_))return this;if(l!==this._dur)return this.render(s,i,o)}if(this._tTime=h,this._time=d,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=y=(v||this._ease)(d/l),this._from&&(this.ratio=y=1-y),d&&!a&&!i&&!m&&(tn(this,"onStart"),this._tTime!==h))return this;for(f=this._pt;f;)f.r(y,f.d),f=f._next;b&&b.render(s<0?s:!d&&T?-ze:b._dur*b._ease(d/this._dur),i,o)||this._startAt&&(this._zTime=s),this._onUpdate&&!i&&(u&&hl(this,s,i,o),tn(this,"onUpdate")),this._repeat&&m!==_&&this.vars.onRepeat&&!i&&this.parent&&tn(this,"onRepeat"),(h===this._tDur||!h)&&this._tTime===h&&(u&&!this._onUpdate&&hl(this,s,!0,!0),(s||!l)&&(h===this._tDur&&this._ts>0||!h&&this._ts<0)&&ks(this,1),!i&&!(u&&!a)&&(h||a||T)&&(tn(this,h===c?"onComplete":"onReverseComplete",!0),this._prom&&!(h<c&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(s){return(!s||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(s),r.prototype.invalidate.call(this,s)},t.resetTo=function(s,i,o,a,c){jr||en.wake(),this._ts||this.play();var l=Math.min(this._dur,(this._dp._time-this._start)*this._ts),u;return this._initted||Ql(this,l),u=this._ease(l/this._dur),i0(this,s,i,o,a,u,l,c)?this.resetTo(s,i,o,a,1):(Qa(this,0),this.parent||cf(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(s,i){if(i===void 0&&(i="all"),!s&&(!i||i==="all"))return this._lazy=this._pt=0,this.parent?Ur(this):this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(s,i,ws&&ws.vars.overwrite!==!0)._first||Ur(this),this.parent&&o!==this.timeline.totalDuration()&&qi(this,this._dur*this.timeline._tDur/o,0,1),this}var a=this._targets,c=s?fn(s):a,l=this._ptLookup,u=this._pt,h,d,f,m,p,_,T;if((!i||i==="all")&&Iv(a,c))return i==="all"&&(this._pt=0),Ur(this);for(h=this._op=this._op||[],i!=="all"&&(wt(i)&&(p={},Ht(i,function(y){return p[y]=1}),i=p),i=r0(a,i)),T=a.length;T--;)if(~c.indexOf(a[T])){d=l[T],i==="all"?(h[T]=i,m=d,f={}):(f=h[T]=h[T]||{},m=i);for(p in m)_=d&&d[p],_&&((!("kill"in _.d)||_.d.kill(p)===!0)&&Xa(this,_,"_pt"),delete d[p]),f!=="all"&&(f[p]=1)}return this._initted&&!this._pt&&u&&Ur(this),this},e.to=function(s,i){return new e(s,i,arguments[2])},e.from=function(s,i){return Br(1,arguments)},e.delayedCall=function(s,i,o,a){return new e(i,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:s,onComplete:i,onReverseComplete:i,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},e.fromTo=function(s,i,o){return Br(2,arguments)},e.set=function(s,i){return i.duration=0,i.repeatDelay||(i.repeat=0),new e(s,i)},e.killTweensOf=function(s,i,o){return $e.killTweensOf(s,i,o)},e}(Yr);_n(_t.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});Ht("staggerTo,staggerFrom,staggerFromTo",function(r){_t[r]=function(){var e=new It,t=fl.call(arguments,0);return t.splice(r==="staggerFromTo"?5:4,0,0),e[r].apply(e,t)}});var Kl=function(e,t,n){return e[t]=n},Mf=function(e,t,n){return e[t](n)},a0=function(e,t,n,s){return e[t](s.fp,n)},c0=function(e,t,n){return e.setAttribute(t,n)},Jl=function(e,t){return ot(e[t])?Mf:Gl(e[t])&&e.setAttribute?c0:Kl},Rf=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},l0=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},Pf=function(e,t){var n=t._pt,s="";if(!e&&t.b)s=t.b;else if(e===1&&t.e)s=t.e;else{for(;n;)s=n.p+(n.m?n.m(n.s+n.c*e):Math.round((n.s+n.c*e)*1e4)/1e4)+s,n=n._next;s+=t.c}t.set(t.t,t.p,s,t)},$l=function(e,t){for(var n=t._pt;n;)n.r(e,n.d),n=n._next},u0=function(e,t,n,s){for(var i=this._pt,o;i;)o=i._next,i.p===s&&i.modifier(e,t,n),i=o},h0=function(e){for(var t=this._pt,n,s;t;)s=t._next,t.p===e&&!t.op||t.op===e?Xa(this,t,"_pt"):t.dep||(n=1),t=s;return!n},d0=function(e,t,n,s){s.mSet(e,t,s.m.call(s.tween,n,s.mt),s)},Uf=function(e){for(var t=e._pt,n,s,i,o;t;){for(n=t._next,s=i;s&&s.pr>t.pr;)s=s._next;(t._prev=s?s._prev:o)?t._prev._next=t:i=t,(t._next=s)?s._prev=t:o=t,t=n}e._pt=i},qt=function(){function r(t,n,s,i,o,a,c,l,u){this.t=n,this.s=i,this.c=o,this.p=s,this.r=a||Rf,this.d=c||this,this.set=l||Kl,this.pr=u||0,this._next=t,t&&(t._prev=this)}var e=r.prototype;return e.modifier=function(n,s,i){this.mSet=this.mSet||this.set,this.set=d0,this.m=n,this.mt=i,this.tween=s},r}();Ht(Yl+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(r){return jl[r]=1});on.TweenMax=on.TweenLite=_t;on.TimelineLite=on.TimelineMax=It;$e=new It({sortChildren:!1,defaults:Wi,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});nn.stringFilter=Sf;var ti=[],la={},f0=[],Lh=0,p0=0,Zc=function(e){return(la[e]||f0).map(function(t){return t()})},gl=function(){var e=Date.now(),t=[];e-Lh>2&&(Zc("matchMediaInit"),ti.forEach(function(n){var s=n.queries,i=n.conditions,o,a,c,l;for(a in s)o=hn.matchMedia(s[a]).matches,o&&(c=1),o!==i[a]&&(i[a]=o,l=1);l&&(n.revert(),c&&t.push(n))}),Zc("matchMediaRevert"),t.forEach(function(n){return n.onMatch(n,function(s){return n.add(null,s)})}),Lh=e,Zc("matchMedia"))},If=function(){function r(t,n){this.selector=n&&pl(n),this.data=[],this._r=[],this.isReverted=!1,this.id=p0++,t&&this.add(t)}var e=r.prototype;return e.add=function(n,s,i){ot(n)&&(i=s,s=n,n=ot);var o=this,a=function(){var l=it,u=o.selector,h;return l&&l!==o&&l.data.push(o),i&&(o.selector=pl(i)),it=o,h=s.apply(o,arguments),ot(h)&&o._r.push(h),it=l,o.selector=u,o.isReverted=!1,h};return o.last=a,n===ot?a(o,function(c){return o.add(null,c)}):n?o[n]=a:a},e.ignore=function(n){var s=it;it=null,n(this),it=s},e.getTweens=function(){var n=[];return this.data.forEach(function(s){return s instanceof r?n.push.apply(n,s.getTweens()):s instanceof _t&&!(s.parent&&s.parent.data==="nested")&&n.push(s)}),n},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(n,s){var i=this;if(n?function(){for(var a=i.getTweens(),c=i.data.length,l;c--;)l=i.data[c],l.data==="isFlip"&&(l.revert(),l.getChildren(!0,!0,!1).forEach(function(u){return a.splice(a.indexOf(u),1)}));for(a.map(function(u){return{g:u._dur||u._delay||u._sat&&!u._sat.vars.immediateRender?u.globalTime(0):-1/0,t:u}}).sort(function(u,h){return h.g-u.g||-1/0}).forEach(function(u){return u.t.revert(n)}),c=i.data.length;c--;)l=i.data[c],l instanceof It?l.data!=="nested"&&(l.scrollTrigger&&l.scrollTrigger.revert(),l.kill()):!(l instanceof _t)&&l.revert&&l.revert(n);i._r.forEach(function(u){return u(n,i)}),i.isReverted=!0}():this.data.forEach(function(a){return a.kill&&a.kill()}),this.clear(),s)for(var o=ti.length;o--;)ti[o].id===this.id&&ti.splice(o,1)},e.revert=function(n){this.kill(n||{})},r}(),m0=function(){function r(t){this.contexts=[],this.scope=t}var e=r.prototype;return e.add=function(n,s,i){Vn(n)||(n={matches:n});var o=new If(0,i||this.scope),a=o.conditions={},c,l,u;it&&!o.selector&&(o.selector=it.selector),this.contexts.push(o),s=o.add("onMatch",s),o.queries=n;for(l in n)l==="all"?u=1:(c=hn.matchMedia(n[l]),c&&(ti.indexOf(o)<0&&ti.push(o),(a[l]=c.matches)&&(u=1),c.addListener?c.addListener(gl):c.addEventListener("change",gl)));return u&&s(o,function(h){return o.add(null,h)}),this},e.revert=function(n){this.kill(n||{})},e.kill=function(n){this.contexts.forEach(function(s){return s.kill(n,!0)})},r}(),va={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(function(s){return Tf(s)})},timeline:function(e){return new It(e)},getTweensOf:function(e,t){return $e.getTweensOf(e,t)},getProperty:function(e,t,n,s){wt(e)&&(e=fn(e)[0]);var i=Js(e||{}).get,o=n?af:of;return n==="native"&&(n=""),e&&(t?o(($t[t]&&$t[t].get||i)(e,t,n,s)):function(a,c,l){return o(($t[a]&&$t[a].get||i)(e,a,c,l))})},quickSetter:function(e,t,n){if(e=fn(e),e.length>1){var s=e.map(function(u){return Xt.quickSetter(u,t,n)}),i=s.length;return function(u){for(var h=i;h--;)s[h](u)}}e=e[0]||{};var o=$t[t],a=Js(e),c=a.harness&&(a.harness.aliases||{})[t]||t,l=o?function(u){var h=new o;Mi._pt=0,h.init(e,n?u+n:u,Mi,0,[e]),h.render(1,h),Mi._pt&&$l(1,Mi)}:a.set(e,c);return o?l:function(u){return l(e,c,n?u+n:u,a,1)}},quickTo:function(e,t,n){var s,i=Xt.to(e,ii((s={},s[t]="+=0.1",s.paused=!0,s),n||{})),o=function(c,l,u){return i.resetTo(t,c,l,u)};return o.tween=i,o},isTweening:function(e){return $e.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=ei(e.ease,Wi.ease)),Ph(Wi,e||{})},config:function(e){return Ph(nn,e||{})},registerEffect:function(e){var t=e.name,n=e.effect,s=e.plugins,i=e.defaults,o=e.extendTimeline;(s||"").split(",").forEach(function(a){return a&&!$t[a]&&!on[a]&&Wr(t+" effect requires "+a+" plugin.")}),qc[t]=function(a,c,l){return n(fn(a),_n(c||{},i),l)},o&&(It.prototype[t]=function(a,c,l){return this.add(qc[t](a,Vn(c)?c:(l=c)&&{},this),l)})},registerEase:function(e,t){Ee[e]=ei(t)},parseEase:function(e,t){return arguments.length?ei(e,t):Ee},getById:function(e){return $e.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var n=new It(e),s,i;for(n.smoothChildTiming=Wt(e.smoothChildTiming),$e.remove(n),n._dp=0,n._time=n._tTime=$e._time,s=$e._first;s;)i=s._next,(t||!(!s._dur&&s instanceof _t&&s.vars.onComplete===s._targets[0]))&&Ln(n,s,s._start-s._delay),s=i;return Ln($e,n,0),n},context:function(e,t){return e?new If(e,t):it},matchMedia:function(e){return new m0(e)},matchMediaRefresh:function(){return ti.forEach(function(e){var t=e.conditions,n,s;for(s in t)t[s]&&(t[s]=!1,n=1);n&&e.revert()})||gl()},addEventListener:function(e,t){var n=la[e]||(la[e]=[]);~n.indexOf(t)||n.push(t)},removeEventListener:function(e,t){var n=la[e],s=n&&n.indexOf(t);s>=0&&n.splice(s,1)},utils:{wrap:Yv,wrapYoyo:Xv,distribute:pf,random:_f,snap:mf,normalize:jv,getUnit:Ot,clamp:Gv,splitColor:xf,toArray:fn,selector:pl,mapRange:vf,pipe:Hv,unitize:qv,interpolate:Zv,shuffle:ff},install:ef,effects:qc,ticker:en,updateRoot:It.updateRoot,plugins:$t,globalTimeline:$e,core:{PropTween:qt,globals:tf,Tween:_t,Timeline:It,Animation:Yr,getCache:Js,_removeLinkedListItem:Xa,reverting:function(){return At},context:function(e){return e&&it&&(it.data.push(e),e._ctx=it),it},suppressOverwrites:function(e){return Vl=e}}};Ht("to,from,fromTo,delayedCall,set,killTweensOf",function(r){return va[r]=_t[r]});en.add(It.updateRoot);Mi=va.to({},{duration:0});var _0=function(e,t){for(var n=e._pt;n&&n.p!==t&&n.op!==t&&n.fp!==t;)n=n._next;return n},g0=function(e,t){var n=e._targets,s,i,o;for(s in t)for(i=n.length;i--;)o=e._ptLookup[i][s],o&&(o=o.d)&&(o._pt&&(o=_0(o,s)),o&&o.modifier&&o.modifier(t[s],e,n[i],s))},Qc=function(e,t){return{name:e,rawVars:1,init:function(s,i,o){o._onInit=function(a){var c,l;if(wt(i)&&(c={},Ht(i,function(u){return c[u]=1}),i=c),t){c={};for(l in i)c[l]=t(i[l]);i=c}g0(a,i)}}}},Xt=va.registerPlugin({name:"attr",init:function(e,t,n,s,i){var o,a,c;this.tween=n;for(o in t)c=e.getAttribute(o)||"",a=this.add(e,"setAttribute",(c||0)+"",t[o],s,i,0,0,o),a.op=o,a.b=c,this._props.push(o)},render:function(e,t){for(var n=t._pt;n;)At?n.set(n.t,n.p,n.b,n):n.r(e,n.d),n=n._next}},{name:"endArray",init:function(e,t){for(var n=t.length;n--;)this.add(e,n,e[n]||0,t[n],0,0,0,0,0,1)}},Qc("roundProps",ml),Qc("modifiers"),Qc("snap",mf))||va;_t.version=It.version=Xt.version="3.12.4";$d=1;Wl()&&ji();Ee.Power0;Ee.Power1;Ee.Power2;Ee.Power3;Ee.Power4;Ee.Linear;Ee.Quad;Ee.Cubic;Ee.Quart;Ee.Quint;Ee.Strong;Ee.Elastic;Ee.Back;Ee.SteppedEase;Ee.Bounce;Ee.Sine;Ee.Expo;Ee.Circ;/*!
 * CSSPlugin 3.12.4
 * https://gsap.com
 *
 * Copyright 2008-2023, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Bh,Ss,Fi,eu,Xs,zh,tu,v0=function(){return typeof window<"u"},rs={},js=180/Math.PI,Ni=Math.PI/180,Ci=Math.atan2,Vh=1e8,nu=/([A-Z])/g,y0=/(left|right|width|margin|padding|x)/i,T0=/[\s,\(]\S/,Bn={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},vl=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},x0=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},w0=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},S0=function(e,t){var n=t.s+t.c*e;t.set(t.t,t.p,~~(n+(n<0?-.5:.5))+t.u,t)},Ff=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},Nf=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},b0=function(e,t,n){return e.style[t]=n},C0=function(e,t,n){return e.style.setProperty(t,n)},E0=function(e,t,n){return e._gsap[t]=n},O0=function(e,t,n){return e._gsap.scaleX=e._gsap.scaleY=n},A0=function(e,t,n,s,i){var o=e._gsap;o.scaleX=o.scaleY=n,o.renderTransform(i,o)},k0=function(e,t,n,s,i){var o=e._gsap;o[t]=n,o.renderTransform(i,o)},et="transform",jt=et+"Origin",D0=function r(e,t){var n=this,s=this.target,i=s.style,o=s._gsap;if(e in rs&&i){if(this.tfm=this.tfm||{},e!=="transform")e=Bn[e]||e,~e.indexOf(",")?e.split(",").forEach(function(a){return n.tfm[a]=es(s,a)}):this.tfm[e]=o.x?o[e]:es(s,e),e===jt&&(this.tfm.zOrigin=o.zOrigin);else return Bn.transform.split(",").forEach(function(a){return r.call(n,a,t)});if(this.props.indexOf(et)>=0)return;o.svg&&(this.svgo=s.getAttribute("data-svg-origin"),this.props.push(jt,t,"")),e=et}(i||t)&&this.props.push(e,t,i[e])},Lf=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},M0=function(){var e=this.props,t=this.target,n=t.style,s=t._gsap,i,o;for(i=0;i<e.length;i+=3)e[i+1]?t[e[i]]=e[i+2]:e[i+2]?n[e[i]]=e[i+2]:n.removeProperty(e[i].substr(0,2)==="--"?e[i]:e[i].replace(nu,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)s[o]=this.tfm[o];s.svg&&(s.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),i=tu(),(!i||!i.isStart)&&!n[et]&&(Lf(n),s.zOrigin&&n[jt]&&(n[jt]+=" "+s.zOrigin+"px",s.zOrigin=0,s.renderTransform()),s.uncache=1)}},Bf=function(e,t){var n={target:e,props:[],revert:M0,save:D0};return e._gsap||Xt.core.getCache(e),t&&t.split(",").forEach(function(s){return n.save(s)}),n},zf,yl=function(e,t){var n=Ss.createElementNS?Ss.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):Ss.createElement(e);return n&&n.style?n:Ss.createElement(e)},zn=function r(e,t,n){var s=getComputedStyle(e);return s[t]||s.getPropertyValue(t.replace(nu,"-$1").toLowerCase())||s.getPropertyValue(t)||!n&&r(e,Yi(t)||t,1)||""},Gh="O,Moz,ms,Ms,Webkit".split(","),Yi=function(e,t,n){var s=t||Xs,i=s.style,o=5;if(e in i&&!n)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);o--&&!(Gh[o]+e in i););return o<0?null:(o===3?"ms":o>=0?Gh[o]:"")+e},Tl=function(){v0()&&window.document&&(Bh=window,Ss=Bh.document,Fi=Ss.documentElement,Xs=yl("div")||{style:{}},yl("div"),et=Yi(et),jt=et+"Origin",Xs.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",zf=!!Yi("perspective"),tu=Xt.core.reverting,eu=1)},Kc=function r(e){var t=yl("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),n=this.parentNode,s=this.nextSibling,i=this.style.cssText,o;if(Fi.appendChild(t),t.appendChild(this),this.style.display="block",e)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=r}catch{}else this._gsapBBox&&(o=this._gsapBBox());return n&&(s?n.insertBefore(this,s):n.appendChild(this)),Fi.removeChild(t),this.style.cssText=i,o},Wh=function(e,t){for(var n=t.length;n--;)if(e.hasAttribute(t[n]))return e.getAttribute(t[n])},Vf=function(e){var t;try{t=e.getBBox()}catch{t=Kc.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===Kc||(t=Kc.call(e,!0)),t&&!t.width&&!t.x&&!t.y?{x:+Wh(e,["x","cx","x1"])||0,y:+Wh(e,["y","cy","y1"])||0,width:0,height:0}:t},Gf=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&Vf(e))},ri=function(e,t){if(t){var n=e.style,s;t in rs&&t!==jt&&(t=et),n.removeProperty?(s=t.substr(0,2),(s==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),n.removeProperty(s==="--"?t:t.replace(nu,"-$1").toLowerCase())):n.removeAttribute(t)}},bs=function(e,t,n,s,i,o){var a=new qt(e._pt,t,n,0,1,o?Nf:Ff);return e._pt=a,a.b=s,a.e=i,e._props.push(n),a},Hh={deg:1,rad:1,turn:1},R0={grid:1,flex:1},Ds=function r(e,t,n,s){var i=parseFloat(n)||0,o=(n+"").trim().substr((i+"").length)||"px",a=Xs.style,c=y0.test(t),l=e.tagName.toLowerCase()==="svg",u=(l?"client":"offset")+(c?"Width":"Height"),h=100,d=s==="px",f=s==="%",m,p,_,T;if(s===o||!i||Hh[s]||Hh[o])return i;if(o!=="px"&&!d&&(i=r(e,t,n,"px")),T=e.getCTM&&Gf(e),(f||o==="%")&&(rs[t]||~t.indexOf("adius")))return m=T?e.getBBox()[c?"width":"height"]:e[u],lt(f?i/m*h:i/100*m);if(a[c?"width":"height"]=h+(d?o:s),p=~t.indexOf("adius")||s==="em"&&e.appendChild&&!l?e:e.parentNode,T&&(p=(e.ownerSVGElement||{}).parentNode),(!p||p===Ss||!p.appendChild)&&(p=Ss.body),_=p._gsap,_&&f&&_.width&&c&&_.time===en.time&&!_.uncache)return lt(i/_.width*h);if(f&&(t==="height"||t==="width")){var y=e.style[t];e.style[t]=h+s,m=e[u],y?e.style[t]=y:ri(e,t)}else(f||o==="%")&&!R0[zn(p,"display")]&&(a.position=zn(e,"position")),p===e&&(a.position="static"),p.appendChild(Xs),m=Xs[u],p.removeChild(Xs),a.position="absolute";return c&&f&&(_=Js(p),_.time=en.time,_.width=p[u]),lt(d?m*i/h:m&&i?h/m*i:0)},es=function(e,t,n,s){var i;return eu||Tl(),t in Bn&&t!=="transform"&&(t=Bn[t],~t.indexOf(",")&&(t=t.split(",")[0])),rs[t]&&t!=="transform"?(i=Zr(e,s),i=t!=="transformOrigin"?i[t]:i.svg?i.origin:Ta(zn(e,jt))+" "+i.zOrigin+"px"):(i=e.style[t],(!i||i==="auto"||s||~(i+"").indexOf("calc("))&&(i=ya[t]&&ya[t](e,t,n)||zn(e,t)||sf(e,t)||(t==="opacity"?1:0))),n&&!~(i+"").trim().indexOf(" ")?Ds(e,t,i,n)+n:i},P0=function(e,t,n,s){if(!n||n==="none"){var i=Yi(t,e,1),o=i&&zn(e,i,1);o&&o!==n?(t=i,n=o):t==="borderColor"&&(n=zn(e,"borderTopColor"))}var a=new qt(this._pt,e.style,t,0,1,Pf),c=0,l=0,u,h,d,f,m,p,_,T,y,b,v,g;if(a.b=n,a.e=s,n+="",s+="",s==="auto"&&(p=e.style[t],e.style[t]=s,s=zn(e,t)||s,p?e.style[t]=p:ri(e,t)),u=[n,s],Sf(u),n=u[0],s=u[1],d=n.match(Di)||[],g=s.match(Di)||[],g.length){for(;h=Di.exec(s);)_=h[0],y=s.substring(c,h.index),m?m=(m+1)%5:(y.substr(-5)==="rgba("||y.substr(-5)==="hsla(")&&(m=1),_!==(p=d[l++]||"")&&(f=parseFloat(p)||0,v=p.substr((f+"").length),_.charAt(1)==="="&&(_=Ii(f,_)+v),T=parseFloat(_),b=_.substr((T+"").length),c=Di.lastIndex-b.length,b||(b=b||nn.units[t]||v,c===s.length&&(s+=b,a.e+=b)),v!==b&&(f=Ds(e,t,p,b)||0),a._pt={_next:a._pt,p:y||l===1?y:",",s:f,c:T-f,m:m&&m<4||t==="zIndex"?Math.round:0});a.c=c<s.length?s.substring(c,s.length):""}else a.r=t==="display"&&s==="none"?Nf:Ff;return Kd.test(s)&&(a.e=0),this._pt=a,a},qh={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},U0=function(e){var t=e.split(" "),n=t[0],s=t[1]||"50%";return(n==="top"||n==="bottom"||s==="left"||s==="right")&&(e=n,n=s,s=e),t[0]=qh[n]||n,t[1]=qh[s]||s,t.join(" ")},I0=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var n=t.t,s=n.style,i=t.u,o=n._gsap,a,c,l;if(i==="all"||i===!0)s.cssText="",c=1;else for(i=i.split(","),l=i.length;--l>-1;)a=i[l],rs[a]&&(c=1,a=a==="transformOrigin"?jt:et),ri(n,a);c&&(ri(n,et),o&&(o.svg&&n.removeAttribute("transform"),Zr(n,1),o.uncache=1,Lf(s)))}},ya={clearProps:function(e,t,n,s,i){if(i.data!=="isFromStart"){var o=e._pt=new qt(e._pt,t,n,0,0,I0);return o.u=s,o.pr=-10,o.tween=i,e._props.push(n),1}}},Xr=[1,0,0,1,0,0],Wf={},Hf=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},jh=function(e){var t=zn(e,et);return Hf(t)?Xr:t.substr(7).match(Qd).map(lt)},su=function(e,t){var n=e._gsap||Js(e),s=e.style,i=jh(e),o,a,c,l;return n.svg&&e.getAttribute("transform")?(c=e.transform.baseVal.consolidate().matrix,i=[c.a,c.b,c.c,c.d,c.e,c.f],i.join(",")==="1,0,0,1,0,0"?Xr:i):(i===Xr&&!e.offsetParent&&e!==Fi&&!n.svg&&(c=s.display,s.display="block",o=e.parentNode,(!o||!e.offsetParent)&&(l=1,a=e.nextElementSibling,Fi.appendChild(e)),i=jh(e),c?s.display=c:ri(e,"display"),l&&(a?o.insertBefore(e,a):o?o.appendChild(e):Fi.removeChild(e))),t&&i.length>6?[i[0],i[1],i[4],i[5],i[12],i[13]]:i)},xl=function(e,t,n,s,i,o){var a=e._gsap,c=i||su(e,!0),l=a.xOrigin||0,u=a.yOrigin||0,h=a.xOffset||0,d=a.yOffset||0,f=c[0],m=c[1],p=c[2],_=c[3],T=c[4],y=c[5],b=t.split(" "),v=parseFloat(b[0])||0,g=parseFloat(b[1])||0,x,w,S,C;n?c!==Xr&&(w=f*_-m*p)&&(S=v*(_/w)+g*(-p/w)+(p*y-_*T)/w,C=v*(-m/w)+g*(f/w)-(f*y-m*T)/w,v=S,g=C):(x=Vf(e),v=x.x+(~b[0].indexOf("%")?v/100*x.width:v),g=x.y+(~(b[1]||b[0]).indexOf("%")?g/100*x.height:g)),s||s!==!1&&a.smooth?(T=v-l,y=g-u,a.xOffset=h+(T*f+y*p)-T,a.yOffset=d+(T*m+y*_)-y):a.xOffset=a.yOffset=0,a.xOrigin=v,a.yOrigin=g,a.smooth=!!s,a.origin=t,a.originIsAbsolute=!!n,e.style[jt]="0px 0px",o&&(bs(o,a,"xOrigin",l,v),bs(o,a,"yOrigin",u,g),bs(o,a,"xOffset",h,a.xOffset),bs(o,a,"yOffset",d,a.yOffset)),e.setAttribute("data-svg-origin",v+" "+g)},Zr=function(e,t){var n=e._gsap||new Of(e);if("x"in n&&!t&&!n.uncache)return n;var s=e.style,i=n.scaleX<0,o="px",a="deg",c=getComputedStyle(e),l=zn(e,jt)||"0",u,h,d,f,m,p,_,T,y,b,v,g,x,w,S,C,O,k,E,D,M,U,P,V,Q,I,B,A,R,H,W,F;return u=h=d=p=_=T=y=b=v=0,f=m=1,n.svg=!!(e.getCTM&&Gf(e)),c.translate&&((c.translate!=="none"||c.scale!=="none"||c.rotate!=="none")&&(s[et]=(c.translate!=="none"?"translate3d("+(c.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(c.rotate!=="none"?"rotate("+c.rotate+") ":"")+(c.scale!=="none"?"scale("+c.scale.split(" ").join(",")+") ":"")+(c[et]!=="none"?c[et]:"")),s.scale=s.rotate=s.translate="none"),w=su(e,n.svg),n.svg&&(n.uncache?(Q=e.getBBox(),l=n.xOrigin-Q.x+"px "+(n.yOrigin-Q.y)+"px",V=""):V=!t&&e.getAttribute("data-svg-origin"),xl(e,V||l,!!V||n.originIsAbsolute,n.smooth!==!1,w)),g=n.xOrigin||0,x=n.yOrigin||0,w!==Xr&&(k=w[0],E=w[1],D=w[2],M=w[3],u=U=w[4],h=P=w[5],w.length===6?(f=Math.sqrt(k*k+E*E),m=Math.sqrt(M*M+D*D),p=k||E?Ci(E,k)*js:0,y=D||M?Ci(D,M)*js+p:0,y&&(m*=Math.abs(Math.cos(y*Ni))),n.svg&&(u-=g-(g*k+x*D),h-=x-(g*E+x*M))):(F=w[6],H=w[7],B=w[8],A=w[9],R=w[10],W=w[11],u=w[12],h=w[13],d=w[14],S=Ci(F,R),_=S*js,S&&(C=Math.cos(-S),O=Math.sin(-S),V=U*C+B*O,Q=P*C+A*O,I=F*C+R*O,B=U*-O+B*C,A=P*-O+A*C,R=F*-O+R*C,W=H*-O+W*C,U=V,P=Q,F=I),S=Ci(-D,R),T=S*js,S&&(C=Math.cos(-S),O=Math.sin(-S),V=k*C-B*O,Q=E*C-A*O,I=D*C-R*O,W=M*O+W*C,k=V,E=Q,D=I),S=Ci(E,k),p=S*js,S&&(C=Math.cos(S),O=Math.sin(S),V=k*C+E*O,Q=U*C+P*O,E=E*C-k*O,P=P*C-U*O,k=V,U=Q),_&&Math.abs(_)+Math.abs(p)>359.9&&(_=p=0,T=180-T),f=lt(Math.sqrt(k*k+E*E+D*D)),m=lt(Math.sqrt(P*P+F*F)),S=Ci(U,P),y=Math.abs(S)>2e-4?S*js:0,v=W?1/(W<0?-W:W):0),n.svg&&(V=e.getAttribute("transform"),n.forceCSS=e.setAttribute("transform","")||!Hf(zn(e,et)),V&&e.setAttribute("transform",V))),Math.abs(y)>90&&Math.abs(y)<270&&(i?(f*=-1,y+=p<=0?180:-180,p+=p<=0?180:-180):(m*=-1,y+=y<=0?180:-180)),t=t||n.uncache,n.x=u-((n.xPercent=u&&(!t&&n.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-u)?-50:0)))?e.offsetWidth*n.xPercent/100:0)+o,n.y=h-((n.yPercent=h&&(!t&&n.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-h)?-50:0)))?e.offsetHeight*n.yPercent/100:0)+o,n.z=d+o,n.scaleX=lt(f),n.scaleY=lt(m),n.rotation=lt(p)+a,n.rotationX=lt(_)+a,n.rotationY=lt(T)+a,n.skewX=y+a,n.skewY=b+a,n.transformPerspective=v+o,(n.zOrigin=parseFloat(l.split(" ")[2])||!t&&n.zOrigin||0)&&(s[jt]=Ta(l)),n.xOffset=n.yOffset=0,n.force3D=nn.force3D,n.renderTransform=n.svg?N0:zf?qf:F0,n.uncache=0,n},Ta=function(e){return(e=e.split(" "))[0]+" "+e[1]},Jc=function(e,t,n){var s=Ot(t);return lt(parseFloat(t)+parseFloat(Ds(e,"x",n+"px",s)))+s},F0=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,qf(e,t)},Hs="0deg",Rr="0px",qs=") ",qf=function(e,t){var n=t||this,s=n.xPercent,i=n.yPercent,o=n.x,a=n.y,c=n.z,l=n.rotation,u=n.rotationY,h=n.rotationX,d=n.skewX,f=n.skewY,m=n.scaleX,p=n.scaleY,_=n.transformPerspective,T=n.force3D,y=n.target,b=n.zOrigin,v="",g=T==="auto"&&e&&e!==1||T===!0;if(b&&(h!==Hs||u!==Hs)){var x=parseFloat(u)*Ni,w=Math.sin(x),S=Math.cos(x),C;x=parseFloat(h)*Ni,C=Math.cos(x),o=Jc(y,o,w*C*-b),a=Jc(y,a,-Math.sin(x)*-b),c=Jc(y,c,S*C*-b+b)}_!==Rr&&(v+="perspective("+_+qs),(s||i)&&(v+="translate("+s+"%, "+i+"%) "),(g||o!==Rr||a!==Rr||c!==Rr)&&(v+=c!==Rr||g?"translate3d("+o+", "+a+", "+c+") ":"translate("+o+", "+a+qs),l!==Hs&&(v+="rotate("+l+qs),u!==Hs&&(v+="rotateY("+u+qs),h!==Hs&&(v+="rotateX("+h+qs),(d!==Hs||f!==Hs)&&(v+="skew("+d+", "+f+qs),(m!==1||p!==1)&&(v+="scale("+m+", "+p+qs),y.style[et]=v||"translate(0, 0)"},N0=function(e,t){var n=t||this,s=n.xPercent,i=n.yPercent,o=n.x,a=n.y,c=n.rotation,l=n.skewX,u=n.skewY,h=n.scaleX,d=n.scaleY,f=n.target,m=n.xOrigin,p=n.yOrigin,_=n.xOffset,T=n.yOffset,y=n.forceCSS,b=parseFloat(o),v=parseFloat(a),g,x,w,S,C;c=parseFloat(c),l=parseFloat(l),u=parseFloat(u),u&&(u=parseFloat(u),l+=u,c+=u),c||l?(c*=Ni,l*=Ni,g=Math.cos(c)*h,x=Math.sin(c)*h,w=Math.sin(c-l)*-d,S=Math.cos(c-l)*d,l&&(u*=Ni,C=Math.tan(l-u),C=Math.sqrt(1+C*C),w*=C,S*=C,u&&(C=Math.tan(u),C=Math.sqrt(1+C*C),g*=C,x*=C)),g=lt(g),x=lt(x),w=lt(w),S=lt(S)):(g=h,S=d,x=w=0),(b&&!~(o+"").indexOf("px")||v&&!~(a+"").indexOf("px"))&&(b=Ds(f,"x",o,"px"),v=Ds(f,"y",a,"px")),(m||p||_||T)&&(b=lt(b+m-(m*g+p*w)+_),v=lt(v+p-(m*x+p*S)+T)),(s||i)&&(C=f.getBBox(),b=lt(b+s/100*C.width),v=lt(v+i/100*C.height)),C="matrix("+g+","+x+","+w+","+S+","+b+","+v+")",f.setAttribute("transform",C),y&&(f.style[et]=C)},L0=function(e,t,n,s,i){var o=360,a=wt(i),c=parseFloat(i)*(a&&~i.indexOf("rad")?js:1),l=c-s,u=s+l+"deg",h,d;return a&&(h=i.split("_")[1],h==="short"&&(l%=o,l!==l%(o/2)&&(l+=l<0?o:-o)),h==="cw"&&l<0?l=(l+o*Vh)%o-~~(l/o)*o:h==="ccw"&&l>0&&(l=(l-o*Vh)%o-~~(l/o)*o)),e._pt=d=new qt(e._pt,t,n,s,l,x0),d.e=u,d.u="deg",e._props.push(n),d},Yh=function(e,t){for(var n in t)e[n]=t[n];return e},B0=function(e,t,n){var s=Yh({},n._gsap),i="perspective,force3D,transformOrigin,svgOrigin",o=n.style,a,c,l,u,h,d,f,m;s.svg?(l=n.getAttribute("transform"),n.setAttribute("transform",""),o[et]=t,a=Zr(n,1),ri(n,et),n.setAttribute("transform",l)):(l=getComputedStyle(n)[et],o[et]=t,a=Zr(n,1),o[et]=l);for(c in rs)l=s[c],u=a[c],l!==u&&i.indexOf(c)<0&&(f=Ot(l),m=Ot(u),h=f!==m?Ds(n,c,l,m):parseFloat(l),d=parseFloat(u),e._pt=new qt(e._pt,a,c,h,d-h,vl),e._pt.u=m||0,e._props.push(c));Yh(a,s)};Ht("padding,margin,Width,Radius",function(r,e){var t="Top",n="Right",s="Bottom",i="Left",o=(e<3?[t,n,s,i]:[t+i,t+n,s+n,s+i]).map(function(a){return e<2?r+a:"border"+a+r});ya[e>1?"border"+r:r]=function(a,c,l,u,h){var d,f;if(arguments.length<4)return d=o.map(function(m){return es(a,m,l)}),f=d.join(" "),f.split(d[0]).length===5?d[0]:f;d=(u+"").split(" "),f={},o.forEach(function(m,p){return f[m]=d[p]=d[p]||d[(p-1)/2|0]}),a.init(c,f,h)}});var jf={name:"css",register:Tl,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,n,s,i){var o=this._props,a=e.style,c=n.vars.startAt,l,u,h,d,f,m,p,_,T,y,b,v,g,x,w,S;eu||Tl(),this.styles=this.styles||Bf(e),S=this.styles.props,this.tween=n;for(p in t)if(p!=="autoRound"&&(u=t[p],!($t[p]&&Af(p,t,n,s,e,i)))){if(f=typeof u,m=ya[p],f==="function"&&(u=u.call(n,s,e,i),f=typeof u),f==="string"&&~u.indexOf("random(")&&(u=qr(u)),m)m(this,e,p,u,n)&&(w=1);else if(p.substr(0,2)==="--")l=(getComputedStyle(e).getPropertyValue(p)+"").trim(),u+="",Os.lastIndex=0,Os.test(l)||(_=Ot(l),T=Ot(u)),T?_!==T&&(l=Ds(e,p,l,T)+T):_&&(u+=_),this.add(a,"setProperty",l,u,s,i,0,0,p),o.push(p),S.push(p,0,a[p]);else if(f!=="undefined"){if(c&&p in c?(l=typeof c[p]=="function"?c[p].call(n,s,e,i):c[p],wt(l)&&~l.indexOf("random(")&&(l=qr(l)),Ot(l+"")||l==="auto"||(l+=nn.units[p]||Ot(es(e,p))||""),(l+"").charAt(1)==="="&&(l=es(e,p))):l=es(e,p),d=parseFloat(l),y=f==="string"&&u.charAt(1)==="="&&u.substr(0,2),y&&(u=u.substr(2)),h=parseFloat(u),p in Bn&&(p==="autoAlpha"&&(d===1&&es(e,"visibility")==="hidden"&&h&&(d=0),S.push("visibility",0,a.visibility),bs(this,a,"visibility",d?"inherit":"hidden",h?"inherit":"hidden",!h)),p!=="scale"&&p!=="transform"&&(p=Bn[p],~p.indexOf(",")&&(p=p.split(",")[0]))),b=p in rs,b){if(this.styles.save(p),v||(g=e._gsap,g.renderTransform&&!t.parseTransform||Zr(e,t.parseTransform),x=t.smoothOrigin!==!1&&g.smooth,v=this._pt=new qt(this._pt,a,et,0,1,g.renderTransform,g,0,-1),v.dep=1),p==="scale")this._pt=new qt(this._pt,g,"scaleY",g.scaleY,(y?Ii(g.scaleY,y+h):h)-g.scaleY||0,vl),this._pt.u=0,o.push("scaleY",p),p+="X";else if(p==="transformOrigin"){S.push(jt,0,a[jt]),u=U0(u),g.svg?xl(e,u,0,x,0,this):(T=parseFloat(u.split(" ")[2])||0,T!==g.zOrigin&&bs(this,g,"zOrigin",g.zOrigin,T),bs(this,a,p,Ta(l),Ta(u)));continue}else if(p==="svgOrigin"){xl(e,u,1,x,0,this);continue}else if(p in Wf){L0(this,g,p,d,y?Ii(d,y+u):u);continue}else if(p==="smoothOrigin"){bs(this,g,"smooth",g.smooth,u);continue}else if(p==="force3D"){g[p]=u;continue}else if(p==="transform"){B0(this,u,e);continue}}else p in a||(p=Yi(p)||p);if(b||(h||h===0)&&(d||d===0)&&!T0.test(u)&&p in a)_=(l+"").substr((d+"").length),h||(h=0),T=Ot(u)||(p in nn.units?nn.units[p]:_),_!==T&&(d=Ds(e,p,l,T)),this._pt=new qt(this._pt,b?g:a,p,d,(y?Ii(d,y+h):h)-d,!b&&(T==="px"||p==="zIndex")&&t.autoRound!==!1?S0:vl),this._pt.u=T||0,_!==T&&T!=="%"&&(this._pt.b=l,this._pt.r=w0);else if(p in a)P0.call(this,e,p,l,y?y+u:u);else if(p in e)this.add(e,p,l||e[p],y?y+u:u,s,i);else if(p!=="parseTransform"){ql(p,u);continue}b||(p in a?S.push(p,0,a[p]):S.push(p,1,l||e[p])),o.push(p)}}w&&Uf(this)},render:function(e,t){if(t.tween._time||!tu())for(var n=t._pt;n;)n.r(e,n.d),n=n._next;else t.styles.revert()},get:es,aliases:Bn,getSetter:function(e,t,n){var s=Bn[t];return s&&s.indexOf(",")<0&&(t=s),t in rs&&t!==jt&&(e._gsap.x||es(e,"x"))?n&&zh===n?t==="scale"?O0:E0:(zh=n||{})&&(t==="scale"?A0:k0):e.style&&!Gl(e.style[t])?b0:~t.indexOf("-")?C0:Jl(e,t)},core:{_removeProperty:ri,_getMatrix:su}};Xt.utils.checkPrefix=Yi;Xt.core.getStyleSaver=Bf;(function(r,e,t,n){var s=Ht(r+","+e+","+t,function(i){rs[i]=1});Ht(e,function(i){nn.units[i]="deg",Wf[i]=1}),Bn[s[13]]=r+","+e,Ht(n,function(i){var o=i.split(":");Bn[o[1]]=s[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");Ht("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(r){nn.units[r]="px"});Xt.registerPlugin(jf);var z0=Xt.registerPlugin(jf)||Xt;z0.core.Tween;const Yf="14.8.49",Xh=(r,e,t)=>({endTime:e,insertTime:t,type:"exponentialRampToValue",value:r}),Zh=(r,e,t)=>({endTime:e,insertTime:t,type:"linearRampToValue",value:r}),wl=(r,e)=>({startTime:e,type:"setValue",value:r}),Xf=(r,e,t)=>({duration:t,startTime:e,type:"setValueCurve",values:r}),Zf=(r,e,{startTime:t,target:n,timeConstant:s})=>n+(e-n)*Math.exp((t-r)/s),Ri=r=>r.type==="exponentialRampToValue",xa=r=>r.type==="linearRampToValue",xs=r=>Ri(r)||xa(r),iu=r=>r.type==="setValue",$n=r=>r.type==="setValueCurve",wa=(r,e,t,n)=>{const s=r[e];return s===void 0?n:xs(s)||iu(s)?s.value:$n(s)?s.values[s.values.length-1]:Zf(t,wa(r,e-1,s.startTime,n),s)},Qh=(r,e,t,n,s)=>t===void 0?[n.insertTime,s]:xs(t)?[t.endTime,t.value]:iu(t)?[t.startTime,t.value]:$n(t)?[t.startTime+t.duration,t.values[t.values.length-1]]:[t.startTime,wa(r,e-1,t.startTime,s)],Sl=r=>r.type==="cancelAndHold",bl=r=>r.type==="cancelScheduledValues",ys=r=>Sl(r)||bl(r)?r.cancelTime:Ri(r)||xa(r)?r.endTime:r.startTime,Kh=(r,e,t,{endTime:n,value:s})=>t===s?s:0<t&&0<s||t<0&&s<0?t*(s/t)**((r-e)/(n-e)):0,Jh=(r,e,t,{endTime:n,value:s})=>t+(r-e)/(n-e)*(s-t),V0=(r,e)=>{const t=Math.floor(e),n=Math.ceil(e);return t===n?r[t]:(1-(e-t))*r[t]+(1-(n-e))*r[n]},G0=(r,{duration:e,startTime:t,values:n})=>{const s=(r-t)/e*(n.length-1);return V0(n,s)},ta=r=>r.type==="setTarget";class W0{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const t=ys(e);if(Sl(e)||bl(e)){const n=this._automationEvents.findIndex(i=>bl(e)&&$n(i)?i.startTime+i.duration>=t:ys(i)>=t),s=this._automationEvents[n];if(n!==-1&&(this._automationEvents=this._automationEvents.slice(0,n)),Sl(e)){const i=this._automationEvents[this._automationEvents.length-1];if(s!==void 0&&xs(s)){if(i!==void 0&&ta(i))throw new Error("The internal list is malformed.");const o=i===void 0?s.insertTime:$n(i)?i.startTime+i.duration:ys(i),a=i===void 0?this._defaultValue:$n(i)?i.values[i.values.length-1]:i.value,c=Ri(s)?Kh(t,o,a,s):Jh(t,o,a,s),l=Ri(s)?Xh(c,t,this._currenTime):Zh(c,t,this._currenTime);this._automationEvents.push(l)}if(i!==void 0&&ta(i)&&this._automationEvents.push(wl(this.getValue(t),t)),i!==void 0&&$n(i)&&i.startTime+i.duration>t){const o=t-i.startTime,a=(i.values.length-1)/i.duration,c=Math.max(2,1+Math.ceil(o*a)),l=o/(c-1)*a,u=i.values.slice(0,c);if(l<1)for(let h=1;h<c;h+=1){const d=l*h%1;u[h]=i.values[h-1]*(1-d)+i.values[h]*d}this._automationEvents[this._automationEvents.length-1]=Xf(u,i.startTime,o)}}}else{const n=this._automationEvents.findIndex(o=>ys(o)>t),s=n===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[n-1];if(s!==void 0&&$n(s)&&ys(s)+s.duration>t)return!1;const i=Ri(e)?Xh(e.value,e.endTime,this._currenTime):xa(e)?Zh(e.value,t,this._currenTime):e;if(n===-1)this._automationEvents.push(i);else{if($n(e)&&t+e.duration>ys(this._automationEvents[n]))return!1;this._automationEvents.splice(n,0,i)}}return!0}flush(e){const t=this._automationEvents.findIndex(n=>ys(n)>e);if(t>1){const n=this._automationEvents.slice(t-1),s=n[0];ta(s)&&n.unshift(wl(wa(this._automationEvents,t-2,s.startTime,this._defaultValue),s.startTime)),this._automationEvents=n}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const t=this._automationEvents.findIndex(o=>ys(o)>e),n=this._automationEvents[t],s=(t===-1?this._automationEvents.length:t)-1,i=this._automationEvents[s];if(i!==void 0&&ta(i)&&(n===void 0||!xs(n)||n.insertTime>e))return Zf(e,wa(this._automationEvents,s-1,i.startTime,this._defaultValue),i);if(i!==void 0&&iu(i)&&(n===void 0||!xs(n)))return i.value;if(i!==void 0&&$n(i)&&(n===void 0||!xs(n)||i.startTime+i.duration>e))return e<i.startTime+i.duration?G0(e,i):i.values[i.values.length-1];if(i!==void 0&&xs(i)&&(n===void 0||!xs(n)))return i.value;if(n!==void 0&&Ri(n)){const[o,a]=Qh(this._automationEvents,s,i,n,this._defaultValue);return Kh(e,o,a,n)}if(n!==void 0&&xa(n)){const[o,a]=Qh(this._automationEvents,s,i,n,this._defaultValue);return Jh(e,o,a,n)}return this._defaultValue}}const H0=r=>({cancelTime:r,type:"cancelAndHold"}),q0=r=>({cancelTime:r,type:"cancelScheduledValues"}),j0=(r,e)=>({endTime:e,type:"exponentialRampToValue",value:r}),Y0=(r,e)=>({endTime:e,type:"linearRampToValue",value:r}),X0=(r,e,t)=>({startTime:e,target:r,timeConstant:t,type:"setTarget"}),Z0=()=>new DOMException("","AbortError"),Q0=r=>(e,t,[n,s,i],o)=>{r(e[s],[t,n,i],a=>a[0]===t&&a[1]===n,o)},K0=r=>(e,t,n)=>{const s=[];for(let i=0;i<n.numberOfInputs;i+=1)s.push(new Set);r.set(e,{activeInputs:s,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},J0=r=>(e,t)=>{r.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},Xi=new WeakSet,Qf=new WeakMap,ru=new WeakMap,Kf=new WeakMap,ou=new WeakMap,Ka=new WeakMap,Jf=new WeakMap,Cl=new WeakMap,El=new WeakMap,Ol=new WeakMap,$f={construct(){return $f}},$0=r=>{try{const e=new Proxy(r,$f);new e}catch{return!1}return!0},$h=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,ed=(r,e)=>{const t=[];let n=r.replace(/^[\s]+/,""),s=n.match($h);for(;s!==null;){const i=s[1].slice(1,-1),o=s[0].replace(/([\s]+)?;?$/,"").replace(i,new URL(i,e).toString());t.push(o),n=n.slice(s[0].length).replace(/^[\s]+/,""),s=n.match($h)}return[t.join(";"),n]},td=r=>{if(r!==void 0&&!Array.isArray(r))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},nd=r=>{if(!$0(r))throw new TypeError("The given value for processorCtor should be a constructor.");if(r.prototype===null||typeof r.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},ey=(r,e,t,n,s,i,o,a,c,l,u,h,d)=>{let f=0;return(m,p,_={credentials:"omit"})=>{const T=u.get(m);if(T!==void 0&&T.has(p))return Promise.resolve();const y=l.get(m);if(y!==void 0){const g=y.get(p);if(g!==void 0)return g}const b=i(m),v=b.audioWorklet===void 0?s(p).then(([g,x])=>{const[w,S]=ed(g,x),C=`${w};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${S}
})})(window,'_AWGS')`;return t(C)}).then(()=>{const g=d._AWGS.pop();if(g===void 0)throw new SyntaxError;n(b.currentTime,b.sampleRate,()=>g(class{},void 0,(x,w)=>{if(x.trim()==="")throw e();const S=El.get(b);if(S!==void 0){if(S.has(x))throw e();nd(w),td(w.parameterDescriptors),S.set(x,w)}else nd(w),td(w.parameterDescriptors),El.set(b,new Map([[x,w]]))},b.sampleRate,void 0,void 0))}):Promise.all([s(p),Promise.resolve(r(h,h))]).then(([[g,x],w])=>{const S=f+1;f=S;const[C,O]=ed(g,x),M=`${C};((AudioWorkletProcessor,registerProcessor)=>{${O}
})(${w?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${w?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${w?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${S}',class extends AudioWorkletProcessor{process(){return !1}})`,U=new Blob([M],{type:"application/javascript; charset=utf-8"}),P=URL.createObjectURL(U);return b.audioWorklet.addModule(P,_).then(()=>{if(a(b))return b;const V=o(b);return V.audioWorklet.addModule(P,_).then(()=>V)}).then(V=>{if(c===null)throw new SyntaxError;try{new c(V,`__sac${S}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(P))});return y===void 0?l.set(m,new Map([[p,v]])):y.set(p,v),v.then(()=>{const g=u.get(m);g===void 0?u.set(m,new Set([p])):g.add(p)}).finally(()=>{const g=l.get(m);g!==void 0&&g.delete(p)}),v}},kn=(r,e)=>{const t=r.get(e);if(t===void 0)throw new Error("A value with the given key could not be found.");return t},Ja=(r,e)=>{const t=Array.from(r).filter(e);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");const[n]=t;return r.delete(n),n},ep=(r,e,t,n)=>{const s=kn(r,e),i=Ja(s,o=>o[0]===t&&o[1]===n);return s.size===0&&r.delete(e),i},yo=r=>kn(Jf,r),Zi=r=>{if(Xi.has(r))throw new Error("The AudioNode is already stored.");Xi.add(r),yo(r).forEach(e=>e(!0))},tp=r=>"port"in r,To=r=>{if(!Xi.has(r))throw new Error("The AudioNode is not stored.");Xi.delete(r),yo(r).forEach(e=>e(!1))},Al=(r,e)=>{!tp(r)&&e.every(t=>t.size===0)&&To(r)},ty=(r,e,t,n,s,i,o,a,c,l,u,h,d)=>{const f=new WeakMap;return(m,p,_,T,y)=>{const{activeInputs:b,passiveInputs:v}=i(p),{outputs:g}=i(m),x=a(m),w=S=>{const C=c(p),O=c(m);if(S){const k=ep(v,m,_,T);r(b,m,k,!1),!y&&!h(m)&&t(O,C,_,T),d(p)&&Zi(p)}else{const k=n(b,m,_,T);e(v,T,k,!1),!y&&!h(m)&&s(O,C,_,T);const E=o(p);if(E===0)u(p)&&Al(p,b);else{const D=f.get(p);D!==void 0&&clearTimeout(D),f.set(p,setTimeout(()=>{u(p)&&Al(p,b)},E*1e3))}}};return l(g,[p,_,T],S=>S[0]===p&&S[1]===_&&S[2]===T,!0)?(x.add(w),u(m)?r(b,m,[_,T,w],!0):e(v,T,[m,_,w],!0),!0):!1}},ny=r=>(e,t,[n,s,i],o)=>{const a=e.get(n);a===void 0?e.set(n,new Set([[s,t,i]])):r(a,[s,t,i],c=>c[0]===s&&c[1]===t,o)},sy=r=>(e,t)=>{const n=r(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(n).connect(e.destination);const s=()=>{t.removeEventListener("ended",s),t.disconnect(n),n.disconnect()};t.addEventListener("ended",s)},iy=r=>(e,t)=>{r(e).add(t)},ry={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},oy=(r,e,t,n,s,i)=>class extends r{constructor(a,c){const l=s(a),u={...ry,...c},h=n(l,u),d=i(l)?e():null;super(a,!1,h,d),this._nativeAnalyserNode=h}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const c=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=c,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const c=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=c,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},Mt=(r,e)=>r.context===e,ay=(r,e,t)=>()=>{const n=new WeakMap,s=async(i,o)=>{let a=e(i);if(!Mt(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=r(o,l)}return n.set(o,a),await t(i,o,a),a};return{render(i,o){const a=n.get(o);return a!==void 0?Promise.resolve(a):s(i,o)}}},Sa=r=>{try{r.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},Hn=()=>new DOMException("","IndexSizeError"),au=r=>{r.getChannelData=(e=>t=>{try{return e.call(r,t)}catch(n){throw n.code===12?Hn():n}})(r.getChannelData)},cy={numberOfChannels:1},ly=(r,e,t,n,s,i,o,a)=>{let c=null;return class np{constructor(u){if(s===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:h,numberOfChannels:d,sampleRate:f}={...cy,...u};c===null&&(c=new s(1,1,44100));const m=n!==null&&e(i,i)?new n({length:h,numberOfChannels:d,sampleRate:f}):c.createBuffer(d,h,f);if(m.numberOfChannels===0)throw t();return typeof m.copyFromChannel!="function"?(o(m),au(m)):e(Sa,()=>Sa(m))||a(m),r.add(m),m}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===np.prototype||r.has(u)}}},Gt=-34028234663852886e22,Ut=-Gt,ns=r=>Xi.has(r),uy={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},hy=(r,e,t,n,s,i,o,a)=>class extends r{constructor(l,u){const h=i(l),d={...uy,...u},f=s(h,d),m=o(h),p=m?e():null;super(l,!1,f,p),this._audioBufferSourceNodeRenderer=p,this._isBufferNullified=!1,this._isBufferSet=d.buffer!==null,this._nativeAudioBufferSourceNode=f,this._onended=null,this._playbackRate=t(this,m,f.playbackRate,Ut,Gt)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(l){if(this._nativeAudioBufferSourceNode.buffer=l,l!==null){if(this._isBufferSet)throw n();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(l){this._nativeAudioBufferSourceNode.loop=l}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(l){this._nativeAudioBufferSourceNode.loopEnd=l}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(l){this._nativeAudioBufferSourceNode.loopStart=l}get onended(){return this._onended}set onended(l){const u=typeof l=="function"?a(this,l):null;this._nativeAudioBufferSourceNode.onended=u;const h=this._nativeAudioBufferSourceNode.onended;this._onended=h!==null&&h===u?l:h}get playbackRate(){return this._playbackRate}start(l=0,u=0,h){if(this._nativeAudioBufferSourceNode.start(l,u,h),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=h===void 0?[l,u]:[l,u,h]),this.context.state!=="closed"){Zi(this);const d=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",d),ns(this)&&To(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",d)}}stop(l=0){this._nativeAudioBufferSourceNode.stop(l),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=l)}},dy=(r,e,t,n,s)=>()=>{const i=new WeakMap;let o=null,a=null;const c=async(l,u)=>{let h=t(l);const d=Mt(h,u);if(!d){const f={buffer:h.buffer,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,loop:h.loop,loopEnd:h.loopEnd,loopStart:h.loopStart,playbackRate:h.playbackRate.value};h=e(u,f),o!==null&&h.start(...o),a!==null&&h.stop(a)}return i.set(u,h),d?await r(u,l.playbackRate,h.playbackRate):await n(u,l.playbackRate,h.playbackRate),await s(l,u,h),h};return{set start(l){o=l},set stop(l){a=l},render(l,u){const h=i.get(u);return h!==void 0?Promise.resolve(h):c(l,u)}}},fy=r=>"playbackRate"in r,py=r=>"frequency"in r&&"gain"in r,my=r=>"offset"in r,_y=r=>!("frequency"in r)&&"gain"in r,gy=r=>"detune"in r&&"frequency"in r,vy=r=>"pan"in r,Ft=r=>kn(Qf,r),xo=r=>kn(Kf,r),kl=(r,e)=>{const{activeInputs:t}=Ft(r);t.forEach(s=>s.forEach(([i])=>{e.includes(r)||kl(i,[...e,r])}));const n=fy(r)?[r.playbackRate]:tp(r)?Array.from(r.parameters.values()):py(r)?[r.Q,r.detune,r.frequency,r.gain]:my(r)?[r.offset]:_y(r)?[r.gain]:gy(r)?[r.detune,r.frequency]:vy(r)?[r.pan]:[];for(const s of n){const i=xo(s);i!==void 0&&i.activeInputs.forEach(([o])=>kl(o,e))}ns(r)&&To(r)},sp=r=>{kl(r.destination,[])},yy=r=>r===void 0||typeof r=="number"||typeof r=="string"&&(r==="balanced"||r==="interactive"||r==="playback"),Ty=(r,e,t,n,s,i,o,a,c)=>class extends r{constructor(u={}){if(c===null)throw new Error("Missing the native AudioContext constructor.");let h;try{h=new c(u)}catch(m){throw m.code===12&&m.message==="sampleRate is not in range"?t():m}if(h===null)throw n();if(!yy(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&h.sampleRate!==u.sampleRate)throw t();super(h,2);const{latencyHint:d}=u,{sampleRate:f}=h;if(this._baseLatency=typeof h.baseLatency=="number"?h.baseLatency:d==="balanced"?512/f:d==="interactive"||d===void 0?256/f:d==="playback"?1024/f:Math.max(2,Math.min(128,Math.round(d*f/128)))*128/f,this._nativeAudioContext=h,c.name==="webkitAudioContext"?(this._nativeGainNode=h.createGain(),this._nativeOscillatorNode=h.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(h.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,h.state==="running"){this._state="suspended";const m=()=>{this._state==="suspended"&&(this._state=null),h.removeEventListener("statechange",m)};h.addEventListener("statechange",m)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),sp(this)}))}createMediaElementSource(u){return new s(this,{mediaElement:u})}createMediaStreamDestination(){return new i(this)}createMediaStreamSource(u){return new o(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new a(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,h)=>{const d=()=>{this._nativeAudioContext.removeEventListener("statechange",d),this._nativeAudioContext.state==="running"?u():this.resume().then(u,h)};this._nativeAudioContext.addEventListener("statechange",d)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?e():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?e():u})}},xy=(r,e,t,n,s,i,o,a)=>class extends r{constructor(l,u){const h=i(l),d=o(h),f=s(h,u,d),m=d?e(a):null;super(l,!1,f,m),this._isNodeOfNativeOfflineAudioContext=d,this._nativeAudioDestinationNode=f}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(l){if(this._isNodeOfNativeOfflineAudioContext)throw n();if(l>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=l}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(l){if(this._isNodeOfNativeOfflineAudioContext)throw n();this._nativeAudioDestinationNode.channelCountMode=l}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},wy=r=>{const e=new WeakMap,t=async(n,s)=>{const i=s.destination;return e.set(s,i),await r(n,s,i),i};return{render(n,s){const i=e.get(s);return i!==void 0?Promise.resolve(i):t(n,s)}}},Sy=(r,e,t,n,s,i,o,a)=>(c,l)=>{const u=l.listener,h=()=>{const g=new Float32Array(1),x=e(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),w=o(l);let S=!1,C=[0,0,-1,0,1,0],O=[0,0,0];const k=()=>{if(S)return;S=!0;const U=n(l,256,9,0);U.onaudioprocess=({inputBuffer:P})=>{const V=[i(P,g,0),i(P,g,1),i(P,g,2),i(P,g,3),i(P,g,4),i(P,g,5)];V.some((I,B)=>I!==C[B])&&(u.setOrientation(...V),C=V);const Q=[i(P,g,6),i(P,g,7),i(P,g,8)];Q.some((I,B)=>I!==O[B])&&(u.setPosition(...Q),O=Q)},x.connect(U)},E=U=>P=>{P!==C[U]&&(C[U]=P,u.setOrientation(...C))},D=U=>P=>{P!==O[U]&&(O[U]=P,u.setPosition(...O))},M=(U,P,V)=>{const Q=t(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:P});Q.connect(x,0,U),Q.start(),Object.defineProperty(Q.offset,"defaultValue",{get(){return P}});const I=r({context:c},w,Q.offset,Ut,Gt);return a(I,"value",B=>()=>B.call(I),B=>A=>{try{B.call(I,A)}catch(R){if(R.code!==9)throw R}k(),w&&V(A)}),I.cancelAndHoldAtTime=(B=>w?()=>{throw s()}:(...A)=>{const R=B.apply(I,A);return k(),R})(I.cancelAndHoldAtTime),I.cancelScheduledValues=(B=>w?()=>{throw s()}:(...A)=>{const R=B.apply(I,A);return k(),R})(I.cancelScheduledValues),I.exponentialRampToValueAtTime=(B=>w?()=>{throw s()}:(...A)=>{const R=B.apply(I,A);return k(),R})(I.exponentialRampToValueAtTime),I.linearRampToValueAtTime=(B=>w?()=>{throw s()}:(...A)=>{const R=B.apply(I,A);return k(),R})(I.linearRampToValueAtTime),I.setTargetAtTime=(B=>w?()=>{throw s()}:(...A)=>{const R=B.apply(I,A);return k(),R})(I.setTargetAtTime),I.setValueAtTime=(B=>w?()=>{throw s()}:(...A)=>{const R=B.apply(I,A);return k(),R})(I.setValueAtTime),I.setValueCurveAtTime=(B=>w?()=>{throw s()}:(...A)=>{const R=B.apply(I,A);return k(),R})(I.setValueCurveAtTime),I};return{forwardX:M(0,0,E(0)),forwardY:M(1,0,E(1)),forwardZ:M(2,-1,E(2)),positionX:M(6,0,D(0)),positionY:M(7,0,D(1)),positionZ:M(8,0,D(2)),upX:M(3,0,E(3)),upY:M(4,1,E(4)),upZ:M(5,0,E(5))}},{forwardX:d,forwardY:f,forwardZ:m,positionX:p,positionY:_,positionZ:T,upX:y,upY:b,upZ:v}=u.forwardX===void 0?h():u;return{get forwardX(){return d},get forwardY(){return f},get forwardZ(){return m},get positionX(){return p},get positionY(){return _},get positionZ(){return T},get upX(){return y},get upY(){return b},get upZ(){return v}}},ba=r=>"context"in r,wo=r=>ba(r[0]),di=(r,e,t,n)=>{for(const s of r)if(t(s)){if(n)return!1;throw Error("The set contains at least one similar element.")}return r.add(e),!0},sd=(r,e,[t,n],s)=>{di(r,[e,t,n],i=>i[0]===e&&i[1]===t,s)},id=(r,[e,t,n],s)=>{const i=r.get(e);i===void 0?r.set(e,new Set([[t,n]])):di(i,[t,n],o=>o[0]===t,s)},nr=r=>"inputs"in r,Ca=(r,e,t,n)=>{if(nr(e)){const s=e.inputs[n];return r.connect(s,t,0),[s,t,0]}return r.connect(e,t,n),[e,t,n]},ip=(r,e,t)=>{for(const n of r)if(n[0]===e&&n[1]===t)return r.delete(n),n;return null},by=(r,e,t)=>Ja(r,n=>n[0]===e&&n[1]===t),rp=(r,e)=>{if(!yo(r).delete(e))throw new Error("Missing the expected event listener.")},op=(r,e,t)=>{const n=kn(r,e),s=Ja(n,i=>i[0]===t);return n.size===0&&r.delete(e),s},Ea=(r,e,t,n)=>{nr(e)?r.disconnect(e.inputs[n],t,0):r.disconnect(e,t,n)},Ze=r=>kn(ru,r),Qr=r=>kn(ou,r),oi=r=>Cl.has(r),ua=r=>!Xi.has(r),rd=(r,e)=>new Promise(t=>{if(e!==null)t(!0);else{const n=r.createScriptProcessor(256,1,1),s=r.createGain(),i=r.createBuffer(1,2,44100),o=i.getChannelData(0);o[0]=1,o[1]=1;const a=r.createBufferSource();a.buffer=i,a.loop=!0,a.connect(n).connect(r.destination),a.connect(s),a.disconnect(s),n.onaudioprocess=c=>{const l=c.inputBuffer.getChannelData(0);Array.prototype.some.call(l,u=>u===1)?t(!0):t(!1),a.stop(),n.onaudioprocess=null,a.disconnect(n),n.disconnect(r.destination)},a.start()}}),$c=(r,e)=>{const t=new Map;for(const n of r)for(const s of n){const i=t.get(s);t.set(s,i===void 0?1:i+1)}t.forEach((n,s)=>e(s,n))},Oa=r=>"context"in r,Cy=r=>{const e=new Map;r.connect=(t=>(n,s=0,i=0)=>{const o=Oa(n)?t(n,s,i):t(n,s),a=e.get(n);return a===void 0?e.set(n,[{input:i,output:s}]):a.every(c=>c.input!==i||c.output!==s)&&a.push({input:i,output:s}),o})(r.connect.bind(r)),r.disconnect=(t=>(n,s,i)=>{if(t.apply(r),n===void 0)e.clear();else if(typeof n=="number")for(const[o,a]of e){const c=a.filter(l=>l.output!==n);c.length===0?e.delete(o):e.set(o,c)}else if(e.has(n))if(s===void 0)e.delete(n);else{const o=e.get(n);if(o!==void 0){const a=o.filter(c=>c.output!==s&&(c.input!==i||i===void 0));a.length===0?e.delete(n):e.set(n,a)}}for(const[o,a]of e)a.forEach(c=>{Oa(o)?r.connect(o,c.output,c.input):r.connect(o,c.output)})})(r.disconnect)},Ey=(r,e,t,n)=>{const{activeInputs:s,passiveInputs:i}=xo(e),{outputs:o}=Ft(r),a=yo(r),c=l=>{const u=Ze(r),h=Qr(e);if(l){const d=op(i,r,t);sd(s,r,d,!1),!n&&!oi(r)&&u.connect(h,t)}else{const d=by(s,r,t);id(i,d,!1),!n&&!oi(r)&&u.disconnect(h,t)}};return di(o,[e,t],l=>l[0]===e&&l[1]===t,!0)?(a.add(c),ns(r)?sd(s,r,[t,c],!0):id(i,[r,t,c],!0),!0):!1},Oy=(r,e,t,n)=>{const{activeInputs:s,passiveInputs:i}=Ft(e),o=ip(s[n],r,t);return o===null?[ep(i,r,t,n)[2],!1]:[o[2],!0]},Ay=(r,e,t)=>{const{activeInputs:n,passiveInputs:s}=xo(e),i=ip(n,r,t);return i===null?[op(s,r,t)[1],!1]:[i[2],!0]},cu=(r,e,t,n,s)=>{const[i,o]=Oy(r,t,n,s);if(i!==null&&(rp(r,i),o&&!e&&!oi(r)&&Ea(Ze(r),Ze(t),n,s)),ns(t)){const{activeInputs:a}=Ft(t);Al(t,a)}},lu=(r,e,t,n)=>{const[s,i]=Ay(r,t,n);s!==null&&(rp(r,s),i&&!e&&!oi(r)&&Ze(r).disconnect(Qr(t),n))},ky=(r,e)=>{const t=Ft(r),n=[];for(const s of t.outputs)wo(s)?cu(r,e,...s):lu(r,e,...s),n.push(s[0]);return t.outputs.clear(),n},Dy=(r,e,t)=>{const n=Ft(r),s=[];for(const i of n.outputs)i[1]===t&&(wo(i)?cu(r,e,...i):lu(r,e,...i),s.push(i[0]),n.outputs.delete(i));return s},My=(r,e,t,n,s)=>{const i=Ft(r);return Array.from(i.outputs).filter(o=>o[0]===t&&(n===void 0||o[1]===n)&&(s===void 0||o[2]===s)).map(o=>(wo(o)?cu(r,e,...o):lu(r,e,...o),i.outputs.delete(o),o[0]))},Ry=(r,e,t,n,s,i,o,a,c,l,u,h,d,f,m,p)=>class extends l{constructor(T,y,b,v){super(b),this._context=T,this._nativeAudioNode=b;const g=u(T);h(g)&&t(rd,()=>rd(g,p))!==!0&&Cy(b),ru.set(this,b),Jf.set(this,new Set),T.state!=="closed"&&y&&Zi(this),r(this,v,b)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(T){this._nativeAudioNode.channelCount=T}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(T){this._nativeAudioNode.channelCountMode=T}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(T){this._nativeAudioNode.channelInterpretation=T}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(T,y=0,b=0){if(y<0||y>=this._nativeAudioNode.numberOfOutputs)throw s();const v=u(this._context),g=m(v);if(d(T)||f(T))throw i();if(ba(T)){const S=Ze(T);try{const O=Ca(this._nativeAudioNode,S,y,b),k=ua(this);(g||k)&&this._nativeAudioNode.disconnect(...O),this.context.state!=="closed"&&!k&&ua(T)&&Zi(T)}catch(O){throw O.code===12?i():O}if(e(this,T,y,b,g)){const O=c([this],T);$c(O,n(g))}return T}const x=Qr(T);if(x.name==="playbackRate"&&x.maxValue===1024)throw o();try{this._nativeAudioNode.connect(x,y),(g||ua(this))&&this._nativeAudioNode.disconnect(x,y)}catch(S){throw S.code===12?i():S}if(Ey(this,T,y,g)){const S=c([this],T);$c(S,n(g))}}disconnect(T,y,b){let v;const g=u(this._context),x=m(g);if(T===void 0)v=ky(this,x);else if(typeof T=="number"){if(T<0||T>=this.numberOfOutputs)throw s();v=Dy(this,x,T)}else{if(y!==void 0&&(y<0||y>=this.numberOfOutputs)||ba(T)&&b!==void 0&&(b<0||b>=T.numberOfInputs))throw s();if(v=My(this,x,T,y,b),v.length===0)throw i()}for(const w of v){const S=c([this],w);$c(S,a)}}},Py=(r,e,t,n,s,i,o,a,c,l,u,h,d)=>(f,m,p,_=null,T=null)=>{const y=p.value,b=new W0(y),v=m?n(b):null,g={get defaultValue(){return y},get maxValue(){return _===null?p.maxValue:_},get minValue(){return T===null?p.minValue:T},get value(){return p.value},set value(x){p.value=x,g.setValueAtTime(x,f.context.currentTime)},cancelAndHoldAtTime(x){if(typeof p.cancelAndHoldAtTime=="function")v===null&&b.flush(f.context.currentTime),b.add(s(x)),p.cancelAndHoldAtTime(x);else{const w=Array.from(b).pop();v===null&&b.flush(f.context.currentTime),b.add(s(x));const S=Array.from(b).pop();p.cancelScheduledValues(x),w!==S&&S!==void 0&&(S.type==="exponentialRampToValue"?p.exponentialRampToValueAtTime(S.value,S.endTime):S.type==="linearRampToValue"?p.linearRampToValueAtTime(S.value,S.endTime):S.type==="setValue"?p.setValueAtTime(S.value,S.startTime):S.type==="setValueCurve"&&p.setValueCurveAtTime(S.values,S.startTime,S.duration))}return g},cancelScheduledValues(x){return v===null&&b.flush(f.context.currentTime),b.add(i(x)),p.cancelScheduledValues(x),g},exponentialRampToValueAtTime(x,w){if(x===0)throw new RangeError;if(!Number.isFinite(w)||w<0)throw new RangeError;const S=f.context.currentTime;return v===null&&b.flush(S),Array.from(b).length===0&&(b.add(l(y,S)),p.setValueAtTime(y,S)),b.add(o(x,w)),p.exponentialRampToValueAtTime(x,w),g},linearRampToValueAtTime(x,w){const S=f.context.currentTime;return v===null&&b.flush(S),Array.from(b).length===0&&(b.add(l(y,S)),p.setValueAtTime(y,S)),b.add(a(x,w)),p.linearRampToValueAtTime(x,w),g},setTargetAtTime(x,w,S){return v===null&&b.flush(f.context.currentTime),b.add(c(x,w,S)),p.setTargetAtTime(x,w,S),g},setValueAtTime(x,w){return v===null&&b.flush(f.context.currentTime),b.add(l(x,w)),p.setValueAtTime(x,w),g},setValueCurveAtTime(x,w,S){const C=x instanceof Float32Array?x:new Float32Array(x);if(h!==null&&h.name==="webkitAudioContext"){const O=w+S,k=f.context.sampleRate,E=Math.ceil(w*k),D=Math.floor(O*k),M=D-E,U=new Float32Array(M);for(let V=0;V<M;V+=1){const Q=(C.length-1)/S*((E+V)/k-w),I=Math.floor(Q),B=Math.ceil(Q);U[V]=I===B?C[I]:(1-(Q-I))*C[I]+(1-(B-Q))*C[B]}v===null&&b.flush(f.context.currentTime),b.add(u(U,w,S)),p.setValueCurveAtTime(U,w,S);const P=D/k;P<O&&d(g,U[U.length-1],P),d(g,C[C.length-1],O)}else v===null&&b.flush(f.context.currentTime),b.add(u(C,w,S)),p.setValueCurveAtTime(C,w,S);return g}};return t.set(g,p),e.set(g,f),r(g,v),g},Uy=r=>({replay(e){for(const t of r)if(t.type==="exponentialRampToValue"){const{endTime:n,value:s}=t;e.exponentialRampToValueAtTime(s,n)}else if(t.type==="linearRampToValue"){const{endTime:n,value:s}=t;e.linearRampToValueAtTime(s,n)}else if(t.type==="setTarget"){const{startTime:n,target:s,timeConstant:i}=t;e.setTargetAtTime(s,n,i)}else if(t.type==="setValue"){const{startTime:n,value:s}=t;e.setValueAtTime(s,n)}else if(t.type==="setValueCurve"){const{duration:n,startTime:s,values:i}=t;e.setValueCurveAtTime(i,s,n)}else throw new Error("Can't apply an unknown automation.")}});class ap{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach((n,s)=>e.call(t,n,s,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const Iy={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},Fy=(r,e,t,n,s,i,o,a,c,l,u,h,d,f)=>class extends e{constructor(p,_,T){var y;const b=a(p),v=c(b),g=u({...Iy,...T});d(g);const x=El.get(b),w=x==null?void 0:x.get(_),S=v||b.state!=="closed"?b:(y=o(b))!==null&&y!==void 0?y:b,C=s(S,v?null:p.baseLatency,l,_,w,g),O=v?n(_,g,w):null;super(p,!0,C,O);const k=[];C.parameters.forEach((D,M)=>{const U=t(this,v,D);k.push([M,U])}),this._nativeAudioWorkletNode=C,this._onprocessorerror=null,this._parameters=new ap(k),v&&r(b,this);const{activeInputs:E}=i(this);h(C,E)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(p){const _=typeof p=="function"?f(this,p):null;this._nativeAudioWorkletNode.onprocessorerror=_;const T=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=T!==null&&T===_?p:T}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function Aa(r,e,t,n,s){if(typeof r.copyFromChannel=="function")e[t].byteLength===0&&(e[t]=new Float32Array(128)),r.copyFromChannel(e[t],n,s);else{const i=r.getChannelData(n);if(e[t].byteLength===0)e[t]=i.slice(s,s+128);else{const o=new Float32Array(i.buffer,s*Float32Array.BYTES_PER_ELEMENT,128);e[t].set(o)}}}const cp=(r,e,t,n,s)=>{typeof r.copyToChannel=="function"?e[t].byteLength!==0&&r.copyToChannel(e[t],n,s):e[t].byteLength!==0&&r.getChannelData(n).set(e[t],s)},ka=(r,e)=>{const t=[];for(let n=0;n<r;n+=1){const s=[],i=typeof e=="number"?e:e[n];for(let o=0;o<i;o+=1)s.push(new Float32Array(128));t.push(s)}return t},Ny=(r,e)=>{const t=kn(Ol,r),n=Ze(e);return kn(t,n)},Ly=async(r,e,t,n,s,i,o)=>{const a=e===null?Math.ceil(r.context.length/128)*128:e.length,c=n.channelCount*n.numberOfInputs,l=s.reduce((_,T)=>_+T,0),u=l===0?null:t.createBuffer(l,a,t.sampleRate);if(i===void 0)throw new Error("Missing the processor constructor.");const h=Ft(r),d=await Ny(t,r),f=ka(n.numberOfInputs,n.channelCount),m=ka(n.numberOfOutputs,s),p=Array.from(r.parameters.keys()).reduce((_,T)=>({..._,[T]:new Float32Array(128)}),{});for(let _=0;_<a;_+=128){if(n.numberOfInputs>0&&e!==null)for(let T=0;T<n.numberOfInputs;T+=1)for(let y=0;y<n.channelCount;y+=1)Aa(e,f[T],y,y,_);i.parameterDescriptors!==void 0&&e!==null&&i.parameterDescriptors.forEach(({name:T},y)=>{Aa(e,p,T,c+y,_)});for(let T=0;T<n.numberOfInputs;T+=1)for(let y=0;y<s[T];y+=1)m[T][y].byteLength===0&&(m[T][y]=new Float32Array(128));try{const T=f.map((b,v)=>h.activeInputs[v].size===0?[]:b),y=o(_/t.sampleRate,t.sampleRate,()=>d.process(T,m,p));if(u!==null)for(let b=0,v=0;b<n.numberOfOutputs;b+=1){for(let g=0;g<s[b];g+=1)cp(u,m[b],g,v+g,_);v+=s[b]}if(!y)break}catch(T){r.dispatchEvent(new ErrorEvent("processorerror",{colno:T.colno,filename:T.filename,lineno:T.lineno,message:T.message}));break}}return u},By=(r,e,t,n,s,i,o,a,c,l,u,h,d,f,m,p)=>(_,T,y)=>{const b=new WeakMap;let v=null;const g=async(x,w)=>{let S=u(x),C=null;const O=Mt(S,w),k=Array.isArray(T.outputChannelCount)?T.outputChannelCount:Array.from(T.outputChannelCount);if(h===null){const E=k.reduce((P,V)=>P+V,0),D=s(w,{channelCount:Math.max(1,E),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,E)}),M=[];for(let P=0;P<x.numberOfOutputs;P+=1)M.push(n(w,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:k[P]}));const U=o(w,{channelCount:T.channelCount,channelCountMode:T.channelCountMode,channelInterpretation:T.channelInterpretation,gain:1});U.connect=e.bind(null,M),U.disconnect=c.bind(null,M),C=[D,M,U]}else O||(S=new h(w,_));if(b.set(w,C===null?S:C[2]),C!==null){if(v===null){if(y===void 0)throw new Error("Missing the processor constructor.");if(d===null)throw new Error("Missing the native OfflineAudioContext constructor.");const V=x.channelCount*x.numberOfInputs,Q=y.parameterDescriptors===void 0?0:y.parameterDescriptors.length,I=V+Q;v=Ly(x,I===0?null:await(async()=>{const A=new d(I,Math.ceil(x.context.length/128)*128,w.sampleRate),R=[],H=[];for(let q=0;q<T.numberOfInputs;q+=1)R.push(o(A,{channelCount:T.channelCount,channelCountMode:T.channelCountMode,channelInterpretation:T.channelInterpretation,gain:1})),H.push(s(A,{channelCount:T.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:T.channelCount}));const W=await Promise.all(Array.from(x.parameters.values()).map(async q=>{const G=i(A,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:q.value});return await f(A,q,G.offset),G})),F=n(A,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,V+Q)});for(let q=0;q<T.numberOfInputs;q+=1){R[q].connect(H[q]);for(let G=0;G<T.channelCount;G+=1)H[q].connect(F,G,q*T.channelCount+G)}for(const[q,G]of W.entries())G.connect(F,0,V+q),G.start(0);return F.connect(A.destination),await Promise.all(R.map(q=>m(x,A,q))),p(A)})(),w,T,k,y,l)}const E=await v,D=t(w,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[M,U,P]=C;E!==null&&(D.buffer=E,D.start(0)),D.connect(M);for(let V=0,Q=0;V<x.numberOfOutputs;V+=1){const I=U[V];for(let B=0;B<k[V];B+=1)M.connect(I,Q+B,B);Q+=k[V]}return P}if(O)for(const[E,D]of x.parameters.entries())await r(w,D,S.parameters.get(E));else for(const[E,D]of x.parameters.entries())await f(w,D,S.parameters.get(E));return await m(x,w,S),S};return{render(x,w){a(w,x);const S=b.get(w);return S!==void 0?Promise.resolve(S):g(x,w)}}},zy=(r,e,t,n,s,i,o,a,c,l,u,h,d,f,m,p,_,T,y,b)=>class extends m{constructor(g,x){super(g,x),this._nativeContext=g,this._audioWorklet=r===void 0?void 0:{addModule:(w,S)=>r(this,w,S)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new s(this)}createBuffer(g,x,w){return new t({length:x,numberOfChannels:g,sampleRate:w})}createBufferSource(){return new n(this)}createChannelMerger(g=6){return new i(this,{numberOfInputs:g})}createChannelSplitter(g=6){return new o(this,{numberOfOutputs:g})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(g=1){return new u(this,{maxDelayTime:g})}createDynamicsCompressor(){return new h(this)}createGain(){return new d(this)}createIIRFilter(g,x){return new f(this,{feedback:x,feedforward:g})}createOscillator(){return new p(this)}createPanner(){return new _(this)}createPeriodicWave(g,x,w={disableNormalization:!1}){return new T(this,{...w,imag:x,real:g})}createStereoPanner(){return new y(this)}createWaveShaper(){return new b(this)}decodeAudioData(g,x,w){return l(this._nativeContext,g).then(S=>(typeof x=="function"&&x(S),S),S=>{throw typeof w=="function"&&w(S),S})}},Vy={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},Gy=(r,e,t,n,s,i,o,a)=>class extends r{constructor(l,u){const h=i(l),d={...Vy,...u},f=s(h,d),m=o(h),p=m?t():null;super(l,!1,f,p),this._Q=e(this,m,f.Q,Ut,Gt),this._detune=e(this,m,f.detune,1200*Math.log2(Ut),-1200*Math.log2(Ut)),this._frequency=e(this,m,f.frequency,l.sampleRate/2,0),this._gain=e(this,m,f.gain,40*Math.log10(Ut),Gt),this._nativeBiquadFilterNode=f,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(l){this._nativeBiquadFilterNode.type=l}getFrequencyResponse(l,u,h){try{this._nativeBiquadFilterNode.getFrequencyResponse(l,u,h)}catch(d){throw d.code===11?n():d}if(l.length!==u.length||u.length!==h.length)throw n()}},Wy=(r,e,t,n,s)=>()=>{const i=new WeakMap,o=async(a,c)=>{let l=t(a);const u=Mt(l,c);if(!u){const h={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=e(c,h)}return i.set(c,l),u?(await r(c,a.Q,l.Q),await r(c,a.detune,l.detune),await r(c,a.frequency,l.frequency),await r(c,a.gain,l.gain)):(await n(c,a.Q,l.Q),await n(c,a.detune,l.detune),await n(c,a.frequency,l.frequency),await n(c,a.gain,l.gain)),await s(a,c,l),l};return{render(a,c){const l=i.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},Hy=(r,e)=>(t,n)=>{const s=e.get(t);if(s!==void 0)return s;const i=r.get(t);if(i!==void 0)return i;try{const o=n();return o instanceof Promise?(r.set(t,o),o.catch(()=>!1).then(a=>(r.delete(t),e.set(t,a),a))):(e.set(t,o),o)}catch{return e.set(t,!1),!1}},qy={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},jy=(r,e,t,n,s)=>class extends r{constructor(o,a){const c=n(o),l={...qy,...a},u=t(c,l),h=s(c)?e():null;super(o,!1,u,h)}},Yy=(r,e,t)=>()=>{const n=new WeakMap,s=async(i,o)=>{let a=e(i);if(!Mt(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=r(o,l)}return n.set(o,a),await t(i,o,a),a};return{render(i,o){const a=n.get(o);return a!==void 0?Promise.resolve(a):s(i,o)}}},Xy={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},Zy=(r,e,t,n,s,i)=>class extends r{constructor(a,c){const l=n(a),u=i({...Xy,...c}),h=t(l,u),d=s(l)?e():null;super(a,!1,h,d)}},Qy=(r,e,t)=>()=>{const n=new WeakMap,s=async(i,o)=>{let a=e(i);if(!Mt(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=r(o,l)}return n.set(o,a),await t(i,o,a),a};return{render(i,o){const a=n.get(o);return a!==void 0?Promise.resolve(a):s(i,o)}}},Ky=r=>(e,t,n)=>r(t,e,n),Jy=r=>(e,t,n=0,s=0)=>{const i=e[n];if(i===void 0)throw r();return Oa(t)?i.connect(t,0,s):i.connect(t,0)},$y=r=>(e,t)=>{const n=r(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),s=e.createBuffer(1,2,44100);return n.buffer=s,n.loop=!0,n.connect(t),n.start(),()=>{n.stop(),n.disconnect(t)}},e1={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},t1=(r,e,t,n,s,i,o)=>class extends r{constructor(c,l){const u=s(c),h={...e1,...l},d=n(u,h),f=i(u),m=f?t():null;super(c,!1,d,m),this._constantSourceNodeRenderer=m,this._nativeConstantSourceNode=d,this._offset=e(this,f,d.offset,Ut,Gt),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?o(this,c):null;this._nativeConstantSourceNode.onended=l;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===l?c:u}start(c=0){if(this._nativeConstantSourceNode.start(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=c),this.context.state!=="closed"){Zi(this);const l=()=>{this._nativeConstantSourceNode.removeEventListener("ended",l),ns(this)&&To(this)};this._nativeConstantSourceNode.addEventListener("ended",l)}}stop(c=0){this._nativeConstantSourceNode.stop(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=c)}},n1=(r,e,t,n,s)=>()=>{const i=new WeakMap;let o=null,a=null;const c=async(l,u)=>{let h=t(l);const d=Mt(h,u);if(!d){const f={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,offset:h.offset.value};h=e(u,f),o!==null&&h.start(o),a!==null&&h.stop(a)}return i.set(u,h),d?await r(u,l.offset,h.offset):await n(u,l.offset,h.offset),await s(l,u,h),h};return{set start(l){o=l},set stop(l){a=l},render(l,u){const h=i.get(u);return h!==void 0?Promise.resolve(h):c(l,u)}}},s1=r=>e=>(r[0]=e,r[0]),i1={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},r1=(r,e,t,n,s,i)=>class extends r{constructor(a,c){const l=n(a),u={...i1,...c},h=t(l,u),f=s(l)?e():null;super(a,!1,h,f),this._isBufferNullified=!1,this._nativeConvolverNode=h,u.buffer!==null&&i(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const c=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=c.createBuffer(1,1,c.sampleRate),this._isBufferNullified=!0,i(this,0)}else this._isBufferNullified=!1,i(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},o1=(r,e,t)=>()=>{const n=new WeakMap,s=async(i,o)=>{let a=e(i);if(!Mt(a,o)){const l={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=r(o,l)}return n.set(o,a),nr(a)?await t(i,o,a.inputs[0]):await t(i,o,a),a};return{render(i,o){const a=n.get(o);return a!==void 0?Promise.resolve(a):s(i,o)}}},a1=(r,e)=>(t,n,s)=>{if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(t,n,s)}catch(i){throw i.name==="SyntaxError"?r():i}},c1=()=>new DOMException("","DataCloneError"),od=r=>{const{port1:e,port2:t}=new MessageChannel;return new Promise(n=>{const s=()=>{t.onmessage=null,e.close(),t.close(),n()};t.onmessage=()=>s();try{e.postMessage(r,[r])}catch{}finally{s()}})},l1=(r,e,t,n,s,i,o,a,c,l,u)=>(h,d)=>{const f=o(h)?h:i(h);if(s.has(d)){const m=t();return Promise.reject(m)}try{s.add(d)}catch{}return e(c,()=>c(f))?f.decodeAudioData(d).then(m=>(od(d).catch(()=>{}),e(a,()=>a(m))||u(m),r.add(m),m)):new Promise((m,p)=>{const _=async()=>{try{await od(d)}catch{}},T=y=>{p(y),_()};try{f.decodeAudioData(d,y=>{typeof y.copyFromChannel!="function"&&(l(y),au(y)),r.add(y),_().then(()=>m(y))},y=>{T(y===null?n():y)})}catch(y){T(y)}})},u1=(r,e,t,n,s,i,o,a)=>(c,l)=>{const u=e.get(c);if(u===void 0)throw new Error("Missing the expected cycle count.");const h=i(c.context),d=a(h);if(u===l){if(e.delete(c),!d&&o(c)){const f=n(c),{outputs:m}=t(c);for(const p of m)if(wo(p)){const _=n(p[0]);r(f,_,p[1],p[2])}else{const _=s(p[0]);f.connect(_,p[1])}}}else e.set(c,u-l)},h1={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},d1=(r,e,t,n,s,i,o)=>class extends r{constructor(c,l){const u=s(c),h={...h1,...l},d=n(u,h),f=i(u),m=f?t(h.maxDelayTime):null;super(c,!1,d,m),this._delayTime=e(this,f,d.delayTime),o(this,h.maxDelayTime)}get delayTime(){return this._delayTime}},f1=(r,e,t,n,s)=>i=>{const o=new WeakMap,a=async(c,l)=>{let u=t(c);const h=Mt(u,l);if(!h){const d={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:i};u=e(l,d)}return o.set(l,u),h?await r(l,c.delayTime,u.delayTime):await n(l,c.delayTime,u.delayTime),await s(c,l,u),u};return{render(c,l){const u=o.get(l);return u!==void 0?Promise.resolve(u):a(c,l)}}},p1=r=>(e,t,n,s)=>r(e[s],i=>i[0]===t&&i[1]===n),m1=r=>(e,t)=>{r(e).delete(t)},_1=r=>"delayTime"in r,g1=(r,e,t)=>function n(s,i){const o=ba(i)?i:t(r,i);if(_1(o))return[];if(s[0]===o)return[s];if(s.includes(o))return[];const{outputs:a}=e(o);return Array.from(a).map(c=>n([...s,o],c[0])).reduce((c,l)=>c.concat(l),[])},na=(r,e,t)=>{const n=e[t];if(n===void 0)throw r();return n},v1=r=>(e,t=void 0,n=void 0,s=0)=>t===void 0?e.forEach(i=>i.disconnect()):typeof t=="number"?na(r,e,t).disconnect():Oa(t)?n===void 0?e.forEach(i=>i.disconnect(t)):s===void 0?na(r,e,n).disconnect(t,0):na(r,e,n).disconnect(t,0,s):n===void 0?e.forEach(i=>i.disconnect(t)):na(r,e,n).disconnect(t,0),y1={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},T1=(r,e,t,n,s,i,o,a)=>class extends r{constructor(l,u){const h=i(l),d={...y1,...u},f=n(h,d),m=o(h),p=m?t():null;super(l,!1,f,p),this._attack=e(this,m,f.attack),this._knee=e(this,m,f.knee),this._nativeDynamicsCompressorNode=f,this._ratio=e(this,m,f.ratio),this._release=e(this,m,f.release),this._threshold=e(this,m,f.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(l){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=l,l>2)throw this._nativeDynamicsCompressorNode.channelCount=u,s()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(l){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=l,l==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,s()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},x1=(r,e,t,n,s)=>()=>{const i=new WeakMap,o=async(a,c)=>{let l=t(a);const u=Mt(l,c);if(!u){const h={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=e(c,h)}return i.set(c,l),u?(await r(c,a.attack,l.attack),await r(c,a.knee,l.knee),await r(c,a.ratio,l.ratio),await r(c,a.release,l.release),await r(c,a.threshold,l.threshold)):(await n(c,a.attack,l.attack),await n(c,a.knee,l.knee),await n(c,a.ratio,l.ratio),await n(c,a.release,l.release),await n(c,a.threshold,l.threshold)),await s(a,c,l),l};return{render(a,c){const l=i.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},w1=()=>new DOMException("","EncodingError"),S1=r=>e=>new Promise((t,n)=>{if(r===null){n(new SyntaxError);return}const s=r.document.head;if(s===null)n(new SyntaxError);else{const i=r.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(o),c=r.onerror,l=()=>{r.onerror=c,URL.revokeObjectURL(a)};r.onerror=(u,h,d,f,m)=>{if(h===a||h===r.location.href&&d===1&&f===1)return l(),n(m),!1;if(c!==null)return c(u,h,d,f,m)},i.onerror=()=>{l(),n(new SyntaxError)},i.onload=()=>{l(),t()},i.src=a,i.type="module",s.appendChild(i)}}),b1=r=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,n,s){if(n!==null){let i=this._listeners.get(n);i===void 0&&(i=r(this,n),typeof n=="function"&&this._listeners.set(n,i)),this._nativeEventTarget.addEventListener(t,i,s)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,n,s){const i=n===null?void 0:this._listeners.get(n);this._nativeEventTarget.removeEventListener(t,i===void 0?null:i,s)}},C1=r=>(e,t,n)=>{Object.defineProperties(r,{currentFrame:{configurable:!0,get(){return Math.round(e*t)}},currentTime:{configurable:!0,get(){return e}}});try{return n()}finally{r!==null&&(delete r.currentFrame,delete r.currentTime)}},E1=r=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw r()},O1={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},A1=(r,e,t,n,s,i)=>class extends r{constructor(a,c){const l=s(a),u={...O1,...c},h=n(l,u),d=i(l),f=d?t():null;super(a,!1,h,f),this._gain=e(this,d,h.gain,Ut,Gt)}get gain(){return this._gain}},k1=(r,e,t,n,s)=>()=>{const i=new WeakMap,o=async(a,c)=>{let l=t(a);const u=Mt(l,c);if(!u){const h={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=e(c,h)}return i.set(c,l),u?await r(c,a.gain,l.gain):await n(c,a.gain,l.gain),await s(a,c,l),l};return{render(a,c){const l=i.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},D1=(r,e)=>t=>e(r,t),M1=r=>e=>{const t=r(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},R1=r=>e=>{var t;return(t=r.get(e))!==null&&t!==void 0?t:0},P1=r=>e=>{const t=r(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},U1=r=>e=>r.get(e),xt=()=>new DOMException("","InvalidStateError"),I1=r=>e=>{const t=r.get(e);if(t===void 0)throw xt();return t},F1=(r,e)=>t=>{let n=r.get(t);if(n!==void 0)return n;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return n=new e(1,1,44100),r.set(t,n),n},N1=r=>e=>{const t=r.get(e);if(t===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return t},$a=()=>new DOMException("","InvalidAccessError"),L1=r=>{r.getFrequencyResponse=(e=>(t,n,s)=>{if(t.length!==n.length||n.length!==s.length)throw $a();return e.call(r,t,n,s)})(r.getFrequencyResponse)},B1={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},z1=(r,e,t,n,s,i)=>class extends r{constructor(a,c){const l=n(a),u=s(l),h={...B1,...c},d=e(l,u?null:a.baseLatency,h),f=u?t(h.feedback,h.feedforward):null;super(a,!1,d,f),L1(d),this._nativeIIRFilterNode=d,i(this,1)}getFrequencyResponse(a,c,l){return this._nativeIIRFilterNode.getFrequencyResponse(a,c,l)}},lp=(r,e,t,n,s,i,o,a,c,l,u)=>{const h=l.length;let d=a;for(let f=0;f<h;f+=1){let m=t[0]*l[f];for(let p=1;p<s;p+=1){const _=d-p&c-1;m+=t[p]*i[_],m-=r[p]*o[_]}for(let p=s;p<n;p+=1)m+=t[p]*i[d-p&c-1];for(let p=s;p<e;p+=1)m-=r[p]*o[d-p&c-1];i[d]=l[f],o[d]=m,d=d+1&c-1,u[f]=m}return d},V1=(r,e,t,n)=>{const s=t instanceof Float64Array?t:new Float64Array(t),i=n instanceof Float64Array?n:new Float64Array(n),o=s.length,a=i.length,c=Math.min(o,a);if(s[0]!==1){for(let m=0;m<o;m+=1)i[m]/=s[0];for(let m=1;m<a;m+=1)s[m]/=s[0]}const l=32,u=new Float32Array(l),h=new Float32Array(l),d=e.createBuffer(r.numberOfChannels,r.length,r.sampleRate),f=r.numberOfChannels;for(let m=0;m<f;m+=1){const p=r.getChannelData(m),_=d.getChannelData(m);u.fill(0),h.fill(0),lp(s,o,i,a,c,u,h,0,l,p,_)}return d},G1=(r,e,t,n,s)=>(i,o)=>{const a=new WeakMap;let c=null;const l=async(u,h)=>{let d=null,f=e(u);const m=Mt(f,h);if(h.createIIRFilter===void 0?d=r(h,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):m||(f=h.createIIRFilter(o,i)),a.set(h,d===null?f:d),d!==null){if(c===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");const _=new t(u.context.destination.channelCount,u.context.length,h.sampleRate);c=(async()=>{await n(u,_,_.destination);const T=await s(_);return V1(T,h,i,o)})()}const p=await c;return d.buffer=p,d.start(0),d}return await n(u,h,f),f};return{render(u,h){const d=a.get(h);return d!==void 0?Promise.resolve(d):l(u,h)}}},W1=(r,e,t,n,s,i)=>o=>(a,c)=>{const l=r.get(a);if(l===void 0){if(!o&&i(a)){const u=n(a),{outputs:h}=t(a);for(const d of h)if(wo(d)){const f=n(d[0]);e(u,f,d[1],d[2])}else{const f=s(d[0]);u.disconnect(f,d[1])}}r.set(a,c)}else r.set(a,l+c)},H1=(r,e)=>t=>{const n=r.get(t);return e(n)||e(t)},q1=(r,e)=>t=>r.has(t)||e(t),j1=(r,e)=>t=>r.has(t)||e(t),Y1=(r,e)=>t=>{const n=r.get(t);return e(n)||e(t)},X1=r=>e=>r!==null&&e instanceof r,Z1=r=>e=>r!==null&&typeof r.AudioNode=="function"&&e instanceof r.AudioNode,Q1=r=>e=>r!==null&&typeof r.AudioParam=="function"&&e instanceof r.AudioParam,K1=(r,e)=>t=>r(t)||e(t),J1=r=>e=>r!==null&&e instanceof r,$1=r=>r!==null&&r.isSecureContext,eT=(r,e,t,n)=>class extends r{constructor(i,o){const a=t(i),c=e(a,o);if(n(a))throw TypeError();super(i,!0,c,null),this._nativeMediaElementAudioSourceNode=c}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},tT={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},nT=(r,e,t,n)=>class extends r{constructor(i,o){const a=t(i);if(n(a))throw new TypeError;const c={...tT,...o},l=e(a,c);super(i,!1,l,null),this._nativeMediaStreamAudioDestinationNode=l}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},sT=(r,e,t,n)=>class extends r{constructor(i,o){const a=t(i),c=e(a,o);if(n(a))throw new TypeError;super(i,!0,c,null),this._nativeMediaStreamAudioSourceNode=c}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},iT=(r,e,t)=>class extends r{constructor(s,i){const o=t(s),a=e(o,i);super(s,!0,a,null)}},rT=(r,e,t,n,s,i)=>class extends t{constructor(a,c){super(a),this._nativeContext=a,Ka.set(this,a),n(a)&&s.set(a,new Set),this._destination=new r(this,c),this._listener=e(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const c=typeof a=="function"?i(this,a):null;this._nativeContext.onstatechange=c;const l=this._nativeContext.onstatechange;this._onstatechange=l!==null&&l===c?a:l}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},Kr=r=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const t=r.decodeAudioData(e.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch{}return!1},oT=(r,e)=>(t,n,s)=>{const i=new Set;return t.connect=(o=>(a,c=0,l=0)=>{const u=i.size===0;if(e(a))return o.call(t,a,c,l),r(i,[a,c,l],h=>h[0]===a&&h[1]===c&&h[2]===l,!0),u&&n(),a;o.call(t,a,c),r(i,[a,c],h=>h[0]===a&&h[1]===c,!0),u&&n()})(t.connect),t.disconnect=(o=>(a,c,l)=>{const u=i.size>0;if(a===void 0)o.apply(t),i.clear();else if(typeof a=="number"){o.call(t,a);for(const d of i)d[1]===a&&i.delete(d)}else{e(a)?o.call(t,a,c,l):o.call(t,a,c);for(const d of i)d[0]===a&&(c===void 0||d[1]===c)&&(l===void 0||d[2]===l)&&i.delete(d)}const h=i.size===0;u&&h&&s()})(t.disconnect),t},Ke=(r,e,t)=>{const n=e[t];n!==void 0&&n!==r[t]&&(r[t]=n)},gt=(r,e)=>{Ke(r,e,"channelCount"),Ke(r,e,"channelCountMode"),Ke(r,e,"channelInterpretation")},ad=r=>typeof r.getFloatTimeDomainData=="function",aT=r=>{r.getFloatTimeDomainData=e=>{const t=new Uint8Array(e.length);r.getByteTimeDomainData(t);const n=Math.max(t.length,r.fftSize);for(let s=0;s<n;s+=1)e[s]=(t[s]-128)*.0078125;return e}},cT=(r,e)=>(t,n)=>{const s=t.createAnalyser();if(gt(s,n),!(n.maxDecibels>n.minDecibels))throw e();return Ke(s,n,"fftSize"),Ke(s,n,"maxDecibels"),Ke(s,n,"minDecibels"),Ke(s,n,"smoothingTimeConstant"),r(ad,()=>ad(s))||aT(s),s},lT=r=>r===null?null:r.hasOwnProperty("AudioBuffer")?r.AudioBuffer:null,rt=(r,e,t)=>{const n=e[t];n!==void 0&&n!==r[t].value&&(r[t].value=n)},uT=r=>{r.start=(e=>{let t=!1;return(n=0,s=0,i)=>{if(t)throw xt();e.call(r,n,s,i),t=!0}})(r.start)},uu=r=>{r.start=(e=>(t=0,n=0,s)=>{if(typeof s=="number"&&s<0||n<0||t<0)throw new RangeError("The parameters can't be negative.");e.call(r,t,n,s)})(r.start)},hu=r=>{r.stop=(e=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");e.call(r,t)})(r.stop)},hT=(r,e,t,n,s,i,o,a,c,l,u)=>(h,d)=>{const f=h.createBufferSource();return gt(f,d),rt(f,d,"playbackRate"),Ke(f,d,"buffer"),Ke(f,d,"loop"),Ke(f,d,"loopEnd"),Ke(f,d,"loopStart"),e(t,()=>t(h))||uT(f),e(n,()=>n(h))||c(f),e(s,()=>s(h))||l(f,h),e(i,()=>i(h))||uu(f),e(o,()=>o(h))||u(f,h),e(a,()=>a(h))||hu(f),r(h,f),f},dT=r=>r===null?null:r.hasOwnProperty("AudioContext")?r.AudioContext:r.hasOwnProperty("webkitAudioContext")?r.webkitAudioContext:null,fT=(r,e)=>(t,n,s)=>{const i=t.destination;if(i.channelCount!==n)try{i.channelCount=n}catch{}s&&i.channelCountMode!=="explicit"&&(i.channelCountMode="explicit"),i.maxChannelCount===0&&Object.defineProperty(i,"maxChannelCount",{value:n});const o=r(t,{channelCount:n,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,gain:1});return e(o,"channelCount",a=>()=>a.call(o),a=>c=>{a.call(o,c);try{i.channelCount=c}catch(l){if(c>i.maxChannelCount)throw l}}),e(o,"channelCountMode",a=>()=>a.call(o),a=>c=>{a.call(o,c),i.channelCountMode=c}),e(o,"channelInterpretation",a=>()=>a.call(o),a=>c=>{a.call(o,c),i.channelInterpretation=c}),Object.defineProperty(o,"maxChannelCount",{get:()=>i.maxChannelCount}),o.connect(i),o},pT=r=>r===null?null:r.hasOwnProperty("AudioWorkletNode")?r.AudioWorkletNode:null,mT=r=>{const{port1:e}=new MessageChannel;try{e.postMessage(r)}finally{e.close()}},_T=(r,e,t,n,s)=>(i,o,a,c,l,u)=>{if(a!==null)try{const h=new a(i,c,u),d=new Map;let f=null;if(Object.defineProperties(h,{channelCount:{get:()=>u.channelCount,set:()=>{throw r()}},channelCountMode:{get:()=>"explicit",set:()=>{throw r()}},onprocessorerror:{get:()=>f,set:m=>{typeof f=="function"&&h.removeEventListener("processorerror",f),f=typeof m=="function"?m:null,typeof f=="function"&&h.addEventListener("processorerror",f)}}}),h.addEventListener=(m=>(...p)=>{if(p[0]==="processorerror"){const _=typeof p[1]=="function"?p[1]:typeof p[1]=="object"&&p[1]!==null&&typeof p[1].handleEvent=="function"?p[1].handleEvent:null;if(_!==null){const T=d.get(p[1]);T!==void 0?p[1]=T:(p[1]=y=>{y.type==="error"?(Object.defineProperties(y,{type:{value:"processorerror"}}),_(y)):_(new ErrorEvent(p[0],{...y}))},d.set(_,p[1]))}}return m.call(h,"error",p[1],p[2]),m.call(h,...p)})(h.addEventListener),h.removeEventListener=(m=>(...p)=>{if(p[0]==="processorerror"){const _=d.get(p[1]);_!==void 0&&(d.delete(p[1]),p[1]=_)}return m.call(h,"error",p[1],p[2]),m.call(h,p[0],p[1],p[2])})(h.removeEventListener),u.numberOfOutputs!==0){const m=t(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return h.connect(m).connect(i.destination),s(h,()=>m.disconnect(),()=>m.connect(i.destination))}return h}catch(h){throw h.code===11?n():h}if(l===void 0)throw n();return mT(u),e(i,o,l,u)},up=(r,e)=>r===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(r*e))))),gT=r=>new Promise((e,t)=>{const{port1:n,port2:s}=new MessageChannel;n.onmessage=({data:i})=>{n.close(),s.close(),e(i)},n.onmessageerror=({data:i})=>{n.close(),s.close(),t(i)},s.postMessage(r)}),vT=async(r,e)=>{const t=await gT(e);return new r(t)},yT=(r,e,t,n)=>{let s=Ol.get(r);s===void 0&&(s=new WeakMap,Ol.set(r,s));const i=vT(t,n);return s.set(e,i),i},TT=(r,e,t,n,s,i,o,a,c,l,u,h,d)=>(f,m,p,_)=>{if(_.numberOfInputs===0&&_.numberOfOutputs===0)throw c();const T=Array.isArray(_.outputChannelCount)?_.outputChannelCount:Array.from(_.outputChannelCount);if(T.some(L=>L<1))throw c();if(T.length!==_.numberOfOutputs)throw e();if(_.channelCountMode!=="explicit")throw c();const y=_.channelCount*_.numberOfInputs,b=T.reduce((L,X)=>L+X,0),v=p.parameterDescriptors===void 0?0:p.parameterDescriptors.length;if(y+v>6||b>6)throw c();const g=new MessageChannel,x=[],w=[];for(let L=0;L<_.numberOfInputs;L+=1)x.push(o(f,{channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,gain:1})),w.push(s(f,{channelCount:_.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:_.channelCount}));const S=[];if(p.parameterDescriptors!==void 0)for(const{defaultValue:L,maxValue:X,minValue:oe,name:j}of p.parameterDescriptors){const $=i(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:_.parameterData[j]!==void 0?_.parameterData[j]:L===void 0?0:L});Object.defineProperties($.offset,{defaultValue:{get:()=>L===void 0?0:L},maxValue:{get:()=>X===void 0?Ut:X},minValue:{get:()=>oe===void 0?Gt:oe}}),S.push($)}const C=n(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,y+v)}),O=up(m,f.sampleRate),k=a(f,O,y+v,Math.max(1,b)),E=s(f,{channelCount:Math.max(1,b),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,b)}),D=[];for(let L=0;L<_.numberOfOutputs;L+=1)D.push(n(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:T[L]}));for(let L=0;L<_.numberOfInputs;L+=1){x[L].connect(w[L]);for(let X=0;X<_.channelCount;X+=1)w[L].connect(C,X,L*_.channelCount+X)}const M=new ap(p.parameterDescriptors===void 0?[]:p.parameterDescriptors.map(({name:L},X)=>{const oe=S[X];return oe.connect(C,0,y+X),oe.start(0),[L,oe.offset]}));C.connect(k);let U=_.channelInterpretation,P=null;const V=_.numberOfOutputs===0?[k]:D,Q={get bufferSize(){return O},get channelCount(){return _.channelCount},set channelCount(L){throw t()},get channelCountMode(){return _.channelCountMode},set channelCountMode(L){throw t()},get channelInterpretation(){return U},set channelInterpretation(L){for(const X of x)X.channelInterpretation=L;U=L},get context(){return k.context},get inputs(){return x},get numberOfInputs(){return _.numberOfInputs},get numberOfOutputs(){return _.numberOfOutputs},get onprocessorerror(){return P},set onprocessorerror(L){typeof P=="function"&&Q.removeEventListener("processorerror",P),P=typeof L=="function"?L:null,typeof P=="function"&&Q.addEventListener("processorerror",P)},get parameters(){return M},get port(){return g.port2},addEventListener(...L){return k.addEventListener(L[0],L[1],L[2])},connect:r.bind(null,V),disconnect:l.bind(null,V),dispatchEvent(...L){return k.dispatchEvent(L[0])},removeEventListener(...L){return k.removeEventListener(L[0],L[1],L[2])}},I=new Map;g.port1.addEventListener=(L=>(...X)=>{if(X[0]==="message"){const oe=typeof X[1]=="function"?X[1]:typeof X[1]=="object"&&X[1]!==null&&typeof X[1].handleEvent=="function"?X[1].handleEvent:null;if(oe!==null){const j=I.get(X[1]);j!==void 0?X[1]=j:(X[1]=$=>{u(f.currentTime,f.sampleRate,()=>oe($))},I.set(oe,X[1]))}}return L.call(g.port1,X[0],X[1],X[2])})(g.port1.addEventListener),g.port1.removeEventListener=(L=>(...X)=>{if(X[0]==="message"){const oe=I.get(X[1]);oe!==void 0&&(I.delete(X[1]),X[1]=oe)}return L.call(g.port1,X[0],X[1],X[2])})(g.port1.removeEventListener);let B=null;Object.defineProperty(g.port1,"onmessage",{get:()=>B,set:L=>{typeof B=="function"&&g.port1.removeEventListener("message",B),B=typeof L=="function"?L:null,typeof B=="function"&&(g.port1.addEventListener("message",B),g.port1.start())}}),p.prototype.port=g.port1;let A=null;yT(f,Q,p,_).then(L=>A=L);const H=ka(_.numberOfInputs,_.channelCount),W=ka(_.numberOfOutputs,T),F=p.parameterDescriptors===void 0?[]:p.parameterDescriptors.reduce((L,{name:X})=>({...L,[X]:new Float32Array(128)}),{});let q=!0;const G=()=>{_.numberOfOutputs>0&&k.disconnect(E);for(let L=0,X=0;L<_.numberOfOutputs;L+=1){const oe=D[L];for(let j=0;j<T[L];j+=1)E.disconnect(oe,X+j,j);X+=T[L]}},N=new Map;k.onaudioprocess=({inputBuffer:L,outputBuffer:X})=>{if(A!==null){const oe=h(Q);for(let j=0;j<O;j+=128){for(let $=0;$<_.numberOfInputs;$+=1)for(let ee=0;ee<_.channelCount;ee+=1)Aa(L,H[$],ee,ee,j);p.parameterDescriptors!==void 0&&p.parameterDescriptors.forEach(({name:$},ee)=>{Aa(L,F,$,y+ee,j)});for(let $=0;$<_.numberOfInputs;$+=1)for(let ee=0;ee<T[$];ee+=1)W[$][ee].byteLength===0&&(W[$][ee]=new Float32Array(128));try{const $=H.map((Y,ae)=>{if(oe[ae].size>0)return N.set(ae,O/128),Y;const ce=N.get(ae);return ce===void 0?[]:(Y.every(ie=>ie.every(ke=>ke===0))&&(ce===1?N.delete(ae):N.set(ae,ce-1)),Y)});q=u(f.currentTime+j/f.sampleRate,f.sampleRate,()=>A.process($,W,F));for(let Y=0,ae=0;Y<_.numberOfOutputs;Y+=1){for(let se=0;se<T[Y];se+=1)cp(X,W[Y],se,ae+se,j);ae+=T[Y]}}catch($){q=!1,Q.dispatchEvent(new ErrorEvent("processorerror",{colno:$.colno,filename:$.filename,lineno:$.lineno,message:$.message}))}if(!q){for(let $=0;$<_.numberOfInputs;$+=1){x[$].disconnect(w[$]);for(let ee=0;ee<_.channelCount;ee+=1)w[j].disconnect(C,ee,$*_.channelCount+ee)}if(p.parameterDescriptors!==void 0){const $=p.parameterDescriptors.length;for(let ee=0;ee<$;ee+=1){const Y=S[ee];Y.disconnect(C,0,y+ee),Y.stop()}}C.disconnect(k),k.onaudioprocess=null,te?G():Z();break}}}};let te=!1;const re=o(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),ne=()=>k.connect(re).connect(f.destination),Z=()=>{k.disconnect(re),re.disconnect()},Te=()=>{if(q){Z(),_.numberOfOutputs>0&&k.connect(E);for(let L=0,X=0;L<_.numberOfOutputs;L+=1){const oe=D[L];for(let j=0;j<T[L];j+=1)E.connect(oe,X+j,j);X+=T[L]}}te=!0},ve=()=>{q&&(ne(),G()),te=!1};return ne(),d(Q,Te,ve)},hp=(r,e)=>{const t=r.createBiquadFilter();return gt(t,e),rt(t,e,"Q"),rt(t,e,"detune"),rt(t,e,"frequency"),rt(t,e,"gain"),Ke(t,e,"type"),t},xT=(r,e)=>(t,n)=>{const s=t.createChannelMerger(n.numberOfInputs);return r!==null&&r.name==="webkitAudioContext"&&e(t,s),gt(s,n),s},wT=r=>{const e=r.numberOfOutputs;Object.defineProperty(r,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw xt()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw xt()}}),Object.defineProperty(r,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw xt()}})},So=(r,e)=>{const t=r.createChannelSplitter(e.numberOfOutputs);return gt(t,e),wT(t),t},ST=(r,e,t,n,s)=>(i,o)=>{if(i.createConstantSource===void 0)return t(i,o);const a=i.createConstantSource();return gt(a,o),rt(a,o,"offset"),e(n,()=>n(i))||uu(a),e(s,()=>s(i))||hu(a),r(i,a),a},sr=(r,e)=>(r.connect=e.connect.bind(e),r.disconnect=e.disconnect.bind(e),r),bT=(r,e,t,n)=>(s,{offset:i,...o})=>{const a=s.createBuffer(1,2,44100),c=e(s,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=t(s,{...o,gain:i}),u=a.getChannelData(0);u[0]=1,u[1]=1,c.buffer=a,c.loop=!0;const h={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(m){l.channelCount=m},get channelCountMode(){return l.channelCountMode},set channelCountMode(m){l.channelCountMode=m},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(m){l.channelInterpretation=m},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(m){c.onended=m},addEventListener(...m){return c.addEventListener(m[0],m[1],m[2])},dispatchEvent(...m){return c.dispatchEvent(m[0])},removeEventListener(...m){return c.removeEventListener(m[0],m[1],m[2])},start(m=0){c.start.call(c,m)},stop(m=0){c.stop.call(c,m)}},d=()=>c.connect(l),f=()=>c.disconnect(l);return r(s,c),n(sr(h,l),d,f)},CT=(r,e)=>(t,n)=>{const s=t.createConvolver();if(gt(s,n),n.disableNormalization===s.normalize&&(s.normalize=!n.disableNormalization),Ke(s,n,"buffer"),n.channelCount>2||(e(s,"channelCount",i=>()=>i.call(s),i=>o=>{if(o>2)throw r();return i.call(s,o)}),n.channelCountMode==="max"))throw r();return e(s,"channelCountMode",i=>()=>i.call(s),i=>o=>{if(o==="max")throw r();return i.call(s,o)}),s},dp=(r,e)=>{const t=r.createDelay(e.maxDelayTime);return gt(t,e),rt(t,e,"delayTime"),t},ET=r=>(e,t)=>{const n=e.createDynamicsCompressor();if(gt(n,t),t.channelCount>2||t.channelCountMode==="max")throw r();return rt(n,t,"attack"),rt(n,t,"knee"),rt(n,t,"ratio"),rt(n,t,"release"),rt(n,t,"threshold"),n},Zt=(r,e)=>{const t=r.createGain();return gt(t,e),rt(t,e,"gain"),t},OT=r=>(e,t,n)=>{if(e.createIIRFilter===void 0)return r(e,t,n);const s=e.createIIRFilter(n.feedforward,n.feedback);return gt(s,n),s};function AT(r,e){const t=e[0]*e[0]+e[1]*e[1];return[(r[0]*e[0]+r[1]*e[1])/t,(r[1]*e[0]-r[0]*e[1])/t]}function kT(r,e){return[r[0]*e[0]-r[1]*e[1],r[0]*e[1]+r[1]*e[0]]}function cd(r,e){let t=[0,0];for(let n=r.length-1;n>=0;n-=1)t=kT(t,e),t[0]+=r[n];return t}const DT=(r,e,t,n)=>(s,i,{channelCount:o,channelCountMode:a,channelInterpretation:c,feedback:l,feedforward:u})=>{const h=up(i,s.sampleRate),d=l instanceof Float64Array?l:new Float64Array(l),f=u instanceof Float64Array?u:new Float64Array(u),m=d.length,p=f.length,_=Math.min(m,p);if(m===0||m>20)throw n();if(d[0]===0)throw e();if(p===0||p>20)throw n();if(f[0]===0)throw e();if(d[0]!==1){for(let S=0;S<p;S+=1)f[S]/=d[0];for(let S=1;S<m;S+=1)d[S]/=d[0]}const T=t(s,h,o,o);T.channelCount=o,T.channelCountMode=a,T.channelInterpretation=c;const y=32,b=[],v=[],g=[];for(let S=0;S<o;S+=1){b.push(0);const C=new Float32Array(y),O=new Float32Array(y);C.fill(0),O.fill(0),v.push(C),g.push(O)}T.onaudioprocess=S=>{const C=S.inputBuffer,O=S.outputBuffer,k=C.numberOfChannels;for(let E=0;E<k;E+=1){const D=C.getChannelData(E),M=O.getChannelData(E);b[E]=lp(d,m,f,p,_,v[E],g[E],b[E],y,D,M)}};const x=s.sampleRate/2;return sr({get bufferSize(){return h},get channelCount(){return T.channelCount},set channelCount(S){T.channelCount=S},get channelCountMode(){return T.channelCountMode},set channelCountMode(S){T.channelCountMode=S},get channelInterpretation(){return T.channelInterpretation},set channelInterpretation(S){T.channelInterpretation=S},get context(){return T.context},get inputs(){return[T]},get numberOfInputs(){return T.numberOfInputs},get numberOfOutputs(){return T.numberOfOutputs},addEventListener(...S){return T.addEventListener(S[0],S[1],S[2])},dispatchEvent(...S){return T.dispatchEvent(S[0])},getFrequencyResponse(S,C,O){if(S.length!==C.length||C.length!==O.length)throw r();const k=S.length;for(let E=0;E<k;E+=1){const D=-Math.PI*(S[E]/x),M=[Math.cos(D),Math.sin(D)],U=cd(f,M),P=cd(d,M),V=AT(U,P);C[E]=Math.sqrt(V[0]*V[0]+V[1]*V[1]),O[E]=Math.atan2(V[1],V[0])}},removeEventListener(...S){return T.removeEventListener(S[0],S[1],S[2])}},T)},MT=(r,e)=>r.createMediaElementSource(e.mediaElement),RT=(r,e)=>{const t=r.createMediaStreamDestination();return gt(t,e),t.numberOfOutputs===1&&Object.defineProperty(t,"numberOfOutputs",{get:()=>0}),t},PT=(r,{mediaStream:e})=>{const t=e.getAudioTracks();t.sort((i,o)=>i.id<o.id?-1:i.id>o.id?1:0);const n=t.slice(0,1),s=r.createMediaStreamSource(new MediaStream(n));return Object.defineProperty(s,"mediaStream",{value:e}),s},UT=(r,e)=>(t,{mediaStreamTrack:n})=>{if(typeof t.createMediaStreamTrackSource=="function")return t.createMediaStreamTrackSource(n);const s=new MediaStream([n]),i=t.createMediaStreamSource(s);if(n.kind!=="audio")throw r();if(e(t))throw new TypeError;return i},IT=r=>r===null?null:r.hasOwnProperty("OfflineAudioContext")?r.OfflineAudioContext:r.hasOwnProperty("webkitOfflineAudioContext")?r.webkitOfflineAudioContext:null,FT=(r,e,t,n,s,i)=>(o,a)=>{const c=o.createOscillator();return gt(c,a),rt(c,a,"detune"),rt(c,a,"frequency"),a.periodicWave!==void 0?c.setPeriodicWave(a.periodicWave):Ke(c,a,"type"),e(t,()=>t(o))||uu(c),e(n,()=>n(o))||i(c,o),e(s,()=>s(o))||hu(c),r(o,c),c},NT=r=>(e,t)=>{const n=e.createPanner();return n.orientationX===void 0?r(e,t):(gt(n,t),rt(n,t,"orientationX"),rt(n,t,"orientationY"),rt(n,t,"orientationZ"),rt(n,t,"positionX"),rt(n,t,"positionY"),rt(n,t,"positionZ"),Ke(n,t,"coneInnerAngle"),Ke(n,t,"coneOuterAngle"),Ke(n,t,"coneOuterGain"),Ke(n,t,"distanceModel"),Ke(n,t,"maxDistance"),Ke(n,t,"panningModel"),Ke(n,t,"refDistance"),Ke(n,t,"rolloffFactor"),n)},LT=(r,e,t,n,s,i,o,a,c,l)=>(u,{coneInnerAngle:h,coneOuterAngle:d,coneOuterGain:f,distanceModel:m,maxDistance:p,orientationX:_,orientationY:T,orientationZ:y,panningModel:b,positionX:v,positionY:g,positionZ:x,refDistance:w,rolloffFactor:S,...C})=>{const O=u.createPanner();if(C.channelCount>2||C.channelCountMode==="max")throw o();gt(O,C);const k={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},E=t(u,{...k,channelInterpretation:"speakers",numberOfInputs:6}),D=n(u,{...C,gain:1}),M=n(u,{...k,gain:1}),U=n(u,{...k,gain:0}),P=n(u,{...k,gain:0}),V=n(u,{...k,gain:0}),Q=n(u,{...k,gain:0}),I=n(u,{...k,gain:0}),B=s(u,256,6,1),A=i(u,{...k,curve:new Float32Array([1,1]),oversample:"none"});let R=[_,T,y],H=[v,g,x];const W=new Float32Array(1);B.onaudioprocess=({inputBuffer:N})=>{const te=[c(N,W,0),c(N,W,1),c(N,W,2)];te.some((ne,Z)=>ne!==R[Z])&&(O.setOrientation(...te),R=te);const re=[c(N,W,3),c(N,W,4),c(N,W,5)];re.some((ne,Z)=>ne!==H[Z])&&(O.setPosition(...re),H=re)},Object.defineProperty(U.gain,"defaultValue",{get:()=>0}),Object.defineProperty(P.gain,"defaultValue",{get:()=>0}),Object.defineProperty(V.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Q.gain,"defaultValue",{get:()=>0}),Object.defineProperty(I.gain,"defaultValue",{get:()=>0});const F={get bufferSize(){},get channelCount(){return O.channelCount},set channelCount(N){if(N>2)throw o();D.channelCount=N,O.channelCount=N},get channelCountMode(){return O.channelCountMode},set channelCountMode(N){if(N==="max")throw o();D.channelCountMode=N,O.channelCountMode=N},get channelInterpretation(){return O.channelInterpretation},set channelInterpretation(N){D.channelInterpretation=N,O.channelInterpretation=N},get coneInnerAngle(){return O.coneInnerAngle},set coneInnerAngle(N){O.coneInnerAngle=N},get coneOuterAngle(){return O.coneOuterAngle},set coneOuterAngle(N){O.coneOuterAngle=N},get coneOuterGain(){return O.coneOuterGain},set coneOuterGain(N){if(N<0||N>1)throw e();O.coneOuterGain=N},get context(){return O.context},get distanceModel(){return O.distanceModel},set distanceModel(N){O.distanceModel=N},get inputs(){return[D]},get maxDistance(){return O.maxDistance},set maxDistance(N){if(N<0)throw new RangeError;O.maxDistance=N},get numberOfInputs(){return O.numberOfInputs},get numberOfOutputs(){return O.numberOfOutputs},get orientationX(){return M.gain},get orientationY(){return U.gain},get orientationZ(){return P.gain},get panningModel(){return O.panningModel},set panningModel(N){O.panningModel=N},get positionX(){return V.gain},get positionY(){return Q.gain},get positionZ(){return I.gain},get refDistance(){return O.refDistance},set refDistance(N){if(N<0)throw new RangeError;O.refDistance=N},get rolloffFactor(){return O.rolloffFactor},set rolloffFactor(N){if(N<0)throw new RangeError;O.rolloffFactor=N},addEventListener(...N){return D.addEventListener(N[0],N[1],N[2])},dispatchEvent(...N){return D.dispatchEvent(N[0])},removeEventListener(...N){return D.removeEventListener(N[0],N[1],N[2])}};h!==F.coneInnerAngle&&(F.coneInnerAngle=h),d!==F.coneOuterAngle&&(F.coneOuterAngle=d),f!==F.coneOuterGain&&(F.coneOuterGain=f),m!==F.distanceModel&&(F.distanceModel=m),p!==F.maxDistance&&(F.maxDistance=p),_!==F.orientationX.value&&(F.orientationX.value=_),T!==F.orientationY.value&&(F.orientationY.value=T),y!==F.orientationZ.value&&(F.orientationZ.value=y),b!==F.panningModel&&(F.panningModel=b),v!==F.positionX.value&&(F.positionX.value=v),g!==F.positionY.value&&(F.positionY.value=g),x!==F.positionZ.value&&(F.positionZ.value=x),w!==F.refDistance&&(F.refDistance=w),S!==F.rolloffFactor&&(F.rolloffFactor=S),(R[0]!==1||R[1]!==0||R[2]!==0)&&O.setOrientation(...R),(H[0]!==0||H[1]!==0||H[2]!==0)&&O.setPosition(...H);const q=()=>{D.connect(O),r(D,A,0,0),A.connect(M).connect(E,0,0),A.connect(U).connect(E,0,1),A.connect(P).connect(E,0,2),A.connect(V).connect(E,0,3),A.connect(Q).connect(E,0,4),A.connect(I).connect(E,0,5),E.connect(B).connect(u.destination)},G=()=>{D.disconnect(O),a(D,A,0,0),A.disconnect(M),M.disconnect(E),A.disconnect(U),U.disconnect(E),A.disconnect(P),P.disconnect(E),A.disconnect(V),V.disconnect(E),A.disconnect(Q),Q.disconnect(E),A.disconnect(I),I.disconnect(E),E.disconnect(B),B.disconnect(u.destination)};return l(sr(F,O),q,G)},BT=r=>(e,{disableNormalization:t,imag:n,real:s})=>{const i=n instanceof Float32Array?n:new Float32Array(n),o=s instanceof Float32Array?s:new Float32Array(s),a=e.createPeriodicWave(o,i,{disableNormalization:t});if(Array.from(n).length<2)throw r();return a},bo=(r,e,t,n)=>r.createScriptProcessor(e,t,n),zT=(r,e)=>(t,n)=>{const s=n.channelCountMode;if(s==="clamped-max")throw e();if(t.createStereoPanner===void 0)return r(t,n);const i=t.createStereoPanner();return gt(i,n),rt(i,n,"pan"),Object.defineProperty(i,"channelCountMode",{get:()=>s,set:o=>{if(o!==s)throw e()}}),i},VT=(r,e,t,n,s,i)=>{const a=new Float32Array([1,1]),c=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...l,oversample:"none"},h=(m,p,_,T)=>{const y=new Float32Array(16385),b=new Float32Array(16385);for(let C=0;C<16385;C+=1){const O=C/16384*c;y[C]=Math.cos(O),b[C]=Math.sin(O)}const v=t(m,{...l,gain:0}),g=n(m,{...u,curve:y}),x=n(m,{...u,curve:a}),w=t(m,{...l,gain:0}),S=n(m,{...u,curve:b});return{connectGraph(){p.connect(v),p.connect(x.inputs===void 0?x:x.inputs[0]),p.connect(w),x.connect(_),_.connect(g.inputs===void 0?g:g.inputs[0]),_.connect(S.inputs===void 0?S:S.inputs[0]),g.connect(v.gain),S.connect(w.gain),v.connect(T,0,0),w.connect(T,0,1)},disconnectGraph(){p.disconnect(v),p.disconnect(x.inputs===void 0?x:x.inputs[0]),p.disconnect(w),x.disconnect(_),_.disconnect(g.inputs===void 0?g:g.inputs[0]),_.disconnect(S.inputs===void 0?S:S.inputs[0]),g.disconnect(v.gain),S.disconnect(w.gain),v.disconnect(T,0,0),w.disconnect(T,0,1)}}},d=(m,p,_,T)=>{const y=new Float32Array(16385),b=new Float32Array(16385),v=new Float32Array(16385),g=new Float32Array(16385),x=Math.floor(16385/2);for(let V=0;V<16385;V+=1)if(V>x){const Q=(V-x)/(16384-x)*c;y[V]=Math.cos(Q),b[V]=Math.sin(Q),v[V]=0,g[V]=1}else{const Q=V/(16384-x)*c;y[V]=1,b[V]=0,v[V]=Math.cos(Q),g[V]=Math.sin(Q)}const w=e(m,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),S=t(m,{...l,gain:0}),C=n(m,{...u,curve:y}),O=t(m,{...l,gain:0}),k=n(m,{...u,curve:b}),E=n(m,{...u,curve:a}),D=t(m,{...l,gain:0}),M=n(m,{...u,curve:v}),U=t(m,{...l,gain:0}),P=n(m,{...u,curve:g});return{connectGraph(){p.connect(w),p.connect(E.inputs===void 0?E:E.inputs[0]),w.connect(S,0),w.connect(O,0),w.connect(D,1),w.connect(U,1),E.connect(_),_.connect(C.inputs===void 0?C:C.inputs[0]),_.connect(k.inputs===void 0?k:k.inputs[0]),_.connect(M.inputs===void 0?M:M.inputs[0]),_.connect(P.inputs===void 0?P:P.inputs[0]),C.connect(S.gain),k.connect(O.gain),M.connect(D.gain),P.connect(U.gain),S.connect(T,0,0),D.connect(T,0,0),O.connect(T,0,1),U.connect(T,0,1)},disconnectGraph(){p.disconnect(w),p.disconnect(E.inputs===void 0?E:E.inputs[0]),w.disconnect(S,0),w.disconnect(O,0),w.disconnect(D,1),w.disconnect(U,1),E.disconnect(_),_.disconnect(C.inputs===void 0?C:C.inputs[0]),_.disconnect(k.inputs===void 0?k:k.inputs[0]),_.disconnect(M.inputs===void 0?M:M.inputs[0]),_.disconnect(P.inputs===void 0?P:P.inputs[0]),C.disconnect(S.gain),k.disconnect(O.gain),M.disconnect(D.gain),P.disconnect(U.gain),S.disconnect(T,0,0),D.disconnect(T,0,0),O.disconnect(T,0,1),U.disconnect(T,0,1)}}},f=(m,p,_,T,y)=>{if(p===1)return h(m,_,T,y);if(p===2)return d(m,_,T,y);throw s()};return(m,{channelCount:p,channelCountMode:_,pan:T,...y})=>{if(_==="max")throw s();const b=r(m,{...y,channelCount:1,channelCountMode:_,numberOfInputs:2}),v=t(m,{...y,channelCount:p,channelCountMode:_,gain:1}),g=t(m,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:T});let{connectGraph:x,disconnectGraph:w}=f(m,p,v,g,b);Object.defineProperty(g.gain,"defaultValue",{get:()=>0}),Object.defineProperty(g.gain,"maxValue",{get:()=>1}),Object.defineProperty(g.gain,"minValue",{get:()=>-1});const S={get bufferSize(){},get channelCount(){return v.channelCount},set channelCount(E){v.channelCount!==E&&(C&&w(),{connectGraph:x,disconnectGraph:w}=f(m,E,v,g,b),C&&x()),v.channelCount=E},get channelCountMode(){return v.channelCountMode},set channelCountMode(E){if(E==="clamped-max"||E==="max")throw s();v.channelCountMode=E},get channelInterpretation(){return v.channelInterpretation},set channelInterpretation(E){v.channelInterpretation=E},get context(){return v.context},get inputs(){return[v]},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},get pan(){return g.gain},addEventListener(...E){return v.addEventListener(E[0],E[1],E[2])},dispatchEvent(...E){return v.dispatchEvent(E[0])},removeEventListener(...E){return v.removeEventListener(E[0],E[1],E[2])}};let C=!1;const O=()=>{x(),C=!0},k=()=>{w(),C=!1};return i(sr(S,b),O,k)}},GT=(r,e,t,n,s,i,o)=>(a,c)=>{const l=a.createWaveShaper();if(i!==null&&i.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return t(a,c);gt(l,c);const u=c.curve===null||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(u!==null&&u.length<2)throw e();Ke(l,{curve:u},"curve"),Ke(l,c,"oversample");let h=null,d=!1;return o(l,"curve",p=>()=>p.call(l),p=>_=>(p.call(l,_),d&&(n(_)&&h===null?h=r(a,l):!n(_)&&h!==null&&(h(),h=null)),_)),s(l,()=>{d=!0,n(l.curve)&&(h=r(a,l))},()=>{d=!1,h!==null&&(h(),h=null)})},WT=(r,e,t,n,s)=>(i,{curve:o,oversample:a,...c})=>{const l=i.createWaveShaper(),u=i.createWaveShaper();gt(l,c),gt(u,c);const h=t(i,{...c,gain:1}),d=t(i,{...c,gain:-1}),f=t(i,{...c,gain:1}),m=t(i,{...c,gain:-1});let p=null,_=!1,T=null;const y={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(g){h.channelCount=g,d.channelCount=g,l.channelCount=g,f.channelCount=g,u.channelCount=g,m.channelCount=g},get channelCountMode(){return l.channelCountMode},set channelCountMode(g){h.channelCountMode=g,d.channelCountMode=g,l.channelCountMode=g,f.channelCountMode=g,u.channelCountMode=g,m.channelCountMode=g},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(g){h.channelInterpretation=g,d.channelInterpretation=g,l.channelInterpretation=g,f.channelInterpretation=g,u.channelInterpretation=g,m.channelInterpretation=g},get context(){return l.context},get curve(){return T},set curve(g){if(g!==null&&g.length<2)throw e();if(g===null)l.curve=g,u.curve=g;else{const x=g.length,w=new Float32Array(x+2-x%2),S=new Float32Array(x+2-x%2);w[0]=g[0],S[0]=-g[x-1];const C=Math.ceil((x+1)/2),O=(x+1)/2-1;for(let k=1;k<C;k+=1){const E=k/C*O,D=Math.floor(E),M=Math.ceil(E);w[k]=D===M?g[D]:(1-(E-D))*g[D]+(1-(M-E))*g[M],S[k]=D===M?-g[x-1-D]:-((1-(E-D))*g[x-1-D])-(1-(M-E))*g[x-1-M]}w[C]=x%2===1?g[C-1]:(g[C-2]+g[C-1])/2,l.curve=w,u.curve=S}T=g,_&&(n(T)&&p===null?p=r(i,h):p!==null&&(p(),p=null))},get inputs(){return[h]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(g){l.oversample=g,u.oversample=g},addEventListener(...g){return h.addEventListener(g[0],g[1],g[2])},dispatchEvent(...g){return h.dispatchEvent(g[0])},removeEventListener(...g){return h.removeEventListener(g[0],g[1],g[2])}};o!==null&&(y.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==y.oversample&&(y.oversample=a);const b=()=>{h.connect(l).connect(f),h.connect(d).connect(u).connect(m).connect(f),_=!0,n(T)&&(p=r(i,h))},v=()=>{h.disconnect(l),l.disconnect(f),h.disconnect(d),d.disconnect(u),u.disconnect(m),m.disconnect(f),_=!1,p!==null&&(p(),p=null)};return s(sr(y,f),b,v)},Lt=()=>new DOMException("","NotSupportedError"),HT={numberOfChannels:1},qT=(r,e,t,n,s)=>class extends r{constructor(o,a,c){let l;if(typeof o=="number"&&a!==void 0&&c!==void 0)l={length:a,numberOfChannels:o,sampleRate:c};else if(typeof o=="object")l=o;else throw new Error("The given parameters are not valid.");const{length:u,numberOfChannels:h,sampleRate:d}={...HT,...l},f=n(h,u,d);e(Kr,()=>Kr(f))||f.addEventListener("statechange",(()=>{let m=0;const p=_=>{this._state==="running"&&(m>0?(f.removeEventListener("statechange",p),_.stopImmediatePropagation(),this._waitForThePromiseToSettle(_)):m+=1)};return p})()),super(f,h),this._length=u,this._nativeOfflineAudioContext=f,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(t()):(this._state="running",s(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,sp(this)}))}_waitForThePromiseToSettle(o){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(o):setTimeout(()=>this._waitForThePromiseToSettle(o))}},jT={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},YT=(r,e,t,n,s,i,o)=>class extends r{constructor(c,l){const u=s(c),h={...jT,...l},d=t(u,h),f=i(u),m=f?n():null,p=c.sampleRate/2;super(c,!1,d,m),this._detune=e(this,f,d.detune,153600,-153600),this._frequency=e(this,f,d.frequency,p,-p),this._nativeOscillatorNode=d,this._onended=null,this._oscillatorNodeRenderer=m,this._oscillatorNodeRenderer!==null&&h.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=h.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?o(this,c):null;this._nativeOscillatorNode.onended=l;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===l?c:u}get type(){return this._nativeOscillatorNode.type}set type(c){this._nativeOscillatorNode.type=c,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(c){this._nativeOscillatorNode.setPeriodicWave(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=c)}start(c=0){if(this._nativeOscillatorNode.start(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=c),this.context.state!=="closed"){Zi(this);const l=()=>{this._nativeOscillatorNode.removeEventListener("ended",l),ns(this)&&To(this)};this._nativeOscillatorNode.addEventListener("ended",l)}}stop(c=0){this._nativeOscillatorNode.stop(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=c)}},XT=(r,e,t,n,s)=>()=>{const i=new WeakMap;let o=null,a=null,c=null;const l=async(u,h)=>{let d=t(u);const f=Mt(d,h);if(!f){const m={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,detune:d.detune.value,frequency:d.frequency.value,periodicWave:o===null?void 0:o,type:d.type};d=e(h,m),a!==null&&d.start(a),c!==null&&d.stop(c)}return i.set(h,d),f?(await r(h,u.detune,d.detune),await r(h,u.frequency,d.frequency)):(await n(h,u.detune,d.detune),await n(h,u.frequency,d.frequency)),await s(u,h,d),d};return{set periodicWave(u){o=u},set start(u){a=u},set stop(u){c=u},render(u,h){const d=i.get(h);return d!==void 0?Promise.resolve(d):l(u,h)}}},ZT={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},QT=(r,e,t,n,s,i,o)=>class extends r{constructor(c,l){const u=s(c),h={...ZT,...l},d=t(u,h),f=i(u),m=f?n():null;super(c,!1,d,m),this._nativePannerNode=d,this._orientationX=e(this,f,d.orientationX,Ut,Gt),this._orientationY=e(this,f,d.orientationY,Ut,Gt),this._orientationZ=e(this,f,d.orientationZ,Ut,Gt),this._positionX=e(this,f,d.positionX,Ut,Gt),this._positionY=e(this,f,d.positionY,Ut,Gt),this._positionZ=e(this,f,d.positionZ,Ut,Gt),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(c){this._nativePannerNode.coneInnerAngle=c}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(c){this._nativePannerNode.coneOuterAngle=c}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(c){this._nativePannerNode.coneOuterGain=c}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(c){this._nativePannerNode.distanceModel=c}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(c){this._nativePannerNode.maxDistance=c}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(c){this._nativePannerNode.panningModel=c}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(c){this._nativePannerNode.refDistance=c}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(c){this._nativePannerNode.rolloffFactor=c}},KT=(r,e,t,n,s,i,o,a,c,l)=>()=>{const u=new WeakMap;let h=null;const d=async(f,m)=>{let p=null,_=i(f);const T={channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation},y={...T,coneInnerAngle:_.coneInnerAngle,coneOuterAngle:_.coneOuterAngle,coneOuterGain:_.coneOuterGain,distanceModel:_.distanceModel,maxDistance:_.maxDistance,panningModel:_.panningModel,refDistance:_.refDistance,rolloffFactor:_.rolloffFactor},b=Mt(_,m);if("bufferSize"in _)p=n(m,{...T,gain:1});else if(!b){const v={...y,orientationX:_.orientationX.value,orientationY:_.orientationY.value,orientationZ:_.orientationZ.value,positionX:_.positionX.value,positionY:_.positionY.value,positionZ:_.positionZ.value};_=s(m,v)}if(u.set(m,p===null?_:p),p!==null){if(h===null){if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");const k=new o(6,f.context.length,m.sampleRate),E=e(k,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});E.connect(k.destination),h=(async()=>{const D=await Promise.all([f.orientationX,f.orientationY,f.orientationZ,f.positionX,f.positionY,f.positionZ].map(async(M,U)=>{const P=t(k,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:U===0?1:0});return await a(k,M,P.offset),P}));for(let M=0;M<6;M+=1)D[M].connect(E,0,M),D[M].start(0);return l(k)})()}const v=await h,g=n(m,{...T,gain:1});await c(f,m,g);const x=[];for(let k=0;k<v.numberOfChannels;k+=1)x.push(v.getChannelData(k));let w=[x[0][0],x[1][0],x[2][0]],S=[x[3][0],x[4][0],x[5][0]],C=n(m,{...T,gain:1}),O=s(m,{...y,orientationX:w[0],orientationY:w[1],orientationZ:w[2],positionX:S[0],positionY:S[1],positionZ:S[2]});g.connect(C).connect(O.inputs[0]),O.connect(p);for(let k=128;k<v.length;k+=128){const E=[x[0][k],x[1][k],x[2][k]],D=[x[3][k],x[4][k],x[5][k]];if(E.some((M,U)=>M!==w[U])||D.some((M,U)=>M!==S[U])){w=E,S=D;const M=k/m.sampleRate;C.gain.setValueAtTime(0,M),C=n(m,{...T,gain:0}),O=s(m,{...y,orientationX:w[0],orientationY:w[1],orientationZ:w[2],positionX:S[0],positionY:S[1],positionZ:S[2]}),C.gain.setValueAtTime(1,M),g.connect(C).connect(O.inputs[0]),O.connect(p)}}return p}return b?(await r(m,f.orientationX,_.orientationX),await r(m,f.orientationY,_.orientationY),await r(m,f.orientationZ,_.orientationZ),await r(m,f.positionX,_.positionX),await r(m,f.positionY,_.positionY),await r(m,f.positionZ,_.positionZ)):(await a(m,f.orientationX,_.orientationX),await a(m,f.orientationY,_.orientationY),await a(m,f.orientationZ,_.orientationZ),await a(m,f.positionX,_.positionX),await a(m,f.positionY,_.positionY),await a(m,f.positionZ,_.positionZ)),nr(_)?await c(f,m,_.inputs[0]):await c(f,m,_),_};return{render(f,m){const p=u.get(m);return p!==void 0?Promise.resolve(p):d(f,m)}}},JT={disableNormalization:!1},$T=(r,e,t,n)=>class fp{constructor(i,o){const a=e(i),c=n({...JT,...o}),l=r(a,c);return t.add(l),l}static[Symbol.hasInstance](i){return i!==null&&typeof i=="object"&&Object.getPrototypeOf(i)===fp.prototype||t.has(i)}},ex=(r,e)=>(t,n,s)=>(r(n).replay(s),e(n,t,s)),tx=(r,e,t)=>async(n,s,i)=>{const o=r(n);await Promise.all(o.activeInputs.map((a,c)=>Array.from(a).map(async([l,u])=>{const d=await e(l).render(l,s),f=n.context.destination;!t(l)&&(n!==f||!t(n))&&d.connect(i,u,c)})).reduce((a,c)=>[...a,...c],[]))},nx=(r,e,t)=>async(n,s,i)=>{const o=e(n);await Promise.all(Array.from(o.activeInputs).map(async([a,c])=>{const u=await r(a).render(a,s);t(a)||u.connect(i,c)}))},sx=(r,e,t,n)=>s=>r(Kr,()=>Kr(s))?Promise.resolve(r(n,n)).then(i=>{if(!i){const o=t(s,512,0,1);s.oncomplete=()=>{o.onaudioprocess=null,o.disconnect()},o.onaudioprocess=()=>s.currentTime,o.connect(s.destination)}return s.startRendering()}):new Promise(i=>{const o=e(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});s.oncomplete=a=>{o.disconnect(),i(a.renderedBuffer)},o.connect(s.destination),s.startRendering()}),ix=r=>(e,t)=>{r.set(e,t)},rx=r=>(e,t)=>r.set(e,t),ox=(r,e,t,n,s,i,o,a)=>(c,l)=>t(c).render(c,l).then(()=>Promise.all(Array.from(n(l)).map(u=>t(u).render(u,l)))).then(()=>s(l)).then(u=>(typeof u.copyFromChannel!="function"?(o(u),au(u)):e(i,()=>i(u))||a(u),r.add(u),u)),ax={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},cx=(r,e,t,n,s,i)=>class extends r{constructor(a,c){const l=s(a),u={...ax,...c},h=t(l,u),d=i(l),f=d?n():null;super(a,!1,h,f),this._pan=e(this,d,h.pan)}get pan(){return this._pan}},lx=(r,e,t,n,s)=>()=>{const i=new WeakMap,o=async(a,c)=>{let l=t(a);const u=Mt(l,c);if(!u){const h={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=e(c,h)}return i.set(c,l),u?await r(c,a.pan,l.pan):await n(c,a.pan,l.pan),nr(l)?await s(a,c,l.inputs[0]):await s(a,c,l),l};return{render(a,c){const l=i.get(c);return l!==void 0?Promise.resolve(l):o(a,c)}}},ux=r=>()=>{if(r===null)return!1;try{new r({length:1,sampleRate:44100})}catch{return!1}return!0},hx=(r,e)=>async()=>{if(r===null)return!0;if(e===null)return!1;const t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),n=new e(1,128,44100),s=URL.createObjectURL(t);let i=!1,o=!1;try{await n.audioWorklet.addModule(s);const a=new r(n,"a",{numberOfOutputs:0}),c=n.createOscillator();a.port.onmessage=()=>i=!0,a.onprocessorerror=()=>o=!0,c.connect(a),c.start(0),await n.startRendering(),await new Promise(l=>setTimeout(l))}catch{}finally{URL.revokeObjectURL(s)}return i&&!o},dx=(r,e)=>()=>{if(e===null)return Promise.resolve(!1);const t=new e(1,1,44100),n=r(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(s=>{t.oncomplete=()=>{n.disconnect(),s(t.currentTime!==0)},t.startRendering()})},fx=()=>new DOMException("","UnknownError"),px={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},mx=(r,e,t,n,s,i,o)=>class extends r{constructor(c,l){const u=s(c),h={...px,...l},d=t(u,h),m=i(u)?n():null;super(c,!0,d,m),this._isCurveNullified=!1,this._nativeWaveShaperNode=d,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(c){if(c===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(c.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=c}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(c){this._nativeWaveShaperNode.oversample=c}},_x=(r,e,t)=>()=>{const n=new WeakMap,s=async(i,o)=>{let a=e(i);if(!Mt(a,o)){const l={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=r(o,l)}return n.set(o,a),nr(a)?await t(i,o,a.inputs[0]):await t(i,o,a),a};return{render(i,o){const a=n.get(o);return a!==void 0?Promise.resolve(a):s(i,o)}}},gx=()=>typeof window>"u"?null:window,vx=(r,e)=>t=>{t.copyFromChannel=(n,s,i=0)=>{const o=r(i),a=r(s);if(a>=t.numberOfChannels)throw e();const c=t.length,l=t.getChannelData(a),u=n.length;for(let h=o<0?-o:0;h+o<c&&h<u;h+=1)n[h]=l[h+o]},t.copyToChannel=(n,s,i=0)=>{const o=r(i),a=r(s);if(a>=t.numberOfChannels)throw e();const c=t.length,l=t.getChannelData(a),u=n.length;for(let h=o<0?-o:0;h+o<c&&h<u;h+=1)l[h+o]=n[h]}},yx=r=>e=>{e.copyFromChannel=(t=>(n,s,i=0)=>{const o=r(i),a=r(s);if(o<e.length)return t.call(e,n,a,o)})(e.copyFromChannel),e.copyToChannel=(t=>(n,s,i=0)=>{const o=r(i),a=r(s);if(o<e.length)return t.call(e,n,a,o)})(e.copyToChannel)},Tx=r=>(e,t)=>{const n=t.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=n),r(e,"buffer",s=>()=>{const i=s.call(e);return i===n?null:i},s=>i=>s.call(e,i===null?n:i))},xx=(r,e)=>(t,n)=>{n.channelCount=1,n.channelCountMode="explicit",Object.defineProperty(n,"channelCount",{get:()=>1,set:()=>{throw r()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:()=>{throw r()}});const s=t.createBufferSource();e(n,()=>{const a=n.numberOfInputs;for(let c=0;c<a;c+=1)s.connect(n,0,c)},()=>s.disconnect(n))},pp=(r,e,t)=>r.copyFromChannel===void 0?r.getChannelData(t)[0]:(r.copyFromChannel(e,t),e[0]),mp=r=>{if(r===null)return!1;const e=r.length;return e%2!==0?r[Math.floor(e/2)]!==0:r[e/2-1]+r[e/2]!==0},Co=(r,e,t,n)=>{let s=r;for(;!s.hasOwnProperty(e);)s=Object.getPrototypeOf(s);const{get:i,set:o}=Object.getOwnPropertyDescriptor(s,e);Object.defineProperty(r,e,{get:t(i),set:n(o)})},wx=r=>({...r,outputChannelCount:r.outputChannelCount!==void 0?r.outputChannelCount:r.numberOfInputs===1&&r.numberOfOutputs===1?[r.channelCount]:Array.from({length:r.numberOfOutputs},()=>1)}),Sx=r=>({...r,channelCount:r.numberOfOutputs}),bx=r=>{const{imag:e,real:t}=r;return e===void 0?t===void 0?{...r,imag:[0,0],real:[0,0]}:{...r,imag:Array.from(t,()=>0),real:t}:t===void 0?{...r,imag:e,real:Array.from(e,()=>0)}:{...r,imag:e,real:t}},_p=(r,e,t)=>{try{r.setValueAtTime(e,t)}catch(n){if(n.code!==9)throw n;_p(r,e,t+1e-7)}},Cx=r=>{const e=r.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},Ex=r=>{const e=r.createBufferSource(),t=r.createBuffer(1,1,44100);e.buffer=t;try{e.start(0,1)}catch{return!1}return!0},Ox=r=>{const e=r.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},du=r=>{const e=r.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},gp=r=>{const e=r.createBuffer(1,1,44100),t=r.createBufferSource();t.buffer=e,t.start(),t.stop();try{return t.stop(),!0}catch{return!1}},fu=r=>{const e=r.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},Ax=r=>{const{port1:e,port2:t}=new MessageChannel;try{e.postMessage(r)}finally{e.close(),t.close()}},kx=r=>{r.start=(e=>(t=0,n=0,s)=>{const i=r.buffer,o=i===null?n:Math.min(i.duration,n);i!==null&&o>i.duration-.5/r.context.sampleRate?e.call(r,t,0,0):e.call(r,t,o,s)})(r.start)},vp=(r,e)=>{const t=e.createGain();r.connect(t);const n=(s=>()=>{s.call(r,t),r.removeEventListener("ended",n)})(r.disconnect);r.addEventListener("ended",n),sr(r,t),r.stop=(s=>{let i=!1;return(o=0)=>{if(i)try{s.call(r,o)}catch{t.gain.setValueAtTime(0,o)}else s.call(r,o),i=!0}})(r.stop)},ir=(r,e)=>t=>{const n={value:r};return Object.defineProperties(t,{currentTarget:n,target:n}),typeof e=="function"?e.call(r,t):e.handleEvent.call(r,t)},Dx=Q0(di),Mx=ny(di),Rx=p1(Ja),yp=new WeakMap,Px=R1(yp),Rn=Hy(new Map,new WeakMap),Gn=gx(),Tp=cT(Rn,Hn),pu=M1(Ft),Ct=tx(Ft,pu,oi),Ux=ay(Tp,Ze,Ct),qe=I1(Ka),us=IT(Gn),Ne=J1(us),xp=new WeakMap,wp=b1(ir),Eo=dT(Gn),mu=X1(Eo),_u=Z1(Gn),Sp=Q1(Gn),Jr=pT(Gn),ft=Ry(K0(Qf),ty(Dx,Mx,Ca,Rx,Ea,Ft,Px,yo,Ze,di,ns,oi,ua),Rn,W1(Cl,Ea,Ft,Ze,Qr,ns),Hn,$a,Lt,u1(Ca,Cl,Ft,Ze,Qr,qe,ns,Ne),g1(xp,Ft,kn),wp,qe,mu,_u,Sp,Ne,Jr),Ix=oy(ft,Ux,Hn,Tp,qe,Ne),gu=new WeakSet,ld=lT(Gn),bp=s1(new Uint32Array(1)),vu=vx(bp,Hn),yu=yx(bp),Cp=ly(gu,Rn,Lt,ld,us,ux(ld),vu,yu),ec=sy(Zt),Ep=nx(pu,xo,oi),qn=Ky(Ep),rr=hT(ec,Rn,Cx,Ex,Ox,du,gp,fu,kx,Tx(Co),vp),jn=ex(P1(xo),Ep),Fx=dy(qn,rr,Ze,jn,Ct),Pn=Py(J0(Kf),xp,ou,Uy,H0,q0,j0,Y0,X0,wl,Xf,Eo,_p),Nx=hy(ft,Fx,Pn,xt,rr,qe,Ne,ir),Lx=xy(ft,wy,Hn,xt,fT(Zt,Co),qe,Ne,Ct),Bx=Wy(qn,hp,Ze,jn,Ct),fi=rx(yp),zx=Gy(ft,Pn,Bx,$a,hp,qe,Ne,fi),Ns=oT(di,_u),Vx=xx(xt,Ns),Ls=xT(Eo,Vx),Gx=Yy(Ls,Ze,Ct),Wx=jy(ft,Gx,Ls,qe,Ne),Hx=Qy(So,Ze,Ct),qx=Zy(ft,Hx,So,qe,Ne,Sx),jx=bT(ec,rr,Zt,Ns),or=ST(ec,Rn,jx,du,fu),Yx=n1(qn,or,Ze,jn,Ct),Xx=t1(ft,Pn,Yx,or,qe,Ne,ir),Op=CT(Lt,Co),Zx=o1(Op,Ze,Ct),Qx=r1(ft,Zx,Op,qe,Ne,fi),Kx=f1(qn,dp,Ze,jn,Ct),Jx=d1(ft,Pn,Kx,dp,qe,Ne,fi),Ap=ET(Lt),$x=x1(qn,Ap,Ze,jn,Ct),ew=T1(ft,Pn,$x,Ap,Lt,qe,Ne,fi),tw=k1(qn,Zt,Ze,jn,Ct),nw=A1(ft,Pn,tw,Zt,qe,Ne),sw=DT($a,xt,bo,Lt),tc=sx(Rn,Zt,bo,dx(Zt,us)),iw=G1(rr,Ze,us,Ct,tc),rw=OT(sw),ow=z1(ft,rw,iw,qe,Ne,fi),aw=Sy(Pn,Ls,or,bo,Lt,pp,Ne,Co),kp=new WeakMap,cw=rT(Lx,aw,wp,Ne,kp,ir),Dp=FT(ec,Rn,du,gp,fu,vp),lw=XT(qn,Dp,Ze,jn,Ct),uw=YT(ft,Pn,Dp,lw,qe,Ne,ir),Mp=$y(rr),hw=WT(Mp,xt,Zt,mp,Ns),nc=GT(Mp,xt,hw,mp,Ns,Eo,Co),dw=LT(Ca,xt,Ls,Zt,bo,nc,Lt,Ea,pp,Ns),Rp=NT(dw),fw=KT(qn,Ls,or,Zt,Rp,Ze,us,jn,Ct,tc),pw=QT(ft,Pn,Rp,fw,qe,Ne,fi),mw=BT(Hn),_w=$T(mw,qe,new WeakSet,bx),gw=VT(Ls,So,Zt,nc,Lt,Ns),Pp=zT(gw,Lt),vw=lx(qn,Pp,Ze,jn,Ct),yw=cx(ft,Pn,Pp,vw,qe,Ne),Tw=_x(nc,Ze,Ct),xw=mx(ft,xt,nc,Tw,qe,Ne,fi),Up=$1(Gn),Tu=C1(Gn),Ip=new WeakMap,ww=F1(Ip,us),Sw=Up?ey(Rn,Lt,S1(Gn),Tu,E1(Z0),qe,ww,Ne,Jr,new WeakMap,new WeakMap,hx(Jr,us),Gn):void 0,bw=K1(mu,Ne),Cw=l1(gu,Rn,c1,w1,new WeakSet,qe,bw,Sa,Kr,vu,yu),Fp=zy(Sw,Ix,Cp,Nx,zx,Wx,qx,Xx,Qx,Cw,Jx,ew,nw,ow,cw,uw,pw,_w,yw,xw),Ew=eT(ft,MT,qe,Ne),Ow=nT(ft,RT,qe,Ne),Aw=sT(ft,PT,qe,Ne),kw=UT(xt,Ne),Dw=iT(ft,kw,qe),Mw=Ty(Fp,xt,Lt,fx,Ew,Ow,Aw,Dw,Eo),xu=N1(kp),Rw=iy(xu),Np=Jy(Hn),Pw=m1(xu),Lp=v1(Hn),Bp=new WeakMap,Uw=D1(Bp,kn),Iw=TT(Np,Hn,xt,Ls,So,or,Zt,bo,Lt,Lp,Tu,Uw,Ns),Fw=_T(xt,Iw,Zt,Lt,Ns),Nw=By(qn,Np,rr,Ls,So,or,Zt,Pw,Lp,Tu,Ze,Jr,us,jn,Ct,tc),Lw=U1(Ip),Bw=ix(Bp),ud=Up?Fy(Rw,ft,Pn,Nw,Fw,Ft,Lw,qe,Ne,Jr,wx,Bw,Ax,ir):void 0,zw=a1(Lt,us),Vw=ox(gu,Rn,pu,xu,tc,Sa,vu,yu),Gw=qT(Fp,Rn,xt,zw,Vw),Ww=H1(Ka,mu),Hw=q1(ru,_u),qw=j1(ou,Sp),jw=Y1(Ka,Ne);function sn(r){return typeof r>"u"}function Ce(r){return!sn(r)}function Yw(r){return typeof r=="function"}function Ms(r){return typeof r=="number"}function ni(r){return Object.prototype.toString.call(r)==="[object Object]"&&r.constructor===Object}function Xw(r){return typeof r=="boolean"}function An(r){return Array.isArray(r)}function os(r){return typeof r=="string"}function sa(r){return os(r)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(r)}function _e(r,e){if(!r)throw new Error(e)}function Dn(r,e,t=1/0){if(!(e<=r&&r<=t))throw new RangeError(`Value must be within [${e}, ${t}], got: ${r}`)}function zp(r){!r.isOffline&&r.state!=="running"&&wu('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let Vp=!1,hd=!1;function dd(r){Vp=r}function Zw(r){sn(r)&&Vp&&!hd&&(hd=!0,wu("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing"))}let Gp=console;function Qw(...r){Gp.log(...r)}function wu(...r){Gp.warn(...r)}function Kw(r){return new Mw(r)}function Jw(r,e,t){return new Gw(r,e,t)}const si=typeof self=="object"?self:null,$w=si&&(si.hasOwnProperty("AudioContext")||si.hasOwnProperty("webkitAudioContext"));function eS(r,e,t){return _e(Ce(ud),"This node only works in a secure context (https or localhost)"),new ud(r,e,t)}class tS{constructor(e,t,n,s){this._callback=e,this._type=t,this._minimumUpdateInterval=Math.max(128/(s||44100),.001),this.updateInterval=n,this._createClock()}_createWorker(){const e=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),t=URL.createObjectURL(e),n=new Worker(t);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){var t;this._updateInterval=Math.max(e,this._minimumUpdateInterval),this._type==="worker"&&((t=this._worker)===null||t===void 0||t.postMessage(this._updateInterval*1e3))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}}function ai(r){return qw(r)}function As(r){return Hw(r)}function ha(r){return jw(r)}function Oi(r){return Ww(r)}function nS(r){return r instanceof Cp}function sS(r,e){return r==="value"||ai(e)||As(e)||nS(e)}function Li(r,...e){if(!e.length)return r;const t=e.shift();if(ni(r)&&ni(t))for(const n in t)sS(n,t[n])?r[n]=t[n]:ni(t[n])?(r[n]||Object.assign(r,{[n]:{}}),Li(r[n],t[n])):Object.assign(r,{[n]:t[n]});return Li(r,...e)}function iS(r,e){return r.length===e.length&&r.every((t,n)=>e[n]===t)}function K(r,e,t=[],n){const s={},i=Array.from(e);if(ni(i[0])&&n&&!Reflect.has(i[0],n)&&(Object.keys(i[0]).some(a=>Reflect.has(r,a))||(Li(s,{[n]:i[0]}),t.splice(t.indexOf(n),1),i.shift())),i.length===1&&ni(i[0]))Li(s,i[0]);else for(let o=0;o<t.length;o++)Ce(i[o])&&(s[t[o]]=i[o]);return Li(r,s)}function rS(r){return r.constructor.getDefaults()}function Bi(r,e){return sn(r)?e:r}function Pi(r,e){return e.forEach(t=>{Reflect.has(r,t)&&delete r[t]}),r}/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2019 Yotam Mann
 */class hs{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...e){(this.debug||si&&this.toString()===si.TONE_DEBUG_CLASS)&&Qw(this,...e)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}hs.version=Yf;const Su=1e-6;function Qi(r,e){return r>e+Su}function Dl(r,e){return Qi(r,e)||bn(r,e)}function Da(r,e){return r+Su<e}function bn(r,e){return Math.abs(r-e)<Su}function oS(r,e,t){return Math.max(Math.min(r,t),e)}class mn extends hs{constructor(){super(),this.name="Timeline",this._timeline=[];const e=K(mn.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(_e(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){const t=this._timeline[this.length-1];_e(Dl(e.time,t.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{const t=this._search(e.time);this._timeline.splice(t+1,0,e)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(e){const t=this._timeline.indexOf(e);return t!==-1&&this._timeline.splice(t,1),this}get(e,t="time"){const n=this._search(e,t);return n!==-1?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,t="time"){const n=this._search(e,t);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(e){const t=this._timeline.length;if(t>0&&this._timeline[t-1].time<e)return this._timeline[t-1];const n=this._search(e);return n-1>=0?this._timeline[n-1]:null}cancel(e){if(this._timeline.length>1){let t=this._search(e);if(t>=0)if(bn(this._timeline[t].time,e)){for(let n=t;n>=0&&bn(this._timeline[n].time,e);n--)t=n;this._timeline=this._timeline.slice(0,t)}else this._timeline=this._timeline.slice(0,t+1);else this._timeline=[]}else this._timeline.length===1&&Dl(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){const t=this._search(e);return t>=0&&(this._timeline=this._timeline.slice(t+1)),this}previousEvent(e){const t=this._timeline.indexOf(e);return t>0?this._timeline[t-1]:null}_search(e,t="time"){if(this._timeline.length===0)return-1;let n=0;const s=this._timeline.length;let i=s;if(s>0&&this._timeline[s-1][t]<=e)return s-1;for(;n<i;){let o=Math.floor(n+(i-n)/2);const a=this._timeline[o],c=this._timeline[o+1];if(bn(a[t],e)){for(let l=o;l<this._timeline.length;l++){const u=this._timeline[l];if(bn(u[t],e))o=l;else break}return o}else{if(Da(a[t],e)&&Qi(c[t],e))return o;Qi(a[t],e)?i=o:n=o+1}}return-1}_iterate(e,t=0,n=this._timeline.length-1){this._timeline.slice(t,n+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,t){const n=this._search(e);return n!==-1&&this._iterate(t,0,n),this}forEachAfter(e,t){const n=this._search(e);return this._iterate(t,n+1),this}forEachBetween(e,t,n){let s=this._search(e),i=this._search(t);return s!==-1&&i!==-1?(this._timeline[s].time!==e&&(s+=1),this._timeline[i].time===t&&(i-=1),this._iterate(n,s,i)):s===-1&&this._iterate(n,0,i),this}forEachFrom(e,t){let n=this._search(e);for(;n>=0&&this._timeline[n].time>=e;)n--;return this._iterate(t,n+1),this}forEachAtTime(e,t){const n=this._search(e);if(n!==-1&&bn(this._timeline[n].time,e)){let s=n;for(let i=n;i>=0&&bn(this._timeline[i].time,e);i--)s=i;this._iterate(i=>{t(i)},s,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const Wp=[];function sc(r){Wp.push(r)}function aS(r){Wp.forEach(e=>e(r))}const Hp=[];function ic(r){Hp.push(r)}function cS(r){Hp.forEach(e=>e(r))}class Oo extends hs{constructor(){super(...arguments),this.name="Emitter"}on(e,t){return e.split(/\W+/).forEach(s=>{sn(this._events)&&(this._events={}),this._events.hasOwnProperty(s)||(this._events[s]=[]),this._events[s].push(t)}),this}once(e,t){const n=(...s)=>{t(...s),this.off(e,n)};return this.on(e,n),this}off(e,t){return e.split(/\W+/).forEach(s=>{if(sn(this._events)&&(this._events={}),this._events.hasOwnProperty(s))if(sn(t))this._events[s]=[];else{const i=this._events[s];for(let o=i.length-1;o>=0;o--)i[o]===t&&i.splice(o,1)}}),this}emit(e,...t){if(this._events&&this._events.hasOwnProperty(e)){const n=this._events[e].slice(0);for(let s=0,i=n.length;s<i;s++)n[s].apply(this,t)}return this}static mixin(e){["on","once","off","emit"].forEach(t=>{const n=Object.getOwnPropertyDescriptor(Oo.prototype,t);Object.defineProperty(e.prototype,t,n)})}dispose(){return super.dispose(),this._events=void 0,this}}class qp extends Oo{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class Ao extends qp{constructor(){var e,t;super(),this.name="Context",this._constants=new Map,this._timeouts=new mn,this._timeoutIds=0,this._initialized=!1,this._closeStarted=!1,this.isOffline=!1,this._workletPromise=null;const n=K(Ao.getDefaults(),arguments,["context"]);n.context?(this._context=n.context,this._latencyHint=((e=arguments[0])===null||e===void 0?void 0:e.latencyHint)||""):(this._context=Kw({latencyHint:n.latencyHint}),this._latencyHint=n.latencyHint),this._ticker=new tS(this.emit.bind(this,"tick"),n.clockSource,n.updateInterval,this._context.sampleRate),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this[!((t=arguments[0])===null||t===void 0)&&t.hasOwnProperty("updateInterval")?"_lookAhead":"lookAhead"]=n.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(aS(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,t,n){return this._context.createBuffer(e,t,n)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,t){return this._context.createIIRFilter(e,t)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,t,n){return this._context.createPeriodicWave(e,t,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){return _e(Oi(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}createMediaElementSource(e){return _e(Oi(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(e)}createMediaStreamDestination(){return _e(Oi(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){_e(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){_e(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){_e(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){_e(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,t){return eS(this.rawContext,e,t)}addAudioWorkletModule(e){return ht(this,void 0,void 0,function*(){_e(Ce(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(e)),yield this._workletPromise})}workletsAreReady(){return ht(this,void 0,void 0,function*(){(yield this._workletPromise)?this._workletPromise:Promise.resolve()})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get lookAhead(){return this._lookAhead}set lookAhead(e){this._lookAhead=e,this.updateInterval=e?e/2:.01}get latencyHint(){return this._latencyHint}get rawContext(){return this._context}now(){return this._context.currentTime+this._lookAhead}immediate(){return this._context.currentTime}resume(){return Oi(this._context)?this._context.resume():Promise.resolve()}close(){return ht(this,void 0,void 0,function*(){Oi(this._context)&&this.state!=="closed"&&!this._closeStarted&&(this._closeStarted=!0,yield this._context.close()),this._initialized&&cS(this)})}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{const t=this._context.createBuffer(1,128,this._context.sampleRate),n=t.getChannelData(0);for(let i=0;i<n.length;i++)n[i]=e;const s=this._context.createBufferSource();return s.channelCount=1,s.channelCountMode="explicit",s.buffer=t,s.loop=!0,s.start(0),this._constants.set(e,s),s}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this.close(),this}_timeoutLoop(){const e=this.now();let t=this._timeouts.peek();for(;this._timeouts.length&&t&&t.time<=e;)t.callback(),this._timeouts.shift(),t=this._timeouts.peek()}setTimeout(e,t){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:n+t}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(t=>{t.id===e&&this._timeouts.remove(t)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,t){const n=++this._timeoutIds,s=()=>{const i=this.now();this._timeouts.add({callback:()=>{e(),s()},id:n,time:i+t})};return s(),n}}class lS extends qp{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,t,n){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,t){return{}}createPanner(){return{}}createPeriodicWave(e,t,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,t){return{}}get rawContext(){return{}}addAudioWorkletModule(e){return ht(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(e,t){return 0}clearTimeout(e){return this}setInterval(e,t){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}}function je(r,e){An(e)?e.forEach(t=>je(r,t)):Object.defineProperty(r,e,{enumerable:!0,writable:!1})}function bu(r,e){An(e)?e.forEach(t=>bu(r,t)):Object.defineProperty(r,e,{writable:!0})}const Ue=()=>{};class Ie extends hs{constructor(){super(),this.name="ToneAudioBuffer",this.onload=Ue;const e=K(Ie.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,os(e.url)?this.load(e.url).catch(e.onerror):e.url&&this.set(e.url)}static getDefaults(){return{onerror:Ue,onload:Ue,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:En().sampleRate}set(e){return e instanceof Ie?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return ht(this,void 0,void 0,function*(){const t=Ie.load(e).then(n=>{this.set(n),this.onload(this)});Ie.downloads.push(t);try{yield t}finally{const n=Ie.downloads.indexOf(t);Ie.downloads.splice(n,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){const t=An(e)&&e[0].length>0,n=t?e.length:1,s=t?e[0].length:e.length,i=En(),o=i.createBuffer(n,s,i.sampleRate),a=!t&&n===1?[e]:e;for(let c=0;c<n;c++)o.copyToChannel(a[c],c);return this._buffer=o,this}toMono(e){if(Ms(e))this.fromArray(this.toArray(e));else{let t=new Float32Array(this.length);const n=this.numberOfChannels;for(let s=0;s<n;s++){const i=this.toArray(s);for(let o=0;o<i.length;o++)t[o]+=i[o]}t=t.map(s=>s/n),this.fromArray(t)}return this}toArray(e){if(Ms(e))return this.getChannelData(e);if(this.numberOfChannels===1)return this.toArray(0);{const t=[];for(let n=0;n<this.numberOfChannels;n++)t[n]=this.getChannelData(n);return t}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e,t=this.duration){_e(this.loaded,"Buffer is not loaded");const n=Math.floor(e*this.sampleRate),s=Math.floor(t*this.sampleRate);_e(n<s,"The start time must be less than the end time");const i=s-n,o=En().createBuffer(this.numberOfChannels,i,this.sampleRate);for(let a=0;a<this.numberOfChannels;a++)o.copyToChannel(this.getChannelData(a).subarray(n,s),a);return new Ie(o)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return new Ie().fromArray(e)}static fromUrl(e){return ht(this,void 0,void 0,function*(){return yield new Ie().load(e)})}static load(e){return ht(this,void 0,void 0,function*(){const t=e.match(/\[([^\]\[]+\|.+)\]$/);if(t){const c=t[1].split("|");let l=c[0];for(const u of c)if(Ie.supportsType(u)){l=u;break}e=e.replace(t[0],l)}const n=Ie.baseUrl===""||Ie.baseUrl.endsWith("/")?Ie.baseUrl:Ie.baseUrl+"/",s=document.createElement("a");s.href=n+e,s.pathname=(s.pathname+s.hash).split("/").map(encodeURIComponent).join("/");const i=yield fetch(s.href);if(!i.ok)throw new Error(`could not load url: ${e}`);const o=yield i.arrayBuffer();return yield En().decodeAudioData(o)})}static supportsType(e){const t=e.split("."),n=t[t.length-1];return document.createElement("audio").canPlayType("audio/"+n)!==""}static loaded(){return ht(this,void 0,void 0,function*(){for(yield Promise.resolve();Ie.downloads.length;)yield Ie.downloads[0]})}}Ie.baseUrl="";Ie.downloads=[];class rc extends Ao{constructor(){super({clockSource:"offline",context:ha(arguments[0])?arguments[0]:Jw(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:ha(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=ha(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return ht(this,void 0,void 0,function*(){let t=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,t++;const n=Math.floor(this.sampleRate/128);e&&t%n===0&&(yield new Promise(s=>setTimeout(s,1)))}})}render(e=!0){return ht(this,void 0,void 0,function*(){yield this.workletsAreReady(),yield this._renderClock(e);const t=yield this._context.startRendering();return new Ie(t)})}close(){return Promise.resolve()}}const jp=new lS;let Zs=jp;function En(){return Zs===jp&&$w&&uS(new Ao),Zs}function uS(r,e=!1){e&&Zs.dispose(),Oi(r)?Zs=new Ao(r):ha(r)?Zs=new rc(r):Zs=r}function hS(){return Zs.resume()}if(si&&!si.TONE_SILENCE_LOGGING){const e=` * Tone.js v${Yf} * `;console.log(`%c${e}`,"background: #000; color: #fff")}function dS(r){return Math.pow(10,r/20)}function fS(r){return 20*(Math.log(r)/Math.LN10)}function Yp(r){return Math.pow(2,r/12)}let oc=440;function pS(){return oc}function mS(r){oc=r}function Ml(r){return Math.round(Xp(r))}function Xp(r){return 69+12*Math.log2(r/oc)}function _S(r){return oc*Math.pow(2,(r-69)/12)}class Cu extends hs{constructor(e,t,n){super(),this.defaultUnits="s",this._val=t,this._units=n,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,t)=>{const n=parseInt(e,10),s=t==="."?1.5:1;return n===1?this._beatsToUnits(this._getTimeSignature())*s:this._beatsToUnits(4/n)*s},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{const t=parseInt(e,10);return this._beatsToUnits(8/(Math.floor(t)*3))},regexp:/^(\d+)t$/i},tr:{method:(e,t,n)=>{let s=0;return e&&e!=="0"&&(s+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(s+=this._beatsToUnits(parseFloat(t))),n&&n!=="0"&&(s+=this._beatsToUnits(parseFloat(n)/4)),s},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof Cu&&this.fromType(this._val),sn(this._val))return this._noArg();if(os(this._val)&&sn(this._units)){for(const e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(ni(this._val)){let e=0;for(const t in this._val)if(Ce(this._val[t])){const n=this._val[t],s=new this.constructor(this.context,t).valueOf()*n;e+=s}return e}if(Ce(this._units)){const e=this._expressions[this._units],t=this._val.toString().trim().match(e.regexp);return t?e.method.apply(this,t.slice(1)):e.method.call(this,this._val)}else return os(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}}class On extends Cu{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{const t=new On(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(t))},regexp:/^@(.+)/}})}quantize(e,t=1){const n=new this.constructor(this.context,e).valueOf(),s=this.valueOf(),a=Math.round(s/n)*n-s;return s+a*t}toNotation(){const e=this.toSeconds(),t=["1m"];for(let i=1;i<9;i++){const o=Math.pow(2,i);t.push(o+"n."),t.push(o+"n"),t.push(o+"t")}t.push("0");let n=t[0],s=new On(this.context,t[0]).toSeconds();return t.forEach(i=>{const o=new On(this.context,i).toSeconds();Math.abs(o-e)<Math.abs(s-e)&&(n=i,s=o)}),n}toBarsBeatsSixteenths(){const e=this._beatsToUnits(1);let t=this.valueOf()/e;t=parseFloat(t.toFixed(4));const n=Math.floor(t/this._getTimeSignature());let s=t%1*4;t=Math.floor(t)%this._getTimeSignature();const i=s.toString();return i.length>3&&(s=parseFloat(parseFloat(i).toFixed(3))),[n,t,s].join(":")}toTicks(){const e=this._beatsToUnits(1);return this.valueOf()/e*this._getPPQ()}toSeconds(){return this.valueOf()}toMidi(){return Ml(this.toFrequency())}_now(){return this.context.now()}}class pn extends On{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return pS()}static set A4(e){mS(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return this.defaultUnits==="midi"?e:pn.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method(e,t){const s=gS[e.toLowerCase()]+(parseInt(t,10)+1)*12;return this.defaultUnits==="midi"?s:pn.mtof(s)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,t,n){let s=1;return e&&e!=="0"&&(s*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(s*=this._beatsToUnits(parseFloat(t))),n&&n!=="0"&&(s*=this._beatsToUnits(parseFloat(n)/4)),s}}})}transpose(e){return new pn(this.context,this.valueOf()*Yp(e))}harmonize(e){return e.map(t=>this.transpose(t))}toMidi(){return Ml(this.valueOf())}toNote(){const e=this.toFrequency(),t=Math.log2(e/pn.A4);let n=Math.round(12*t)+57;const s=Math.floor(n/12);return s<0&&(n+=-12*s),vS[n%12]+s.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.floor(t*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(e*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return _S(e)}static ftom(e){return Ml(e)}}const gS={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},vS=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class Vr extends On{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class Yt extends hs{constructor(){super();const e=K(Yt.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:En()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return Zw(e),new On(this.context,e).toSeconds()}toFrequency(e){return new pn(this.context,e).toFrequency()}toTicks(e){return new Vr(this.context,e).toTicks()}_getPartialProperties(e){const t=this.get();return Object.keys(t).forEach(n=>{sn(e[n])&&delete t[n]}),t}get(){const e=rS(this);return Object.keys(e).forEach(t=>{if(Reflect.has(this,t)){const n=this[t];Ce(n)&&Ce(n.value)&&Ce(n.setValueAtTime)?e[t]=n.value:n instanceof Yt?e[t]=n._getPartialProperties(e[t]):An(n)||Ms(n)||os(n)||Xw(n)?e[t]=n:delete e[t]}}),e}set(e){return Object.keys(e).forEach(t=>{Reflect.has(this,t)&&Ce(this[t])&&(this[t]&&Ce(this[t].value)&&Ce(this[t].setValueAtTime)?this[t].value!==e[t]&&(this[t].value=e[t]):this[t]instanceof Yt?this[t].set(e[t]):this[t]=e[t])}),this}}class Eu extends mn{constructor(e="stopped"){super(),this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){const t=this.get(e);return t!==null?t.state:this._initial}setStateAtTime(e,t,n){return Dn(t,0),this.add(Object.assign({},n,{state:e,time:t})),this}getLastState(e,t){const n=this._search(t);for(let s=n;s>=0;s--){const i=this._timeline[s];if(i.state===e)return i}}getNextState(e,t){const n=this._search(t);if(n!==-1)for(let s=n;s<this._timeline.length;s++){const i=this._timeline[s];if(i.state===e)return i}}}class Fe extends Yt{constructor(){super(K(Fe.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const e=K(Fe.getDefaults(),arguments,["param","units","convert"]);for(_e(Ce(e.param)&&(ai(e.param)||e.param instanceof Fe),"param must be an AudioParam");!ai(e.param);)e.param=e.param._param;this._swappable=Ce(e.swappable)?e.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new mn(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,Ce(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Yt.getDefaults(),{convert:!0,units:"number"})}get value(){const e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return Ce(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return Ce(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(e,t){return this.units===t}_assertRange(e){return Ce(this.maxValue)&&Ce(this.minValue)&&Dn(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?dS(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&this.units==="decibels"?fS(e):e}setValueAtTime(e,t){const n=this.toSeconds(t),s=this._fromType(e);return _e(isFinite(s)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(s),this.log(this.units,"setValueAtTime",e,n),this._events.add({time:n,type:"setValueAtTime",value:s}),this._param.setValueAtTime(s,n),this}getValueAtTime(e){const t=Math.max(this.toSeconds(e),0),n=this._events.getAfter(t),s=this._events.get(t);let i=this._initialValue;if(s===null)i=this._initialValue;else if(s.type==="setTargetAtTime"&&(n===null||n.type==="setValueAtTime")){const o=this._events.getBefore(s.time);let a;o===null?a=this._initialValue:a=o.value,s.type==="setTargetAtTime"&&(i=this._exponentialApproach(s.time,a,s.value,s.constant,t))}else if(n===null)i=s.value;else if(n.type==="linearRampToValueAtTime"||n.type==="exponentialRampToValueAtTime"){let o=s.value;if(s.type==="setTargetAtTime"){const a=this._events.getBefore(s.time);a===null?o=this._initialValue:o=a.value}n.type==="linearRampToValueAtTime"?i=this._linearInterpolate(s.time,o,n.time,n.value,t):i=this._exponentialInterpolate(s.time,o,n.time,n.value,t)}else i=s.value;return this._toType(i)}setRampPoint(e){e=this.toSeconds(e);let t=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),this._fromType(t)===0&&(t=this._toType(this._minOutput)),this.setValueAtTime(t,e),this}linearRampToValueAtTime(e,t){const n=this._fromType(e),s=this.toSeconds(t);return _e(isFinite(n)&&isFinite(s),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(n),this._events.add({time:s,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",e,s),this._param.linearRampToValueAtTime(n,s),this}exponentialRampToValueAtTime(e,t){let n=this._fromType(e);n=bn(n,0)?this._minOutput:n,this._assertRange(n);const s=this.toSeconds(t);return _e(isFinite(n)&&isFinite(s),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({time:s,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",e,s),this._param.exponentialRampToValueAtTime(n,s),this}exponentialRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(e,n+this.toSeconds(t)),this}linearRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(e,n+this.toSeconds(t)),this}targetRampTo(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(e,n,t),this}exponentialApproachValueAtTime(e,t,n){t=this.toSeconds(t),n=this.toSeconds(n);const s=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(e,t,s),this.cancelAndHoldAtTime(t+n*.9),this.linearRampToValueAtTime(e,t+n),this}setTargetAtTime(e,t,n){const s=this._fromType(e);_e(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const i=this.toSeconds(t);return this._assertRange(s),_e(isFinite(s)&&isFinite(i),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({constant:n,time:i,type:"setTargetAtTime",value:s}),this.log(this.units,"setTargetAtTime",e,i,n),this._param.setTargetAtTime(s,i,n),this}setValueCurveAtTime(e,t,n,s=1){n=this.toSeconds(n),t=this.toSeconds(t);const i=this._fromType(e[0])*s;this.setValueAtTime(this._toType(i),t);const o=n/(e.length-1);for(let a=1;a<e.length;a++){const c=this._fromType(e[a])*s;this.linearRampToValueAtTime(this._toType(c),t+a*o)}return this}cancelScheduledValues(e){const t=this.toSeconds(e);return _e(isFinite(t),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(t),this._param.cancelScheduledValues(t),this.log(this.units,"cancelScheduledValues",t),this}cancelAndHoldAtTime(e){const t=this.toSeconds(e),n=this._fromType(this.getValueAtTime(t));_e(isFinite(t),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",t,"value="+n);const s=this._events.get(t),i=this._events.getAfter(t);return s&&bn(s.time,t)?i?(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time)):(this._param.cancelAndHoldAtTime(t),this._events.cancel(t+this.sampleTime)):i&&(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time),i.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(n),t):i.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(n),t)),this._events.add({time:t,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,t),this}rampTo(e,t=.1,n){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(e,t,n):this.linearRampTo(e,t,n),this}apply(e){const t=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(t),t);const n=this._events.get(t);if(n&&n.type==="setTargetAtTime"){const s=this._events.getAfter(n.time),i=s?s.time:t+2,o=(i-t)/10;for(let a=t;a<i;a+=o)e.linearRampToValueAtTime(this.getValueAtTime(a),a)}return this._events.forEachAfter(this.context.currentTime,s=>{s.type==="cancelScheduledValues"?e.cancelScheduledValues(s.time):s.type==="setTargetAtTime"?e.setTargetAtTime(s.value,s.time,s.constant):e[s.type](s.value,s.time)}),this}setParam(e){_e(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const t=this.input;return t.disconnect(this._param),this.apply(e),this._param=e,t.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,t,n,s,i){return n+(t-n)*Math.exp(-(i-e)/s)}_linearInterpolate(e,t,n,s,i){return t+(s-t)*((i-e)/(n-e))}_exponentialInterpolate(e,t,n,s,i){return t*Math.pow(s/t,(i-e)/(n-e))}}class he extends Yt{constructor(){super(...arguments),this._internalChannels=[]}get numberOfInputs(){return Ce(this.input)?ai(this.input)||this.input instanceof Fe?1:this.input.numberOfInputs:0}get numberOfOutputs(){return Ce(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return Ce(e)&&(e instanceof he||As(e))}_getInternalNodes(){const e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach(n=>{n.channelCount=e.channelCount,n.channelCountMode=e.channelCountMode,n.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){const e=this._getInternalNodes();_e(e.length>0,"ToneAudioNode does not have any internal nodes");const t=e[0];return{channelCount:t.channelCount,channelCountMode:t.channelCountMode,channelInterpretation:t.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelInterpretation:e}))}connect(e,t=0,n=0){return Rs(this,e,t,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return wu("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,t=0,n=0){return yS(this,e,t,n),this}chain(...e){return $r(this,...e),this}fan(...e){return e.forEach(t=>this.connect(t)),this}dispose(){return super.dispose(),Ce(this.input)&&(this.input instanceof he?this.input.dispose():As(this.input)&&this.input.disconnect()),Ce(this.output)&&(this.output instanceof he?this.output.dispose():As(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function $r(...r){const e=r.shift();r.reduce((t,n)=>(t instanceof he?t.connect(n):As(t)&&Rs(t,n),n),e)}function Rs(r,e,t=0,n=0){for(_e(Ce(r),"Cannot connect from undefined node"),_e(Ce(e),"Cannot connect to undefined node"),(e instanceof he||As(e))&&_e(e.numberOfInputs>0,"Cannot connect to node with no inputs"),_e(r.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof he||e instanceof Fe;)Ce(e.input)&&(e=e.input);for(;r instanceof he;)Ce(r.output)&&(r=r.output);ai(e)?r.connect(e,t):r.connect(e,t,n)}function yS(r,e,t=0,n=0){if(Ce(e))for(;e instanceof he;)e=e.input;for(;!As(r);)Ce(r.output)&&(r=r.output);ai(e)?r.disconnect(e,t):As(e)?r.disconnect(e,t,n):r.disconnect()}class Ve extends he{constructor(){super(K(Ve.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const e=K(Ve.getDefaults(),arguments,["gain","units"]);this.gain=new Fe({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),je(this,"gain")}static getDefaults(){return Object.assign(he.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class Ki extends he{constructor(e){super(e),this.onended=Ue,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Ve({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const n=this.toSeconds(t);return this._startTime!==-1&&n>=this._startTime&&(this._stopTime===-1||n<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(he.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:Ue})}_startGain(e,t=1){_e(this._startTime===-1,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=e+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,e),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(t,e+n):this._gainNode.gain.exponentialApproachValueAtTime(t,e,n)):this._gainNode.gain.setValueAtTime(t,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){_e(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();const t=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+t,this._stopTime=Math.max(this._stopTime,this.now()),t>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,t,e):this._gainNode.gain.targetRampTo(0,t,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const n=this._curve==="exponential"?t*2:0;this._stopSource(this.now()+n),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==Ue&&(this.onended(this),this.onended=Ue,!this.context.isOffline)){const e=()=>this.dispose();typeof window.requestIdleCallback<"u"?window.requestIdleCallback(e):setTimeout(e,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),_e(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.dispose(),this.onended=Ue,this}}class Ma extends Ki{constructor(){super(K(Ma.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const e=K(Ma.getDefaults(),arguments,["offset"]);Rs(this._source,this._gainNode),this.offset=new Fe({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(Ki.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._source.start(t),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class He extends he{constructor(){super(K(He.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const e=K(He.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new Ma({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(he.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,t=0,n=0){return Ou(this,e,t,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,t){return this._param.setValueAtTime(e,t),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,t){return this._param.linearRampToValueAtTime(e,t),this}exponentialRampToValueAtTime(e,t){return this._param.exponentialRampToValueAtTime(e,t),this}exponentialRampTo(e,t,n){return this._param.exponentialRampTo(e,t,n),this}linearRampTo(e,t,n){return this._param.linearRampTo(e,t,n),this}targetRampTo(e,t,n){return this._param.targetRampTo(e,t,n),this}exponentialApproachValueAtTime(e,t,n){return this._param.exponentialApproachValueAtTime(e,t,n),this}setTargetAtTime(e,t,n){return this._param.setTargetAtTime(e,t,n),this}setValueCurveAtTime(e,t,n,s){return this._param.setValueCurveAtTime(e,t,n,s),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,t,n){return this._param.rampTo(e,t,n),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}}function Ou(r,e,t,n){(e instanceof Fe||ai(e)||e instanceof He&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof He&&(e.overridden=!0)),Rs(r,e,t,n)}class Ra extends Fe{constructor(){super(K(Ra.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new mn(1/0),this._multiplier=1;const e=K(Ra.getDefaults(),arguments,["value"]);this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Fe.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,t,n){t=this.toSeconds(t),this.setRampPoint(t);const s=this._fromType(e),i=this._events.get(t),o=Math.round(Math.max(1/n,1));for(let a=0;a<=o;a++){const c=n*a+t,l=this._exponentialApproach(i.time,i.value,s,n,c);this.linearRampToValueAtTime(this._toType(l),c)}return this}setValueAtTime(e,t){const n=this.toSeconds(t);super.setValueAtTime(e,t);const s=this._events.get(n),i=this._events.previousEvent(s),o=this._getTicksUntilEvent(i,n);return s.ticks=Math.max(o,0),this}linearRampToValueAtTime(e,t){const n=this.toSeconds(t);super.linearRampToValueAtTime(e,t);const s=this._events.get(n),i=this._events.previousEvent(s),o=this._getTicksUntilEvent(i,n);return s.ticks=Math.max(o,0),this}exponentialRampToValueAtTime(e,t){t=this.toSeconds(t);const n=this._fromType(e),s=this._events.get(t),i=Math.round(Math.max((t-s.time)*10,1)),o=(t-s.time)/i;for(let a=0;a<=i;a++){const c=o*a+s.time,l=this._exponentialInterpolate(s.time,s.value,t,n,c);this.linearRampToValueAtTime(this._toType(l),c)}return this}_getTicksUntilEvent(e,t){if(e===null)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(sn(e.ticks)){const o=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(o,e.time)}const n=this._fromType(this.getValueAtTime(e.time));let s=this._fromType(this.getValueAtTime(t));const i=this._events.get(t);return i&&i.time===t&&i.type==="setValueAtTime"&&(s=this._fromType(this.getValueAtTime(t-this.sampleTime))),.5*(t-e.time)*(n+s)+e.ticks}getTicksAtTime(e){const t=this.toSeconds(e),n=this._events.get(t);return Math.max(this._getTicksUntilEvent(n,t),0)}getDurationOfTicks(e,t){const n=this.toSeconds(t),s=this.getTicksAtTime(t);return this.getTimeOfTick(s+e)-n}getTimeOfTick(e){const t=this._events.get(e,"ticks"),n=this._events.getAfter(e,"ticks");if(t&&t.ticks===e)return t.time;if(t&&n&&n.type==="linearRampToValueAtTime"&&t.value!==n.value){const s=this._fromType(this.getValueAtTime(t.time)),o=(this._fromType(this.getValueAtTime(n.time))-s)/(n.time-t.time),a=Math.sqrt(Math.pow(s,2)-2*o*(t.ticks-e)),c=(-s+a)/o,l=(-s-a)/o;return(c>0?c:l)+t.time}else return t?t.value===0?1/0:t.time+(e-t.ticks)/t.value:e/this._initialValue}ticksToTime(e,t){return this.getDurationOfTicks(e,t)}timeToTicks(e,t){const n=this.toSeconds(t),s=this.toSeconds(e),i=this.getTicksAtTime(n);return this.getTicksAtTime(n+s)-i}_fromType(e){return this.units==="bpm"&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return this.units==="bpm"&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){const t=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(t,0)}}class Pa extends He{constructor(){super(K(Pa.getDefaults(),arguments,["value"])),this.name="TickSignal";const e=K(Pa.getDefaults(),arguments,["value"]);this.input=this._param=new Ra({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(He.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,t){return this._param.ticksToTime(e,t)}timeToTicks(e,t){return this._param.timeToTicks(e,t)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,t){return this._param.getDurationOfTicks(e,t)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}}class Ua extends Yt{constructor(){super(K(Ua.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new Eu,this._tickOffset=new mn,this._ticksAtTime=new mn,this._secondsAtTime=new mn;const e=K(Ua.getDefaults(),arguments,["frequency"]);this.frequency=new Pa({context:this.context,units:e.units,value:e.frequency}),je(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},Yt.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,t){const n=this.toSeconds(e);return this._state.getValueAtTime(n)!=="started"&&(this._state.setStateAtTime("started",n),Ce(t)&&this.setTicksAtTime(t,n),this._ticksAtTime.cancel(n),this._secondsAtTime.cancel(n)),this}stop(e){const t=this.toSeconds(e);if(this._state.getValueAtTime(t)==="stopped"){const n=this._state.get(t);n&&n.time>0&&(this._tickOffset.cancel(n.time),this._state.cancel(n.time))}return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this.setTicksAtTime(0,t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}pause(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&(this._state.setStateAtTime("paused",t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t)),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}getTicksAtTime(e){const t=this.toSeconds(e),n=this._state.getLastState("stopped",t),s=this._ticksAtTime.get(t),i={state:"paused",time:t};this._state.add(i);let o=s||n,a=s?s.ticks:0,c=null;return this._state.forEachBetween(o.time,t+this.sampleTime,l=>{let u=o.time;const h=this._tickOffset.get(l.time);h&&h.time>=o.time&&(a=h.ticks,u=h.time),o.state==="started"&&l.state!=="started"&&(a+=this.frequency.getTicksAtTime(l.time)-this.frequency.getTicksAtTime(u),l.time!=i.time&&(c={state:l.state,time:l.time,ticks:a})),o=l}),this._state.remove(i),c&&this._ticksAtTime.add(c),a}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){const t=this.now(),n=this.frequency.timeToTicks(e,t);this.setTicksAtTime(n,t)}getSecondsAtTime(e){e=this.toSeconds(e);const t=this._state.getLastState("stopped",e),n={state:"paused",time:e};this._state.add(n);const s=this._secondsAtTime.get(e);let i=s||t,o=s?s.seconds:0,a=null;return this._state.forEachBetween(i.time,e+this.sampleTime,c=>{let l=i.time;const u=this._tickOffset.get(c.time);u&&u.time>=i.time&&(o=u.seconds,l=u.time),i.state==="started"&&c.state!=="started"&&(o+=c.time-l,c.time!=n.time&&(a={state:c.state,time:c.time,seconds:o})),i=c}),this._state.remove(n),a&&this._secondsAtTime.add(a),o}setTicksAtTime(e,t){return t=this.toSeconds(t),this._tickOffset.cancel(t),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,t),ticks:e,time:t}),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,t=this.now()){const n=this._tickOffset.get(t),s=this._state.get(t),i=Math.max(n.time,s.time),o=this.frequency.getTicksAtTime(i)+e-n.ticks;return this.frequency.getTimeOfTick(o)}forEachTickBetween(e,t,n){let s=this._state.get(e);this._state.forEachBetween(e,t,o=>{s&&s.state==="started"&&o.state!=="started"&&this.forEachTickBetween(Math.max(s.time,e),o.time-this.sampleTime,n),s=o});let i=null;if(s&&s.state==="started"){const o=Math.max(s.time,e),a=this.frequency.getTicksAtTime(o),c=this.frequency.getTicksAtTime(s.time),l=a-c;let u=Math.ceil(l)-l;u=bn(u,1)?0:u;let h=this.frequency.getTimeOfTick(a+u);for(;h<t;){try{n(h,Math.round(this.getTicksAtTime(h)))}catch(d){i=d;break}h+=this.frequency.getDurationOfTicks(1,h)}}if(i)throw i;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}}class eo extends Yt{constructor(){super(K(eo.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=Ue,this._lastUpdate=0,this._state=new Eu("stopped"),this._boundLoop=this._loop.bind(this);const e=K(eo.getDefaults(),arguments,["callback","frequency"]);this.callback=e.callback,this._tickSource=new Ua({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,je(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(Yt.getDefaults(),{callback:Ue,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,t){zp(this.context);const n=this.toSeconds(e);return this.log("start",n),this._state.getValueAtTime(n)!=="started"&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,t),n<this._lastUpdate&&this.emit("start",n,t)),this}stop(e){const t=this.toSeconds(e);return this.log("stop",t),this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._tickSource.stop(t),t<this._lastUpdate&&this.emit("stop",t),this}pause(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&(this._state.setStateAtTime("paused",t),this._tickSource.pause(t),t<this._lastUpdate&&this.emit("pause",t)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,t){return this._tickSource.setTicksAtTime(e,t),this}getTimeOfTick(e,t=this.now()){return this._tickSource.getTimeOfTick(e,t)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,t){const n=this.toSeconds(t),s=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(s+e,n)}_loop(){const e=this._lastUpdate,t=this.now();this._lastUpdate=t,this.log("loop",e,t),e!==t&&(this._state.forEachBetween(e,t,n=>{switch(n.state){case"started":const s=this._tickSource.getTicksAtTime(n.time);this.emit("start",n.time,s);break;case"stopped":n.time!==0&&this.emit("stop",n.time);break;case"paused":this.emit("pause",n.time);break}}),this._tickSource.forEachTickBetween(e,t,(n,s)=>{this.callback(n,s)}))}getStateAtTime(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}Oo.mixin(eo);class Au extends hs{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const e=K(Au.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach(t=>{this._loadingCount++;const n=e.urls[t];this.add(t,n,this._bufferLoaded.bind(this,e.onload),e.onerror)})}static getDefaults(){return{baseUrl:"",onerror:Ue,onload:Ue,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return _e(this.has(e),`ToneAudioBuffers has no buffer named: ${e}`),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,this._loadingCount===0&&e&&e()}get loaded(){return Array.from(this._buffers).every(([e,t])=>t.loaded)}add(e,t,n=Ue,s=Ue){return os(t)?(this.baseUrl&&t.trim().substring(0,11).toLowerCase()==="data:audio/"&&(this.baseUrl=""),this._buffers.set(e.toString(),new Ie(this.baseUrl+t,n,s))):this._buffers.set(e.toString(),new Ie(t,n,s)),this}dispose(){return super.dispose(),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this}}class Ui extends Vr{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class TS extends Yt{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new mn,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(e,t){return this._events.add({callback:e,time:this.toSeconds(t)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(e){return this._events.cancel(this.toSeconds(e)),this}_drawLoop(){const e=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=e;){const t=this._events.shift();t&&e-t.time<=this.expiration&&t.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}sc(r=>{r.draw=new TS({context:r})});ic(r=>{r.draw.dispose()});class xS extends hs{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(e){_e(Ce(e.time),"Events must have a time property"),_e(Ce(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let t=new wS(e.time,e.time+e.duration,e);for(this._root===null?this._root=t:this._root.insert(t),this._length++;t!==null;)t.updateHeight(),t.updateMax(),this._rebalance(t),t=t.parent;return this}remove(e){if(this._root!==null){const t=[];this._root.search(e.time,t);for(const n of t)if(n.event===e){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,t=>this.remove(t)),this}_setRoot(e){this._root=e,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(e,t){e.parent!==null?(e.isLeftChild()?e.parent.left=t:e.parent.right=t,this._rebalance(e.parent)):this._setRoot(t)}_removeNode(e){if(e.left===null&&e.right===null)this._replaceNodeInParent(e,null);else if(e.right===null)this._replaceNodeInParent(e,e.left);else if(e.left===null)this._replaceNodeInParent(e,e.right);else{const t=e.getBalance();let n,s=null;if(t>0)if(e.left.right===null)n=e.left,n.right=e.right,s=n;else{for(n=e.left.right;n.right!==null;)n=n.right;n.parent&&(n.parent.right=n.left,s=n.parent,n.left=e.left,n.right=e.right)}else if(e.right.left===null)n=e.right,n.left=e.left,s=n;else{for(n=e.right.left;n.left!==null;)n=n.left;n.parent&&(n.parent.left=n.right,s=n.parent,n.left=e.left,n.right=e.right)}e.parent!==null?e.isLeftChild()?e.parent.left=n:e.parent.right=n:this._setRoot(n),s&&this._rebalance(s)}e.dispose()}_rotateLeft(e){const t=e.parent,n=e.isLeftChild(),s=e.right;s&&(e.right=s.left,s.left=e),t!==null?n?t.left=s:t.right=s:this._setRoot(s)}_rotateRight(e){const t=e.parent,n=e.isLeftChild(),s=e.left;s&&(e.left=s.right,s.right=e),t!==null?n?t.left=s:t.right=s:this._setRoot(s)}_rebalance(e){const t=e.getBalance();t>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):t<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(this._root!==null){const t=[];if(this._root.search(e,t),t.length>0){let n=t[0];for(let s=1;s<t.length;s++)t[s].low>n.low&&(n=t[s]);return n.event}}return null}forEach(e){if(this._root!==null){const t=[];this._root.traverse(n=>t.push(n)),t.forEach(n=>{n.event&&e(n.event)})}return this}forEachAtTime(e,t){if(this._root!==null){const n=[];this._root.search(e,n),n.forEach(s=>{s.event&&t(s.event)})}return this}forEachFrom(e,t){if(this._root!==null){const n=[];this._root.searchAfter(e,n),n.forEach(s=>{s.event&&t(s.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(e=>e.dispose()),this._root=null,this}}class wS{constructor(e,t,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=e,this.high=t,this.max=this.high}insert(e){e.low<=this.low?this.left===null?this.left=e:this.left.insert(e):this.right===null?this.right=e:this.right.insert(e)}search(e,t){e>this.max||(this.left!==null&&this.left.search(e,t),this.low<=e&&this.high>e&&t.push(this),!(this.low>e)&&this.right!==null&&this.right.search(e,t))}searchAfter(e,t){this.low>=e&&(t.push(this),this.left!==null&&this.left.searchAfter(e,t)),this.right!==null&&this.right.searchAfter(e,t)}traverse(e){e(this),this.left!==null&&this.left.traverse(e),this.right!==null&&this.right.traverse(e)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return this.left!==null&&this.right!==null?e=this.left.height-this.right.height:this.left!==null?e=this.left.height+1:this.right!==null&&(e=-(this.right.height+1)),e}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class Ps extends he{constructor(){super(K(Ps.getDefaults(),arguments,["volume"])),this.name="Volume";const e=K(Ps.getDefaults(),arguments,["volume"]);this.input=this.output=new Ve({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,je(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(he.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}let SS=class Rl extends he{constructor(){super(K(Rl.getDefaults(),arguments)),this.name="Destination",this.input=new Ps({context:this.context}),this.output=new Ve({context:this.context}),this.volume=this.input.volume;const e=K(Rl.getDefaults(),arguments);$r(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(he.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),$r(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}};sc(r=>{r.destination=new SS({context:r})});ic(r=>{r.destination.dispose()});class bS extends hs{constructor(e){super(),this.name="TimelineValue",this._timeline=new mn({memory:10}),this._initialValue=e}set(e,t){return this._timeline.add({value:e,time:t}),this}get(e){const t=this._timeline.get(e);return t?t.value:this._initialValue}}class as extends he{constructor(){super(Object.assign(K(as.getDefaults(),arguments,["context"])))}connect(e,t=0,n=0){return Ou(this,e,t,n),this}}class ci extends as{constructor(){super(Object.assign(K(ci.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const e=K(ci.getDefaults(),arguments,["mapping","length"]);An(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):Yw(e.mapping)&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(He.getDefaults(),{length:1024})}setMap(e,t=1024){const n=new Float32Array(t);for(let s=0,i=t;s<i;s++){const o=s/(i-1)*2-1;n[s]=e(o,s)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){const t=["none","2x","4x"].some(n=>n.includes(e));_e(t,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class to extends as{constructor(){super(Object.assign(K(to.getDefaults(),arguments,["value"]))),this.name="Pow";const e=K(to.getDefaults(),arguments,["value"]);this._exponentScaler=this.input=this.output=new ci({context:this.context,mapping:this._expFunc(e.value),length:8192}),this._exponent=e.value}static getDefaults(){return Object.assign(as.getDefaults(),{value:1})}_expFunc(e){return t=>Math.pow(Math.abs(t),e)}get value(){return this._exponent}set value(e){this._exponent=e,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class Us{constructor(e,t){this.id=Us._eventId++,this._remainderTime=0;const n=Object.assign(Us.getDefaults(),t);this.transport=e,this.callback=n.callback,this._once=n.once,this.time=Math.floor(n.time),this._remainderTime=n.time-this.time}static getDefaults(){return{callback:Ue,once:!1,time:0}}get floatTime(){return this.time+this._remainderTime}invoke(e){if(this.callback){const t=this.transport.bpm.getDurationOfTicks(1,e);this.callback(e+this._remainderTime*t),this._once&&this.transport.clear(this.id)}}dispose(){return this.callback=void 0,this}}Us._eventId=0;class ku extends Us{constructor(e,t){super(e,t),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(ku.getDefaults(),t);this.duration=n.duration,this._interval=n.interval,this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.transport.on("ticks",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},Us.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvent(){return Da(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new Ui(this.context,this._nextTick).toSeconds()):-1}_createEvents(e){Da(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Ui(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;const t=this.transport.getTicksAtTime(e);Qi(t,this.time)&&(this._nextTick=this.floatTime+Math.ceil((t-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}}class no extends Yt{constructor(){super(K(no.getDefaults(),arguments)),this.name="Transport",this._loop=new bS(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new mn,this._repeatedEvents=new xS,this._syncedSignals=[],this._swingAmount=0;const e=K(no.getDefaults(),arguments);this._ppq=e.ppq,this._clock=new eo({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),je(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(Yt.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,t){if(this._loop.get(e)&&t>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),t=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&t%this._ppq!==0&&t%(this._swingTicks*2)!==0){const n=t%(this._swingTicks*2)/(this._swingTicks*2),s=Math.sin(n*Math.PI)*this._swingAmount;e+=new Ui(this.context,this._swingTicks*2/3).toSeconds()*s}dd(!0),this._timeline.forEachAtTime(t,n=>n.invoke(e)),dd(!1)}schedule(e,t){const n=new Us(this,{callback:e,time:new Vr(this.context,t).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(e,t,n,s=1/0){const i=new ku(this,{callback:e,duration:new On(this.context,s).toTicks(),interval:new On(this.context,t).toTicks(),time:new Vr(this.context,n).toTicks()});return this._addEvent(i,this._repeatedEvents)}scheduleOnce(e,t){const n=new Us(this,{callback:e,once:!0,time:new Vr(this.context,t).toTicks()});return this._addEvent(n,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){const t=this._scheduledEvents[e.toString()];t.timeline.remove(t.event),t.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,t){return this._scheduledEvents[e.id.toString()]={event:e,timeline:t},t.add(e),e.id}cancel(e=0){const t=this.toTicks(e);return this._timeline.forEachFrom(t,n=>this.clear(n.id)),this._repeatedEvents.forEachFrom(t,n=>this.clear(n.id)),this}_bindClockEvents(){this._clock.on("start",(e,t)=>{t=new Ui(this.context,t).toSeconds(),this.emit("start",e,t)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,t){this.context.resume();let n;return Ce(t)&&(n=this.toTicks(t)),this._clock.start(e,n),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),this._clock.getStateAtTime(e)!=="started"?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){An(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new On(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new On(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new Ui(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){const e=this.now(),t=this._clock.getTicksAtTime(e);return new Ui(this.context,t).toBarsBeatsSixteenths()}set position(e){const t=this.toTicks(e);this.ticks=t}get seconds(){return this._clock.seconds}set seconds(e){const t=this.now(),n=this._clock.frequency.timeToTicks(e,t);this.ticks=n}get progress(){if(this.loop){const e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){const t=this.now();if(this.state==="started"){const n=this._clock.getTicksAtTime(t),s=this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,t),i=t+s;this.emit("stop",i),this._clock.setTicksAtTime(e,i),this.emit("start",i,this._clock.getSecondsAtTime(i))}else this.emit("ticks",t),this._clock.setTicksAtTime(e,t)}}getTicksAtTime(e){return this._clock.getTicksAtTime(e)}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),this.state!=="started")return 0;{const t=this.now(),n=this.getTicksAtTime(t),s=e-n%e;return this._clock.nextTickTime(s,t)}}syncSignal(e,t){const n=this.now();let s=this.bpm,i=1/(60/s.getValueAtTime(n)/this.PPQ),o=[];if(e.units==="time"){const c=.015625/i,l=new Ve(c),u=new to(-1),h=new Ve(c);s.chain(l,u,h),s=h,i=1/i,o=[l,u,h]}t||(e.getValueAtTime(n)!==0?t=e.getValueAtTime(n)/i:t=0);const a=new Ve(t);return s.connect(a),a.connect(e._param),o.push(a),this._syncedSignals.push({initial:e.value,nodes:o,signal:e}),e.value=0,this}unsyncSignal(e){for(let t=this._syncedSignals.length-1;t>=0;t--){const n=this._syncedSignals[t];n.signal===e&&(n.nodes.forEach(s=>s.dispose()),n.signal.value=n.initial,this._syncedSignals.splice(t,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),bu(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}Oo.mixin(no);sc(r=>{r.transport=new no({context:r})});ic(r=>{r.transport.dispose()});class Dt extends he{constructor(e){super(e),this.input=void 0,this._state=new Eu("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=Ue,this._syncedStop=Ue,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Ps({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,je(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(he.getDefaults(),{mute:!1,onstop:Ue,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,t,n){let s=sn(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(s=this._clampToCurrentTime(s),!this._synced&&this._state.getValueAtTime(s)==="started")_e(Qi(s,this._state.get(s).time),"Start time must be strictly greater than previous start time"),this._state.cancel(s),this._state.setStateAtTime("started",s),this.log("restart",s),this.restart(s,t,n);else if(this.log("start",s),this._state.setStateAtTime("started",s),this._synced){const i=this._state.get(s);i&&(i.offset=this.toSeconds(Bi(t,0)),i.duration=n?this.toSeconds(n):void 0);const o=this.context.transport.schedule(a=>{this._start(a,t,n)},s);this._scheduled.push(o),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>s&&this._syncedStart(this.now(),this.context.transport.seconds)}else zp(this.context),this._start(s,t,n);return this}stop(e){let t=sn(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(t=this._clampToCurrentTime(t),this._state.getValueAtTime(t)==="started"||Ce(this._state.getNextState("started",t))){if(this.log("stop",t),!this._synced)this._stop(t);else{const n=this.context.transport.schedule(this._stop.bind(this),t);this._scheduled.push(n)}this._state.cancel(t),this._state.setStateAtTime("stopped",t)}return this}restart(e,t,n){return e=this.toSeconds(e),this._state.getValueAtTime(e)==="started"&&(this._state.cancel(e),this._restart(e,t,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,t)=>{if(Qi(t,0)){const n=this._state.get(t);if(n&&n.state==="started"&&n.time!==t){const s=t-this.toSeconds(n.time);let i;n.duration&&(i=this.toSeconds(n.duration)-s),this._start(e,this.toSeconds(n.offset)+s,i)}}},this._syncedStop=e=>{const t=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));this._state.getValueAtTime(t)==="started"&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=Ue,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class Ji extends Ki{constructor(){super(K(Ji.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const e=K(Ji.getDefaults(),arguments,["url","onload"]);Rs(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Fe({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new Ie(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(Ki.getDefaults(),{url:new Ie,loop:!1,loopEnd:0,loopStart:0,onload:Ue,onerror:Ue,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,t,n,s=1){_e(this.buffer.loaded,"buffer is either not set or not loaded");const i=this.toSeconds(e);this._startGain(i,s),this.loop?t=Bi(t,this.loopStart):t=Bi(t,0);let o=Math.max(this.toSeconds(t),0);if(this.loop){const a=this.toSeconds(this.loopEnd)||this.buffer.duration,c=this.toSeconds(this.loopStart),l=a-c;Dl(o,a)&&(o=(o-c)%l+c),bn(o,this.buffer.duration)&&(o=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,Da(o,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(i,o)),Ce(n)){let a=this.toSeconds(n);a=Math.max(a,0),this.stop(i+a)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class so extends Dt{constructor(){super(K(so.getDefaults(),arguments,["type"])),this.name="Noise",this._source=null;const e=K(so.getDefaults(),arguments,["type"]);this._playbackRate=e.playbackRate,this.type=e.type,this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Dt.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(e){if(_e(e in fd,"Noise: invalid type: "+e),this._type!==e&&(this._type=e,this.state==="started")){const t=this.now();this._stop(t),this._start(t)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._source&&(this._source.playbackRate.value=e)}_start(e){const t=fd[this._type];this._source=new Ji({url:t,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(e),Math.random()*(t.duration-.001))}_stop(e){this._source&&(this._source.stop(this.toSeconds(e)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(e){this._stop(e),this._start(e)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}const Ei=44100*5,el=2,Kn={brown:null,pink:null,white:null},fd={get brown(){if(!Kn.brown){const r=[];for(let e=0;e<el;e++){const t=new Float32Array(Ei);r[e]=t;let n=0;for(let s=0;s<Ei;s++){const i=Math.random()*2-1;t[s]=(n+.02*i)/1.02,n=t[s],t[s]*=3.5}}Kn.brown=new Ie().fromArray(r)}return Kn.brown},get pink(){if(!Kn.pink){const r=[];for(let e=0;e<el;e++){const t=new Float32Array(Ei);r[e]=t;let n,s,i,o,a,c,l;n=s=i=o=a=c=l=0;for(let u=0;u<Ei;u++){const h=Math.random()*2-1;n=.99886*n+h*.0555179,s=.99332*s+h*.0750759,i=.969*i+h*.153852,o=.8665*o+h*.3104856,a=.55*a+h*.5329522,c=-.7616*c-h*.016898,t[u]=n+s+i+o+a+c+l+h*.5362,t[u]*=.11,l=h*.115926}}Kn.pink=new Ie().fromArray(r)}return Kn.pink},get white(){if(!Kn.white){const r=[];for(let e=0;e<el;e++){const t=new Float32Array(Ei);r[e]=t;for(let n=0;n<Ei;n++)t[n]=Math.random()*2-1}Kn.white=new Ie().fromArray(r)}return Kn.white}};function pi(r,e){return ht(this,void 0,void 0,function*(){const t=e/r.context.sampleRate,n=new rc(1,t,r.context.sampleRate);return new r.constructor(Object.assign(r.get(),{frequency:2/t,detune:0,context:n})).toDestination().start(0),(yield n.render()).getChannelData(0)})}class Ia extends Ki{constructor(){super(K(Ia.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const e=K(Ia.getDefaults(),arguments,["frequency","type"]);Rs(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new Fe({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new Fe({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),je(this,["frequency","detune"])}static getDefaults(){return Object.assign(Ki.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._oscillator.start(t),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class ut extends Dt{constructor(){super(K(ut.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const e=K(ut.getDefaults(),arguments,["frequency","type"]);this.frequency=new He({context:this.context,units:"frequency",value:e.frequency}),je(this,"frequency"),this.detune=new He({context:this.context,units:"cents",value:e.detune}),je(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&e.type!=="custom"&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(Dt.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){const t=this.toSeconds(e),n=new Ia({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(t)}_stop(e){const t=this.toSeconds(e);this._oscillator&&this._oscillator.stop(t)}_restart(e){const t=this.toSeconds(e);return this.log("restart",t),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(t),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return ut._periodicWaveCache.find(t=>t.phase===this._phase&&iS(t.partials,this._partials));{const e=ut._periodicWaveCache.find(t=>t.type===this._type&&t.phase===this._phase);return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;const t=["sine","square","sawtooth","triangle"].indexOf(e)!==-1;if(this._phase===0&&t)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=e);else{const n=this._getCachedPeriodicWave();if(Ce(n)){const{partials:s,wave:i}=n;this._wave=i,this._partials=s,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{const[s,i]=this._getRealImaginary(e,this._phase),o=this.context.createPeriodicWave(s,i);this._wave=o,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),ut._periodicWaveCache.push({imag:i,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:s,type:this._type,wave:this._wave}),ut._periodicWaveCache.length>100&&ut._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&this._type!=="custom"&&e!=="custom"?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){Dn(e,0);let t=this._type;const n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(t=n[1]),this._type!=="custom")e===0?this.type=t:this.type=t+e.toString();else{const s=new Float32Array(e);this._partials.forEach((i,o)=>s[o]=i),this._partials=Array.from(s),this.type=this._type}}_getRealImaginary(e,t){let s=2048;const i=new Float32Array(s),o=new Float32Array(s);let a=1;if(e==="custom"){if(a=this._partials.length+1,this._partialCount=this._partials.length,s=a,this._partials.length===0)return[i,o]}else{const c=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);c?(a=parseInt(c[2],10)+1,this._partialCount=parseInt(c[2],10),e=c[1],a=Math.max(a,2),s=a):this._partialCount=0,this._partials=[]}for(let c=1;c<s;++c){const l=2/(c*Math.PI);let u;switch(e){case"sine":u=c<=a?1:0,this._partials[c-1]=u;break;case"square":u=c&1?2*l:0,this._partials[c-1]=u;break;case"sawtooth":u=l*(c&1?1:-1),this._partials[c-1]=u;break;case"triangle":c&1?u=2*(l*l)*(c-1>>1&1?-1:1):u=0,this._partials[c-1]=u;break;case"custom":u=this._partials[c-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}u!==0?(i[c]=-u*Math.sin(t*c),o[c]=u*Math.cos(t*c)):(i[c]=0,o[c]=0)}return[i,o]}_inverseFFT(e,t,n){let s=0;const i=e.length;for(let o=0;o<i;o++)s+=e[o]*Math.cos(o*n)+t[o]*Math.sin(o*n);return s}getInitialValue(){const[e,t]=this._getRealImaginary(this._type,0);let n=0;const s=Math.PI*2,i=32;for(let o=0;o<i;o++)n=Math.max(this._inverseFFT(e,t,o/i*s),n);return oS(-this._inverseFFT(e,t,this._phase)/n,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(e=1024){return ht(this,void 0,void 0,function*(){return pi(this,e)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}ut._periodicWaveCache=[];class CS extends as{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new ci({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Is extends He{constructor(){super(Object.assign(K(Is.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const e=K(Is.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new Ve({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(He.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class io extends Dt{constructor(){super(K(io.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new CS({context:this.context}),this._modulationNode=new Ve({context:this.context});const e=K(io.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new ut({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new ut({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Is({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),je(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(ut.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return ht(this,void 0,void 0,function*(){return pi(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class ro extends Dt{constructor(){super(K(ro.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new Ve({context:this.context,gain:0});const e=K(ro.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new ut({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new He({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new ut({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Is({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new Is({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),je(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(ut.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(e=1024){return ht(this,void 0,void 0,function*(){return pi(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class $i extends Dt{constructor(){super(K($i.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new Ve({context:this.context,gain:0}),this._thresh=new ci({context:this.context,mapping:t=>t<=0?-1:1});const e=K($i.getDefaults(),arguments,["frequency","width"]);this.width=new He({context:this.context,units:"audioRange",value:e.width}),this._triangle=new ut({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),je(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Dt.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(e=1024){return ht(this,void 0,void 0,function*(){return pi(this,e)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class oo extends Dt{constructor(){super(K(oo.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const e=K(oo.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new He({context:this.context,units:"frequency",value:e.frequency}),this.detune=new He({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,je(this,["frequency","detune"])}static getDefaults(){return Object.assign(ut.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach(t=>t.start(e))}_stop(e){e=this.toSeconds(e),this._forEach(t=>t.stop(e))}_restart(e){this._forEach(t=>t.restart(e))}_forEach(e){for(let t=0;t<this._oscillators.length;t++)e(this._oscillators[t],t)}get type(){return this._type}set type(e){this._type=e,this._forEach(t=>t.type=e)}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){const t=-e/2,n=e/(this._oscillators.length-1);this._forEach((s,i)=>s.detune.value=t+n*i)}}get count(){return this._oscillators.length}set count(e){if(Dn(e,1),this._oscillators.length!==e){this._forEach(t=>t.dispose()),this._oscillators=[];for(let t=0;t<e;t++){const n=new ut({context:this.context,volume:-6-e*1.1,type:this._type,phase:this._phase+t/e*360,partialCount:this._partialCount,onstop:t===0?()=>this.onstop(this):Ue});this.type==="custom"&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[t]=n}this.spread=this._spread,this.state==="started"&&this._forEach(t=>t.start())}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach((t,n)=>t.phase=this._phase+n/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach(t=>t.baseType=e),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach(t=>t.partials=e))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach(t=>t.partialCount=e),this._type=this._oscillators[0].type}asArray(e=1024){return ht(this,void 0,void 0,function*(){return pi(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(e=>e.dispose()),this}}class ao extends Dt{constructor(){super(K(ao.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Is({context:this.context,value:2});const e=K(ao.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new $i({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new ut({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),je(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Dt.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(e=1024){return ht(this,void 0,void 0,function*(){return pi(this,e)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const pd={am:io,fat:oo,fm:ro,oscillator:ut,pulse:$i,pwm:ao};class li extends Dt{constructor(){super(K(li.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const e=K(li.getDefaults(),arguments,["frequency","type"]);this.frequency=new He({context:this.context,units:"frequency",value:e.frequency}),this.detune=new He({context:this.context,units:"cents",value:e.detune}),je(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(ut.getDefaults(),ro.getDefaults(),io.getDefaults(),oo.getDefaults(),$i.getDefaults(),ao.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some(t=>this._sourceType===t)&&(e=this._sourceType),e+this._oscillator.type}set type(e){e.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):e==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):e==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;const t=pd[e],n=this.now();if(this._oscillator){const s=this._oscillator;s.stop(n),this.context.setTimeout(()=>s.dispose(),this.blockTime)}this._oscillator=new t({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let t="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(t=this._oscillator.type),e==="fm"?this.type="fm"+t:e==="am"?this.type="am"+t:e==="fat"?this.type="fat"+t:e==="oscillator"?this.type=t:e==="pulse"?this.type="pulse":e==="pwm"&&(this.type="pwm")}_getOscType(e,t){return e instanceof pd[t]}get baseType(){return this._oscillator.baseType}set baseType(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&e!=="pulse"&&e!=="pwm"&&(this._oscillator.baseType=e)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(e){this._getOscType(this._oscillator,"fat")&&Ms(e)&&(this._oscillator.count=e)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(e){this._getOscType(this._oscillator,"fat")&&Ms(e)&&(this._oscillator.spread=e)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&os(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(e=1024){return ht(this,void 0,void 0,function*(){return pi(this,e)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class Du extends He{constructor(){super(Object.assign(K(Du.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Add",this._sum=new Ve({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,$r(this._constantSource,this._sum)}static getDefaults(){return Object.assign(He.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class Fa extends as{constructor(){super(Object.assign(K(Fa.getDefaults(),arguments,["min","max"]))),this.name="Scale";const e=K(Fa.getDefaults(),arguments,["min","max"]);this._mult=this.input=new Is({context:this.context,value:e.max-e.min}),this._add=this.output=new Du({context:this.context,value:e.min}),this._min=e.min,this._max=e.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(as.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(e){this._min=e,this._setRange()}get max(){return this._max}set max(e){this._max=e,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}function Zp(r,e=1/0){const t=new WeakMap;return function(n,s){Reflect.defineProperty(n,s,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(i){Dn(i,r,e),t.set(this,i)}})}}function ds(r,e=1/0){const t=new WeakMap;return function(n,s){Reflect.defineProperty(n,s,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(i){Dn(this.toSeconds(i),r,e),t.set(this,i)}})}}class co extends Dt{constructor(){super(K(co.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const e=K(co.getDefaults(),arguments,["url","onload"]);this._buffer=new Ie({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Dt.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Ue,onerror:Ue,playbackRate:1,reverse:!1})}load(e){return ht(this,void 0,void 0,function*(){return yield this._buffer.load(e),this._onload(),this})}_onload(e=Ue){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,t,n){return super.start(e,t,n),this}_start(e,t,n){this._loop?t=Bi(t,this._loopStart):t=Bi(t,0);const s=this.toSeconds(t),i=n;n=Bi(n,Math.max(this._buffer.duration-s,0));let o=this.toSeconds(n);o=o/this._playbackRate,e=this.toSeconds(e);const a=new Ji({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(e+o),this._state.setStateAtTime("stopped",e+o,{implicitEnd:!0})),this._activeSources.add(a),this._loop&&sn(i)?a.start(e,s):a.start(e,s,o-this.toSeconds(this.fadeOut))}_stop(e){const t=this.toSeconds(e);this._activeSources.forEach(n=>n.stop(t))}restart(e,t,n){return super.restart(e,t,n),this}_restart(e,t,n){var s;(s=[...this._activeSources].pop())===null||s===void 0||s.stop(e),this._start(e,t,n)}seek(e,t){const n=this.toSeconds(t);if(this._state.getValueAtTime(n)==="started"){const s=this.toSeconds(e);this._stop(n),this._start(n,s)}return this}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&Dn(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&Dn(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(t=>{t.loop=e}),e)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;const t=this.now(),n=this._state.getNextState("stopped",t);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach(s=>s.cancelStop())),this._activeSources.forEach(s=>{s.playbackRate.setValueAtTime(e,t)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}Mn([ds(0)],co.prototype,"fadeIn",void 0);Mn([ds(0)],co.prototype,"fadeOut",void 0);class ES extends as{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new ci({context:this.context,mapping:e=>Math.abs(e)*2-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class gn extends he{constructor(){super(K(gn.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new He({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const e=K(gn.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(he.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,t){if(os(e))return e;{let n;for(n in ia)if(ia[n][t]===e)return n;return e}}_setCurve(e,t,n){if(os(n)&&Reflect.has(ia,n)){const s=ia[n];ni(s)?e!=="_decayCurve"&&(this[e]=s[t]):this[e]=s}else if(An(n)&&e!=="_decayCurve")this[e]=n;else throw new Error("Envelope: invalid curve: "+n)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._getCurve(this._decayCurve,"Out")}set decayCurve(e){this._setCurve("_decayCurve","Out",e)}triggerAttack(e,t=1){this.log("triggerAttack",e,t),e=this.toSeconds(e);let s=this.toSeconds(this.attack);const i=this.toSeconds(this.decay),o=this.getValueAtTime(e);if(o>0){const a=1/s;s=(1-o)/a}if(s<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(t,e);else if(this._attackCurve==="linear")this._sig.linearRampTo(t,s,e);else if(this._attackCurve==="exponential")this._sig.targetRampTo(t,s,e);else{this._sig.cancelAndHoldAtTime(e);let a=this._attackCurve;for(let c=1;c<a.length;c++)if(a[c-1]<=o&&o<=a[c]){a=this._attackCurve.slice(c),a[0]=o;break}this._sig.setValueCurveAtTime(a,e,s,t)}if(i&&this.sustain<1){const a=t*this.sustain,c=e+s;this.log("decay",c),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(a,i+c):this._sig.exponentialApproachValueAtTime(a,c,i)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);const t=this.getValueAtTime(e);if(t>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,e):this._releaseCurve==="linear"?this._sig.linearRampTo(0,n,e):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,n,e):(_e(An(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,n,t))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,t,n=1){return t=this.toSeconds(t),this.triggerAttack(t,n),this.triggerRelease(t+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,t=0,n=0){return Ou(this,e,t,n),this}asArray(e=1024){return ht(this,void 0,void 0,function*(){const t=e/this.context.sampleRate,n=new rc(1,t,this.context.sampleRate),s=this.toSeconds(this.attack)+this.toSeconds(this.decay),i=s+this.toSeconds(this.release),o=i*.1,a=i+o,c=new this.constructor(Object.assign(this.get(),{attack:t*this.toSeconds(this.attack)/a,decay:t*this.toSeconds(this.decay)/a,release:t*this.toSeconds(this.release)/a,context:n}));return c._sig.toDestination(),c.triggerAttackRelease(t*(s+o)/a,0),(yield n.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}Mn([ds(0)],gn.prototype,"attack",void 0);Mn([ds(0)],gn.prototype,"decay",void 0);Mn([Zp(0,1)],gn.prototype,"sustain",void 0);Mn([ds(0)],gn.prototype,"release",void 0);const ia=(()=>{let e,t;const n=[];for(e=0;e<128;e++)n[e]=Math.sin(e/(128-1)*(Math.PI/2));const s=[],i=6.4;for(e=0;e<128-1;e++){t=e/(128-1);const d=Math.sin(t*(Math.PI*2)*i-Math.PI/2)+1;s[e]=d/10+t*.83}s[128-1]=1;const o=[],a=5;for(e=0;e<128;e++)o[e]=Math.ceil(e/(128-1)*a)/a;const c=[];for(e=0;e<128;e++)t=e/(128-1),c[e]=.5*(1-Math.cos(Math.PI*t));const l=[];for(e=0;e<128;e++){t=e/(128-1);const d=Math.pow(t,3)*4+.2,f=Math.cos(d*Math.PI*2*t);l[e]=Math.abs(f*(1-t))}function u(d){const f=new Array(d.length);for(let m=0;m<d.length;m++)f[m]=1-d[m];return f}function h(d){return d.slice(0).reverse()}return{bounce:{In:u(l),Out:l},cosine:{In:n,Out:h(n)},exponential:"exponential",linear:"linear",ripple:{In:s,Out:u(s)},sine:{In:c,Out:u(c)},step:{In:o,Out:u(o)}}})();class ui extends he{constructor(){super(K(ui.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease,this._syncedRelease=t=>this._original_triggerRelease(t);const e=K(ui.getDefaults(),arguments);this._volume=this.output=new Ps({context:this.context,volume:e.volume}),this.volume=this._volume.volume,je(this,"volume")}static getDefaults(){return Object.assign(he.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}_syncState(){let e=!1;return this._synced||(this._synced=!0,e=!0),e}_syncMethod(e,t){const n=this["_original_"+e]=this[e];this[e]=(...s)=>{const i=s[t],o=this.context.transport.schedule(a=>{s[t]=a,n.apply(this,s)},i);this._scheduledEvents.push(o)}}unsync(){return this._scheduledEvents.forEach(e=>this.context.transport.clear(e)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease,this.context.transport.off("stop",this._syncedRelease),this.context.transport.off("pause",this._syncedRelease),this.context.transport.off("loopEnd",this._syncedRelease)),this}triggerAttackRelease(e,t,n,s){const i=this.toSeconds(n),o=this.toSeconds(t);return this.triggerAttack(e,i,s),this.triggerRelease(i+o),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class cs extends ui{constructor(){super(K(cs.getDefaults(),arguments));const e=K(cs.getDefaults(),arguments);this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign(ui.getDefaults(),{detune:0,onsilence:Ue,portamento:0})}triggerAttack(e,t,n=1){this.log("triggerAttack",e,t,n);const s=this.toSeconds(t);return this._triggerEnvelopeAttack(s,n),this.setNote(e,s),this}triggerRelease(e){this.log("triggerRelease",e);const t=this.toSeconds(e);return this._triggerEnvelopeRelease(t),this}setNote(e,t){const n=this.toSeconds(t),s=e instanceof pn?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const i=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(s,i,n)}else this.frequency.setValueAtTime(s,n);return this}}Mn([ds(0)],cs.prototype,"portamento",void 0);class ac extends gn{constructor(){super(K(ac.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new Ve({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class lo extends cs{constructor(){super(K(lo.getDefaults(),arguments)),this.name="Synth";const e=K(lo.getDefaults(),arguments);this.oscillator=new li(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new ac(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),je(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(cs.getDefaults(),{envelope:Object.assign(Pi(gn.getDefaults(),Object.keys(he.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Pi(li.getDefaults(),[...Object.keys(Dt.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,t){if(this.envelope.triggerAttack(e,t),this.oscillator.start(e),this.envelope.sustain===0){const n=this.toSeconds(this.envelope.attack),s=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+n+s)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class uo extends he{constructor(){super(K(uo.getDefaults(),arguments,["frequency","type"])),this.name="BiquadFilter";const e=K(uo.getDefaults(),arguments,["frequency","type"]);this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new Fe({context:this.context,units:"number",value:e.Q,param:this._filter.Q}),this.frequency=new Fe({context:this.context,units:"frequency",value:e.frequency,param:this._filter.frequency}),this.detune=new Fe({context:this.context,units:"cents",value:e.detune,param:this._filter.detune}),this.gain=new Fe({context:this.context,units:"decibels",convert:!1,value:e.gain,param:this._filter.gain}),this.type=e.type}static getDefaults(){return Object.assign(he.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(e){_e(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e)!==-1,`Invalid filter type: ${e}`),this._filter.type=e}getFrequencyResponse(e=128){const t=new Float32Array(e);for(let o=0;o<e;o++){const c=Math.pow(o/e,2)*(2e4-20)+20;t[o]=c}const n=new Float32Array(e),s=new Float32Array(e),i=this.context.createBiquadFilter();return i.type=this.type,i.Q.value=this.Q.value,i.frequency.value=this.frequency.value,i.gain.value=this.gain.value,i.getFrequencyResponse(t,n,s),n}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class er extends he{constructor(){super(K(er.getDefaults(),arguments,["frequency","type","rolloff"])),this.name="Filter",this.input=new Ve({context:this.context}),this.output=new Ve({context:this.context}),this._filters=[];const e=K(er.getDefaults(),arguments,["frequency","type","rolloff"]);this._filters=[],this.Q=new He({context:this.context,units:"positive",value:e.Q}),this.frequency=new He({context:this.context,units:"frequency",value:e.frequency}),this.detune=new He({context:this.context,units:"cents",value:e.detune}),this.gain=new He({context:this.context,units:"decibels",convert:!1,value:e.gain}),this._type=e.type,this.rolloff=e.rolloff,je(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(he.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(e){_e(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e)!==-1,`Invalid filter type: ${e}`),this._type=e,this._filters.forEach(n=>n.type=e)}get rolloff(){return this._rolloff}set rolloff(e){const t=Ms(e)?e:parseInt(e,10),n=[-12,-24,-48,-96];let s=n.indexOf(t);_e(s!==-1,`rolloff can only be ${n.join(", ")}`),s+=1,this._rolloff=t,this.input.disconnect(),this._filters.forEach(i=>i.disconnect()),this._filters=new Array(s);for(let i=0;i<s;i++){const o=new uo({context:this.context});o.type=this._type,this.frequency.connect(o.frequency),this.detune.connect(o.detune),this.Q.connect(o.Q),this.gain.connect(o.gain),this._filters[i]=o}this._internalChannels=this._filters,$r(this.input,...this._internalChannels,this.output)}getFrequencyResponse(e=128){const t=new uo({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),n=new Float32Array(e).map(()=>1);return this._filters.forEach(()=>{t.getFrequencyResponse(e).forEach((i,o)=>n[o]*=i)}),t.dispose(),n}dispose(){return super.dispose(),this._filters.forEach(e=>{e.dispose()}),bu(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class ho extends gn{constructor(){super(K(ho.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="FrequencyEnvelope";const e=K(ho.getDefaults(),arguments,["attack","decay","sustain","release"]);this._octaves=e.octaves,this._baseFrequency=this.toFrequency(e.baseFrequency),this._exponent=this.input=new to({context:this.context,value:e.exponent}),this._scale=this.output=new Fa({context:this.context,min:this._baseFrequency,max:this._baseFrequency*Math.pow(2,this._octaves)}),this._sig.chain(this._exponent,this._scale)}static getDefaults(){return Object.assign(gn.getDefaults(),{baseFrequency:200,exponent:1,octaves:4})}get baseFrequency(){return this._baseFrequency}set baseFrequency(e){const t=this.toFrequency(e);Dn(t,0),this._baseFrequency=t,this._scale.min=this._baseFrequency,this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(e){this._octaves=e,this._scale.max=this._baseFrequency*Math.pow(2,e)}get exponent(){return this._exponent.value}set exponent(e){this._exponent.value=e}dispose(){return super.dispose(),this._exponent.dispose(),this._scale.dispose(),this}}class fo extends cs{constructor(){super(K(fo.getDefaults(),arguments)),this.name="MonoSynth";const e=K(fo.getDefaults(),arguments);this.oscillator=new li(Object.assign(e.oscillator,{context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)})),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.filter=new er(Object.assign(e.filter,{context:this.context})),this.filterEnvelope=new ho(Object.assign(e.filterEnvelope,{context:this.context})),this.envelope=new ac(Object.assign(e.envelope,{context:this.context})),this.oscillator.chain(this.filter,this.envelope,this.output),this.filterEnvelope.connect(this.filter.frequency),je(this,["oscillator","frequency","detune","filter","filterEnvelope","envelope"])}static getDefaults(){return Object.assign(cs.getDefaults(),{envelope:Object.assign(Pi(gn.getDefaults(),Object.keys(he.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.9}),filter:Object.assign(Pi(er.getDefaults(),Object.keys(he.getDefaults())),{Q:1,rolloff:-12,type:"lowpass"}),filterEnvelope:Object.assign(Pi(ho.getDefaults(),Object.keys(he.getDefaults())),{attack:.6,baseFrequency:200,decay:.2,exponent:2,octaves:3,release:2,sustain:.5}),oscillator:Object.assign(Pi(li.getDefaults(),Object.keys(Dt.getDefaults())),{type:"sawtooth"})})}_triggerEnvelopeAttack(e,t=1){if(this.envelope.triggerAttack(e,t),this.filterEnvelope.triggerAttack(e),this.oscillator.start(e),this.envelope.sustain===0){const n=this.toSeconds(this.envelope.attack),s=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+n+s)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.filterEnvelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this.filterEnvelope.dispose(),this.filter.dispose(),this}}class po extends lo{constructor(){super(K(po.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const e=K(po.getDefaults(),arguments);this.pitchDecay=e.pitchDecay,this.octaves=e.octaves,je(this,["oscillator","envelope"])}static getDefaults(){return Li(cs.getDefaults(),lo.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(e,t){const n=this.toSeconds(t),s=this.toFrequency(e instanceof pn?e.toFrequency():e),i=s*this.octaves;return this.oscillator.frequency.setValueAtTime(i,n),this.oscillator.frequency.exponentialRampToValueAtTime(s,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}Mn([Zp(0)],po.prototype,"octaves",void 0);Mn([ds(0)],po.prototype,"pitchDecay",void 0);const Qp=new Set;function Mu(r){Qp.add(r)}function Kp(r,e){const t=`registerProcessor("${r}", ${e})`;Qp.add(t)}const OS=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;Mu(OS);const AS=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;Mu(AS);const kS=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;Mu(kS);const DS="feedback-comb-filter",MS=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;Kp(DS,MS);class mo extends ui{constructor(){super(K(mo.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const e=K(mo.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),t={};Object.keys(e.urls).forEach(n=>{const s=parseInt(n,10);if(_e(sa(n)||Ms(s)&&isFinite(s),`url key is neither a note or midi pitch: ${n}`),sa(n)){const i=new pn(this.context,n).toMidi();t[i]=e.urls[n]}else Ms(s)&&isFinite(s)&&(t[s]=e.urls[s])}),this._buffers=new Au({urls:t,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign(ui.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:Ue,onerror:Ue,release:.1,urls:{}})}_findClosest(e){let n=0;for(;n<96;){if(this._buffers.has(e+n))return-n;if(this._buffers.has(e-n))return n;n++}throw new Error(`No available buffers for note: ${e}`)}triggerAttack(e,t,n=1){return this.log("triggerAttack",e,t,n),Array.isArray(e)||(e=[e]),e.forEach(s=>{const i=Xp(new pn(this.context,s).toFrequency()),o=Math.round(i),a=i-o,c=this._findClosest(o),l=o-c,u=this._buffers.get(l),h=Yp(c+a),d=new Ji({url:u,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:h}).connect(this.output);d.start(t,0,u.duration/h,n),An(this._activeSources.get(o))||this._activeSources.set(o,[]),this._activeSources.get(o).push(d),d.onended=()=>{if(this._activeSources&&this._activeSources.has(o)){const f=this._activeSources.get(o),m=f.indexOf(d);m!==-1&&f.splice(m,1)}}}),this}triggerRelease(e,t){return this.log("triggerRelease",e,t),Array.isArray(e)||(e=[e]),e.forEach(n=>{const s=new pn(this.context,n).toMidi();if(this._activeSources.has(s)&&this._activeSources.get(s).length){const i=this._activeSources.get(s);t=this.toSeconds(t),i.forEach(o=>{o.stop(t)}),this._activeSources.set(s,[])}}),this}releaseAll(e){const t=this.toSeconds(e);return this._activeSources.forEach(n=>{for(;n.length;)n.shift().stop(t)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(e,t,n,s=1){const i=this.toSeconds(n);return this.triggerAttack(e,i,s),An(t)?(_e(An(e),"notes must be an array when duration is array"),e.forEach((o,a)=>{const c=t[Math.min(a,t.length-1)];this.triggerRelease(o,i+this.toSeconds(c))})):this.triggerRelease(e,i+this.toSeconds(t)),this}add(e,t,n){if(_e(sa(e)||isFinite(e),`note must be a pitch or midi: ${e}`),sa(e)){const s=new pn(this.context,e).toMidi();this._buffers.add(s,t,n)}else this._buffers.add(e,t,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(e=>{e.forEach(t=>t.dispose())}),this._activeSources.clear(),this}}Mn([ds(0)],mo.prototype,"attack",void 0);Mn([ds(0)],mo.prototype,"release",void 0);class Na extends he{constructor(){super(Object.assign(K(Na.getDefaults(),arguments,["fade"]))),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new ES({context:this.context}),this.a=new Ve({context:this.context,gain:0}),this.b=new Ve({context:this.context,gain:0}),this.output=new Ve({context:this.context}),this._internalChannels=[this.a,this.b];const e=K(Na.getDefaults(),arguments,["fade"]);this.fade=new He({context:this.context,units:"normalRange",value:e.fade}),je(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",Rs(this._split,this.a.gain,0),Rs(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(he.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}class md extends he{constructor(e){super(e),this.name="Effect",this._dryWet=new Na({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new Ve({context:this.context}),this.effectReturn=new Ve({context:this.context}),this.input=new Ve({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(e.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],je(this,"wet")}static getDefaults(){return Object.assign(he.getDefaults(),{wet:1})}connectEffect(e){return this._internalChannels.push(e),this.effectSend.chain(e,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}class La extends he{constructor(){super(Object.assign(K(La.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const e=K(La.getDefaults(),arguments,["pan"]);this.pan=new Fe({context:this.context,param:this._panner.pan,value:e.pan,minValue:-1,maxValue:1}),this._panner.channelCount=e.channelCount,this._panner.channelCountMode="explicit",je(this,"pan")}static getDefaults(){return Object.assign(he.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}const RS="bit-crusher",PS=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;Kp(RS,PS);class Ba extends he{constructor(){super(K(Ba.getDefaults(),arguments,["channels"])),this.name="Merge";const e=K(Ba.getDefaults(),arguments,["channels"]);this._merger=this.output=this.input=this.context.createChannelMerger(e.channels)}static getDefaults(){return Object.assign(he.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class za extends md{constructor(){super(K(za.getDefaults(),arguments,["decay"])),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();const e=K(za.getDefaults(),arguments,["decay"]);this._decay=e.decay,this._preDelay=e.preDelay,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(md.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(e){e=this.toSeconds(e),Dn(e,.001),this._decay=e,this.generate()}get preDelay(){return this._preDelay}set preDelay(e){e=this.toSeconds(e),Dn(e,0),this._preDelay=e,this.generate()}generate(){return ht(this,void 0,void 0,function*(){const e=this.ready,t=new rc(2,this._decay+this._preDelay,this.context.sampleRate),n=new so({context:t}),s=new so({context:t}),i=new Ba({context:t});n.connect(i,0,0),s.connect(i,0,1);const o=new Ve({context:t}).toDestination();i.connect(o),n.start(0),s.start(0),o.gain.setValueAtTime(0,0),o.gain.setValueAtTime(1,this._preDelay),o.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);const a=t.render();return this.ready=a.then(Ue),yield e,this._convolver.buffer=(yield a).get(),this})}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class ct extends he{constructor(){super(K(ct.getDefaults(),arguments,["solo"])),this.name="Solo";const e=K(ct.getDefaults(),arguments,["solo"]);this.input=this.output=new Ve({context:this.context}),ct._allSolos.has(this.context)||ct._allSolos.set(this.context,new Set),ct._allSolos.get(this.context).add(this),this.solo=e.solo}static getDefaults(){return Object.assign(he.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(e){e?this._addSolo():this._removeSolo(),ct._allSolos.get(this.context).forEach(t=>t._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){ct._soloed.has(this.context)||ct._soloed.set(this.context,new Set),ct._soloed.get(this.context).add(this)}_removeSolo(){ct._soloed.has(this.context)&&ct._soloed.get(this.context).delete(this)}_isSoloed(){return ct._soloed.has(this.context)&&ct._soloed.get(this.context).has(this)}_noSolos(){return!ct._soloed.has(this.context)||ct._soloed.has(this.context)&&ct._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),ct._allSolos.get(this.context).delete(this),this._removeSolo(),this}}ct._allSolos=new Map;ct._soloed=new Map;class Va extends he{constructor(){super(K(Va.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const e=K(Va.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new La({context:this.context,pan:e.pan,channelCount:e.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Ps({context:this.context,volume:e.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=e.mute,je(this,["pan","volume"])}static getDefaults(){return Object.assign(he.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class Ys extends he{constructor(){super(K(Ys.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const e=K(Ys.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new ct({solo:e.solo,context:this.context}),this._panVol=this.output=new Va({context:this.context,pan:e.pan,volume:e.volume,mute:e.mute,channelCount:e.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),je(this,["pan","volume"])}static getDefaults(){return Object.assign(he.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(e){this._solo.solo=e}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(e){this._panVol.mute=e}_getBus(e){return Ys.buses.has(e)||Ys.buses.set(e,new Ve({context:this.context})),Ys.buses.get(e)}send(e,t=0){const n=this._getBus(e),s=new Ve({context:this.context,units:"decibels",gain:t});return this.connect(s),s.connect(n),s}receive(e){return this._getBus(e).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}Ys.buses=new Map;class US extends he{constructor(){super(...arguments),this.name="Listener",this.positionX=new Fe({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Fe({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Fe({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Fe({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Fe({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Fe({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Fe({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Fe({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Fe({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(he.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}sc(r=>{r.listener=new US({context:r})});ic(r=>{r.listener.dispose()});En().transport;const Ru=En().destination;En().destination;En().listener;En().draw;En();const Pu=new er(900,"highpass"),Jp=new Ps(-6);Jp.chain(Pu,Ru);const IS=new za(3).connect(Jp),cc=new fo({envelope:{attack:0,decay:.9,sustain:.2,release:.1}});cc.oscillator.type="triangle2";cc.volume.value=-6;cc.chain(Pu,Ru);const lc=new fo({envelope:{attack:.4,decay:.9,sustain:.7,release:.6}}).connect(IS);lc.oscillator.type="triangle";lc.volume.value=-6;lc.chain(Pu,Ru);function FS(){return Math.floor((Math.random()-.5)*20)}let _d=!1;const Mb=async(r=0)=>{_d||(await hS(),_d=!0);try{if(r>2e3)lc.triggerAttackRelease(60,.3);else if(r>1e3){let e=310;e+=FS(),cc.triggerAttackRelease(e,.001)}}catch(e){console.warn(e)}},Rb=r=>Qs.jsx("svg",{width:"1em",height:"1em",viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:Qs.jsx("g",{id:"Type=Edit, Size=20x20",children:Qs.jsx("path",{id:"icon","fill-rule":"evenodd","clip-rule":"evenodd",d:"M14.9243 3.3359L9.06461 9.19559C8.97523 9.28497 8.9036 9.39048 8.85353 9.50654L7.99772 11.49C7.89015 11.7394 8.14272 11.9919 8.39203 11.8843L10.3755 11.0285C10.4916 10.9785 10.5971 10.9068 10.6865 10.8175L16.5462 4.95777C16.994 4.50991 16.994 3.78377 16.5462 3.3359C16.0983 2.88804 15.3722 2.88804 14.9243 3.3359ZM14.5297 10.7363C14.5297 10.3876 14.8127 10.1047 15.1615 10.1047C15.5116 10.1047 15.7933 10.3889 15.7933 10.7363L15.7222 14.1051C15.7222 15.1499 14.8954 16 13.8506 16H5.87166C4.85054 16 4 15.1499 4 14.0814V6.0806C4 5.05918 4.85054 4.2091 5.87166 4.2091L9.68606 4.20936C10.0362 4.20936 10.3178 4.49228 10.3178 4.841C10.3178 5.18972 10.0349 5.47264 9.68606 5.47264H5.89535C5.54735 5.47264 5.26357 5.75609 5.26357 6.10428V14.1051C5.26357 14.4533 5.54735 14.7367 5.89535 14.7367H13.898C14.246 14.7367 14.5297 14.4533 14.5297 14.1051V10.7363Z",fill:"currentColor"})})});export{XS as A,$S as B,HS as C,Rb as E,zS as L,eb as O,YS as P,dt as R,jS as S,WS as T,tb as V,qS as a,VS as b,ZS as c,JS as d,we as e,z0 as g,Mb as p,nb as u};
